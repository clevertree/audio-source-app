{"version":3,"sources":["audio-source/components/div/ASUIDiv.js","audio-source/components/icon/ASUIIcon.js","audio-source/components/button/ASUIButton.js","audio-source/components/menu/dropdown/ASUIDropDownContainer.native.js","audio-source/components/button/ASUIButtonDropDown.js","audio-source/components/form/ASUIForm.js","audio-source/components/form/ASUIPanel.js","audio-source/components/input-range/ASUIInputRange.js","audio-source/components/index.js","audio-source/components/menu/ASUIMenuAction.js","audio-source/components/menu/dropdown/ASUIDropDownContainer.js","audio-source/components/menu/dropdown/ASUIMenuDropDown.js","audio-source/components/menu/ASUIMenuBreak.js","audio-source/components/menu/overlay/ASUIMenuOverlayContainerBase.js","audio-source/components/menu/index.js","audio-source/common/program/ProgramLoader.js","audio-source/common/values/Values.js","audio-source/song/instruction/Instruction.js","audio-source/components/menu/ASUIMenuContext.js","audio-source/song/values/SongValues.js","audio-source/common/storage/LocalStorage.js","audio-source/common/storage/Storage.js","audio-source/3rdparty/chip-player-js-lib/src/players/Player.js","audio-source/3rdparty/chip-player-js-lib/src/effects/SubBass.js","audio-source/3rdparty/chip-player-js-lib/src/players/GMEPlayer.js","audio-source/3rdparty/chip-player-js-lib/src/chip-core.js","audio-source/3rdparty/chip-player-js-lib/src/players/XMPPlayer.js","audio-source/song/file/GMESongFile.js","audio-source/song/file/JSONSongFile.js","audio-source/song/file/FileService.js","audio-source/song/config/ConfigListener.js","audio-source/song/instruction/InstructionIterator.js","audio-source/song/instruction/QuantizedInstructionIterator.js","audio-source/programs/instrument/voice/AudioBufferInstrument.js","audio-source/programs/instrument/voice/render/AudioBufferInstrumentRenderer.js","audio-source/programs/instrument/voice/render/AudioBufferInstrumentRendererStyle.js","audio-source/programs/instrument/loader/PeriodicWaveLoader.js","audio-source/programs/instrument/voice/OscillatorInstrument.js","audio-source/song/library/Library.js","audio-source/programs/instrument/voice/render/OscillatorInstrumentRenderer.js","audio-source/programs/instrument/voice/render/OscillatorInstrumentRendererBase.js","audio-source/programs/instrument/poly/PolyphonyInstrument.js","audio-source/programs/instrument/poly/render/PolyphonyInstrumentRenderer.js","audio-source/programs/instrument/poly/render/PolyphonyInstrumentRendererBase.js","audio-source/programs/player/gme/GMEPlayerSynthesizer.js","audio-source/programs/player/gme/GMEPlayerSynthesizerRenderer.js","audio-source/programs/instrument/test/TestInstrument.js","audio-source/programs/index.js","audio-source/song/track/TrackIterator.js","audio-source/song/track/TrackPlayback.js","audio-source/song/Song.js","audio-source/common/keyboard/Keyboard.js","audio-source/song/index.js","audio-source/components/button/ASUIClickableBase.native.js","audio-source/song/instruction/TrackInstruction.js","audio-source/common/prompt/PromptManager.js","audio-source/song/instruction/NoteInstruction.js","audio-source/song/instruction/CommandInstruction.js","audio-source/song/instruction/MIDIInstruction.js","audio-source/samples/wave/mohayonao.library.js","audio-source/samples/wave.library.js","audio-source/samples/gm/fws/fws.library.js","audio-source/samples/sample.library.js","audio-source/default.library.js","audio-source/song/proxy/SongProxyWebViewClient.js","App.js","serviceWorker.js","index.js"],"names":["ASUIDiv","children","this","props","React","Component","ASUIIcon","className","source","ASUIButton","cb","onMouseInput","e","onKeyDown","context","overlay","disabled","selected","title","onClick","tabIndex","console","warn","constructor","name","onAction","Error","closeAllDropDownMenus","ASUIClickableBase","contextType","ASUIMenuContext","defaultProps","propTypes","PropTypes","func","isRequired","bool","ASUIDropDownContainer","state","open","stick","divRef","createRef","prevProps","prevState","snapshot","getOverlay","addCloseMenuCallback","closeMenu","bind","removeCloseMenuCallback","updateScreenPosition","vertical","options","Provider","value","parentDropDown","ref","isHoverEnabled","openMenu","stickMenu","error","Promise","setState","setTimeout","closeMenus","getAncestorMenus","forEach","menu","stayOpenOnStick","menus","parent","push","closeAllMenus","current","div","rect","getBoundingClientRect","right","window","innerWidth","classList","add","bottom","innerHeight","ASUIButtonDropDown","dropdown","arrow","toggleMenu","hoverMenu","any","ASUIForm","header","ASUIPanel","ASUIInputRange","onChange","preventDefault","newValue","parseFloat","target","type","min","max","step","ASUIMenuAction","ASUIMenuDropDown","getClassName","onMouseEnter","defaultPrevented","isDefaultPrevented","key","info","ASUIMenuBreak","ProgramLoader","song","programID","destination","loadInstanceFromID","data","programs","getData","getProgramClassInfo","classProgram","config","loadInstance","Renderer","classRenderer","registeredProgramClasses","stopPlayback","classes","i","length","stopProgramPlayback","unloadAll","classInfo","Values","onSelectValue","keyboardOctave","renderMenuSelectCommandByFrequency","renderMenuSelectCommandByOctave","renderMenuSelectCommandByNamed","renderMenuSelectCommandByTrack","a","PromptManager","openPromptDialog","values","getAllNamedFrequencies","noteName","frequency","onTrackAdd","getAllSongGroups","trackName","selectedTrack","hasBreak","getNoteFrequencies","renderMenuSelectCommandByFrequencyOctave","getNoteOctaves","octave","renderMenuSelectCommandByOctaveFrequency","currentDuration","timeDivision","renderMenuSelect","results","currentVelocity","customAction","velocity","mixerValue","getNoteVelocities","menuTitle","getRegisteredPrograms","map","d","Date","getTime","performance","now","replace","c","r","Math","random","floor","toString","callback","freq","noteList","j","noteFrequency","result","addResult","noteFrequencies","vi","beatsPerMeasure","beatsPerMeasureString","beatPerMeasure","beatsPerMinute","beatsPerMinuteString","beatPerMinute","lengthInTicks","lengthString","commandString","seconds","m","ms","round","padStart","formattedSeconds","parts","split","parseInt","note","noteQuarterToneList","noteScale","slice","isNaN","keyNumber","pow","durationString","units","substr","fraction","indexOf","fractionSplit","input","stringValue","getNoteDurations","duration","beatDivisor","toFixed","Instruction","instructionData","durationTicks","formatDuration","newCommand","newDeltaDuration","newDuration","trackList","Object","keys","processInstructionTrack","instructionList","Array","isArray","instruction","parseInstruction","unshift","getInstruction","require","unimplemented","createContext","removeDropDownMenu","openMenuItem","addDropDownMenu","SongValues","id","programList","programClass","programInfo","tracks","parseDurationAsTicks","LocalStorage","localStorage","setItem","getItem","Storage","decodeForStorage","json","replacer","space","encodedString","JSON","stringify","LZString","compress","decompress","parse","songData","songHistory","uuid","generateUUID","songRecentUUIDs","filter","entry","encodeForStorage","prompt","instructionsKey","jsonStringInstructions","jsonString","assign","dataStr","encodeURIComponent","downloadAnchorNode","document","createElement","setAttribute","fileName","body","appendChild","click","remove","songUUID","songDataString","songHistoryString","batchRecentCommands","batchCommand","getBatchRecentCommands","batchRecentSearches","getBatchRecentSearches","Player","audioCtx","destNode","chipCore","onPlayerStateUpdate","_outerAudioProcess","paused","fileExtensions","metadata","destinationNode","bufferSize","_innerAudioProcess","audioNode","createScriptProcessor","onaudioprocess","debug","location","search","timeCount","renderTime","perfLoggingInterval","fileExtension","toLowerCase","filename","startMs","index","author","connect","stopped","fn","event","start","end","cost","budget","sampleRate","log","audioprocess","outputBuffer","numberOfChannels","getChannelData","fill","filepath","meta","pop","system","shift","game","artist","SubBass","iirCalculator","CalcCascades","lowpass1Coeffs","lowpass","order","characteristic","Fs","Fc","gain","lowpass2Coeffs","highpassCoeffs","highpass","lowpass1","IirFilter","lowpass2","sCurr","sPrev","cycleCounter","dcAvg","dcWeight","exp","envAvg","envWeight","envelopeStep","sample","removeDcStep","abs","process","sBass","singleStep","env","sOctaves","emu","libgme","GMEPlayer","setParameter","getParameter","getParamDefs","subtune","tempo","params","subbass","buffer","allocate","ALLOC_NORMAL","emuPtr","subBass","setAudioProcess","gmeAudioProcess","channel","channels","getPositionMs","getDurationMs","fadingOut","setFadeout","_gme_track_ended","_gme_play","getValue","sub","_gme_track_count","playSubtune","suspend","_parseMetadata","_gme_start_track","filepathMeta","metadataFromFilepath","formatNeedsBass","match","ccall","stop","resume","metadataPtr","_gme_track_info","offset","readInt32","readString","raw","ptr","char","encoding","convert","to","intro_length","loop_length","play_length","copyright","comment","UTF8ToString","_gme_voice_name","_gme_voice_count","_gme_tell_scaled","label","isPaused","val","_gme_set_tempo","_gme_set_fade","voices","mask","isEnabled","_gme_mute_voices","positionMs","muteAudioDuringCall","_gme_seek_scaled","_gme_delete","CHIP_CORE","Module","moduleOverrides","hasOwnProperty","read_","readBinary","arguments_","thisProgram","scriptDirectory","currentScript","src","lastIndexOf","url","xhr","XMLHttpRequest","send","responseText","wasmBinary","wasmMemory","out","err","dynamicAlloc","size","ret","HEAP32","DYNAMICTOP_PTR","_emscripten_get_heap_size","abort","getNativeTypeSize","bits","Number","assert","setValue","noSafe","charAt","HEAP8","HEAP16","tempI64","tempDouble","Math_abs","Math_min","Math_floor","Math_ceil","HEAPF32","HEAPF64","WebAssembly","wasmTable","Table","ABORT","condition","text","HEAPU8","UTF8Decoder","TextDecoder","undefined","UTF8ArrayToString","u8Array","idx","maxBytesToRead","endIdx","endPtr","subarray","decode","str","u0","u1","u2","String","fromCharCode","ch","stringToUTF8Array","outU8Array","outIdx","maxBytesToWrite","startIdx","u","charCodeAt","stringToUTF8","outPtr","lengthBytesUTF8","len","writeArrayToMemory","array","set","updateGlobalBufferAndViews","buf","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Float32Array","Float64Array","INITIAL_INITIAL_MEMORY","callRuntimeCallbacks","callbacks","arg","Memory","byteLength","__ATPRERUN__","__ATINIT__","__ATMAIN__","__ATPOSTRUN__","ceil","runDependencies","runDependencyWatcher","dependenciesFulfilled","addRunDependency","removeRunDependency","clearInterval","what","RuntimeError","isDataURI","prototype","startsWith","path","wasmBinaryFile","getBinary","ASM_CONSTS","161276","$0","161441","161499","stackTrace","js","stack","jsStackTrace","x","___wasm_call_ctors","___exception_infos","__ZSt18uncaught_exceptionv","uncaught_exceptions","___setErrNo","PATH","splitPath","exec","normalizeArray","allowAboveRoot","up","last","splice","normalize","isAbsolute","trailingSlash","p","join","dirname","root","dir","basename","lastSlash","extname","paths","call","arguments","join2","l","PATH_FS","resolve","resolvedPath","resolvedAbsolute","FS","cwd","TypeError","relative","from","trim","arr","fromParts","toParts","samePartsLength","outputParts","concat","TTY","ttys","init","shutdown","register","dev","ops","output","registerDevice","stream_ops","stream","tty","node","rdev","ErrnoError","seekable","close","flush","read","pos","get_char","bytesRead","timestamp","write","put_char","default_tty_ops","readline","intArrayFromString","default_tty1_ops","MEMFS","ops_table","mount","createNode","mode","isBlkdev","isFIFO","getattr","node_ops","setattr","lookup","mknod","rename","unlink","rmdir","readdir","symlink","llseek","file","mmap","msync","link","readlink","chrdev","chrdev_stream_ops","isDir","contents","isFile","usedBytes","isLink","isChrdev","getFileDataAsRegularArray","getFileDataAsTypedArray","expandFileStorage","newCapacity","prevCapacity","oldContents","resizeFileStorage","newSize","attr","ino","nlink","uid","gid","atime","mtime","ctime","blksize","blocks","genericErrors","old_node","new_dir","new_name","new_node","lookupNode","entries","newname","oldpath","position","canOwn","whence","prot","flags","allocated","fromHeap","_malloc","byteOffset","mmapFlags","mounts","devices","streams","nextInode","nameTable","currentPath","initialized","ignorePermissions","trackingDelegate","tracking","openFlags","READ","WRITE","filesystems","syncFSRequests","handleFSError","errno","lookupPath","opts","defaults","follow_mount","recurse_count","current_path","islast","isMountpoint","mounted","follow","count","getPath","isRoot","mountpoint","hashName","parentid","hash","hashAddNode","name_next","hashRemoveNode","errCode","mayLookup","nodeName","FSNode","destroyNode","isSocket","flagModes","modeStringToFlags","flagsToPermissionString","flag","perms","nodePermissions","mayCreate","mayDelete","isdir","mayOpen","MAX_OPEN_FDS","nextfd","fd_start","fd_end","fd","getStream","createStream","FSStream","object","get","isRead","isWrite","isAppend","newStream","closeStream","device","getDevice","major","minor","makedev","ma","mi","getMounts","check","apply","syncfs","populate","completed","doCallback","done","errored","pseudo","mountRoot","unmount","next","create","mkdir","mkdirTree","dirs","mkdev","newpath","old_path","new_path","old_dir","old_dirname","new_dirname","old_name","message","stat","dontFollow","lstat","chmod","lchmod","fchmod","chown","lchown","fchown","truncate","ftruncate","utime","created","ungotten","readFiles","trackingFlags","isClosed","getdents","seeking","bytesWritten","munmap","ioctl","cmd","readFile","writeFile","actualNumBytes","ArrayBuffer","isView","chdir","createDefaultDirectories","createDefaultDevices","random_device","crypto","randomBuffer","getRandomValues","createDevice","createSpecialDirectories","createStandardStreams","ensureErrnoError","setErrno","code","staticInit","quit","fflush","getMode","canRead","canWrite","joinPath","forceRelative","absolutePath","base","standardizePath","findObject","dontResolveLastLink","analyzePath","exists","parentExists","parentPath","parentObject","createFolder","createPath","reverse","part","createFile","properties","createDataFile","createLink","forceLoadFile","obj","isDevice","isFolder","success","createLazyFile","LazyUint8Array","lengthKnown","chunks","chunkOffset","chunkSize","chunkNum","getter","setDataGetter","cacheLength","status","datalength","getResponseHeader","hasByteServing","usesGzip","lazyArray","setRequestHeader","responseType","overrideMimeType","response","doXHR","_length","_chunkSize","defineProperties","createPreloadedFile","onload","onerror","dontCreateFile","preFinish","Browser","fullname","processData","byteArray","finish","handled","plugin","asyncLoad","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","DB_NAME","pathname","DB_VERSION","DB_STORE_NAME","saveFilesToDB","openRequest","onupgradeneeded","createObjectStore","onsuccess","transaction","files","objectStore","ok","fail","total","putRequest","put","loadFilesFromDB","db","getRequest","SYSCALLS","mappings","DEFAULT_POLLMASK","umask","calculateAt","dirfd","dirstream","doStat","doMsync","addr","doMkdir","doMknod","doReadlink","bufsize","endChar","doAccess","amode","doDup","suggestFD","suggest","doReadv","iov","iovcnt","curr","doWritev","varargs","getStr","getStreamFromFD","get64","low","high","_abs","emscripten_realloc_buffer","grow","ENV","_emscripten_get_environ","strings","navigator","languages","__isLeapYear","year","__arraySum","sum","__MONTH_DAYS_LEAP","__MONTH_DAYS_REGULAR","__addDays","date","days","newDate","leap","getFullYear","currentMonth","getMonth","daysInCurrentMonth","getDate","setDate","setMonth","setFullYear","readAsmConstArgs","sigPtr","args","stringy","dontAddNull","u8array","numBytesWritten","asmLibraryArg","line","destructor","adjusted","refcount","caught","rethrown","op","argp","_free","malloc","syscallMunmap","argbuf","dest","num","copyWithin","requestedSize","oldSize","multiple","cutDown","overGrownHeapSize","__environ","environ_buf","bufSize","string","writeAsciiToMemory","penviron_count","penviron_buf_size","pnum","offset_low","offset_high","newOffset","s","maxsize","format","tm","tm_zone","tm_sec","tm_min","tm_hour","tm_mday","tm_mon","tm_year","tm_wday","tm_yday","tm_isdst","tm_gmtoff","pattern","EXPANSION_RULES_1","rule","RegExp","WEEKDAYS","MONTHS","leadingSomething","digits","character","leadingNulls","compareByDay","date1","date2","sgn","compare","getFirstWeekStartDate","janFourth","getDay","getWeekBasedYear","thisDate","janFourthThisYear","janFourthNextYear","firstWeekStartThisYear","firstWeekStartNextYear","EXPANSION_RULES_2","substring","twelveHour","janFirst","firstSunday","endDate","februaryFirstUntilEndMonth","daysDifference","firstMonday","off","ahead","bytes","_strftime","asm","receiveInstance","instance","module","exports","receiveInstantiatedSource","instantiateArrayBuffer","receiver","fetch","reject","credentials","then","catch","binary","instantiate","reason","instantiateStreaming","instantiateAsync","createWasm","calledRun","stackSave","stackAlloc","stackRestore","run","doRun","postRun","preRun","ident","returnType","argTypes","toC","getCFunc","cArgs","converter","Boolean","convertReturnValue","slab","types","allocator","zeroinit","singleType","typeSize","previousType","old","runCaller","GMESongFile","ChipCore","locateFile","prefix","endsWith","onRuntimeInitialized","audioContext","uint8Array","player","loadData","numVoices","getNumVoices","setTempo","setVoices","AudioContext","loadPlayerFromBuffer","loadSongDataFromPlayer","version","rootGroup","fileURL","instructions","arrayBuffer","JSONSongFile","reader","FileReader","readAsText","fileResult","archiveBuffers","torrentCache","trackerURLS","requireWebTorrent","AudioSourceLoader","customElements","relativeScriptPath","scriptElm","findScript","promises","head","FileService","time","getFileBufferFromTorrent","timeEnd","torrentID","t","torrentURL","getBuffer","parsedURL","hostname","filePath","getTorrent","torrent","archiveFilePath","archiveBuffer","getFileBufferFromArchive","decompress7ZipArchive","WebTorrent","magnetURL","getMagnetURL","client","infoHash","DataStorage","INTERRUPT","fda","filedata","rootdata","worker7z","Worker","onmessage","terminate","fda0","postMessage","action","totalMemory","FilesDataArray","TARGET","Symbol","LISTENER","ConfigListener","updateTimeout","changeListeners","listener","prop","v","b","number","deleteCount","newValues","Proxy","queueChange","queueHistoryAction","proxyObject","addChangeListener","InstructionIterator","currentIndex","positionTicks","endPositionTicks","positionSeconds","endPositionSeconds","lastInstructionPositionInTicks","lastInstructionPositionInSeconds","rowCount","cursorPosition","deltaDurationTicks","elapsedTime","trackEndPositionInTicks","trackPlaybackEndTime","hasReachedEnd","currentInstruction","incrementPositionByInstruction","rowCallback","instructionCallback","nextInstruction","isInteger","QuantizedInstructionIterator","quantizationTicks","nextQuantizationBreakInTicks","nextPositionTicks","getNextInstructionPositionInTicks","doRow","row","updateNextQuantizationBreakInTicks","nextInstructionRow","nextQuantizedInstructionRow","AudioBufferInstrument","audioBuffer","loadAudioBuffer","decodeAudioData","frequencyValue","startTime","onended","velocityGain","createGain","createBufferSource","loop","playbackRate","getCommandFrequency","detune","AudioBufferInstrumentRenderer","sampleID","instrumentID","sampleData","getSampleData","sampleName","toggleOpen","mixer","openMenuChangeMixer","openOnHover","openMenuChangeDetune","openMenuChangeKeyRoot","alias","openMenuChangeKeyAlias","range","openMenuChangeKeyRange","changeLoop","openMenuRoot","openMenuChangeLoop","openMenuChangeSample","renderMenu","changeMixer","detuneValue","changeDetune","getSong","changeRoot","changeAlias","menuKey","changeRange","newMixerValue","samples","getSampleID","newDetuneValue","newRootValue","newAliasValue","newLoopValue","PeriodicWaveLoader","waveURLCache","waveData","real","imag","createPeriodicWave","OscillatorInstrument","oldDestination","waveLoader","osc","createOscillator","isPeriodicWaveAvailable","setPeriodicWave","getCachedPeriodicWaveFromURL","loadPeriodicWaveFromURL","periodicWave","playingOSCs","Library","programClassName","presets","getPresets","onSelectPreset","renderMenuProgramNew","renderMenuProgramAllPresets","includeRecent","lastSelectedLibrary","renderMenuProgramPresets","getLibraries","renderMenuLibraryOptions","library","getTitle","presetConfig","onSelectLibraryOptions","cache","cacheURL","libraryConfig","defaultLibrary","default","libraryData","URL","OscillatorInstrumentRenderer","renderParameters","renderMenuRoot","loadDefault","renderMenuChangeMixer","renderMenuChangeDetune","renderMenuChangeKeyRoot","renderMenuChangeKeyAlias","renderMenuChangeKeyRange","newType","preset","renderMenuChangeOscillator","renderMenuChangeLoop","onRemove","renderMenuChangeOscillatorStandard","loadPreset","changeOscillator","renderMenuSelectCommand","noteNameOctave","PolyphonyInstrument","voiceID","voiceClassName","voiceConfig","voiceClass","voice","loadVoice","playFrequency","PolyphonyInstrumentRenderer","voiceData","renderMenuAddVoice","removeVoice","addVoice","instrumentClassName","promptUser","instrumentConfig","openConfirmDialog","newVoiceID","setStatus","setError","newTitle","songLengthAllPresets","libGMESupport","GMEPlayerSynthesizer","fileBuffer","service","loadBufferFromURL","spcBuffer","loadBuffer","namedFrequency","loadGMEPlayer","spcPlayer","spcPlayers","currentTime","waitTime","seekPos","seekPlaybackPosition","play","pause","aliasName","command","getCommandKeyNumber","noteCommands","GMEPlayerSynthesizerRenderer","TestInstrument","addProgramClass","TrackIterator","startingTrackName","startingBeatsPerMinute","startingTimeDivision","onEvent","activeTracks","startingStats","startPosition","startTrackIteration","trackStats","iterator","instructionGetIterator","totalPositionSeconds","totalEndPositionSeconds","subTrackStats","getTrackName","program","CommandInstruction","processCommandInstruction","TrackInstruction","processTrackInstruction","seekLength","seekPosition","finished","seekToPosition","processInstruction","seekToIndex","TrackPlayback","getStartTrackName","active","endPromise","endResolve","playTrackInstructionCallback","playTrackInstruction","playingIndices","playback","filterCallback","oldCallback","seekInterval","setInterval","renderPlayback","currentPositionSeconds","getPlaybackPosition","timeTillFinished","getEndPositionInSeconds","NoteInstruction","noteStartTime","noteIndex","playInstruction","ProgramList","Song","eventListeners","programLoader","volume","lastVolumeGain","generateTitle","startTrack","track0","track1","getProxiedData","history","loadSongData","programLoadAll","dispatchEventCallback","dispatchEvent","eventName","listenerCallback","eventName2","listenerCallback2","unloadAllPrograms","playbackPosition","processInstructionTracks","currentTrackName","noteDuration","noteVelocity","onstart","parseFrequencyString","getClass","getConfig","programLoadInstanceFromID","programLoadRenderer","programConfig","oldConfig","programGetConfig","isLastProgram","resolveProxiedObject","instructionGetList","insertPositionInTicks","insertInstructionData","insertInstruction","currentPositionInTicks","splitDuration","modifyIndex","instructionReplaceDeltaDuration","instructionInsertAtIndex","lastInsertIndex","lastPauseIndex","insertIndex","deleteIndex","deleteInstruction","instructionGetByIndex","replaceIndex","newDelta","newVelocity","newTrackName","removeTrackName","oldTrackName","removedGroupData","seekToEnd","songPositionInTicks","getGroupPositionFromTicks","groupPositionInTicks","currentPosition","elapsedTicks","ticksToSeconds","positionInSeconds","getSongPlaybackPosition","getGroupPositionInTicks","secondsToTicks","newVolume","getSongPositionFromTicks","setPlaybackPosition","songPosition","getVolumeGain","awaitPlaybackReachedEnd","getPositionInSeconds","stopAllPlayback","selectedIndices","addInstructionFilter","playAtStartingTrackIndex","noteDurationTicks","playProgram","pathList","oldData","historyAction","storage","loadSongFromMemory","loadSongHistoryFromMemory","loadSongHistory","getFileSupportModule","loadSongDataFromFileInput","loadBufferFromFileInput","loadSongDataFromBuffer","fileService","readAsArrayBuffer","fileExt","toJSON","DEFAULT_VOLUME","Keyboard","layoutName","keyboardLayout","getKeyboardLayout","onPress","onLongPress","renderChildren","textProps","doAction","defaultValue","confirm","newCommandName","getCommandName","oldProgram","programInstance","loadProgramFromParams","useDestination","useProgram","getParams","MIDIInstruction","baseURL","MohayonaoWaveLibrary","FWSLibrary","SampleLibrary","WaveLibrary","SongProxyWebViewClient","webView","onMessage","nextProps","nextState","ReactNativeWebView","_AUDIOSOURCE","SONGCLASSES","addEventListener","View","App","menuOpen","playerElm","switchToMenu","updateMenu","forceUpdate","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"mLAGqBA,E,iLAGb,IAAIC,EAAWC,KAAKC,MAAMF,SAG1B,MAFuB,oBAAbA,IACNA,EAAWA,EAASC,OACjB,wBAASA,KAAKC,MAAQF,O,GANAG,IAAMC,WCwB5BC,G,kBAdX,aAAyB,IAAbH,EAAY,uDAAJ,GAAI,qEACdA,EAAO,K,sEAIb,IAAII,EAAY,YAIhB,OAHGL,KAAKC,MAAMK,SACVD,GAAa,IAAML,KAAKC,MAAMK,QAE3B,yBAAKD,UAAWA,Q,GAhBRH,IAAMC,Y,iCCARI,E,YAejB,WAAYN,GAAQ,IAAD,8BACf,4CAAMA,KACDO,GAAK,CACNC,aAAc,SAAAC,GAAC,OAAI,EAAKD,aAAaC,IACrCC,UAAW,SAAAD,GAAC,OAAI,EAAKC,UAAUD,KAJpB,E,0EAQJ,OAAOV,KAAKY,QAAQC,U,+BAI/B,IAAIR,EAAY,iBAQhB,OAPGL,KAAKC,MAAMI,YACVA,GAAa,IAAML,KAAKC,MAAMI,WAC/BL,KAAKC,MAAMa,WACVT,GAAa,aACdL,KAAKC,MAAMc,WACVV,GAAa,aAGb,yBACIW,MAAOhB,KAAKC,MAAMe,MAClBX,UAAWA,EACXY,QAASjB,KAAKQ,GAAGC,aACjBE,UAAWX,KAAKQ,GAAGG,UACnBO,SAAU,GAETlB,KAAKC,MAAMF,Y,+BAQfW,GACL,GAAGV,KAAKC,MAAMa,SACVK,QAAQC,KAAKpB,KAAKqB,YAAYC,KAAO,gBAAiBtB,UAD1D,CAKA,IAAIA,KAAKC,MAAMsB,SACX,MAAM,IAAIC,MAAM,6CAEL,IADAxB,KAAKC,MAAMsB,SAASb,EAAGV,OAElCA,KAAKyB,6B,GA7DuBC,KAAnBnB,EAEVoB,YAAcC,IAFJrB,EAKVsB,aAAe,GALLtB,EASVuB,UAAY,CACfP,SAAUQ,IAAUC,KAAKC,WACzBnB,SAAUiB,IAAUG,M,4CCZtBC,E,YAkBF,WAAYlC,GAAQ,IAAD,8BACf,4CAAMA,KACDmC,MAAQ,CACTC,MAAM,EACNC,OAAO,GAEX,EAAKC,OAASrC,IAAMsC,YANL,E,0EASJ,OAAOxC,KAAKY,QAAQC,U,yCAEhB4B,EAAWC,EAAWC,GAElC3C,KAAK4C,eACA5C,KAAKoC,MAAMC,KACXrC,KAAK4C,aAAaC,qBAAqB7C,KAAMA,KAAK8C,UAAUC,KAAK/C,OAEjEA,KAAK4C,aAAaI,wBAAwBhD,OAElDA,KAAKiD,yB,6CAIFjD,KAAK4C,cACJ5C,KAAK4C,aAAaI,wBAAwBhD,Q,+BAI9C,IAAKA,KAAKoC,MAAMC,KACZ,OAAO,KAEX,IAAIhC,EAAY,qBAKhB,GAJIL,KAAKC,MAAMiD,WACX7C,GAAa,aACbL,KAAKoC,MAAME,QACXjC,GAAa,UACdL,KAAKC,MAAMa,SACV,MAAO,WAEX,IAAIqC,EAAUnD,KAAKoC,MAAMe,QAEzB,OAAO,kBAACvB,EAAA,EAAgBwB,SAAjB,CACHC,MAAO,CAACxC,QAAQb,KAAK4C,aAAcU,eAAetD,OAClD,yBACIK,UAAWA,EACXN,SAAUoD,EACVI,IAAKvD,KAAKuC,Y,mCAOK,IAApBvC,KAAKoC,MAAMC,MAAkBrC,KAAK4C,cAAiB5C,KAAK4C,aAAaY,kBAExExD,KAAKyD,a,mCAKAzD,KAAKoC,MAAMC,KAENrC,KAAKoC,MAAME,MAGjBtC,KAAK8C,YAFL9C,KAAK0D,YAFL1D,KAAKyD,a,4JAQLzD,KAAKC,MAAMa,S,yCACJK,QAAQwC,MAAM,qB,WACrB3D,KAAKoC,MAAMC,K,sBACL,IAAIb,MAAM,yB,WAGjBxB,KAAK4C,a,oBAEQ,IADA5C,KAAK4C,aAAaa,SAASzD,KAAKC,MAAMkD,S,oDAQ/B,oBADnBA,EAAUnD,KAAKC,MAAMkD,WAErBA,EAAUA,EAAQnD,SACnBmD,aAAmBS,S,kCACFT,E,QAAhBA,E,eACCA,GACDhC,QAAQC,KAAK,6BAA8BpB,MAE/CA,KAAK6D,SAAS,CACVxB,MAAM,EACNc,YAGJW,YAAW,WACP,EAAKlB,aAAamB,WAAW,EAAKC,sBACnC,K,yIAIH,IAAKhE,KAAKoC,MAAMC,KACZ,MAAM,IAAIb,MAAM,0CAEpBxB,KAAKgE,mBAAmBC,SAAQ,SAAAC,GAC5BA,EAAKL,SAAS,CACVvB,OAAO,S,kCAKiB,IAA1B6B,EAAyB,wDAC3BnE,KAAKoC,MAAME,QAA6B,IAApB6B,GAIxBnE,KAAK6D,SAAS,CACVxB,MAAM,EACNC,OAAO,EACPa,QAAS,S,yCAOb,IAFA,IAAIiB,EAAQ,GACRC,EAASrE,KACNqE,GACHD,EAAME,KAAKD,GACXA,EAASA,EAAOzD,QAAQ0C,eAE5B,OAAOc,I,8CAKJpE,KAAK4C,cACJ5C,KAAK4C,aAAa2B,kB,6CAItB,GAAIvE,KAAKoC,MAAMC,MAASrC,KAAKuC,OAAOiC,QAApC,CAEA,IAAMC,EAAMzE,KAAKuC,OAAOiC,QAClBE,EAAOD,EAAIE,wBACdD,EAAKE,MAAQC,OAAOC,YACnBL,EAAIM,UAAUC,IAAI,kBACnBN,EAAKO,OAASJ,OAAOK,aACpBT,EAAIM,UAAUC,IAAI,wB,GAtKM9E,IAAMC,WAApCgC,EACKR,YAAcC,IADnBO,EAIKN,aAAe,CAElBqB,UAAgB,GAkLTf,QCvLMgD,E,YAYjB,WAAYlF,GAAQ,IAAD,8BACf,4CAAMA,KACDmF,SAAWlF,IAAMsC,YAFP,E,8EAMS,IAAbvC,EAAY,uDAAJ,GACfoF,GAA6B,IAArBrF,KAAKC,MAAMoF,MAAkBrF,KAAKC,MAAMiD,SAAW,SAAM,SAAOlD,KAAKC,MAAMoF,MACvF,MAAO,CAAC,sEACiBpF,GACrBoF,EAAQ,yBAAKhF,UAAU,SAASgF,GAAe,KAC/C,kBAAC,EAAD,CACI9B,IAAKvD,KAAKoF,SACVtE,SAAUd,KAAKC,MAAMa,SACrBqC,QAASnD,KAAKC,MAAMkD,QACpBD,SAAUlD,KAAKC,MAAMiD,c,mCAMf,OAAOlD,KAAKoF,SAASZ,QAAQc,e,kCAC7B,OAAOtF,KAAKoF,SAASZ,QAAQe,c,+BAEtC7E,GACLV,KAAKsF,iB,GArCmC5D,KAA3ByD,EAEVtD,aAAe,CAClBwD,OAAgB,EAChBnC,UAAgB,GAJHiC,EAQVrD,UAAY,CACfqB,QAASpB,IAAUyD,IAAIvD,Y,WCXzBwD,G,wLAYE,IAAIpF,EAAY,YACbL,KAAKC,MAAMI,YACVA,GAAa,IAAML,KAAKC,MAAMI,WAElC,IAAIN,EAAWC,KAAKC,MAAMF,SAI1B,MAHuB,oBAAbA,IACNA,EAAWA,EAASC,OAGpB,yBAAKK,UAAWA,GACXL,KAAKC,MAAMyF,OAAS,yBAAKrF,UAAU,UAAUL,KAAKC,MAAMyF,QAAgB,KACzE,yBAAKrF,UAAU,aACVN,Q,GAxBEG,IAAMC,YAAvBsF,EAEK5D,aAAe,G,OA8BX4D,IChCTE,E,iLAYE,IAAItF,EAAY,aACbL,KAAKC,MAAMI,YACVA,GAAa,IAAML,KAAKC,MAAMI,WAElC,IAAIN,EAAWC,KAAKC,MAAMF,SAI1B,MAHuB,oBAAbA,IACNA,EAAWA,EAASC,OAGpB,yCACQA,KAAKC,MADb,CAEII,UAAWA,IAEVL,KAAKC,MAAMyF,OAAS,yBAAKrF,UAAU,UAAUL,KAAKC,MAAMyF,QAAgB,KACxE3F,O,GA1BOG,IAAMC,WAAxBwF,EAEK9D,aAAe,G,OA8BX8D,IChCTC,E,YAYF,aAAyB,IAAD,EAAZ3F,EAAY,uDAAJ,GAAI,4BACpB,4CAAMA,KACDO,GAAK,CACNqF,SAAU,SAAAnF,GAAC,OAAI,EAAKmF,SAASnF,IAC7BO,QAAS,SAAAP,GAAC,OAAI,EAAKO,QAAQP,KAJX,E,qEAQhBA,GACJA,EAAEoF,iBACF,IAAMC,EAAWC,WAAWtF,EAAEuF,OAAO5C,OACrCrD,KAAKC,MAAM4F,SAASnF,EAAGqF,K,+BAIlBrF,GACLA,EAAEoF,iBACF,IAAMC,EAAWC,WAAWtF,EAAEuF,OAAO5C,OACrCrD,KAAKC,MAAM4F,SAASnF,EAAGqF,K,+BAKvB,IAAI1F,EAAY,mBAGhB,OAFGL,KAAKC,MAAMI,YACVA,GAAa,IAAML,KAAKC,MAAMI,WAE9B,2BACIA,UAAWA,EACX6F,KAAK,QACL7C,MAAOrD,KAAKC,MAAMoD,MAClBwC,SAAU7F,KAAKQ,GAAGqF,SAClB5E,QAASjB,KAAKQ,GAAGS,QACjBkF,IAAKnG,KAAKC,MAAMkG,IAChBC,IAAKpG,KAAKC,MAAMmG,IAChBC,KAAMrG,KAAKC,MAAMoG,KACjB/E,KAAMtB,KAAKC,MAAMqB,KACjBN,MAAOhB,KAAKC,MAAMe,Y,GAjDLd,IAAMC,WAA7ByF,EAEK/D,aAAe,GAwDX+D,QC7Df,uR,gFCOeU,G,6LAHM,MAAO,qB,GADC5E,M,wBCGvBS,G,kBAkBF,WAAYlC,GAAQ,IAAD,8BACf,4CAAMA,KACDmC,MAAQ,CACTC,MAAM,EACNC,OAAO,GAEX,EAAKC,OAASrC,IAAMsC,YANL,E,0EASJ,OAAOxC,KAAKY,QAAQC,U,yCAEhB4B,EAAWC,EAAWC,GAElC3C,KAAK4C,eACA5C,KAAKoC,MAAMC,KACXrC,KAAK4C,aAAaC,qBAAqB7C,KAAMA,KAAK8C,UAAUC,KAAK/C,OAEjEA,KAAK4C,aAAaI,wBAAwBhD,OAElDA,KAAKiD,yB,6CAIFjD,KAAK4C,cACJ5C,KAAK4C,aAAaI,wBAAwBhD,Q,+BAI9C,IAAKA,KAAKoC,MAAMC,KACZ,OAAO,KAEX,IAAIhC,EAAY,qBAKhB,GAJIL,KAAKC,MAAMiD,WACX7C,GAAa,aACbL,KAAKoC,MAAME,QACXjC,GAAa,UACdL,KAAKC,MAAMa,SACV,MAAO,WAEX,IAAIqC,EAAUnD,KAAKC,MAAMkD,QAMzB,MALuB,oBAAZA,IACPA,EAAUA,EAAQnD,OACjBmD,GACDhC,QAAQC,KAAK,6BAA8BpB,MAExC,kBAAC4B,EAAA,EAAgBwB,SAAjB,CACHC,MAAO,CAACxC,QAAQb,KAAK4C,aAAcU,eAAetD,OAClD,yBACIK,UAAWA,EACXN,SAAUoD,EACVI,IAAKvD,KAAKuC,Y,mCAOK,IAApBvC,KAAKoC,MAAMC,MAAkBrC,KAAK4C,cAAiB5C,KAAK4C,aAAaY,kBAExExD,KAAKyD,a,mCAKAzD,KAAKoC,MAAMC,KAENrC,KAAKoC,MAAME,MAGjBtC,KAAK8C,YAFL9C,KAAK0D,YAFL1D,KAAKyD,a,iCAOD,IAAD,OACP,GAAIzD,KAAKC,MAAMa,SACX,OAAOK,QAAQwC,MAAM,oBACzB,GAAI3D,KAAKoC,MAAMC,KACX,MAAM,IAAIb,MAAM,yBAGpB,GAAGxB,KAAK4C,eAEQ,IADA5C,KAAK4C,aAAaa,SAASzD,KAAKC,MAAMkD,SAG9C,OAIRnD,KAAK6D,SAAS,CACVxB,MAAM,IAGVyB,YAAW,WACP,EAAKlB,aAAamB,WAAW,EAAKC,sBACnC,O,kCAIH,IAAKhE,KAAKoC,MAAMC,KACZ,MAAM,IAAIb,MAAM,0CAEpBxB,KAAKgE,mBAAmBC,SAAQ,SAAAC,GAC5BA,EAAKL,SAAS,CACVvB,OAAO,S,kCAKiB,IAA1B6B,EAAyB,wDAC3BnE,KAAKoC,MAAME,QAA6B,IAApB6B,GAIxBnE,KAAK6D,SAAS,CACVxB,MAAM,EACNC,OAAO,EACPa,QAAS,S,yCAOb,IAFA,IAAIiB,EAAQ,GACRC,EAASrE,KACNqE,GACHD,EAAME,KAAKD,GACXA,EAASA,EAAOzD,QAAQ0C,eAE5B,OAAOc,I,8CAKJpE,KAAK4C,cACJ5C,KAAK4C,aAAa2B,kB,6CAItB,GAAIvE,KAAKoC,MAAMC,MAASrC,KAAKuC,OAAOiC,QAApC,CAEA,IAAMC,EAAMzE,KAAKuC,OAAOiC,QAClBE,EAAOD,EAAIE,wBACdD,EAAKE,MAAQC,OAAOC,YACnBL,EAAIM,UAAUC,IAAI,kBACnBN,EAAKO,OAASJ,OAAOK,aACpBT,EAAIM,UAAUC,IAAI,wB,GAjKM9E,IAAMC,YAApCgC,EACKR,YAAcC,IADnBO,EAIKN,aAAe,CAElBqB,UAAgB,GA6KTf,QCpLMoE,E,YAajB,WAAYtG,GAAQ,IAAD,8BACf,4CAAMA,KAEDO,GAAK,CACNG,UAAW,SAACD,GAAD,OAAO,EAAKC,UAAUD,IACjCD,aAAc,SAAAC,GAAC,OAAI,EAAKD,aAAaC,KAEzC,EAAK0E,SAAWlF,IAAMsC,YAPP,E,4EAWF,MAAO,mB,+BAGpB,IAAInC,EAAYL,KAAKwG,eAClBxG,KAAKC,MAAMI,YACVA,GAAa,IAAML,KAAKC,MAAMI,WAC/BL,KAAKC,MAAMa,WACVT,GAAa,aACdL,KAAKC,MAAMc,WACVV,GAAa,aAEjB,IAAIgF,GAA6B,IAArBrF,KAAKC,MAAMoF,MAAkBrF,KAAKC,MAAMiD,SAAW,SAAM,SAAOlD,KAAKC,MAAMoF,MACvF,OACI,yBACIrE,MAAOhB,KAAKC,MAAMe,MAClBX,UAAWA,EACXoG,aAAczG,KAAKQ,GAAGC,aACtBQ,QAASjB,KAAKQ,GAAGC,aACjBE,UAAWX,KAAKQ,GAAGG,UACnBO,SAAU,GAETlB,KAAKC,MAAMF,SACXsF,EAAQ,yBAAKhF,UAAU,SAASgF,GAAe,KAChD,kBAAC,EAAD,CACI9B,IAAKvD,KAAKoF,SACVtE,SAAUd,KAAKC,MAAMa,SACrBqC,QAASnD,KAAKC,MAAMkD,QACpBD,SAAUlD,KAAKC,MAAMiD,c,mCAMnB,OAAOlD,KAAKoF,SAASZ,QAAQc,e,kCAC7B,OAAOtF,KAAKoF,SAASZ,QAAQe,c,mCAElC7E,GACT,IAAGA,EAAEgG,iBAGL,OADAhG,EAAEoF,iBACKpF,EAAEwF,MACL,IAAK,QAED,GAAGlG,KAAKC,MAAMgB,UACmB,IAA1BjB,KAAKC,MAAMgB,QAAQP,GAClB,OACRV,KAAKsF,aACL,MAEJ,IAAK,aACL,IAAK,YACDtF,KAAKuF,YACL,MAEJ,QACI,MAAM,IAAI/D,MAAM,wBAA0Bd,EAAEwF,S,gCAM9CxF,GACN,IAAGA,EAAEiG,qBAEL,OAAOjG,EAAEkG,KACL,IAAK,IACL,IAAK,QACD5G,KAAKsF,aACL,MAEJ,QACInE,QAAQ0F,KAAK,kBAAmBnG,EAAEkG,Q,mCAIjClG,GACTV,KAAKsF,iB,GApGiCpF,IAAMC,WAA/BoG,EAEV1E,aAAe,CAClBwD,OAAgB,EAChBnC,UAAgB,G,ICET4D,E,iLANP,OACI,wBAAIzG,UAAU,wB,GAHEH,IAAMC,W,uCCDwBD,IAAMC,UCHhE,uG,wECEM4G,E,WACF,WAAYC,GAAO,oBACfhH,KAAKgH,KAAOA,E,wEAMYC,EAAWC,GACnC,OAAOlH,KAAKmH,mBAAmBF,K,8BAY3BA,GACJ,IAAKjH,KAAKgH,KAAKI,KAAKC,SAASJ,GACzB,MAAM,IAAIzF,MAAM,uBAAyByF,GAC7C,OAAOjH,KAAKgH,KAAKI,KAAKC,SAASJ,K,mCAItBA,GAAY,IAAD,EACAjH,KAAKsH,QAAQL,GACjC,OAFoB,sB,gCAIdA,GAAY,IAAD,EACEjH,KAAKsH,QAAQL,GAChC,OAFiB,sB,+BAIZA,GACL,IAAM5G,EAAYL,KAAKwG,aAAaS,GAEpC,OADuBF,EAAcQ,oBAAoBlH,GAAlDmH,e,yCAIQP,GAAY,IAAD,EACEjH,KAAKsH,QAAQL,GADf,mBACnB5G,EADmB,KACRoH,EADQ,KAE1B,OAAOV,EAAcW,aAAarH,EAAWoH,K,0CAI7BR,GAAY,IAAD,EACCjH,KAAKsH,QAAQL,GADd,mBACpB5G,EADoB,KACToH,EADS,KAELE,EAAYZ,EAAcQ,oBAAoBlH,GAA7DuH,cACP,OAAO,kBAACD,EAAD,CACHV,UAAWA,EACXQ,OAAQA,M,0CAOIR,GAChB,IACOO,EADST,EAAcc,yBACCZ,GAAxBO,aACHA,EAAaM,cAGbN,EAAaM,iB,wCAMjB,IADA,IAAMC,EAAUhB,EAAcc,yBACtBG,EAAE,EAAGA,EAAED,EAAQE,OAAQD,IAC3BhI,KAAKkI,oBAAoBF,K,0CAM7B,IADA,IAAMD,EAAUhB,EAAcc,yBACtBG,EAAE,EAAGA,EAAED,EAAQE,OAAQD,IAAK,CAAC,IAC1BR,EAAgBO,EAAQC,GAAxBR,aACHA,EAAaW,WAKjBX,EAAaW,gB,oCAWD9H,GAAuB,IAAZoH,EAAW,uDAAJ,GAAI,EACfzH,KAAKuH,oBAAoBlH,GAAzCmH,EAD+B,EAC/BA,aACP,OAAO,IAAIA,EAAaC,K,0CAGDpH,GAEvB,IADA,IAAM0H,EAAUhB,EAAcc,yBACtBG,EAAE,EAAGA,EAAED,EAAQE,OAAQD,IAAK,CAChC,IAAMI,EAAYL,EAAQC,GAC1B,GAAGI,EAAU/H,YAAcA,EACvB,OAAO+H,EAEf,MAAM,IAAI5G,MAAJ,wBAA2BnB,EAA3B,qB,sCAKaA,EAAWmH,GAA+C,IAAjCI,EAAgC,uDAAlB,KAAM5G,EAAY,uDAAN,KAEhE+G,EAAUhB,EAAcc,yBAC9B7G,EAAQA,GAASwG,EAAalG,KAC9ByG,EAAQzD,KAAK,CAACkD,eAAcI,gBAAevH,YAAWW,Y,8CAGzB,OAAO+F,EAAcc,6B,KAzHpDd,EAqIKc,yBAA2B,GAGvBd,O,oHCpITsB,E,qHAK6BC,GAAqC,IAAD,OAArBC,EAAqB,uDAAN,KACzD,OAAQ,oCACJ,kBAAC,IAAD,CAAkBpF,QAAS,kBAAM,EAAKqF,mCAAmCF,EAAeC,KAAxF,gBACA,kBAAC,IAAD,CAAkBpF,QAAS,kBAAM,EAAKsF,gCAAgCH,EAAeC,KAArF,aACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkBzH,UAAQ,EAACqC,QAAS,kBAAM,EAAKuF,+BAA+BJ,KAA9E,YACA,kBAAC,IAAD,CAAkBxH,UAAQ,EAACqC,QAAS,kBAAM,EAAKwF,+BAA+BL,KAA9E,YACA,kBAAC,IAAD,CAAgB/G,SAAQ,uCAAE,WAAMb,GAAN,SAAAkI,EAAA,kEAAWN,EAAX,SAA+BO,IAAcC,iBAAiB,yBAA9D,uGAAF,uDAAxB,qB,qDAO8BR,GAClC,OAAOtI,KAAK+I,OAAOC,wBAAuB,SAACC,EAAUC,EAAWjC,GAAtB,OACtC,kBAAC,IAAD,CACIL,IAAKqC,EACL1H,SAAU,SAAAb,GAAC,OAAI4H,EAAcW,IAC7BlJ,SAAUkJ,S,qDAMgBX,GAAiC,IAAD,OAAjBa,EAAiB,uDAAN,KAC5D,OAAQ,oCACHnJ,KAAKoJ,kBAAiB,SAACC,GAAD,OACnBA,IAAc,EAAKA,UAAY,KAC3B,kBAAC,IAAD,CACIzC,IAAKyC,EACLvI,SAAUuI,IAAc,EAAKjH,MAAMkH,cACnC/H,SAAU,SAAAb,GAAC,OAAI4H,EAAc,IAAMe,KACrCA,MAEV,kBAAC,IAAD,CAAgB9H,SAAU4H,EAAYI,UAAQ,GAA9C,uB,yDAakCjB,GAAqC,IAAD,OAArBC,EAAqB,uDAAN,KACpE,OAAOvI,KAAKwJ,oBAAmB,SAACP,GAAD,OAC3B,kBAAC,IAAD,CAAkBrC,IAAKqC,EAAU9F,QAAS,kBAAM,EAAKsG,yCAAyCnB,EAAeW,EAAUV,KAClHU,Q,+DAMmCX,EAAeW,GAAgC,IAAtBV,EAAqB,uDAAN,KACpF,OAAQ,oCACgB,OAAnBA,EAA0B,kBAAC,IAAD,CAAgBhH,SAAU,kBAAM+G,EAAcW,EAAS,GAAGV,KAAkBU,EAAS,GAAGV,EAAxF,cAAqI,KAC/JvI,KAAK0J,gBAAe,SAACC,GAAD,OACjB,kBAAC,IAAD,CAAgB/C,IAAK+C,EAAQpI,SAAU,kBAAM+G,EAAcW,EAAS,GAAGU,KAClEV,EAAS,GAAGU,S,sDAMUrB,GAAqC,IAAD,OAArBC,EAAqB,uDAAN,KACjE,OAAQ,oCACgB,OAAnBA,EAA0B,kBAAC,IAAD,CAAkB3B,IAAK2B,EAAgBpF,QAAS,kBAAM,EAAKyG,yCAAyCtB,EAAeC,KACzIA,EADsB,cAEL,KACrBvI,KAAK0J,gBAAe,SAACC,GAAD,OACjB,kBAAC,IAAD,CAAkB/C,IAAK+C,EAAQxG,QAAS,kBAAM,EAAKyG,yCAAyCtB,EAAeqB,KACtGA,S,+DAM+BrB,EAAeqB,GAC3D,OAAO3J,KAAKwJ,oBAAmB,SAACP,GAAD,OAC3B,kBAAC,IAAD,CAAgBrC,IAAKqC,EAAU1H,SAAU,kBAAM+G,EAAcW,EAAS,GAAGU,KAAeV,EAAS,GAAGU,Q,+CAK5ErB,EAAeuB,EAAiBC,GAC5D,OAAQ,oCACJ,kBAAC,IAAD,CAAkBhJ,UAAQ,EAACqC,QAAS,kBAAM4G,EAAiB,YAA3D,UACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkB5G,QAAS,kBAAM4G,EAAiB,cAAlD,YACA,kBAAC,IAAD,CAAkB5G,QAAS,kBAAM4G,EAAiB,aAAlD,WACA,kBAAC,IAAD,CAAkB5G,QAAS,kBAAM4G,EAAiB,YAAlD,UACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkBjJ,UAAQ,EAACqC,QAAS,kBAAM4G,EAAiB,YAA3D,WAGJ,SAASA,EAAiBnD,GACtB,IAAIoD,EAAU,GACd,OAAOpD,GACH,IAAK,WACD,IADJ,eACaoB,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAc,EAAIN,EAAI8B,EAAT,YAA4B9B,EAA5B,QAA3D,YAAsGA,EAAtG,QAFCA,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAA7B,EAASA,GAIT,IALJ,eAKaA,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAcN,EAAI8B,EAAc9B,EAAI,OAASA,EAAI,OAF9FA,EAAI,EAAGA,GAAK,GAAIA,IAAzB,EAASA,GAIT,MAEJ,IAAK,UACD,IADJ,eACaA,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAc,GAAKN,EAAI,KAAO8B,EAAjB,YAAoC9B,EAApC,QAA3D,YAA8GA,EAA9G,QAFCA,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAA7B,EAASA,GAIT,IALJ,eAKaA,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAeN,EAAI,IAAO8B,EAAc9B,EAAI,OAASA,EAAI,OAFtGA,EAAI,EAAGA,GAAK,GAAIA,IAAzB,EAASA,GAIT,MAEJ,IAAK,SACD,IADJ,eACaA,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAc,GAAS,IAAJN,GAAW8B,EAAjB,YAAoC9B,EAApC,QAA3D,YAA8GA,EAA9G,QAFCA,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAA7B,EAASA,GAIT,IALJ,eAKaA,GACLgC,EAAQ1F,KACJ,kBAAC,IAAD,CAAgBsC,IAAG,UAAKoB,EAAL,KAAWzG,SAAU,kBAAM+G,EAAmB,IAAJN,EAAW8B,EAAc9B,EAAI,OAASA,EAAI,OAFtGA,EAAI,EAAGA,GAAK,GAAIA,IAAzB,EAASA,GAIT,MAEJ,QACI,MAAM,IAAIxG,MAAM,eAExB,OAAOwI,K,+CAIiB1B,GAAsC,IAAvB2B,EAAsB,uDAAN,KACrDC,EAAY,uCAAG,4BAAAtB,EAAA,sEACMC,IAAcC,iBAAiB,gCAAiC,KADtE,OACXqB,EADW,OAEjB7B,EAAc6B,GAFG,2CAAH,qDAIlB,OAAQ,oCACJ,kBAAC,IAAD,CAAgB5I,SAAU,aAAQT,UAAQ,GAA1C,gBACA,kBAAC,IAAD,CACIqF,IAAK,EACLC,IAAK,IACL/C,MAAO4G,EACPpE,SAAU,SAACnF,EAAG0J,GAAJ,OAAmB9B,EAAc8B,MAE/C,kBAAC,IAAD,MACCpK,KAAKqK,mBAAkB,SAACF,GAAD,OACpB,kBAAC,IAAD,CAAgBvD,IAAKuD,EAAU5I,SAAU,kBAAM+G,EAAc6B,KAAcA,MAC/E,kBAAC,IAAD,CAAgB5I,SAAU2I,EAAcX,UAAQ,GAAhD,a,uDAKgCjB,GAAgC,IAAjBgC,EAAgB,uDAAN,KAC7D,OAAQ,oCACHA,EAAY,oCAAE,kBAAC,IAAD,CAAgBxJ,UAAQ,EAACS,SAAU,cAAW+I,GAA2B,kBAAC,IAAD,OAAsB,KAC7GvD,IAAcwD,wBAAwBC,KAAI,SAAC/C,EAAQO,GAAT,OACvC,kBAAC,IAAD,CAAgBpB,IAAKoB,EAAGzG,SAAU,kBAAM+G,EAAcb,EAAOpH,aAAoBoH,EAAOzG,a,qCAQhG,IAAIyJ,GAAI,IAAIC,MAAOC,UAInB,MAH2B,qBAAhBC,aAA0D,oBAApBA,YAAYC,MACzDJ,GAAKG,YAAYC,OAEd,uCAAuCC,QAAQ,SAAS,SAAUC,GACrE,IAAIC,GAAKP,EAAoB,GAAhBQ,KAAKC,UAAiB,GAAK,EAGxC,OAFAT,EAAIQ,KAAKE,MAAMV,EAAI,KAEL,MAANM,EAAYC,EAAS,EAAJA,EAAU,GAAMI,SAAS,S,2CAStD,IAHkD,IAA5BC,EAA2B,uDAAhB,SAACC,GAAD,OAAUA,GACrCtB,EAAU,GACVuB,EAAWvL,KAAKuL,WACbC,EAAI,EAAGA,EAAID,EAAStD,OAAQuD,IAAK,CACtC,IAAMC,EAAgBF,EAASC,GACzBE,EAASL,EAASI,GACxB,IAAIE,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,uCAKP,IAFkD,IAAhCqB,EAA+B,uDAApB,SAAC1B,GAAD,OAAYA,GACnCK,EAAU,GACPhC,EAAI,EAAGA,GAAK,EAAGA,IAAK,CACzB,IAAM0D,EAASL,EAASrD,GACxB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,iDAOP,IAHwD,IAA5BqB,EAA2B,uDAAhB,SAACC,GAAD,OAAUA,GAC3CtB,EAAU,GACV4B,EAAkB5L,KAAKuL,WACpBvD,EAAI,EAAGA,GAAK,EAAGA,IACpB,IAAK,IAAIwD,EAAI,EAAGA,EAAII,EAAgB3D,OAAQuD,IAAK,CAC7C,IAAMC,EAAgBG,EAAgBJ,GAAKxD,EACrC0D,EAASL,EAASI,GACxB,IAAIE,EAAU3B,EAAS0B,GAAS,OAAO1B,EAG/C,OAAOA,I,0CAMP,IAFyD,IAApCqB,EAAmC,uDAAxB,SAAClB,GAAD,OAAcA,GACxCH,EAAU,GACP6B,EAAK,IAAKA,GAAM,EAAGA,GAAM,GAAI,CAClC,IAAMH,EAASL,EAASQ,GACxB,IAAIF,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,2CAOP,IAFwH,IAAlGqB,EAAiG,uDAAtF,SAACS,EAAiBC,GAAlB,MAA4C,CAACD,EAAiBC,IACzF/B,EAAU,GACPgC,EAAiB,EAAGA,GAAkB,GAAIA,IAAkB,CACjE,IAAMN,EAASL,EAASW,EAAgBA,EAAc,eAAWA,EAAiB,EAAI,IAAM,GAAtC,iBACtD,IAAIL,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,0CAKP,IAFmH,IAA9FqB,EAA6F,uDAAlF,SAACY,EAAgBC,GAAjB,MAA0C,CAACD,EAAgBC,IACrFlC,EAAU,GACPmC,EAAgB,GAAIA,GAAiB,IAAKA,GAAiB,GAAI,CACpE,IAAMT,EAASL,EAASc,EAAeA,EAAa,eAAWA,EAAgB,EAAI,IAAM,GAArC,gBACpD,IAAIR,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,sDAGsG,IAA5EqB,EAA2E,uDAAhE,SAACe,EAAeC,GAAhB,MAAiC,CAACD,EAAeC,IACvFrC,EAAU,GAMhB,MALA,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KAC3C/F,SAAQ,SAAA+D,GACL,IAAM0D,EAASL,EAASrD,EAAGA,EAAI,SAC/B,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,KAExCA,I,qCAGWG,GAClB,MAAwB,kBAAbA,EACA,MACS,MAAbA,EAAmB,MAAQA,EAAW,K,sCAK1BlD,GACnB,MAAyB,kBAAdA,EACA,MACJA,EAAY,GAAK,IAAMA,EAAY,GAAKA,I,oCAG9BqF,GACjB,OAAOA,I,6CAGmBC,GAC1B,IAAIC,EAAIvB,KAAKE,MAAMoB,EAAU,IAC7BA,GAAoB,GACpB,IAAIE,EAAKxB,KAAKyB,MAAwC,KAAjCH,EAAUtB,KAAKE,MAAMoB,KAM1C,OALAA,EAAUtB,KAAKE,MAAMoB,GAErBC,GAAKA,EAAI,IAAIG,SAAS,EAAG,KACzBJ,GAAWA,EAAU,IAAII,SAAS,EAAG,KACrCF,GAAMA,EAAK,IAAIE,SAAS,EAAG,KACrB,GAAN,OAAUH,EAAV,YAAeD,EAAf,YAA0BE,K,4CAGDG,GACzB,IAAMC,EAAQD,EAAiBxB,WAAW0B,MAAM,KAChD,OAAiC,GAAzBC,SAASF,EAAM,GAAI,IACpBE,SAASF,EAAM,GAAI,IACnBE,SAASF,EAAM,GAAI,IAAM,M,2CAGRG,GACxB,GAAoB,kBAATA,EACP,MAAM,IAAIxL,MAAM,6BACpB,IAAKwL,EACD,MAAM,IAAIxL,MAAM,qBAEpB,IAAMyL,EAAsBjN,KAAKiN,sBAC3BC,EAAYF,EAAKG,MAAM,GAAI,GAC3BxD,EAASoD,SAASC,EAAKG,OAAO,IACpC,GAAGC,MAAMzD,GACL,MAAM,IAAInI,MAAM,yBAA2BwL,GAC/C,GAA6C,qBAAnCC,EAAoBC,GAC1B,MAAM,IAAI1L,MAAM,sBAAwB0L,GAC5C,IAAIG,EAAYJ,EAAoBC,GAOpC,OAJIG,EADAA,EAAY,EACAA,EAAY,GAAqB,IAAd1D,EAAS,GAAW,EAEvC0D,EAA4B,IAAd1D,EAAS,GAAW,EAE3C,IAAMsB,KAAKqC,IAAI,GAAID,EAAY,IAAM,M,2CAKpBE,EAAgBzD,GACxC,IAAIA,EACA,MAAM,IAAItI,MAAM,wBACpB,GAA8B,kBAAnB+L,EACP,OAAOA,EACX,IAAMC,EAAQD,EAAeE,OAAOF,EAAetF,OAAS,GACxDyF,EAAWH,EAAeE,OAAO,EAAGF,EAAetF,OAAS,GAChE,IAA8B,IAA3ByF,EAASC,QAAQ,KAAa,CAC7B,IAAMC,EAAgBF,EAASZ,MAAM,KACrCY,EAAWX,SAASa,EAAc,GAAI,IAAMb,SAASa,EAAc,GAAI,IAE3E,OAAQJ,GACJ,IAAK,IACD,OAAOT,SAASW,GACpB,IAAK,IACD,OAAO5D,EAAe9D,WAAW0H,GACrC,IAAK,IACD,OAAsB,IAAf5D,EAAqB9D,WAAW0H,GAC3C,IAAK,IACD,OAAO5D,EAAe,IAAM9D,WAAW0H,GAC3C,QACI,MAAM,IAAIlM,MAAM,qBAAuB+L,M,qCAI7BM,EAAO/D,GACzB,IAAIgE,EAQJ,GAPA9N,KAAK+N,kBAAiB,SAACC,EAAUT,GAC7B,GAAIM,IAAUG,GAAYH,IAAUN,EAEhC,OADAO,EAAcP,GACP,IAEZzD,GAECgE,EACA,OAAOA,EACX,IAAMG,EAAcJ,EAAQ/D,EAC5B,OAAGmE,IAAgBhD,KAAKyB,MAAMuB,GACnBA,EAAc,KAEzBJ,EAAQ7H,WAAW6H,GAAOK,QAAQ,IACrBpD,QAAQ,MAAO,O,yCAM5B,IAFwG,IAApFO,EAAmF,uDAAxE,SAAC2C,EAAUT,GAAX,MAA8B,CAACS,EAAUT,IAAiBzD,EAAc,uCACjGE,EAAU,GACPhC,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAAG,CAC5B,IAAI0D,EAASL,EAAS,EAAIrD,EAAI8B,EAAT,YAA4B9B,EAA5B,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,IAAK,IAAIhC,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAAG,CAC5B,IAAI0D,EAASL,EAAU,EAAIrD,EAAK,IAAM8B,EAAjB,YAAoC9B,EAApC,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,IAAK,IAAIhC,EAAI,GAAIA,EAAI,EAAGA,GAAK,EAAG,CAC5B,IAAI0D,EAASL,EAAS,EAAIrD,EAAI,IAAM8B,EAAf,YAAkC9B,EAAlC,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAG3C,IAAK,IAAIhC,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC1B,IAAI0D,EAASL,EAASrD,EAAI8B,EAAL,UAAsB9B,EAAtB,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAG3C,IAAK,IAAIhC,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC1B,IAAI0D,EAASL,EAASrD,EAAI,IAAM8B,EAAX,UAA4B9B,EAA5B,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAG3C,IAAK,IAAIhC,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC1B,IAAI0D,EAASL,EAAa,IAAJrD,EAAU8B,EAAX,UAA4B9B,EAA5B,MACrB,IAAI2D,EAAU3B,EAAS0B,GAAS,OAAO1B,EAE3C,OAAOA,I,iCAYP,MAAO,CACH,IACA,KACA,KACA,IACA,IACA,KACA,KACA,IACA,KACA,KACA,IACA,KACA,IACA,KACA,KACA,IACA,KACA,Q,4CAKJ,MAAO,CACH,EAAK,EACL,GAAM,EACN,KAAM,EACN,MAAO,EACP,GAAM,EACN,IAAO,EACP,EAAK,EACL,GAAM,EACN,EAAK,EACL,GAAM,EACN,KAAM,EACN,MAAO,EACP,GAAM,EACN,IAAO,EACP,EAAK,GACL,GAAM,GACN,KAAM,GACN,MAAO,GACP,GAAM,GACN,IAAO,GACP,EAAK,GACL,GAAM,GACN,KAAM,GACN,MAAO,GACP,EAAK,GACL,GAAM,GACN,KAAM,GACN,MAAO,GACP,GAAM,GACN,IAAO,GACP,EAAK,GACL,GAAM,GACN,KAAM,GACN,MAAO,GACP,GAAM,GACN,IAAO,Q,KAKnB,SAAS2B,EAAW3B,EAAS0B,GAGzB,OAFe,OAAXA,GAAqC,qBAAXA,GAC1B1B,EAAQ1F,KAAKoH,IACC,IAAXA,GAAmBA,EAKfrD,O,0DC5eT8F,E,WACF,aAAoC,IAAxBC,EAAuB,uDAAL,CAAC,GAAI,oBAC/BpO,KAAKoH,KAAOgH,E,8DAoBEtE,GACd,IAAMuE,EAAgBrO,KAAKqO,cAC3B,OAAqB,OAAlBA,EACQ,MACJhG,IAAOiG,eAAeD,EAAevE,K,8BApB5C,OAAO9J,KAAKoH,KAAK,I,aAGTmH,GACRvO,KAAKoH,KAAK,GAAKmH,I,yCAKf,OAAOvO,KAAKoH,KAAK,I,aAGEoH,GACnBxO,KAAKoH,KAAK,GAAKoH,I,kCASDC,GAAgB,MAAM,IAAIjN,MAAM,uBAAyBxB,KAAKqB,YAAYC,O,eAC1D,MAAM,IAAIE,MAAM,uBAAyBxB,KAAKqB,YAAYC,Q,4BACrE,MAAM,IAAIE,MAAM,uBAAyBxB,KAAKqB,YAAYC,Q,6BAGpE6I,GAAa,MAAM,IAAI3I,MAAM,uBAAyBxB,KAAKqB,YAAYC,O,eAE1D,MAAM,IAAIE,MAAM,uBAAyBxB,KAAKqB,YAAYC,S,gDAMpDoN,GAAY,IAAD,OACvCC,OAAOC,KAAKF,GAAWzK,SAAQ,SAACoF,EAAWrB,GAAZ,OAC3B,EAAK6G,wBAAwBH,EAAUrF,S,8CAEhByF,GAC3B,IAAIC,MAAMC,QAAQF,GACd,MAAM,IAAItN,MAAM,sCACpB,IAAI,IAAIwG,EAAE,EAAGA,EAAE8G,EAAgB7G,OAAQD,IAAK,CACxC,IAAMiH,EAAcjP,KAAKkP,iBAAiBJ,EAAgB9G,IAC1D8G,EAAgB9G,GAAKiH,EAAY7H,Q,uCAIjBgH,GACpB,GAAIA,aAA2BD,EAC3B,OAAOC,EAKX,GAJ8B,kBAApBA,IACNA,EAAkB,CAACA,IACO,kBAApBA,IACNA,EAAkB,CAAC,EAAGA,KACtBW,MAAMC,QAAQZ,GACd,MAAM,IAAI5M,MAAM,4BAGpB,MAFiC,kBAAvB4M,EAAgB,IACtBA,EAAgBe,QAAQ,GACrBnP,KAAKoP,eAAehB,K,qCAGTA,GAClB,IAAIA,EACA,MAAM,IAAI5M,MAAM,4BACpB,IAAM8K,EAAgB8B,EAAgB,GACtC,GAA4B,kBAAlB9B,EACN,OAAOA,EAAc,IACjB,IAAK,IACD,OAAO,IAAK+C,EAAQ,IAAb,SAA4CjB,GACvD,IAAK,IACD,OAAO,IAAKiB,EAAQ,IAAb,SAA8CjB,GACzD,QACI,OAAO,IAAKiB,EAAQ,IAAb,SAA2CjB,QAGvD,GAA4B,kBAAlB9B,EACb,OAAO,IAAK+C,EAAQ,KAAb,SAA2CjB,GAEtD,MAAM,IAAI5M,MAAM,2B,KAiBT2M,O,6BCxGf,WAEMmB,EAAgB,WAAa,MAAM,IAAI9N,MAAM,wCAC7CI,EAHN,OAGwB1B,EAAMqP,cAAc,CACxC9L,SAAU,SAACN,GAAD,OAAkCmM,GAC5CvL,WAAY,0EAA4BuL,GACxC/K,cAAe,kBAA6B+K,GAC5C9L,eAAgB,kBAA4B8L,GAC5CE,mBAAoB,SAACC,GAAD,OAAwBH,GAC5CI,gBAAiB,SAACD,GAAD,OAA2BH,KAGjC1N,O,qGCuEf,SAAS+J,EAAW3B,EAAS0B,GAGzB,OAFe,OAAXA,GAAqC,qBAAXA,GAC1B1B,EAAQ1F,KAAKoH,IACC,IAAXA,GAAmBA,EAKfiE,M,WAxFX,WAAY3I,GAAO,oBACfhH,KAAKgH,KAAOA,E,8DAIsC,IAAtCqE,EAAqC,uDAA1B,SAACuE,EAAItO,GAAL,MAAc,CAACsO,EAAItO,IACpC0F,EAAOhH,KAAKgH,KACZgD,EAAU,GAChB,GAAIhD,GAAQA,EAAKI,KAAKC,SAElB,IADA,IAAMwI,EAAc7I,EAAKI,KAAKC,SACrBJ,EAAY,EAAGA,EAAY4I,EAAY5H,OAAQhB,IAAa,CAAC,IAAD,cAC7B4I,EAAY5I,GADiB,GAC1D6I,EAD0D,KAC5CC,EAD4C,KAG3DrE,EAASL,EAASpE,EAAW6I,EAAcC,GACjD,IAAIpE,EAAU3B,EAAS0B,GAAS,OAAO1B,EAG/C,OAAOA,I,yCAG4C,IAAtCqB,EAAqC,uDAA1B,SAAChC,GAAD,OAAeA,GACjCrC,EAAOhH,KAAKgH,KACZgD,EAAU,GACV8E,EAAkB9H,EAAKI,KAAK4I,OAKlC,OAJArB,OAAOC,KAAKE,GAAiB7K,SAAQ,SAAU2C,EAAKoB,GAChD,IAAM0D,EAASL,EAASzE,GACxB,IAAI+E,EAAU3B,EAAS0B,GAAS,OAAO1B,KAEpCA,I,+CAIyF,wDAChG,MAAO,S,yCAyBQ6D,GACf,OAAOxF,IAAOiG,eAAeT,EAAO7N,KAAKgH,KAAKI,KAAK0C,gB,2CAMlCyD,GACjB,OAAOlF,IAAO4H,qBAAqB1C,EAAgBvN,KAAKgH,KAAKI,KAAK0C,gB,qCAGvD+D,GACX,OAAOxF,IAAOiG,eAAeT,EAAO7N,KAAKgH,KAAKI,KAAK0C,gB,yCAIgC,IAAtEuB,EAAqE,uDAA1D,SAAC2C,EAAUT,GAAX,MAA8B,CAACS,EAAUT,IACjE,OAAOlF,IAAO0F,iBAAiB1C,EAAUrL,KAAKgH,KAAKI,KAAK0C,kB,sBC9E3CoG,E,8IACItJ,EAAKvD,G,0FACf8M,aAAaC,QAAQxJ,EAAKvD,I,2KAGhBuD,G,0FACVuJ,aAAaE,QAAQzJ,I,yGCuLrB0J,E,kOApLAtQ,K,SAA6BkQ,EAAaG,QAAQ,oB,gDAAwB,K,+CAArEE,iB,8JAMCC,GAAsC,IAAhCC,EAA+B,uDAApB,KAAMC,EAAc,uDAAN,KACxCC,EAAgBC,KAAKC,UAAUL,EAAMC,EAAUC,GAEnD,OAAOI,IAASC,SAASJ,K,uCAGZA,GACb,OAAKA,GAELA,EAAgBG,IAASE,WAAWL,IAAkBA,EAC/CC,KAAKK,MAAMN,IAFP,O,yEAOCvO,G,0FAAOwE,E,+BAAI,qB,SACjBsJ,EAAaE,QAAQxJ,EAAKgK,KAAKC,UAAUzO,I,yQAGnCwE,E,+BAAI,qB,SACEsJ,EAAaG,QAAQzJ,G,cAAnCxE,E,UAEAA,EAAQwO,KAAKK,MAAM7O,I,kBAChBA,G,iLAGY8O,EAAUC,G,8EAExBD,EAASE,OACVF,EAASE,KAAO/I,IAAOgJ,gBACvBC,EAAkB,G,cAEAtR,K,SAA4BkQ,EAAaG,QAAQ,oB,gDAAuB,K,iBAA1FiB,E,KAAuBf,iB,kEAEvBpP,QAAQwC,MAAR,M,eAEJ2N,EAAkBA,EAAgBC,QAAO,SAACC,GAAD,OAAWA,EAAMJ,OAASF,EAASE,SAC5DjC,QAAQ,CAACiC,KAAMF,EAASE,KAAMpQ,MAAOkQ,EAASlQ,Q,UACxDkP,EAAaE,QAAQ,mBAAoBpQ,KAAKyR,iBAAiBH,I,yBAG/DpB,EAAaE,QAAQ,QAAUc,EAASE,KAAMpR,KAAKyR,iBAAiBP,I,yBACpEhB,EAAaE,QAAQ,gBAAkBc,EAASE,KAAMpR,KAAKyR,iBAAiBN,I,QAElFhQ,QAAQ0F,KAAK,yBAA2BqK,EAASE,KAAMF,G,wJAG5CA,GAA0B,IAAhBQ,IAAe,yDAE9BC,EAAkB,oBAAsBtJ,IAAOgJ,eAAiB,OAClEO,EAAyBhB,KAAKC,UAAUK,EAASlB,QACjD6B,EAAajB,KAAKC,UAAUlC,OAAOmD,OAAO,GAAIZ,EAAU,CACxDlB,OAAQ2B,IACR,KAAM,MACVE,EAAaA,EAAW/G,QAAQ,IAAM6G,EAAkB,IAAKC,GAC7D,IAAMG,EAAU,gCAAkCC,mBAAmBH,GAC/DI,EAAqBC,SAASC,cAAc,KAClDF,EAAmBG,aAAa,OAAQL,GAExC,IAAIM,GAAYnB,EAASlQ,OAAS,YACzB8J,QAAQ,OAAQ,KACnB,QAGN,GAFI4G,IACAW,EAAWxN,OAAO6M,OAAO,oBAAqBW,KAC7CA,EACD,OAAOlR,QAAQC,KAAK,qBACxB6Q,EAAmBG,aAAa,WAAYC,GAC5CH,SAASI,KAAKC,YAAYN,GAC1BA,EAAmBO,QACnBP,EAAmBQ,W,kFAKEC,G,yFACMxC,EAAaG,QAAQ,QAAUqC,G,UAAtDC,E,6BAEM,IAAInR,MAAM,iCAAmCkR,G,UACnDxB,EAAWlR,KAAKuQ,iBAAiBoC,G,sBAE3B,IAAInR,MAAM,sBAAwBmR,G,gCACrCzB,G,gMAIqBwB,G,uFACExC,EAAaG,QAAQ,gBAAkBqC,G,UAAjEE,E,gDAEO,M,gCACJ5S,KAAKuQ,iBAAiBqC,I,sRAUG1C,EAAaG,QAAQ,yB,UAAjDwC,E,gDAEO,I,cACXA,EAAsBjC,KAAKK,MAAM4B,G,kBAC1BA,G,uLAGkBC,G,8EAE0B,KAD/CD,EAAsB7S,KAAK+S,0BACPpF,QAAQmF,IAC5BD,EAAoB1D,QAAQ2D,G,SAE1B5C,EAAaE,QAAQ,wBAAyBQ,KAAKC,UAAUgC,I,sRAMnC3C,EAAaG,QAAQ,yB,UAAjD2C,E,gDAEO,I,cACXA,EAAsBpC,KAAKK,MAAM+B,G,kBAC1BA,G,uLAGkBF,G,8EAE0B,KAD/CE,EAAsBhT,KAAKiT,0BACPtF,QAAQmF,IAC5BE,EAAoB7D,QAAQ2D,G,SAE1B5C,EAAaE,QAAQ,wBAAyBQ,KAAKC,UAAUmC,I,mJC5HtDE,E,WACnB,WAAYC,EAAUC,EAAUC,EAAUC,GAAsB,oBAC9DtT,KAAKuT,mBAAqBvT,KAAKuT,mBAAmBxQ,KAAK/C,MAEvDA,KAAKwT,QAAS,EACdxT,KAAKyT,eAAiB,GACtBzT,KAAK0T,SAAW,GAChB1T,KAAKmT,SAAWA,EAChBnT,KAAK2T,gBAAkBP,EACvBpT,KAAKsT,oBAAsBA,EAC3BtT,KAAK4T,WAAa,KAClB5T,KAAK6T,mBAAqB,KAC1B7T,KAAK8T,UAAY9T,KAAKmT,SAASY,sBAAsB/T,KAAK4T,WAAY,EAAG,GACzE5T,KAAK8T,UAAUE,eAAiBhU,KAAKuT,mBACrCvT,KAAKiU,OAA0D,IAAlDpP,OAAOqP,SAASC,OAAOxG,QAAQ,cAC5C3N,KAAKoU,UAAY,EACjBpU,KAAKqU,WAAa,EAClBrU,KAAKsU,oBAAsB,I,0DAK3B,OADAtU,KAAKwT,QAAUxT,KAAKwT,OACbxT,KAAKwT,S,iCAIZ,OAAOxT,KAAKwT,S,+BAIZxT,KAAKwT,QAAS,I,8BAGRe,GACN,OAAqE,IAA9DvU,KAAKyT,eAAe9F,QAAQ4G,EAAcC,iB,+BAG1CpN,EAAMqN,GACb,MAAMjT,MAAM,4C,6BAIZ,MAAMA,MAAM,wC,kCAIZ,MAAMA,MAAM,6C,iCAIZL,QAAQC,KAAK,wD,kCAIbD,QAAQC,KAAK,yD,iCAGJsT,GACTvT,QAAQC,KAAK,0D,mCAGFuT,GACXxT,QAAQC,KAAK,4D,qCAIb,OAAO,I,uCAIP,OAAO,I,mCAIP,OAAO,I,oCAIP,MAAO,CACLJ,MAAO,KACP4T,OAAQ,Q,qCAKV,MAAO,K,gCAIP,IAAK5U,KAAK6T,mBACR,MAAMrS,MAAM,+CAEdxB,KAAK8T,UAAUe,QAAQ7U,KAAK2T,mB,gCAI5B3T,KAAK8U,SAAU,EACf9U,KAAKwT,QAAS,I,6CAGOuB,GACrB/U,KAAKsT,oBAAsByB,I,sCAGbA,GACd,GAAkB,oBAAPA,EACT,MAAMvT,MAAM,oCAEdxB,KAAK6T,mBAAqBkB,I,yCAGTC,GACjB,IAAMC,EAAQrK,YAAYC,MAC1B7K,KAAK6T,mBAAmBmB,GACxB,IAAME,EAAMtK,YAAYC,MAExB,GAAI7K,KAAKiU,QACPjU,KAAKqU,YAAca,EAAMD,EACzBjV,KAAKoU,YACDpU,KAAKoU,WAAapU,KAAKsU,qBAAqB,CAC9C,IAAMa,EAAOnV,KAAKqU,WAAarU,KAAKoU,UAC9BgB,EAAS,IAAOpV,KAAK4T,WAAa5T,KAAKmT,SAASkC,WACtDlU,QAAQmU,IACN,2DACAtV,KAAKqB,YAAYC,KACjB6T,EAAKjH,QAAQ,GACblO,KAAK4T,WACLwB,EAAOlH,QAAQ,IACd,IAAMiH,EAAOC,GAAQlH,QAAQ,IAEhClO,KAAKqU,WAAa,EAClBrU,KAAKoU,UAAY,K,0CAKHN,EAAWiB,GAC7B,GAAIjB,GAAyC,YAA5BA,EAAUlT,QAAQwB,QAAuC,IAAhBpC,KAAKwT,OAAkB,CAC/E,IAAM+B,EAAezB,EAAUE,eAI/BF,EAAUE,eAAiB,SAAUtT,GACnC,IAAK,IAAIsH,EAAI,EAAGA,EAAItH,EAAE8U,aAAaC,iBAAkBzN,IACnDtH,EAAE8U,aAAaE,eAAe1N,GAAG2N,KAAK,GAExCZ,IACAjB,EAAUE,eAAiBuB,QAG7BR,O,4CAIwBa,GAI1B,IAAM/I,EAAQ+I,EAAS9I,MAAM,KACvB+I,EAAO,GAQb,OAPAA,EAAK7U,MAAQ6L,EAAMiJ,MACnBD,EAAKE,OAASlJ,EAAMmJ,QACA,cAAhBH,EAAKE,OACPF,EAAKI,KAAOpJ,EAAMmJ,QAElBH,EAAKK,OAASrJ,EAAMmJ,QAEfH,M,aCzLUM,EACnB,WAAYd,GAAa,oBACvB,IAAMe,EAAgB,IAAIC,eACpBC,EAAiBF,EAAcG,QAAQ,CAC3CC,MAAO,EACPC,eAAgB,cAChBC,GAAIrB,EACJsB,GAAI,IACJC,KAAM,IAGFC,EAAiBT,EAAcG,QAAQ,CAC3CC,MAAO,EACPC,eAAgB,cAChBC,GAAIrB,EACJsB,GAAI,IACJC,KAAM,IAGFE,EAAiBV,EAAcW,SAAS,CAC5CP,MAAO,EACPC,eAAgB,cAChBC,GAAIrB,EACJsB,GAAI,GACJC,KAAM,IAGFI,EAAW,IAAIC,YAAUX,GACzBY,EAAW,IAAID,YAAUJ,GACzBE,EAAW,IAAIE,YAAUH,GAK3BK,EAAQ,EACRC,EAAQ,EACRC,EAAe,EACfC,EAAQ,EACRC,EAAWtM,KAAKuM,KAAK,GAPF,IAOOnC,IAC1BoC,EAAS,EACTC,EAAYzM,KAAKuM,KAAK,GARF,KAQOnC,IAO/B,SAASsC,EAAaC,GAGpB,OAFAA,EANF,SAAsBA,GAEpB,OAAOA,GADPN,EAAQC,EAAWD,GAAS,EAAIC,GAAYK,GAKnCC,CAAaD,GAEN,OADhBH,EAASC,EAAYD,GAAU,EAAIC,GAAazM,KAAK6M,IAAIF,IAI3D5X,KAAK+X,QAAU,SAACH,GACd,IAAMI,EAAQhB,EAASiB,WAAWL,GAC5BM,EAAMP,EAAaK,GAEzBZ,EAAQD,EACRA,EAAQa,EAGJZ,EAAQ,GAAKD,GAAS,IACxBE,GAAgBA,EAAe,GAAKpM,KAAKqC,IAAI,EAhC9B,IAoCjB,IADA,IAAI6K,EAAW,EACNnQ,EAAI,EAAGA,EApCC,EAoCeA,IAAK,CAEnCmQ,GADYd,EAAgB,GAAKrP,EACf,GAAK,EAIzB,OADa+O,EAASkB,WAAWf,EAASe,WAAWE,IACvCD,I,iBCrEhBE,EAAM,KACNC,EAAS,KAEP5E,EAAiB,CACrB,MACA,OACA,MACA,MACA,MACA,MACA,KACA,MACA,OAGmB6E,E,YACnB,WAAYnF,EAAUC,EAAUC,EAAUC,GAAsB,IAAD,8BAC7D,4CAAMH,EAAUC,EAAUC,EAAUC,KAC/BiF,aAAe,EAAKA,aAAaxV,KAAlB,gBACpB,EAAKyV,aAAe,EAAKA,aAAazV,KAAlB,gBACpB,EAAK0V,aAAe,EAAKA,aAAa1V,KAAlB,gBAEpBsV,EAAShF,EACT,EAAKG,QAAS,EACd,EAAKC,eAAiBA,EACtB,EAAKiF,QAAU,EACf,EAAKC,MAAQ,EACb,EAAKC,OAAS,CAAEC,QAAS,GAEzB,EAAKC,OAAST,EAAOU,SAA2B,GAAlB,EAAKnF,WAAiB,MAAOyE,EAAOW,cAClE,EAAKC,OAASZ,EAAOU,SAAS,EAAG,MAAOV,EAAOW,cAE/C,EAAKE,QAAU,IAAI/C,EAAQhD,EAASkC,YAEpC,EAAK8D,gBAAgB,EAAKC,iBAlBmC,E,6EAqB/C1Y,GACd,IAAIsH,EAAGqR,EACDC,EAAW,GACjB,IAAKD,EAAU,EAAGA,EAAU3Y,EAAE8U,aAAaC,iBAAkB4D,IAC3DC,EAASD,GAAW3Y,EAAE8U,aAAaE,eAAe2D,GAGpD,GAAIrZ,KAAKwT,OACP,IAAK6F,EAAU,EAAGA,EAAUC,EAASrR,OAAQoR,IAC3CC,EAASD,GAAS1D,KAAK,QAW3B,GANI3V,KAAKuZ,iBAAmBvZ,KAAKwZ,kBAAsC,IAAnBxZ,KAAKyZ,YACvDtY,QAAQmU,IAAI,uBAAwBtV,KAAKuZ,iBACzCvZ,KAAK0Z,WAAW1Z,KAAKuZ,iBACrBvZ,KAAKyZ,WAAY,GAGkB,IAAjCpB,EAAOsB,iBAAiBvB,GAAY,CAGtC,IAFAC,EAAOuB,UAAUxB,EAAuB,EAAlBpY,KAAK4T,WAAgB5T,KAAK8Y,QAE3CO,EAAU,EAAGA,EAAUC,EAASrR,OAAQoR,IAC3C,IAAKrR,EAAI,EAAGA,EAAIhI,KAAK4T,WAAY5L,IAC/BsR,EAASD,GAASrR,GAAKqQ,EAAOwB,SAAS7Z,KAAK8Y,OAEtC,EAAJ9Q,EAAQ,EACE,EAAVqR,EACA,OAhEM,MAoEZ,GAAIrZ,KAAK4Y,OAAOC,QAAU,EACxB,IAAK7Q,EAAI,EAAGA,EAAIhI,KAAK4T,WAAY5L,IAAK,CACpC,IAAM8R,EAAM9Z,KAAKkZ,QAAQnB,QAAQuB,EAAS,GAAGtR,IAAMhI,KAAK4Y,OAAOC,QAC/DS,EAAS,GAAGtR,IAAM8R,EAClBR,EAAS,GAAGtR,IAAM8R,QAItB9Z,KAAK0Y,WAED1Y,KAAK0Y,SAAWL,EAAO0B,iBAAiB3B,IAA2C,IAAnCpY,KAAKga,YAAYha,KAAK0Y,YACxE1Y,KAAKia,UACL9Y,QAAQ8S,MACN,gGACAoE,EAAOsB,iBAAiBvB,GACxBpY,KAAK0Y,QACLL,EAAO0B,iBAAiB3B,IAE1BpY,KAAKsT,qBAAoB,M,kCAKnBoF,GAMV,OALA1Y,KAAKyZ,WAAY,EACjBzZ,KAAK0Y,QAAUA,EACf1Y,KAAK0T,SAAW1T,KAAKka,eAAexB,GACpCvX,QAAQ8S,MAAM,oCAAqCyE,GACnD1Y,KAAKsT,qBAAoB,GAClB+E,EAAO8B,iBAAiB/B,EAAKM,K,+BAG7BtR,EAAMwO,GACb5V,KAAK0Y,QAAU,EACf1Y,KAAKyZ,WAAY,EACjBzZ,KAAKoa,aAAelH,EAAOmH,qBAAqBzE,GAChD,IAAM0E,EAAkB1E,EAAS2E,MAC/B,2DAIF,GAFAva,KAAK4Y,OAAOC,QAAUyB,EAAkB,EAAI,EAOtC,IALFjC,EAAOmC,MACT,gBACA,SACA,CAAC,QAAS,SAAU,SAAU,UAC9B,CAACpT,EAAMA,EAAKa,OAAQjI,KAAKiZ,OAAQjZ,KAAKmT,SAASkC,aAI/C,MAFAlU,QAAQwC,MAAM,yBACd3D,KAAKya,OACCjZ,MAAM,6BAA+BoU,GAM7C,GAJAwC,EAAMC,EAAOwB,SAAS7Z,KAAKiZ,OAAQ,OAEnCjZ,KAAK6U,UACL7U,KAAK0a,SACkC,IAAnC1a,KAAKga,YAAYha,KAAK0Y,SAExB,MADAvX,QAAQwC,MAAM,2BACRnC,MAAM,kC,qCAIDkX,GACb,IAAMiC,EAActC,EAAOU,SAAS,EAAG,MAAOV,EAAOW,cACK,IAAtDX,EAAOuC,gBAAgBxC,EAAKuC,EAAajC,IAC3CvX,QAAQwC,MAAM,2BAChB,IAAMJ,EAAM8U,EAAOwB,SAASc,EAAa,KAErCE,EAAS,EAEPC,EAAY,WAChB,IAAIzX,EAAQgV,EAAOwB,SAAStW,EAAMsX,EAAQ,OAE1C,OADAA,GAAU,EACHxX,GAGH0X,EAAa,WAGjB,IAFA,IAAMC,EAAM,GACNC,EAAM5C,EAAOwB,SAAStW,EAAMsX,EAAQ,OACjC7S,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAC5B,IAAIkT,EAAO7C,EAAOwB,SAASoB,EAAMjT,EAAG,MACpC,GAAa,IAATkT,EACF,MAEFF,EAAI1W,KAAY,IAAP4W,GAIX,OADAL,GAAU,EACHM,IAASC,QAAQJ,EAAK,CAACK,GAAI,UAAWnV,KAAM,YAG/C2P,EAAO,GAwBb,OAtBAA,EAAK5N,OAAS6S,IACdjF,EAAKyF,aAAeR,IACpBjF,EAAK0F,YAAcT,IACnBjF,EAAK2F,YAAcV,IAEnBD,GAAU,GAEVhF,EAAKE,OAASgF,IACdlF,EAAKI,KAAO8E,IACZlF,EAAK7U,MAAQ+Z,KAAgBlF,EAAKI,MAAQjW,KAAKoa,aAAapZ,MAC5D6U,EAAKK,OAAS6E,KAAgB/a,KAAKoa,aAAalE,OAChDL,EAAK4F,UAAYV,IACjBlF,EAAK6F,QAAUX,IAURlF,I,mCAGIlB,GACX,GAAIyD,EAAK,OAAOC,EAAOsD,aAAatD,EAAOuD,gBAAgBxD,EAAKzD,M,qCAIhE,GAAIyD,EAAK,OAAOC,EAAOwD,iBAAiBzD,K,uCAIxC,GAAIA,EAAK,OAAOC,EAAO0B,iBAAiB3B,K,mCAIxC,OAAOpY,KAAK0Y,U,sCAIZ,OAAIN,EAAYC,EAAOyD,iBAAiB1D,GACjC,I,sCAIP,OAAIA,EAAYpY,KAAK0T,SAAS8H,YACvB,I,oCAIP,OAAOxb,KAAK0T,W,mCAGD9D,GACX,OAAO5P,KAAK4Y,OAAOhJ,K,qCAInB,MAAO,CACL,CACEA,GAAI,UACJmM,MAAO,WACP7V,KAAM,SACNC,IAAK,EACLC,IAAK,EACLC,KAAM,IACNhD,MAAO,M,mCAKAuM,EAAIvM,GACf,OAAQuM,GACN,IAAK,UACH5P,KAAK4Y,OAAOhJ,GAAM5J,WAAW3C,GAC7B,MACF,QACElC,QAAQC,KAAK,2CAA4CwO,M,kCAK7D,OAAQ5P,KAAKgc,YAA+C,IAAjC3D,EAAOsB,iBAAiBvB,K,+BAG5C6D,GACPjc,KAAK2Y,MAAQsD,EACT7D,GAAKC,EAAO6D,eAAe9D,EAAK6D,K,iCAG3BvH,GACL0D,GAAKC,EAAO8D,cAAc/D,EAAK1D,EAAS,O,gCAGpC0H,GACR,IAAIC,EAAO,EACXD,EAAOnY,SAAQ,SAACqY,EAAWtU,GACpBsU,IACHD,GAAQ,GAAKrU,MAGboQ,GAAKC,EAAOkE,iBAAiBnE,EAAKiE,K,6BAGjCG,GACDpE,GACFpY,KAAKyc,oBAAoBzc,KAAK8T,WAAW,kBACvCuE,EAAOqE,iBAAiBtE,EAAKoE,Q,6BAKjCxc,KAAKia,UACD7B,GAAKC,EAAOsE,YAAYvE,GAC5BA,EAAM,KACNjX,QAAQ8S,MAAM,oBACdjU,KAAKsT,qBAAoB,O,GAzQUJ,GCg1IxB0J,GCl2IG3R,KAAKqC,IAAI,EAAG,IDGhB,SAASsP,GAGX,IAEIhW,EAFAiW,EAA8B,qBAFlCD,EAAYA,GAAa,IAEuBA,EAAY,GACxDE,EAAkB,GAEtB,IAAKlW,KAAOiW,EACNA,EAAOE,eAAenW,KACxBkW,EAAgBlW,GAAOiW,EAAOjW,IAGlC,IAcIoW,EAAkBC,EAdlBC,EAAa,GACbC,EAAc,iBAMdC,EAAkB,GAWTlL,SAASmL,gBAClBD,EAAkBlL,SAASmL,cAAcC,KAMzCF,EADuC,IAArCA,EAAgBzP,QAAQ,SACRyP,EAAgB3P,OAAO,EAAG2P,EAAgBG,YAAY,KAAO,GAE7D,GAGlBP,EAAQ,SAAoBQ,GAC1B,IAAIC,EAAM,IAAIC,eAGd,OAFAD,EAAIpb,KAAK,MAAOmb,GAAK,GACrBC,EAAIE,KAAK,MACFF,EAAIG,cAgCjB,IAoDIC,EAkEAC,EAtHAC,EAAMlB,EAAM,OAAa1b,QAAQmU,IAAIvS,KAAK5B,SAC1C6c,EAAMnB,EAAM,UAAgB1b,QAAQC,KAAK2B,KAAK5B,SAClD,IAAKyF,KAAOkW,EACNA,EAAgBC,eAAenW,KACjCiW,EAAOjW,GAAOkW,EAAgBlW,IAUlC,SAASqX,EAAaC,GACpB,IAAIC,EAAMC,EAAOC,GAAkB,GAC/BnJ,EAAMiJ,EAAMD,EAAO,IAAM,GAK7B,OAJIhJ,EAAMoJ,MACRC,IAEFH,EAAOC,GAAkB,GAAKnJ,EACvBiJ,EAET,SAASK,EAAkBtY,GACzB,OAAQA,GACN,IAAK,KACL,IAAK,KACH,OAAO,EACT,IAAK,MACH,OAAO,EACT,IAAK,MACH,OAAO,EACT,IAAK,MACH,OAAO,EACT,IAAK,QACH,OAAO,EACT,IAAK,SACH,OAAO,EACT,QAEE,GAA8B,MAA1BA,EAAKA,EAAK+B,OAAS,GACrB,OAAO,EACF,GAAgB,MAAZ/B,EAAK,GAAY,CAC1B,IAAIuY,EAAOC,OAAOxY,EAAKuH,OAAO,IAE9B,OADAkR,EAAOF,EAAO,IAAM,EAAG,kCAAoCA,EAAO,UAAYvY,GACvEuY,EAAO,EAEd,OAAO,GAcf,SAASG,EAAS3D,EAAK5X,EAAO6C,EAAM2Y,GAIlC,OAFqC,OADrC3Y,EAAOA,GAAQ,MACN4Y,OAAO5Y,EAAK+B,OAAS,KAC5B/B,EAAO,OACDA,GACN,IAAK,KAGL,IAAK,KACH6Y,EAAM9D,GAAO,GAAK5X,EAClB,MACF,IAAK,MACH2b,EAAO/D,GAAO,GAAK5X,EACnB,MACF,IAAK,MACH+a,EAAOnD,GAAO,GAAK5X,EACnB,MACF,IAAK,MACH4b,GAAU,CAAC5b,IAAU,GAAI6b,EAAa7b,GACjC8b,EAASD,IAAe,EAAIA,EAAa,GAAkE,EAA7DE,GAAUC,EAAWH,EAAa,YAAa,eAAqB,KAAOI,GAAWJ,MAAiBA,IAAe,IAAM,cAAgB,EAAI,IAC/Ld,EAAOnD,GAAO,GAAKgE,GAAQ,GAC3Bb,EAAOnD,EAAM,GAAK,GAAKgE,GAAQ,GACnC,MACF,IAAK,QACHM,EAAQtE,GAAO,GAAK5X,EACpB,MACF,IAAK,SACHmc,EAAQvE,GAAO,GAAK5X,EACpB,MACF,QACEkb,EAAM,8BAAgCrY,IApF5C4W,EAAkB,KACdD,EAAM,YACRK,EAAaL,EAAM,WACjBA,EAAM,cACRM,EAAcN,EAAM,aAClBA,EAAM,MACAA,EAAM,KAwCZA,EAAM,aACRgB,EAAahB,EAAM,YAEjBA,EAAM,eACQA,EAAM,cACG,kBAAhB4C,aACTzB,EAAI,mCA4DN,IAAI0B,EAAY,IAAID,YAAYE,MAAM,CACpC,QAAW,IACX,QAAW,IACX,QAAW,YAETC,GAAQ,EAEZ,SAASjB,EAAOkB,EAAWC,GACpBD,GACHtB,EAAM,qBAAuBuB,GAgHjC,IAoHIhH,EAAQiG,EAAOgB,EAAQf,EAAiBZ,EAAiBmB,EAASC,EApHlEQ,EAAqC,qBAAhBC,YAA8B,IAAIA,YAAY,aAAUC,EACjF,SAASC,EAAkBC,EAASC,EAAKC,GAGvC,IAFA,IAAIC,EAASF,EAAMC,EACfE,EAASH,EACND,EAAQI,MAAaA,GAAUD,MAClCC,EACJ,GAAIA,EAASH,EAAM,IAAMD,EAAQK,UAAYT,EAC3C,OAAOA,EAAYU,OAAON,EAAQK,SAASJ,EAAKG,IAGhD,IADA,IAAIG,EAAM,GACHN,EAAMG,GAAQ,CACnB,IAAII,EAAKR,EAAQC,KACjB,GAAW,IAALO,EAAN,CAIA,IAAIC,EAAsB,GAAjBT,EAAQC,KACjB,GAAkB,MAAR,IAALO,GAAL,CAIA,IAAIE,EAAsB,GAAjBV,EAAQC,KAMjB,IAJEO,EADgB,MAAR,IAALA,IACQ,GAALA,IAAY,GAAKC,GAAM,EAAIC,GAEtB,EAALF,IAAW,GAAKC,GAAM,GAAKC,GAAM,EAAqB,GAAjBV,EAAQC,MAE5C,MACPM,GAAOI,OAAOC,aAAaJ,OACtB,CACL,IAAIK,EAAKL,EAAK,MACdD,GAAOI,OAAOC,aAAa,MAAQC,GAAM,GAAI,MAAa,KAALA,SAbrDN,GAAOI,OAAOC,cAAmB,GAALJ,IAAY,EAAIC,QAL5CF,GAAOI,OAAOC,aAAaJ,GAsBjC,OAAOD,EAET,SAAShF,EAAaV,EAAKqF,GACzB,OAAOrF,EAAMkF,EAAkBJ,EAAQ9E,EAAKqF,GAAkB,GAEhE,SAASY,EAAkBP,EAAKQ,EAAYC,EAAQC,GAClD,KAAMA,EAAkB,GACtB,OAAO,EAGT,IAFA,IAAIC,EAAWF,EACXb,EAASa,EAASC,EAAkB,EAC/BrZ,EAAI,EAAGA,EAAI2Y,EAAI1Y,SAAUD,EAAG,CACnC,IAAIuZ,EAAIZ,EAAIa,WAAWxZ,GAKvB,GAJIuZ,GAAK,OAASA,GAAK,QAErBA,EAAI,QAAc,KAAJA,IAAa,IAAW,KAD7BZ,EAAIa,aAAaxZ,IAGxBuZ,GAAK,IAAK,CACZ,GAAIH,GAAUb,EACZ,MACFY,EAAWC,KAAYG,OAClB,GAAIA,GAAK,KAAM,CACpB,GAAIH,EAAS,GAAKb,EAChB,MACFY,EAAWC,KAAY,IAAMG,GAAK,EAClCJ,EAAWC,KAAY,IAAU,GAAJG,OACxB,GAAIA,GAAK,MAAO,CACrB,GAAIH,EAAS,GAAKb,EAChB,MACFY,EAAWC,KAAY,IAAMG,GAAK,GAClCJ,EAAWC,KAAY,IAAMG,GAAK,EAAI,GACtCJ,EAAWC,KAAY,IAAU,GAAJG,MACxB,CACL,GAAIH,EAAS,GAAKb,EAChB,MACFY,EAAWC,KAAY,IAAMG,GAAK,GAClCJ,EAAWC,KAAY,IAAMG,GAAK,GAAK,GACvCJ,EAAWC,KAAY,IAAMG,GAAK,EAAI,GACtCJ,EAAWC,KAAY,IAAU,GAAJG,GAIjC,OADAJ,EAAWC,GAAU,EACdA,EAASE,EAElB,SAASG,EAAad,EAAKe,EAAQL,GACjC,OAAOH,EAAkBP,EAAKZ,EAAQ2B,EAAQL,GAEhD,SAASM,EAAgBhB,GAEvB,IADA,IAAIiB,EAAM,EACD5Z,EAAI,EAAGA,EAAI2Y,EAAI1Y,SAAUD,EAAG,CACnC,IAAIuZ,EAAIZ,EAAIa,WAAWxZ,GACnBuZ,GAAK,OAASA,GAAK,QACrBA,EAAI,QAAc,KAAJA,IAAa,IAA4B,KAAtBZ,EAAIa,aAAaxZ,IAChDuZ,GAAK,MACLK,EAEFA,GADOL,GAAK,KACL,EACAA,GAAK,MACL,EAEA,EAEX,OAAOK,EAGT,SAASC,EAAmBC,EAAOhJ,GACjCiG,EAAMgD,IAAID,EAAOhJ,GAiBnB,SAASkJ,EAA2BC,GAClCnJ,EAASmJ,EACTpF,EAAM,MAAYkC,EAAQ,IAAImD,UAAUD,GACxCpF,EAAM,OAAamC,EAAS,IAAImD,WAAWF,GAC3CpF,EAAM,OAAauB,EAAS,IAAIgE,WAAWH,GAC3CpF,EAAM,OAAakD,EAAS,IAAIsC,WAAWJ,GAC3CpF,EAAM,QAAwB,IAAIyF,YAAYL,GAC9CpF,EAAM,QAAwB,IAAI0F,YAAYN,GAC9CpF,EAAM,QAAc0C,EAAU,IAAIiD,aAAaP,GAC/CpF,EAAM,QAAc2C,EAAU,IAAIiD,aAAaR,GA5BP,qBAAhBhC,aAA8B,IAAIA,YAAY,YA8BxE,IACM5B,EAAiB,QACnBqE,EAAyB7F,EAAM,gBAAsB,SAczD,SAAS8F,EAAqBC,GAC5B,KAAOA,EAAU3a,OAAS,GAAG,CAC3B,IAAIoD,EAAWuX,EAAU5M,QACzB,GAAuB,mBAAZ3K,EAAX,CAIA,IAAIrJ,EAAOqJ,EAASrJ,KACA,kBAATA,OACYke,IAAjB7U,EAASwX,IACXhG,EAAM,UAAc7a,GAEpB6a,EAAM,WAAe7a,EAAMqJ,EAASwX,KAGtC7gB,OAAsBke,IAAjB7U,EAASwX,IAAoB,KAAOxX,EAASwX,UAXlDxX,MAhBJyS,EADEjB,EAAM,WACKA,EAAM,WAEN,IAAI4C,YAAYqD,OAAO,CAClC,QAAWJ,EA1BM,WA8BnB5J,EAASgF,EAAWhF,QAEtB4J,EAAyB5J,EAAOiK,WAChCf,EAA2BlJ,GAC3BsF,EAAOC,GAAkB,GAfN,SAmCnB,IAAI2E,EAAe,GACfC,EAAa,GACbC,EAAa,GACbC,EAAgB,GAuChBhE,EAAWlU,KAAK6M,IAChBwH,EAAYrU,KAAKmY,KACjB/D,EAAapU,KAAKE,MAClBiU,EAAWnU,KAAK9E,IAChBkd,EAAkB,EAClBC,EAAuB,KACvBC,EAAwB,KAI5B,SAASC,EAAiB5T,GACxByT,IACIxG,EAAM,wBACRA,EAAM,uBAA2BwG,GAGrC,SAASI,EAAoB7T,GAK3B,GAJAyT,IACIxG,EAAM,wBACRA,EAAM,uBAA2BwG,GAEZ,GAAnBA,IAC2B,OAAzBC,IACFI,cAAcJ,GACdA,EAAuB,MAErBC,GAAuB,CACzB,IAAIlY,EAAWkY,EACfA,EAAwB,KACxBlY,KAMN,SAASkT,EAAMoF,GAUb,MATI9G,EAAM,SACRA,EAAM,QAAY8G,GAGpB5F,EADA4F,GAAQ,IAER3F,EAAI2F,GACJ/D,GAAQ,EAER+D,EAAO,SAAWA,EAAO,+CACnB,IAAIlE,YAAYmE,aAAaD,GAGrC,SAASE,EAAUpP,GACjB,OAAOsM,OAAO+C,UAAUC,WAAatP,EAASsP,WAF5B,yCAE4F,IAApCtP,EAAS9G,QAFjE,yCAdpBkP,EAAM,gBAAsB,GAC5BA,EAAM,gBAAsB,GAiB5B,IA1iBoBmH,EA+nBhB9E,EACAD,GAtFAgF,GAAiB,iBAIrB,SAASC,KACP,IACE,GAAIrG,EACF,OAAO,IAAIwE,WAAWxE,GAExB,GAAIZ,EACF,OAAOA,EAAWgH,IAElB,KAAM,kDAER,MAAOjG,GACPO,EAAMP,IAdL6F,EAAUI,MA3iBKD,EA4iBUC,GAA5BA,GA3iBIpH,EAAM,WACDA,EAAM,WAAemH,EAAM5G,GAE7BA,EAAkB4G,GA6nB3B,IAAIG,GAAa,CACfC,OAAQ,SAASC,GACfljB,QAAQmU,IAAI,+BAAgC+O,IAE9CC,OAAQ,SAASD,GACfljB,QAAQmU,IAAI,oCAAqC+O,IAEnDE,OAAQ,SAASF,GACfljB,QAAQmU,IAAI,+BAAgC+O,KAoChD,SAASG,KACP,IAAIC,EAfN,WACE,IAAIzG,EAAM,IAAIxc,MACd,IAAKwc,EAAI0G,MAAO,CACd,IACE,MAAM,IAAIljB,MACV,MAAOd,GACPsd,EAAMtd,EAER,IAAKsd,EAAI0G,MACP,MAAO,6BAGX,OAAO1G,EAAI0G,MAAMtZ,WAGRuZ,GAGT,OAFI9H,EAAM,kBACR4H,GAAM,KAAO5H,EAAM,mBACF4H,EAvBP3Z,QADA,iBACe,SAAS8Z,GAElC,OAAOA,IADUA,EACAA,EADAA,EACQ,KAAOA,EAAI,OAZxC3B,EAAW3e,KAAK,CACdtC,KAAM,WACJ6iB,QAuCJ,IAAIC,GAAqB,GAEzB,SAASC,KACP,OAAOA,GAA2BC,oBAAsB,EAoB1D,SAASC,GAAY5hB,GAGnB,OAFIwZ,EAAM,oBACRuB,EAAOvB,EAAM,qBAA2B,GAAKxZ,GACxCA,EAMT,IAAI6hB,GAAO,CACTC,UAAW,SAAS1Q,GAElB,MADkB,gEACC2Q,KAAK3Q,GAAUtH,MAAM,IAE1CkY,eAAgB,SAASxY,EAAOyY,GAE9B,IADA,IAAIC,EAAK,EACAvd,EAAI6E,EAAM5E,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC1C,IAAIwd,EAAO3Y,EAAM7E,GACJ,MAATwd,EACF3Y,EAAM4Y,OAAOzd,EAAG,GACE,OAATwd,GACT3Y,EAAM4Y,OAAOzd,EAAG,GAChBud,KACSA,IACT1Y,EAAM4Y,OAAOzd,EAAG,GAChBud,KAGJ,GAAID,EACF,KAAOC,EAAIA,IACT1Y,EAAMsC,QAAQ,MAGlB,OAAOtC,GAET6Y,UAAW,SAAS1B,GAClB,IAAI2B,EAAgC,MAAnB3B,EAAKlF,OAAO,GACvB8G,EAAoC,MAApB5B,EAAKvW,QAAQ,GAUnC,OATAuW,EAAOkB,GAAKG,eAAerB,EAAKlX,MAAM,KAAKyE,QAAO,SAASsU,GACzD,QAASA,MACNF,GAAYG,KAAK,OACRH,IACZ3B,EAAO,KAELA,GAAQ4B,IACV5B,GAAQ,MAEF2B,EAAa,IAAM,IAAM3B,GAEnC+B,QAAS,SAAS/B,GAChB,IAAItY,EAASwZ,GAAKC,UAAUnB,GACtBgC,EAAOta,EAAO,GACdua,EAAMva,EAAO,GACnB,OAAKsa,GAASC,GAGVA,IACFA,EAAMA,EAAIxY,OAAO,EAAGwY,EAAIhe,OAAS,IAE5B+d,EAAOC,GALL,KAOXC,SAAU,SAASlC,GACjB,GAAa,MAATA,EACF,MAAO,IACT,IAAImC,EAAYnC,EAAKzG,YAAY,KACjC,OAAmB,IAAf4I,EACKnC,EACFA,EAAKvW,OAAO0Y,EAAY,IAEjCC,QAAS,SAASpC,GAChB,OAAOkB,GAAKC,UAAUnB,GAAM,IAE9B8B,KAAM,WACJ,IAAIO,EAAQtX,MAAM+U,UAAU3W,MAAMmZ,KAAKC,UAAW,GAClD,OAAOrB,GAAKQ,UAAUW,EAAMP,KAAK,OAEnCU,MAAO,SAASC,EAAGzb,GACjB,OAAOka,GAAKQ,UAAUe,EAAI,IAAMzb,KAGhC0b,GAAU,CACZC,QAAS,WAGP,IAFA,IAAIC,EAAe,GACbC,GAAmB,EAChB7e,EAAIue,UAAUte,OAAS,EAAGD,IAAM,IAAM6e,EAAkB7e,IAAK,CACpE,IAAIgc,EAAOhc,GAAK,EAAIue,UAAUve,GAAK8e,GAAGC,MACtC,GAAoB,kBAAT/C,EACT,MAAM,IAAIgD,UAAU,6CACf,IAAKhD,EACV,MAAO,GAET4C,EAAe5C,EAAO,IAAM4C,EAC5BC,EAAsC,MAAnB7C,EAAKlF,OAAO,GAKjC,OAAQ+H,EAAmB,IAAM,KAHjCD,EAAe1B,GAAKG,eAAeuB,EAAa9Z,MAAM,KAAKyE,QAAO,SAASsU,GACzE,QAASA,MACNgB,GAAkBf,KAAK,OAC2B,KAEzDmB,SAAU,SAASC,EAAM7L,GAGvB,SAAS8L,EAAKC,GAEZ,IADA,IAAInS,EAAQ,EACLA,EAAQmS,EAAInf,QACE,KAAfmf,EAAInS,GADiBA,KAK3B,IADA,IAAIC,EAAMkS,EAAInf,OAAS,EAChBiN,GAAO,GACK,KAAbkS,EAAIlS,GADOA,KAIjB,OAAID,EAAQC,EACH,GACFkS,EAAIja,MAAM8H,EAAOC,EAAMD,EAAQ,GAfxCiS,EAAOR,GAAQC,QAAQO,GAAMzZ,OAAO,GACpC4N,EAAKqL,GAAQC,QAAQtL,GAAI5N,OAAO,GAoBhC,IAJA,IAAI4Z,EAAYF,EAAKD,EAAKpa,MAAM,MAC5Bwa,EAAUH,EAAK9L,EAAGvO,MAAM,MACxB7E,EAASgD,KAAK9E,IAAIkhB,EAAUpf,OAAQqf,EAAQrf,QAC5Csf,EAAkBtf,EACbD,EAAI,EAAGA,EAAIC,EAAQD,IAC1B,GAAIqf,EAAUrf,KAAOsf,EAAQtf,GAAI,CAC/Buf,EAAkBvf,EAClB,MAGJ,IAAIwf,EAAc,GAClB,IAASxf,EAAIuf,EAAiBvf,EAAIqf,EAAUpf,OAAQD,IAClDwf,EAAYljB,KAAK,MAGnB,OADAkjB,EAAcA,EAAYC,OAAOH,EAAQna,MAAMoa,KAC5BzB,KAAK,OAGxB4B,GAAM,CACRC,KAAM,GACNC,KAAM,aACNC,SAAU,aACVC,SAAU,SAASC,EAAKC,GACtBN,GAAIC,KAAKI,GAAO,CACdla,MAAO,GACPoa,OAAQ,GACRD,IAAKA,GAEPlB,GAAGoB,eAAeH,EAAKL,GAAIS,aAE7BA,WAAY,CACV9lB,KAAM,SAAS+lB,GACb,IAAIC,EAAMX,GAAIC,KAAKS,EAAOE,KAAKC,MAC/B,IAAKF,EACH,MAAM,IAAIvB,GAAG0B,WAAW,IAE1BJ,EAAOC,IAAMA,EACbD,EAAOK,UAAW,GAEpBC,MAAO,SAASN,GACdA,EAAOC,IAAIL,IAAIW,MAAMP,EAAOC,MAE9BM,MAAO,SAASP,GACdA,EAAOC,IAAIL,IAAIW,MAAMP,EAAOC,MAE9BO,KAAM,SAASR,EAAQtP,EAAQ+B,EAAQ5S,EAAQ4gB,GAC7C,IAAKT,EAAOC,MAAQD,EAAOC,IAAIL,IAAIc,SACjC,MAAM,IAAIhC,GAAG0B,WAAW,IAG1B,IADA,IAAIO,EAAY,EACP/gB,EAAI,EAAGA,EAAIC,EAAQD,IAAK,CAC/B,IAAI0D,EACJ,IACEA,EAAS0c,EAAOC,IAAIL,IAAIc,SAASV,EAAOC,KACxC,MAAO3nB,GACP,MAAM,IAAIomB,GAAG0B,WAAW,IAE1B,QAAetI,IAAXxU,GAAsC,IAAdqd,EAC1B,MAAM,IAAIjC,GAAG0B,WAAW,GAE1B,GAAe,OAAX9c,QAA8BwU,IAAXxU,EACrB,MACFqd,IACAjQ,EAAO+B,EAAS7S,GAAK0D,EAKvB,OAHIqd,IACFX,EAAOE,KAAKU,UAAYte,KAAKG,OAExBke,GAETE,MAAO,SAASb,EAAQtP,EAAQ+B,EAAQ5S,EAAQ4gB,GAC9C,IAAKT,EAAOC,MAAQD,EAAOC,IAAIL,IAAIkB,SACjC,MAAM,IAAIpC,GAAG0B,WAAW,IAE1B,IACE,IAAK,IAAIxgB,EAAI,EAAGA,EAAIC,EAAQD,IAC1BogB,EAAOC,IAAIL,IAAIkB,SAASd,EAAOC,IAAKvP,EAAO+B,EAAS7S,IAEtD,MAAOtH,GACP,MAAM,IAAIomB,GAAG0B,WAAW,IAK1B,OAHIvgB,IACFmgB,EAAOE,KAAKU,UAAYte,KAAKG,OAExB7C,IAGXmhB,gBAAiB,CACfL,SAAU,SAAST,GACjB,IAAKA,EAAIxa,MAAM5F,OAAQ,CACrB,IAAIyD,EAAS,KAYb,GAXqB,oBAAV7G,QAAiD,mBAAjBA,OAAO6M,OAEjC,QADfhG,EAAS7G,OAAO6M,OAAO,cAErBhG,GAAU,MAEgB,mBAAZ0d,UAED,QADf1d,EAAS0d,cAEP1d,GAAU,OAGTA,EACH,OAAO,KAET2c,EAAIxa,MAAQwb,GAAmB3d,GAAQ,GAEzC,OAAO2c,EAAIxa,MAAMmI,SAEnBkT,SAAU,SAASb,EAAKpM,GACV,OAARA,GAAwB,KAARA,GAClB8B,EAAIoC,EAAkBkI,EAAIJ,OAAQ,IAClCI,EAAIJ,OAAS,IAEF,GAAPhM,GACFoM,EAAIJ,OAAO3jB,KAAK2X,IAGtB0M,MAAO,SAASN,GACVA,EAAIJ,QAAUI,EAAIJ,OAAOhgB,OAAS,IACpC8V,EAAIoC,EAAkBkI,EAAIJ,OAAQ,IAClCI,EAAIJ,OAAS,MAInBqB,iBAAkB,CAChBJ,SAAU,SAASb,EAAKpM,GACV,OAARA,GAAwB,KAARA,GAClB+B,EAAImC,EAAkBkI,EAAIJ,OAAQ,IAClCI,EAAIJ,OAAS,IAEF,GAAPhM,GACFoM,EAAIJ,OAAO3jB,KAAK2X,IAGtB0M,MAAO,SAASN,GACVA,EAAIJ,QAAUI,EAAIJ,OAAOhgB,OAAS,IACpC+V,EAAImC,EAAkBkI,EAAIJ,OAAQ,IAClCI,EAAIJ,OAAS,OAKjBsB,GAAQ,CACVC,UAAW,KACXC,MAAO,SAASA,GACd,OAAOF,GAAMG,WAAW,KAAM,IAAK,MAAa,IAElDA,WAAY,SAASrlB,EAAQ/C,EAAMqoB,EAAM5B,GACvC,GAAIjB,GAAG8C,SAASD,IAAS7C,GAAG+C,OAAOF,GACjC,MAAM,IAAI7C,GAAG0B,WAAW,IAErBe,GAAMC,YACTD,GAAMC,UAAY,CAChBvD,IAAK,CACHqC,KAAM,CACJwB,QAASP,GAAMQ,SAASD,QACxBE,QAAST,GAAMQ,SAASC,QACxBC,OAAQV,GAAMQ,SAASE,OACvBC,MAAOX,GAAMQ,SAASG,MACtBC,OAAQZ,GAAMQ,SAASI,OACvBC,OAAQb,GAAMQ,SAASK,OACvBC,MAAOd,GAAMQ,SAASM,MACtBC,QAASf,GAAMQ,SAASO,QACxBC,QAAShB,GAAMQ,SAASQ,SAE1BnC,OAAQ,CACNoC,OAAQjB,GAAMpB,WAAWqC,SAG7BC,KAAM,CACJnC,KAAM,CACJwB,QAASP,GAAMQ,SAASD,QACxBE,QAAST,GAAMQ,SAASC,SAE1B5B,OAAQ,CACNoC,OAAQjB,GAAMpB,WAAWqC,OACzB5B,KAAMW,GAAMpB,WAAWS,KACvBK,MAAOM,GAAMpB,WAAWc,MACxBlQ,SAAUwQ,GAAMpB,WAAWpP,SAC3B2R,KAAMnB,GAAMpB,WAAWuC,KACvBC,MAAOpB,GAAMpB,WAAWwC,QAG5BC,KAAM,CACJtC,KAAM,CACJwB,QAASP,GAAMQ,SAASD,QACxBE,QAAST,GAAMQ,SAASC,QACxBa,SAAUtB,GAAMQ,SAASc,UAE3BzC,OAAQ,IAEV0C,OAAQ,CACNxC,KAAM,CACJwB,QAASP,GAAMQ,SAASD,QACxBE,QAAST,GAAMQ,SAASC,SAE1B5B,OAAQtB,GAAGiE,qBAIjB,IAAIzC,EAAOxB,GAAG4C,WAAWrlB,EAAQ/C,EAAMqoB,EAAM5B,GAqB7C,OApBIjB,GAAGkE,MAAM1C,EAAKqB,OAChBrB,EAAKyB,SAAWR,GAAMC,UAAUvD,IAAIqC,KACpCA,EAAKH,WAAaoB,GAAMC,UAAUvD,IAAImC,OACtCE,EAAK2C,SAAW,IACPnE,GAAGoE,OAAO5C,EAAKqB,OACxBrB,EAAKyB,SAAWR,GAAMC,UAAUiB,KAAKnC,KACrCA,EAAKH,WAAaoB,GAAMC,UAAUiB,KAAKrC,OACvCE,EAAK6C,UAAY,EACjB7C,EAAK2C,SAAW,MACPnE,GAAGsE,OAAO9C,EAAKqB,OACxBrB,EAAKyB,SAAWR,GAAMC,UAAUoB,KAAKtC,KACrCA,EAAKH,WAAaoB,GAAMC,UAAUoB,KAAKxC,QAC9BtB,GAAGuE,SAAS/C,EAAKqB,QAC1BrB,EAAKyB,SAAWR,GAAMC,UAAUsB,OAAOxC,KACvCA,EAAKH,WAAaoB,GAAMC,UAAUsB,OAAO1C,QAE3CE,EAAKU,UAAYte,KAAKG,MAClBxG,IACFA,EAAO4mB,SAAS3pB,GAAQgnB,GAEnBA,GAETgD,0BAA2B,SAAShD,GAClC,GAAIA,EAAK2C,UAAY3C,EAAK2C,SAASxK,SAAU,CAE3C,IADA,IAAI2G,EAAM,GACDpf,EAAI,EAAGA,EAAIsgB,EAAK6C,YAAanjB,EACpCof,EAAI9iB,KAAKgkB,EAAK2C,SAASjjB,IACzB,OAAOof,EAET,OAAOkB,EAAK2C,UAEdM,wBAAyB,SAASjD,GAChC,OAAKA,EAAK2C,SAEN3C,EAAK2C,SAASxK,SACT6H,EAAK2C,SAASxK,SAAS,EAAG6H,EAAK6C,WACjC,IAAI9I,WAAWiG,EAAK2C,UAHlB,IAAI5I,WAAW,IAK1BmJ,kBAAmB,SAASlD,EAAMmD,GAChC,IAAIC,EAAepD,EAAK2C,SAAW3C,EAAK2C,SAAShjB,OAAS,EAC1D,KAAIyjB,GAAgBD,GAApB,CAGAA,EAAcxgB,KAAK7E,IAAIqlB,EAAaC,GAAgBA,EADxB,QAC+D,EAAI,OAAS,GACpF,GAAhBA,IACFD,EAAcxgB,KAAK7E,IAAIqlB,EAAa,MACtC,IAAIE,EAAcrD,EAAK2C,SACvB3C,EAAK2C,SAAW,IAAI5I,WAAWoJ,GAC3BnD,EAAK6C,UAAY,GACnB7C,EAAK2C,SAASlJ,IAAI4J,EAAYlL,SAAS,EAAG6H,EAAK6C,WAAY,KAG/DS,kBAAmB,SAAStD,EAAMuD,GAChC,GAAIvD,EAAK6C,WAAaU,EAAtB,CAEA,GAAe,GAAXA,EAGF,OAFAvD,EAAK2C,SAAW,UAChB3C,EAAK6C,UAAY,GAGnB,IAAK7C,EAAK2C,UAAY3C,EAAK2C,SAASxK,SAAU,CAC5C,IAAIkL,EAAcrD,EAAK2C,SAMvB,OALA3C,EAAK2C,SAAW,IAAI5I,WAAWwJ,GAC3BF,GACFrD,EAAK2C,SAASlJ,IAAI4J,EAAYlL,SAAS,EAAGxV,KAAK9E,IAAI0lB,EAASvD,EAAK6C,kBAEnE7C,EAAK6C,UAAYU,GAKnB,GAFKvD,EAAK2C,WACR3C,EAAK2C,SAAW,IACd3C,EAAK2C,SAAShjB,OAAS4jB,EACzBvD,EAAK2C,SAAShjB,OAAS4jB,OAEvB,KAAOvD,EAAK2C,SAAShjB,OAAS4jB,GAC5BvD,EAAK2C,SAAS3mB,KAAK,GACvBgkB,EAAK6C,UAAYU,IAEnB9B,SAAU,CACRD,QAAS,SAASxB,GAChB,IAAIwD,EAAO,GAsBX,OArBAA,EAAK/D,IAAMjB,GAAGuE,SAAS/C,EAAKqB,MAAQrB,EAAK1Y,GAAK,EAC9Ckc,EAAKC,IAAMzD,EAAK1Y,GAChBkc,EAAKnC,KAAOrB,EAAKqB,KACjBmC,EAAKE,MAAQ,EACbF,EAAKG,IAAM,EACXH,EAAKI,IAAM,EACXJ,EAAKvD,KAAOD,EAAKC,KACbzB,GAAGkE,MAAM1C,EAAKqB,MAChBmC,EAAK5N,KAAO,KACH4I,GAAGoE,OAAO5C,EAAKqB,MACxBmC,EAAK5N,KAAOoK,EAAK6C,UACRrE,GAAGsE,OAAO9C,EAAKqB,MACxBmC,EAAK5N,KAAOoK,EAAKsC,KAAK3iB,OAEtB6jB,EAAK5N,KAAO,EAEd4N,EAAKK,MAAQ,IAAIzhB,KAAK4d,EAAKU,WAC3B8C,EAAKM,MAAQ,IAAI1hB,KAAK4d,EAAKU,WAC3B8C,EAAKO,MAAQ,IAAI3hB,KAAK4d,EAAKU,WAC3B8C,EAAKQ,QAAU,KACfR,EAAKS,OAASthB,KAAKmY,KAAK0I,EAAK5N,KAAO4N,EAAKQ,SAClCR,GAET9B,QAAS,SAAS1B,EAAMwD,QACJ5L,IAAd4L,EAAKnC,OACPrB,EAAKqB,KAAOmC,EAAKnC,WAEIzJ,IAAnB4L,EAAK9C,YACPV,EAAKU,UAAY8C,EAAK9C,gBAEN9I,IAAd4L,EAAK5N,MACPqL,GAAMqC,kBAAkBtD,EAAMwD,EAAK5N,OAGvC+L,OAAQ,SAAS5lB,EAAQ/C,GACvB,MAAMwlB,GAAG0F,cAAc,KAEzBtC,MAAO,SAAS7lB,EAAQ/C,EAAMqoB,EAAM5B,GAClC,OAAOwB,GAAMG,WAAWrlB,EAAQ/C,EAAMqoB,EAAM5B,IAE9CoC,OAAQ,SAASsC,EAAUC,EAASC,GAClC,GAAI7F,GAAGkE,MAAMyB,EAAS9C,MAAO,CAC3B,IAAIiD,EACJ,IACEA,EAAW9F,GAAG+F,WAAWH,EAASC,GAClC,MAAOjsB,IACT,GAAIksB,EACF,IAAK,IAAI5kB,KAAK4kB,EAAS3B,SACrB,MAAM,IAAInE,GAAG0B,WAAW,WAIvBiE,EAASpoB,OAAO4mB,SAASwB,EAASnrB,MACzCmrB,EAASnrB,KAAOqrB,EAChBD,EAAQzB,SAAS0B,GAAYF,EAC7BA,EAASpoB,OAASqoB,GAEpBtC,OAAQ,SAAS/lB,EAAQ/C,UAChB+C,EAAO4mB,SAAS3pB,IAEzB+oB,MAAO,SAAShmB,EAAQ/C,GACtB,IAAIgnB,EAAOxB,GAAG+F,WAAWxoB,EAAQ/C,GACjC,IAAK,IAAI0G,KAAKsgB,EAAK2C,SACjB,MAAM,IAAInE,GAAG0B,WAAW,WAEnBnkB,EAAO4mB,SAAS3pB,IAEzBgpB,QAAS,SAAShC,GAChB,IAAIwE,EAAU,CAAC,IAAK,MACpB,IAAK,IAAIlmB,KAAO0hB,EAAK2C,SACd3C,EAAK2C,SAASlO,eAAenW,IAGlCkmB,EAAQxoB,KAAKsC,GAEf,OAAOkmB,GAETvC,QAAS,SAASlmB,EAAQ0oB,EAASC,GACjC,IAAI1E,EAAOiB,GAAMG,WAAWrlB,EAAQ0oB,EAAS,MAAa,GAE1D,OADAzE,EAAKsC,KAAOoC,EACL1E,GAETuC,SAAU,SAASvC,GACjB,IAAKxB,GAAGsE,OAAO9C,EAAKqB,MAClB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,OAAOF,EAAKsC,OAGhBzC,WAAY,CACVS,KAAM,SAASR,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,GAC7C,IAAIhC,EAAW7C,EAAOE,KAAK2C,SAC3B,GAAIgC,GAAY7E,EAAOE,KAAK6C,UAC1B,OAAO,EACT,IAAIjN,EAAOjT,KAAK9E,IAAIiiB,EAAOE,KAAK6C,UAAY8B,EAAUhlB,GACtD,GAAIiW,EAAO,GAAK+M,EAASxK,SACvB3H,EAAOiJ,IAAIkJ,EAASxK,SAASwM,EAAUA,EAAW/O,GAAOrD,QAEzD,IAAK,IAAI7S,EAAI,EAAGA,EAAIkW,EAAMlW,IACxB8Q,EAAO+B,EAAS7S,GAAKijB,EAASgC,EAAWjlB,GAE7C,OAAOkW,GAET+K,MAAO,SAASb,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUC,GAIxD,GAHIpU,EAAOA,SAAWiG,EAAMjG,SAC1BoU,GAAS,IAENjlB,EACH,OAAO,EACT,IAAIqgB,EAAOF,EAAOE,KAElB,GADAA,EAAKU,UAAYte,KAAKG,MAClBiO,EAAO2H,YAAc6H,EAAK2C,UAAY3C,EAAK2C,SAASxK,UAAW,CACjE,GAAIyM,EAGF,OAFA5E,EAAK2C,SAAWnS,EAAO2H,SAAS5F,EAAQA,EAAS5S,GACjDqgB,EAAK6C,UAAYljB,EACVA,EACF,GAAuB,IAAnBqgB,EAAK6C,WAAgC,IAAb8B,EAGjC,OAFA3E,EAAK2C,SAAWnS,EAAO3L,MAAM0N,EAAQA,EAAS5S,GAC9CqgB,EAAK6C,UAAYljB,EACVA,EACF,GAAIglB,EAAWhlB,GAAUqgB,EAAK6C,UAEnC,OADA7C,EAAK2C,SAASlJ,IAAIjJ,EAAO2H,SAAS5F,EAAQA,EAAS5S,GAASglB,GACrDhlB,EAIX,GADAshB,GAAMiC,kBAAkBlD,EAAM2E,EAAWhlB,GACrCqgB,EAAK2C,SAASxK,UAAY3H,EAAO2H,SACnC6H,EAAK2C,SAASlJ,IAAIjJ,EAAO2H,SAAS5F,EAAQA,EAAS5S,GAASglB,QAE5D,IAAK,IAAIjlB,EAAI,EAAGA,EAAIC,EAAQD,IAC1BsgB,EAAK2C,SAASgC,EAAWjlB,GAAK8Q,EAAO+B,EAAS7S,GAIlD,OADAsgB,EAAK6C,UAAYlgB,KAAK7E,IAAIkiB,EAAK6C,UAAW8B,EAAWhlB,GAC9CA,GAETuiB,OAAQ,SAASpC,EAAQvN,EAAQsS,GAC/B,IAAIF,EAAWpS,EAQf,GAPe,IAAXsS,EACFF,GAAY7E,EAAO6E,SACC,IAAXE,GACLrG,GAAGoE,OAAO9C,EAAOE,KAAKqB,QACxBsD,GAAY7E,EAAOE,KAAK6C,WAGxB8B,EAAW,EACb,MAAM,IAAInG,GAAG0B,WAAW,IAE1B,OAAOyE,GAETlU,SAAU,SAASqP,EAAQvN,EAAQ5S,GACjCshB,GAAMiC,kBAAkBpD,EAAOE,KAAMzN,EAAS5S,GAC9CmgB,EAAOE,KAAK6C,UAAYlgB,KAAK7E,IAAIgiB,EAAOE,KAAK6C,UAAWtQ,EAAS5S,IAEnEyiB,KAAM,SAAStC,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUG,EAAMC,GAC7D,IAAKvG,GAAGoE,OAAO9C,EAAOE,KAAKqB,MACzB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAIvN,EACAqS,EACArC,EAAW7C,EAAOE,KAAK2C,SAC3B,GAAc,EAARoC,GAAcpC,EAASnS,SAAWA,EAAOA,OAGxC,EACDmU,EAAW,GAAKA,EAAWhlB,EAASgjB,EAAShjB,UAE7CgjB,EADEA,EAASxK,SACAwK,EAASxK,SAASwM,EAAUA,EAAWhlB,GAEvC8G,MAAM+U,UAAU3W,MAAMmZ,KAAK2E,EAAUgC,EAAUA,EAAWhlB,IAGzEqlB,GAAY,EACZ,IAAIC,EAAWzU,EAAOA,QAAUiG,EAAMjG,OAEtC,KADAmC,EAAMuS,GAAQvlB,IAEZ,MAAM,IAAI6e,GAAG0B,WAAW,KAEzB+E,EAAWxO,EAAQjG,GAAQiJ,IAAIkJ,EAAUhQ,QAhB1CqS,GAAY,EACZrS,EAAMgQ,EAASwC,WAiBjB,MAAO,CACLxS,IAAKA,EACLqS,UAAWA,IAGf3C,MAAO,SAASvC,EAAQtP,EAAQ+B,EAAQ5S,EAAQylB,GAC9C,IAAK5G,GAAGoE,OAAO9C,EAAOE,KAAKqB,MACzB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,OAAgB,EAAZkF,EACK,GAEUnE,GAAMpB,WAAWc,MAAMb,EAAQtP,EAAQ,EAAG7Q,EAAQ4S,GAAQ,GACtE,MAITiM,GAAK,CACPd,KAAM,KACN2H,OAAQ,GACRC,QAAS,GACTC,QAAS,GACTC,UAAW,EACXC,UAAW,KACXC,YAAa,IACbC,aAAa,EACbC,mBAAmB,EACnBC,iBAAkB,GAClBC,SAAU,CACRC,UAAW,CACTC,KAAM,EACNC,MAAO,IAGX/F,WAAY,KACZgE,cAAe,GACfgC,YAAa,KACbC,eAAgB,EAChBC,cAAe,SAAShuB,GACtB,KAAMA,aAAaomB,GAAG0B,YACpB,MAAM9nB,EAAI,MAAQ8jB,KACpB,OAAOS,GAAYvkB,EAAEiuB,QAEvBC,WAAY,SAAS5K,EAAM6K,GAGzB,GADAA,EAAOA,GAAQ,KADf7K,EAAO0C,GAAQC,QAAQG,GAAGC,MAAO/C,IAG/B,MAAO,CACLA,KAAM,GACNsE,KAAM,MAEV,IAAIwG,EAAW,CACbC,cAAc,EACdC,cAAe,GAEjB,IAAK,IAAIpoB,KAAOkoB,OACI5O,IAAd2O,EAAKjoB,KACPioB,EAAKjoB,GAAOkoB,EAASloB,IAGzB,GAAIioB,EAAKG,cAAgB,EACvB,MAAM,IAAIlI,GAAG0B,WAAW,IAO1B,IALA,IAAI3b,EAAQqY,GAAKG,eAAerB,EAAKlX,MAAM,KAAKyE,QAAO,SAASsU,GAC9D,QAASA,MACP,GACArhB,EAAUsiB,GAAGd,KACbiJ,EAAe,IACVjnB,EAAI,EAAGA,EAAI6E,EAAM5E,OAAQD,IAAK,CACrC,IAAIknB,EAASlnB,IAAM6E,EAAM5E,OAAS,EAClC,GAAIinB,GAAUL,EAAKxqB,OACjB,MASF,GAPAG,EAAUsiB,GAAG+F,WAAWroB,EAASqI,EAAM7E,IACvCinB,EAAe/J,GAAKsB,MAAMyI,EAAcpiB,EAAM7E,IAC1C8e,GAAGqI,aAAa3qB,MACb0qB,GAAUA,GAAUL,EAAKE,gBAC5BvqB,EAAUA,EAAQ4qB,QAAQpJ,OAGzBkJ,GAAUL,EAAKQ,OAElB,IADA,IAAIC,EAAQ,EACLxI,GAAGsE,OAAO5mB,EAAQmlB,OAAO,CAC9B,IAAIiB,EAAO9D,GAAG+D,SAASoE,GAMvB,GALAA,EAAevI,GAAQC,QAAQzB,GAAKa,QAAQkJ,GAAerE,GAI3DpmB,EAHasiB,GAAG8H,WAAWK,EAAc,CACvCD,cAAeH,EAAKG,gBAEL1G,KACbgH,IAAU,GACZ,MAAM,IAAIxI,GAAG0B,WAAW,KAKhC,MAAO,CACLxE,KAAMiL,EACN3G,KAAM9jB,IAGV+qB,QAAS,SAASjH,GAEhB,IADA,IAAItE,IACS,CACX,GAAI8C,GAAG0I,OAAOlH,GAAO,CACnB,IAAImB,EAAQnB,EAAKmB,MAAMgG,WACvB,OAAKzL,EAE8B,MAA5ByF,EAAMA,EAAMxhB,OAAS,GAAawhB,EAAQ,IAAMzF,EAAOyF,EAAQzF,EAD7DyF,EAGXzF,EAAOA,EAAOsE,EAAKhnB,KAAO,IAAM0iB,EAAOsE,EAAKhnB,KAC5CgnB,EAAOA,EAAKjkB,SAGhBqrB,SAAU,SAASC,EAAUruB,GAE3B,IADA,IAAIsuB,EAAO,EACF5nB,EAAI,EAAGA,EAAI1G,EAAK2G,OAAQD,IAC/B4nB,GAAQA,GAAQ,GAAKA,EAAOtuB,EAAKkgB,WAAWxZ,GAAK,EAEnD,OAAQ2nB,EAAWC,IAAS,GAAK9I,GAAGiH,UAAU9lB,QAEhD4nB,YAAa,SAASvH,GACpB,IAAIsH,EAAO9I,GAAG4I,SAASpH,EAAKjkB,OAAOuL,GAAI0Y,EAAKhnB,MAC5CgnB,EAAKwH,UAAYhJ,GAAGiH,UAAU6B,GAC9B9I,GAAGiH,UAAU6B,GAAQtH,GAEvByH,eAAgB,SAASzH,GACvB,IAAIsH,EAAO9I,GAAG4I,SAASpH,EAAKjkB,OAAOuL,GAAI0Y,EAAKhnB,MAC5C,GAAIwlB,GAAGiH,UAAU6B,KAAUtH,EACzBxB,GAAGiH,UAAU6B,GAAQtH,EAAKwH,eAG1B,IADA,IAAItrB,EAAUsiB,GAAGiH,UAAU6B,GACpBprB,GAAS,CACd,GAAIA,EAAQsrB,YAAcxH,EAAM,CAC9B9jB,EAAQsrB,UAAYxH,EAAKwH,UACzB,MAEFtrB,EAAUA,EAAQsrB,YAIxBjD,WAAY,SAASxoB,EAAQ/C,GAC3B,IAAI0uB,EAAUlJ,GAAGmJ,UAAU5rB,GAC3B,GAAI2rB,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,EAAQ3rB,GAGlC,IADA,IAAIurB,EAAO9I,GAAG4I,SAASrrB,EAAOuL,GAAItO,GACzBgnB,EAAOxB,GAAGiH,UAAU6B,GAAOtH,EAAMA,EAAOA,EAAKwH,UAAW,CAC/D,IAAII,EAAW5H,EAAKhnB,KACpB,GAAIgnB,EAAKjkB,OAAOuL,KAAOvL,EAAOuL,IAAMsgB,IAAa5uB,EAC/C,OAAOgnB,EAGX,OAAOxB,GAAGmD,OAAO5lB,EAAQ/C,IAE3BooB,WAAY,SAASrlB,EAAQ/C,EAAMqoB,EAAMpB,GACvC,IAAID,EAAO,IAAIxB,GAAGqJ,OAAO9rB,EAAO/C,EAAKqoB,EAAKpB,GAE1C,OADAzB,GAAG+I,YAAYvH,GACRA,GAET8H,YAAa,SAAS9H,GACpBxB,GAAGiJ,eAAezH,IAEpBkH,OAAQ,SAASlH,GACf,OAAOA,IAASA,EAAKjkB,QAEvB8qB,aAAc,SAAS7G,GACrB,QAASA,EAAK8G,SAEhBlE,OAAQ,SAASvB,GACf,OAA0B,SAAX,MAAPA,IAEVqB,MAAO,SAASrB,GACd,OAA0B,SAAX,MAAPA,IAEVyB,OAAQ,SAASzB,GACf,OAA0B,SAAX,MAAPA,IAEV0B,SAAU,SAAS1B,GACjB,OAA0B,QAAX,MAAPA,IAEVC,SAAU,SAASD,GACjB,OAA0B,SAAX,MAAPA,IAEVE,OAAQ,SAASF,GACf,OAA0B,QAAX,MAAPA,IAEV0G,SAAU,SAAS1G,GACjB,OAA0B,SAAX,MAAPA,IAEV2G,UAAW,CACT,EAAK,EACL,GAAM,QACN,KAAM,EACN,EAAK,IACL,GAAM,IACN,GAAM,IACN,KAAM,IACN,MAAO,IACP,MAAO,IACP,EAAK,KACL,GAAM,KACN,GAAM,KACN,KAAM,KACN,MAAO,KACP,MAAO,MAETC,kBAAmB,SAAS5P,GAC1B,IAAI0M,EAAQvG,GAAGwJ,UAAU3P,GACzB,GAAqB,qBAAV0M,EACT,MAAM,IAAI7rB,MAAM,2BAA6Bmf,GAE/C,OAAO0M,GAETmD,wBAAyB,SAASC,GAChC,IAAIC,EAAQ,CAAC,IAAK,IAAK,MAAa,EAAPD,GAI7B,OAHW,IAAPA,IACFC,GAAS,KAEJA,GAETC,gBAAiB,SAASrI,EAAMoI,GAC9B,OAAI5J,GAAGoH,kBACE,IAEmB,IAAxBwC,EAAM/iB,QAAQ,MAA6B,IAAZ2a,EAAKqB,SAEL,IAAxB+G,EAAM/iB,QAAQ,MAA6B,IAAZ2a,EAAKqB,SAEZ,IAAxB+G,EAAM/iB,QAAQ,MAA6B,GAAZ2a,EAAKqB,MAGxC,EANE,GAQXsG,UAAW,SAAShK,GAClB,IAAI+J,EAAUlJ,GAAG6J,gBAAgB1K,EAAK,KACtC,OAAI+J,IAEC/J,EAAI8D,SAASE,OAEX,EADE,IAGX2G,UAAW,SAAS3K,EAAK3kB,GACvB,IAEE,OADWwlB,GAAG+F,WAAW5G,EAAK3kB,GACvB,GACP,MAAOZ,IACT,OAAOomB,GAAG6J,gBAAgB1K,EAAK,OAEjC4K,UAAW,SAAS5K,EAAK3kB,EAAMwvB,GAC7B,IAAIxI,EACJ,IACEA,EAAOxB,GAAG+F,WAAW5G,EAAK3kB,GAC1B,MAAOZ,GACP,OAAOA,EAAEiuB,MAEX,IAAIqB,EAAUlJ,GAAG6J,gBAAgB1K,EAAK,MACtC,GAAI+J,EACF,OAAOA,EAET,GAAIc,EAAO,CACT,IAAKhK,GAAGkE,MAAM1C,EAAKqB,MACjB,OAAO,GAET,GAAI7C,GAAG0I,OAAOlH,IAASxB,GAAGyI,QAAQjH,KAAUxB,GAAGC,MAC7C,OAAO,QAGT,GAAID,GAAGkE,MAAM1C,EAAKqB,MAChB,OAAO,GAGX,OAAO,GAEToH,QAAS,SAASzI,EAAM+E,GACtB,OAAK/E,EAGDxB,GAAGsE,OAAO9C,EAAKqB,MACV,GACE7C,GAAGkE,MAAM1C,EAAKqB,QACmB,MAAtC7C,GAAG0J,wBAAwBnD,IAA0B,IAARA,GACxC,GAGJvG,GAAG6J,gBAAgBrI,EAAMxB,GAAG0J,wBAAwBnD,IATlD,IAWX2D,aAAc,KACdC,OAAQ,SAASC,EAAUC,GACzBD,EAAWA,GAAY,EACvBC,EAASA,GAAUrK,GAAGkK,aACtB,IAAK,IAAII,EAAKF,EAAUE,GAAMD,EAAQC,IACpC,IAAKtK,GAAG+G,QAAQuD,GACd,OAAOA,EAGX,MAAM,IAAItK,GAAG0B,WAAW,KAE1B6I,UAAW,SAASD,GAClB,OAAOtK,GAAG+G,QAAQuD,IAEpBE,aAAc,SAASlJ,EAAQ8I,EAAUC,GAClCrK,GAAGyK,WACNzK,GAAGyK,SAAW,aAEdzK,GAAGyK,SAASzN,UAAY,CACtB0N,OAAQ,CACNC,IAAK,WACH,OAAOzxB,KAAKsoB,MAEdvG,IAAK,SAAS9F,GACZjc,KAAKsoB,KAAOrM,IAGhByV,OAAQ,CACND,IAAK,WACH,OAAkC,KAAb,QAAbzxB,KAAKqtB,SAGjBsE,QAAS,CACPF,IAAK,WACH,OAAkC,KAAb,QAAbzxB,KAAKqtB,SAGjBuE,SAAU,CACRH,IAAK,WACH,OAAoB,KAAbzxB,KAAKqtB,UAKpB,IAAIwE,EAAY,IAAI/K,GAAGyK,SACvB,IAAK,IAAI1L,KAAKuC,EACZyJ,EAAUhM,GAAKuC,EAAOvC,GAExBuC,EAASyJ,EACT,IAAIT,EAAKtK,GAAGmK,OAAOC,EAAUC,GAG7B,OAFA/I,EAAOgJ,GAAKA,EACZtK,GAAG+G,QAAQuD,GAAMhJ,EACVA,GAET0J,YAAa,SAASV,GACpBtK,GAAG+G,QAAQuD,GAAM,MAEnBrG,kBAAmB,CACjB1oB,KAAM,SAAS+lB,GACb,IAAI2J,EAASjL,GAAGkL,UAAU5J,EAAOE,KAAKC,MACtCH,EAAOD,WAAa4J,EAAO5J,WACvBC,EAAOD,WAAW9lB,MACpB+lB,EAAOD,WAAW9lB,KAAK+lB,IAG3BoC,OAAQ,WACN,MAAM,IAAI1D,GAAG0B,WAAW,MAG5ByJ,MAAO,SAASlK,GACd,OAAOA,GAAO,GAEhBmK,MAAO,SAASnK,GACd,OAAa,IAANA,GAEToK,QAAS,SAASC,EAAIC,GACpB,OAAOD,GAAM,EAAIC,GAEnBnK,eAAgB,SAASH,EAAKC,GAC5BlB,GAAG8G,QAAQ7F,GAAO,CAChBI,WAAYH,IAGhBgK,UAAW,SAASjK,GAClB,OAAOjB,GAAG8G,QAAQ7F,IAEpBuK,UAAW,SAAS7I,GAGlB,IAFA,IAAIkE,EAAS,GACT4E,EAAQ,CAAC9I,GACN8I,EAAMtqB,QAAQ,CACnB,IAAIuE,EAAI+lB,EAAMzc,MACd6X,EAAOrpB,KAAKkI,GACZ+lB,EAAMjuB,KAAKkuB,MAAMD,EAAO/lB,EAAEmhB,QAE5B,OAAOA,GAET8E,OAAQ,SAASC,EAAUrnB,GACD,oBAAbqnB,IACTrnB,EAAWqnB,EACXA,GAAW,GAEb5L,GAAG2H,iBACC3H,GAAG2H,eAAiB,GACtBzQ,EAAI,YAAc8I,GAAG2H,eAAiB,2EAExC,IAAId,EAAS7G,GAAGwL,UAAUxL,GAAGd,KAAKyD,OAC9BkJ,EAAY,EAChB,SAASC,EAAW5C,GAElB,OADAlJ,GAAG2H,iBACIpjB,EAAS2kB,GAElB,SAAS6C,EAAK7C,GACZ,GAAIA,EACF,OAAK6C,EAAKC,aAIV,GAHED,EAAKC,SAAU,EACRF,EAAW5C,MAIhB2C,GAAahF,EAAO1lB,QACxB2qB,EAAW,MAGfjF,EAAO1pB,SAAQ,SAASwlB,GACtB,IAAKA,EAAMvjB,KAAKusB,OACd,OAAOI,EAAK,MAEdpJ,EAAMvjB,KAAKusB,OAAOhJ,EAAOiJ,EAAUG,OAGvCpJ,MAAO,SAASvjB,EAAM2oB,EAAMY,GAC1B,IAEInH,EAFAtC,EAAsB,MAAfyJ,EACPsD,GAAUtD,EAEd,GAAIzJ,GAAQc,GAAGd,KACb,MAAM,IAAIc,GAAG0B,WAAW,IACnB,IAAKxC,IAAS+M,EAAQ,CAC3B,IAAI9I,EAASnD,GAAG8H,WAAWa,EAAY,CACrCV,cAAc,IAIhB,GAFAU,EAAaxF,EAAOjG,KACpBsE,EAAO2B,EAAO3B,KACVxB,GAAGqI,aAAa7G,GAClB,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IAAK1B,GAAGkE,MAAM1C,EAAKqB,MACjB,MAAM,IAAI7C,GAAG0B,WAAW,IAG5B,IAAIiB,EAAQ,CACVvjB,KAAMA,EACN2oB,KAAMA,EACNY,WAAYA,EACZ9B,OAAQ,IAENqF,EAAY9sB,EAAKujB,MAAMA,GAW3B,OAVAuJ,EAAUvJ,MAAQA,EAClBA,EAAMzD,KAAOgN,EACThN,EACFc,GAAGd,KAAOgN,EACD1K,IACTA,EAAK8G,QAAU3F,EACXnB,EAAKmB,OACPnB,EAAKmB,MAAMkE,OAAOrpB,KAAKmlB,IAGpBuJ,GAETC,QAAS,SAASxD,GAChB,IAAIxF,EAASnD,GAAG8H,WAAWa,EAAY,CACrCV,cAAc,IAEhB,IAAKjI,GAAGqI,aAAalF,EAAO3B,MAC1B,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IAAIF,EAAO2B,EAAO3B,KACdmB,EAAQnB,EAAK8G,QACbzB,EAAS7G,GAAGwL,UAAU7I,GAC1B9a,OAAOC,KAAKkY,GAAGiH,WAAW9pB,SAAQ,SAAS2rB,GAEzC,IADA,IAAIprB,EAAUsiB,GAAGiH,UAAU6B,GACpBprB,GAAS,CACd,IAAI0uB,EAAO1uB,EAAQsrB,WACoB,IAAnCnC,EAAOhgB,QAAQnJ,EAAQilB,QACzB3C,GAAGsJ,YAAY5rB,GAEjBA,EAAU0uB,MAGd5K,EAAK8G,QAAU,KACf,IAAI/O,EAAMiI,EAAKmB,MAAMkE,OAAOhgB,QAAQ8b,GACpCnB,EAAKmB,MAAMkE,OAAOlI,OAAOpF,EAAK,IAEhC4J,OAAQ,SAAS5lB,EAAQ/C,GACvB,OAAO+C,EAAO0lB,SAASE,OAAO5lB,EAAQ/C,IAExC4oB,MAAO,SAASlG,EAAM2F,EAAM5B,GAC1B,IAGI1jB,EAHSyiB,GAAG8H,WAAW5K,EAAM,CAC/B3f,QAAQ,IAEUikB,KAChBhnB,EAAO4jB,GAAKgB,SAASlC,GACzB,IAAK1iB,GAAiB,MAATA,GAAyB,OAATA,EAC3B,MAAM,IAAIwlB,GAAG0B,WAAW,IAE1B,IAAIwH,EAAUlJ,GAAG8J,UAAUvsB,EAAQ/C,GACnC,GAAI0uB,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1B,IAAK3rB,EAAO0lB,SAASG,MACnB,MAAM,IAAIpD,GAAG0B,WAAW,IAE1B,OAAOnkB,EAAO0lB,SAASG,MAAM7lB,EAAQ/C,EAAMqoB,EAAM5B,IAEnDoL,OAAQ,SAASnP,EAAM2F,GAIrB,OAHAA,OAAgBzJ,IAATyJ,EAAqBA,EAAO,IACnCA,GAAQ,KACRA,GAAQ,MACD7C,GAAGoD,MAAMlG,EAAM2F,EAAM,IAE9ByJ,MAAO,SAASpP,EAAM2F,GAIpB,OAHAA,OAAgBzJ,IAATyJ,EAAqBA,EAAO,IACnCA,GAAQ,KACRA,GAAQ,MACD7C,GAAGoD,MAAMlG,EAAM2F,EAAM,IAE9B0J,UAAW,SAASrP,EAAM2F,GAGxB,IAFA,IAAI2J,EAAOtP,EAAKlX,MAAM,KAClBrC,EAAI,GACCzC,EAAI,EAAGA,EAAIsrB,EAAKrrB,SAAUD,EACjC,GAAKsrB,EAAKtrB,GAAV,CAEAyC,GAAK,IAAM6oB,EAAKtrB,GAChB,IACE8e,GAAGsM,MAAM3oB,EAAGkf,GACZ,MAAOjpB,GACP,GAAe,IAAXA,EAAEiuB,MACJ,MAAMjuB,KAId6yB,MAAO,SAASvP,EAAM2F,EAAM5B,GAM1B,MALmB,qBAARA,IACTA,EAAM4B,EACNA,EAAO,KAETA,GAAQ,KACD7C,GAAGoD,MAAMlG,EAAM2F,EAAM5B,IAE9BwC,QAAS,SAASyC,EAASwG,GACzB,IAAK9M,GAAQC,QAAQqG,GACnB,MAAM,IAAIlG,GAAG0B,WAAW,IAE1B,IAGInkB,EAHSyiB,GAAG8H,WAAW4E,EAAS,CAClCnvB,QAAQ,IAEUikB,KACpB,IAAKjkB,EACH,MAAM,IAAIyiB,GAAG0B,WAAW,IAE1B,IAAIuE,EAAU7H,GAAKgB,SAASsN,GACxBxD,EAAUlJ,GAAG8J,UAAUvsB,EAAQ0oB,GACnC,GAAIiD,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1B,IAAK3rB,EAAO0lB,SAASQ,QACnB,MAAM,IAAIzD,GAAG0B,WAAW,IAE1B,OAAOnkB,EAAO0lB,SAASQ,QAAQlmB,EAAQ0oB,EAASC,IAElD7C,OAAQ,SAASsJ,EAAUC,GACzB,IAIYC,EAASjH,EAJjBkH,EAAc1O,GAAKa,QAAQ0N,GAC3BI,EAAc3O,GAAKa,QAAQ2N,GAC3BI,EAAW5O,GAAKgB,SAASuN,GACzB9G,EAAWzH,GAAKgB,SAASwN,GAE7B,IAIEC,EAHS7M,GAAG8H,WAAW6E,EAAU,CAC/BpvB,QAAQ,IAEOikB,KAIjBoE,EAHS5F,GAAG8H,WAAW8E,EAAU,CAC/BrvB,QAAQ,IAEOikB,KACjB,MAAO5nB,GACP,MAAM,IAAIomB,GAAG0B,WAAW,IAE1B,IAAKmL,IAAYjH,EACf,MAAM,IAAI5F,GAAG0B,WAAW,IAC1B,GAAImL,EAAQlK,QAAUiD,EAAQjD,MAC5B,MAAM,IAAI3C,GAAG0B,WAAW,IAE1B,IASIoE,EATAH,EAAW3F,GAAG+F,WAAW8G,EAASG,GAClC7M,EAAWP,GAAQO,SAASwM,EAAUI,GAC1C,GAA2B,MAAvB5M,EAASnI,OAAO,GAClB,MAAM,IAAIgI,GAAG0B,WAAW,IAG1B,GAA2B,OAD3BvB,EAAWP,GAAQO,SAASyM,EAAUE,IACzB9U,OAAO,GAClB,MAAM,IAAIgI,GAAG0B,WAAW,IAG1B,IACEoE,EAAW9F,GAAG+F,WAAWH,EAASC,GAClC,MAAOjsB,IACT,GAAI+rB,IAAaG,EAAjB,CAGA,IAAIkE,EAAQhK,GAAGkE,MAAMyB,EAAS9C,MAC1BqG,EAAUlJ,GAAG+J,UAAU8C,EAASG,EAAUhD,GAC9C,GAAId,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAG1B,GADAA,EAAUpD,EAAW9F,GAAG+J,UAAUnE,EAASC,EAAUmE,GAAShK,GAAG8J,UAAUlE,EAASC,GAElF,MAAM,IAAI7F,GAAG0B,WAAWwH,GAE1B,IAAK2D,EAAQ5J,SAASI,OACpB,MAAM,IAAIrD,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGqI,aAAa1C,IAAaG,GAAY9F,GAAGqI,aAAavC,GAC3D,MAAM,IAAI9F,GAAG0B,WAAW,IAE1B,GAAIkE,IAAYiH,IACd3D,EAAUlJ,GAAG6J,gBAAgBgD,EAAS,MAEpC,MAAM,IAAI7M,GAAG0B,WAAWwH,GAG5B,IACMlJ,GAAGqH,iBAAH,cACFrH,GAAGqH,iBAAH,aAAoCsF,EAAUC,GAEhD,MAAOhzB,GACPsd,EAAI,wCAA0CyV,EAAW,OAASC,EAAW,0BAA4BhzB,EAAEqzB,SAE7GjN,GAAGiJ,eAAetD,GAClB,IACEkH,EAAQ5J,SAASI,OAAOsC,EAAUC,EAASC,GAC3C,MAAOjsB,GACP,MAAMA,EAHR,QAKEomB,GAAG+I,YAAYpD,GAEjB,IACM3F,GAAGqH,iBAAH,YACFrH,GAAGqH,iBAAH,WAAkCsF,EAAUC,GAC9C,MAAOhzB,GACPsd,EAAI,sCAAwCyV,EAAW,OAASC,EAAW,0BAA4BhzB,EAAEqzB,YAG7G1J,MAAO,SAASrG,GACd,IAGI3f,EAHSyiB,GAAG8H,WAAW5K,EAAM,CAC/B3f,QAAQ,IAEUikB,KAChBhnB,EAAO4jB,GAAKgB,SAASlC,GACrBsE,EAAOxB,GAAG+F,WAAWxoB,EAAQ/C,GAC7B0uB,EAAUlJ,GAAG+J,UAAUxsB,EAAQ/C,GAAM,GACzC,GAAI0uB,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1B,IAAK3rB,EAAO0lB,SAASM,MACnB,MAAM,IAAIvD,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGqI,aAAa7G,GAClB,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IACM1B,GAAGqH,iBAAH,gBACFrH,GAAGqH,iBAAH,eAAsCnK,GAExC,MAAOtjB,GACPsd,EAAI,0CAA4CgG,EAAO,0BAA4BtjB,EAAEqzB,SAEvF1vB,EAAO0lB,SAASM,MAAMhmB,EAAQ/C,GAC9BwlB,GAAGsJ,YAAY9H,GACf,IACMxB,GAAGqH,iBAAH,cACFrH,GAAGqH,iBAAH,aAAoCnK,GACtC,MAAOtjB,GACPsd,EAAI,wCAA0CgG,EAAO,0BAA4BtjB,EAAEqzB,WAGvFzJ,QAAS,SAAStG,GAChB,IAGIsE,EAHSxB,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAQ,IAEQ/G,KAClB,IAAKA,EAAKyB,SAASO,QACjB,MAAM,IAAIxD,GAAG0B,WAAW,IAE1B,OAAOF,EAAKyB,SAASO,QAAQhC,IAE/B8B,OAAQ,SAASpG,GACf,IAGI3f,EAHSyiB,GAAG8H,WAAW5K,EAAM,CAC/B3f,QAAQ,IAEUikB,KAChBhnB,EAAO4jB,GAAKgB,SAASlC,GACrBsE,EAAOxB,GAAG+F,WAAWxoB,EAAQ/C,GAC7B0uB,EAAUlJ,GAAG+J,UAAUxsB,EAAQ/C,GAAM,GACzC,GAAI0uB,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1B,IAAK3rB,EAAO0lB,SAASK,OACnB,MAAM,IAAItD,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGqI,aAAa7G,GAClB,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IACM1B,GAAGqH,iBAAH,gBACFrH,GAAGqH,iBAAH,eAAsCnK,GAExC,MAAOtjB,GACPsd,EAAI,0CAA4CgG,EAAO,0BAA4BtjB,EAAEqzB,SAEvF1vB,EAAO0lB,SAASK,OAAO/lB,EAAQ/C,GAC/BwlB,GAAGsJ,YAAY9H,GACf,IACMxB,GAAGqH,iBAAH,cACFrH,GAAGqH,iBAAH,aAAoCnK,GACtC,MAAOtjB,GACPsd,EAAI,wCAA0CgG,EAAO,0BAA4BtjB,EAAEqzB,WAGvFlJ,SAAU,SAAS7G,GACjB,IACI4G,EADS9D,GAAG8H,WAAW5K,GACTsE,KAClB,IAAKsC,EACH,MAAM,IAAI9D,GAAG0B,WAAW,IAE1B,IAAKoC,EAAKb,SAASc,SACjB,MAAM,IAAI/D,GAAG0B,WAAW,IAE1B,OAAO9B,GAAQC,QAAQG,GAAGyI,QAAQ3E,EAAKvmB,QAASumB,EAAKb,SAASc,SAASD,KAEzEoJ,KAAM,SAAShQ,EAAMiQ,GACnB,IAGI3L,EAHSxB,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAS4E,IAEO3L,KAClB,IAAKA,EACH,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IAAKF,EAAKyB,SAASD,QACjB,MAAM,IAAIhD,GAAG0B,WAAW,IAE1B,OAAOF,EAAKyB,SAASD,QAAQxB,IAE/B4L,MAAO,SAASlQ,GACd,OAAO8C,GAAGkN,KAAKhQ,GAAM,IAEvBmQ,MAAO,SAASnQ,EAAM2F,EAAMsK,GAC1B,IAAI3L,EASJ,KAJEA,EAJkB,kBAATtE,EACI8C,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAS4E,IAEG3L,KAEPtE,GAEC+F,SAASC,QACjB,MAAM,IAAIlD,GAAG0B,WAAW,IAE1BF,EAAKyB,SAASC,QAAQ1B,EAAM,CAC1BqB,KAAa,KAAPA,GAA0B,KAAZrB,EAAKqB,KACzBX,UAAWte,KAAKG,SAGpBupB,OAAQ,SAASpQ,EAAM2F,GACrB7C,GAAGqN,MAAMnQ,EAAM2F,GAAM,IAEvB0K,OAAQ,SAASjD,EAAIzH,GACnB,IAAIvB,EAAStB,GAAGuK,UAAUD,GAC1B,IAAKhJ,EACH,MAAM,IAAItB,GAAG0B,WAAW,GAE1B1B,GAAGqN,MAAM/L,EAAOE,KAAMqB,IAExB2K,MAAO,SAAStQ,EAAMiI,EAAKC,EAAK+H,GAC9B,IAAI3L,EASJ,KAJEA,EAJkB,kBAATtE,EACI8C,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAS4E,IAEG3L,KAEPtE,GAEC+F,SAASC,QACjB,MAAM,IAAIlD,GAAG0B,WAAW,IAE1BF,EAAKyB,SAASC,QAAQ1B,EAAM,CAC1BU,UAAWte,KAAKG,SAGpB0pB,OAAQ,SAASvQ,EAAMiI,EAAKC,GAC1BpF,GAAGwN,MAAMtQ,EAAMiI,EAAKC,GAAK,IAE3BsI,OAAQ,SAASpD,EAAInF,EAAKC,GACxB,IAAI9D,EAAStB,GAAGuK,UAAUD,GAC1B,IAAKhJ,EACH,MAAM,IAAItB,GAAG0B,WAAW,GAE1B1B,GAAGwN,MAAMlM,EAAOE,KAAM2D,EAAKC,IAE7BuI,SAAU,SAASzQ,EAAMpC,GACvB,GAAIA,EAAM,EACR,MAAM,IAAIkF,GAAG0B,WAAW,IAE1B,IAAIF,EASJ,KAJEA,EAJkB,kBAATtE,EACI8C,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAQ,IAEI/G,KAEPtE,GAEC+F,SAASC,QACjB,MAAM,IAAIlD,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGkE,MAAM1C,EAAKqB,MAChB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAK1B,GAAGoE,OAAO5C,EAAKqB,MAClB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAIwH,EAAUlJ,GAAG6J,gBAAgBrI,EAAM,KACvC,GAAI0H,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1B1H,EAAKyB,SAASC,QAAQ1B,EAAM,CAC1BpK,KAAM0D,EACNoH,UAAWte,KAAKG,SAGpB6pB,UAAW,SAAStD,EAAIxP,GACtB,IAAIwG,EAAStB,GAAGuK,UAAUD,GAC1B,IAAKhJ,EACH,MAAM,IAAItB,GAAG0B,WAAW,GAE1B,GAAiC,KAAb,QAAfJ,EAAOiF,OACV,MAAM,IAAIvG,GAAG0B,WAAW,IAE1B1B,GAAG2N,SAASrM,EAAOE,KAAM1G,IAE3B+S,MAAO,SAAS3Q,EAAMmI,EAAOC,GAC3B,IAGI9D,EAHSxB,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAQ,IAEQ/G,KAClBA,EAAKyB,SAASC,QAAQ1B,EAAM,CAC1BU,UAAW/d,KAAK7E,IAAI+lB,EAAOC,MAG/B/pB,KAAM,SAAS2hB,EAAMqJ,EAAO1D,EAAMuH,EAAUC,GAC1C,GAAa,KAATnN,EACF,MAAM,IAAI8C,GAAG0B,WAAW,IAS1B,IAAIF,EACJ,GAPAqB,EAAuB,qBAATA,EAAuB,IAAMA,EAEzCA,EADU,IAFZ0D,EAAyB,kBAAVA,EAAqBvG,GAAGyJ,kBAAkBlD,GAASA,GAGlD,KAAP1D,EAAc,MAEd,EAGW,kBAAT3F,EACTsE,EAAOtE,MACF,CACLA,EAAOkB,GAAKQ,UAAU1B,GACtB,IAIEsE,EAHaxB,GAAG8H,WAAW5K,EAAM,CAC/BqL,SAAkB,OAARhC,KAEE/E,KACd,MAAO5nB,KAEX,IAAIk0B,GAAU,EACd,GAAY,GAARvH,EACF,GAAI/E,GACF,GAAY,IAAR+E,EACF,MAAM,IAAIvG,GAAG0B,WAAW,SAG1BF,EAAOxB,GAAGoD,MAAMlG,EAAM2F,EAAM,GAC5BiL,GAAU,EAGd,IAAKtM,EACH,MAAM,IAAIxB,GAAG0B,WAAW,IAK1B,GAHI1B,GAAGuE,SAAS/C,EAAKqB,QACnB0D,IAAS,KAEC,MAARA,IAAkBvG,GAAGkE,MAAM1C,EAAKqB,MAClC,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAKoM,EAAS,CACZ,IAAI5E,EAAUlJ,GAAGiK,QAAQzI,EAAM+E,GAC/B,GAAI2C,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAGhB,IAAR3C,GACFvG,GAAG2N,SAASnM,EAAM,GAEpB+E,IAAS,IACT,IAAIjF,EAAStB,GAAGwK,aAAa,CAC3BhJ,KAAMA,EACNtE,KAAM8C,GAAGyI,QAAQjH,GACjB+E,MAAOA,EACP5E,UAAU,EACVwE,SAAU,EACV9E,WAAYG,EAAKH,WACjB0M,SAAU,GACVlxB,OAAO,GACNutB,EAAUC,GACT/I,EAAOD,WAAW9lB,MACpB+lB,EAAOD,WAAW9lB,KAAK+lB,IAErBvL,EAAM,cAA8B,EAARwQ,IACzBvG,GAAGgO,YACNhO,GAAGgO,UAAY,IACX9Q,KAAQ8C,GAAGgO,YACfhO,GAAGgO,UAAU9Q,GAAQ,EACrBhG,EAAI,2CAA6CgG,KAGrD,IACE,GAAI8C,GAAGqH,iBAAH,WAAmC,CACrC,IAAI4G,EAAgB,EACM,KAAb,QAAR1H,KACH0H,GAAiBjO,GAAGsH,SAASC,UAAUC,MAEf,KAAb,QAARjB,KACH0H,GAAiBjO,GAAGsH,SAASC,UAAUE,OAEzCzH,GAAGqH,iBAAH,WAAkCnK,EAAM+Q,IAE1C,MAAOr0B,GACPsd,EAAI,sCAAwCgG,EAAO,iCAAmCtjB,EAAEqzB,SAE1F,OAAO3L,GAETM,MAAO,SAASN,GACd,GAAItB,GAAGkO,SAAS5M,GACd,MAAM,IAAItB,GAAG0B,WAAW,GAEtBJ,EAAO6M,WACT7M,EAAO6M,SAAW,MACpB,IACM7M,EAAOD,WAAWO,OACpBN,EAAOD,WAAWO,MAAMN,GAE1B,MAAO1nB,GACP,MAAMA,EALR,QAOEomB,GAAGgL,YAAY1J,EAAOgJ,IAExBhJ,EAAOgJ,GAAK,MAEd4D,SAAU,SAAS5M,GACjB,OAAqB,OAAdA,EAAOgJ,IAEhB5G,OAAQ,SAASpC,EAAQvN,EAAQsS,GAC/B,GAAIrG,GAAGkO,SAAS5M,GACd,MAAM,IAAItB,GAAG0B,WAAW,GAE1B,IAAKJ,EAAOK,WAAaL,EAAOD,WAAWqC,OACzC,MAAM,IAAI1D,GAAG0B,WAAW,IAE1B,GAAc,GAAV2E,GAAyB,GAAVA,GAAyB,GAAVA,EAChC,MAAM,IAAIrG,GAAG0B,WAAW,IAI1B,OAFAJ,EAAO6E,SAAW7E,EAAOD,WAAWqC,OAAOpC,EAAQvN,EAAQsS,GAC3D/E,EAAOyM,SAAW,GACXzM,EAAO6E,UAEhBrE,KAAM,SAASR,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,GAC7C,GAAIhlB,EAAS,GAAKglB,EAAW,EAC3B,MAAM,IAAInG,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGkO,SAAS5M,GACd,MAAM,IAAItB,GAAG0B,WAAW,GAE1B,GAAiC,KAAb,QAAfJ,EAAOiF,OACV,MAAM,IAAIvG,GAAG0B,WAAW,GAE1B,GAAI1B,GAAGkE,MAAM5C,EAAOE,KAAKqB,MACvB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAKJ,EAAOD,WAAWS,KACrB,MAAM,IAAI9B,GAAG0B,WAAW,IAE1B,IAAI0M,EAA8B,qBAAbjI,EACrB,GAAKiI,GAEE,IAAK9M,EAAOK,SACjB,MAAM,IAAI3B,GAAG0B,WAAW,SAFxByE,EAAW7E,EAAO6E,SAIpB,IAAIlE,EAAYX,EAAOD,WAAWS,KAAKR,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,GAGvE,OAFKiI,IACH9M,EAAO6E,UAAYlE,GACdA,GAETE,MAAO,SAASb,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUC,GACxD,GAAIjlB,EAAS,GAAKglB,EAAW,EAC3B,MAAM,IAAInG,GAAG0B,WAAW,IAE1B,GAAI1B,GAAGkO,SAAS5M,GACd,MAAM,IAAItB,GAAG0B,WAAW,GAE1B,GAAiC,KAAb,QAAfJ,EAAOiF,OACV,MAAM,IAAIvG,GAAG0B,WAAW,GAE1B,GAAI1B,GAAGkE,MAAM5C,EAAOE,KAAKqB,MACvB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAKJ,EAAOD,WAAWc,MACrB,MAAM,IAAInC,GAAG0B,WAAW,IAEP,KAAfJ,EAAOiF,OACTvG,GAAG0D,OAAOpC,EAAQ,EAAG,GAEvB,IAAI8M,EAA8B,qBAAbjI,EACrB,GAAKiI,GAEE,IAAK9M,EAAOK,SACjB,MAAM,IAAI3B,GAAG0B,WAAW,SAFxByE,EAAW7E,EAAO6E,SAIpB,IAAIkI,EAAe/M,EAAOD,WAAWc,MAAMb,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUC,GAChFgI,IACH9M,EAAO6E,UAAYkI,GACrB,IACM/M,EAAOpE,MAAQ8C,GAAGqH,iBAAH,eACjBrH,GAAGqH,iBAAH,cAAqC/F,EAAOpE,MAC9C,MAAOtjB,GACPsd,EAAI,yCAA2CoK,EAAOpE,KAAO,0BAA4BtjB,EAAEqzB,SAE7F,OAAOoB,GAETpc,SAAU,SAASqP,EAAQvN,EAAQ5S,GACjC,GAAI6e,GAAGkO,SAAS5M,GACd,MAAM,IAAItB,GAAG0B,WAAW,GAE1B,GAAI3N,EAAS,GAAK5S,GAAU,EAC1B,MAAM,IAAI6e,GAAG0B,WAAW,IAE1B,GAAiC,KAAb,QAAfJ,EAAOiF,OACV,MAAM,IAAIvG,GAAG0B,WAAW,GAE1B,IAAK1B,GAAGoE,OAAO9C,EAAOE,KAAKqB,QAAU7C,GAAGkE,MAAM5C,EAAOE,KAAKqB,MACxD,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAKJ,EAAOD,WAAWpP,SACrB,MAAM,IAAI+N,GAAG0B,WAAW,KAE1BJ,EAAOD,WAAWpP,SAASqP,EAAQvN,EAAQ5S,IAE7CyiB,KAAM,SAAStC,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUG,EAAMC,GAC7D,GAAmB,KAAP,EAAPD,IAAmC,KAAP,EAARC,IAAiD,KAAb,QAAfjF,EAAOiF,OACnD,MAAM,IAAIvG,GAAG0B,WAAW,GAE1B,GAAiC,KAAb,QAAfJ,EAAOiF,OACV,MAAM,IAAIvG,GAAG0B,WAAW,GAE1B,IAAKJ,EAAOD,WAAWuC,KACrB,MAAM,IAAI5D,GAAG0B,WAAW,IAE1B,OAAOJ,EAAOD,WAAWuC,KAAKtC,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,EAAUG,EAAMC,IAEhF1C,MAAO,SAASvC,EAAQtP,EAAQ+B,EAAQ5S,EAAQylB,GAC9C,OAAKtF,GAAWA,EAAOD,WAAWwC,MAG3BvC,EAAOD,WAAWwC,MAAMvC,EAAQtP,EAAQ+B,EAAQ5S,EAAQylB,GAFtD,GAIX0H,OAAQ,SAAShN,GACf,OAAO,GAETiN,MAAO,SAASjN,EAAQkN,EAAKzS,GAC3B,IAAKuF,EAAOD,WAAWkN,MACrB,MAAM,IAAIvO,GAAG0B,WAAW,IAE1B,OAAOJ,EAAOD,WAAWkN,MAAMjN,EAAQkN,EAAKzS,IAE9C0S,SAAU,SAASvR,EAAM6K,GAIvB,IAHAA,EAAOA,GAAQ,IACVxB,MAAQwB,EAAKxB,OAAS,IAC3BwB,EAAK1T,SAAW0T,EAAK1T,UAAY,SACX,SAAlB0T,EAAK1T,UAAyC,WAAlB0T,EAAK1T,SACnC,MAAM,IAAI3Z,MAAM,0BAA4BqtB,EAAK1T,SAAW,KAE9D,IAAIgD,EACAiK,EAAStB,GAAGzkB,KAAK2hB,EAAM6K,EAAKxB,OAE5BplB,EADO6e,GAAGkN,KAAKhQ,GACD9F,KACd+D,EAAM,IAAII,WAAWpa,GAQzB,OAPA6e,GAAG8B,KAAKR,EAAQnG,EAAK,EAAGha,EAAQ,GACV,SAAlB4mB,EAAK1T,SACPgD,EAAMgC,EAAkB8B,EAAK,GACF,WAAlB4M,EAAK1T,WACdgD,EAAM8D,GAER6E,GAAG4B,MAAMN,GACFjK,GAETqX,UAAW,SAASxR,EAAM5c,EAAMynB,IAC9BA,EAAOA,GAAQ,IACVxB,MAAQwB,EAAKxB,OAAS,IAC3B,IAAIjF,EAAStB,GAAGzkB,KAAK2hB,EAAM6K,EAAKxB,MAAOwB,EAAKlF,MAC5C,GAAoB,kBAATviB,EAAmB,CAC5B,IAAI6a,EAAM,IAAII,WAAWV,EAAgBva,GAAQ,GAC7CquB,EAAiBvU,EAAkB9Z,EAAM6a,EAAK,EAAGA,EAAIha,QACzD6e,GAAGmC,MAAMb,EAAQnG,EAAK,EAAGwT,OAAgBvV,EAAW2O,EAAK3B,YACpD,KAAIwI,YAAYC,OAAOvuB,GAG5B,MAAM,IAAI5F,MAAM,yBAFhBslB,GAAGmC,MAAMb,EAAQhhB,EAAM,EAAGA,EAAK2b,gBAAY7C,EAAW2O,EAAK3B,QAI7DpG,GAAG4B,MAAMN,IAEXrB,IAAK,WACH,OAAOD,GAAGkH,aAEZ4H,MAAO,SAAS5R,GACd,IAAIiG,EAASnD,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAQ,IAEV,GAAoB,OAAhBpF,EAAO3B,KACT,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IAAK1B,GAAGkE,MAAMf,EAAO3B,KAAKqB,MACxB,MAAM,IAAI7C,GAAG0B,WAAW,IAE1B,IAAIwH,EAAUlJ,GAAG6J,gBAAgB1G,EAAO3B,KAAM,KAC9C,GAAI0H,EACF,MAAM,IAAIlJ,GAAG0B,WAAWwH,GAE1BlJ,GAAGkH,YAAc/D,EAAOjG,MAE1B6R,yBAA0B,WACxB/O,GAAGsM,MAAM,QACTtM,GAAGsM,MAAM,SACTtM,GAAGsM,MAAM,mBAEX0C,qBAAsB,WAepB,IAAIC,EACJ,GAfAjP,GAAGsM,MAAM,QACTtM,GAAGoB,eAAepB,GAAGqL,QAAQ,EAAG,GAAI,CAClCvJ,KAAM,WACJ,OAAO,GAETK,MAAO,SAASb,EAAQtP,EAAQ+B,EAAQ5S,EAAQ4gB,GAC9C,OAAO5gB,KAGX6e,GAAGyM,MAAM,YAAazM,GAAGqL,QAAQ,EAAG,IACpCzK,GAAII,SAAShB,GAAGqL,QAAQ,EAAG,GAAIzK,GAAIyB,iBACnCzB,GAAII,SAAShB,GAAGqL,QAAQ,EAAG,GAAIzK,GAAI4B,kBACnCxC,GAAGyM,MAAM,WAAYzM,GAAGqL,QAAQ,EAAG,IACnCrL,GAAGyM,MAAM,YAAazM,GAAGqL,QAAQ,EAAG,IAEd,kBAAX6D,QAA4D,oBAA9BA,OAAM,gBAAoC,CACjF,IAAIC,EAAe,IAAI5T,WAAW,GAClC0T,EAAgB,WAEd,OADAC,OAAOE,gBAAgBD,GAChBA,EAAa,IAGnBF,IACHA,EAAgB,WACdxX,EAAM,mBAGVuI,GAAGqP,aAAa,OAAQ,SAAUJ,GAClCjP,GAAGqP,aAAa,OAAQ,UAAWJ,GACnCjP,GAAGsM,MAAM,YACTtM,GAAGsM,MAAM,iBAEXgD,yBAA0B,WACxBtP,GAAGsM,MAAM,SACTtM,GAAGsM,MAAM,cACTtM,GAAGsM,MAAM,iBACTtM,GAAG2C,MAAM,CACPA,MAAO,WACL,IAAInB,EAAOxB,GAAG4C,WAAW,aAAc,KAAM,MAAa,IAsB1D,OArBApB,EAAKyB,SAAW,CACdE,OAAQ,SAAS5lB,EAAQ/C,GACvB,IAAI8vB,GAAM9vB,EACN8mB,EAAStB,GAAGuK,UAAUD,GAC1B,IAAKhJ,EACH,MAAM,IAAItB,GAAG0B,WAAW,GAC1B,IAAIrK,EAAM,CACR9Z,OAAQ,KACRolB,MAAO,CACLgG,WAAY,QAEd1F,SAAU,CACRc,SAAU,WACR,OAAOzC,EAAOpE,QAKpB,OADA7F,EAAI9Z,OAAS8Z,EACNA,IAGJmK,IAER,GAAI,kBAET+N,sBAAuB,WACjBxZ,EAAM,MACRiK,GAAGqP,aAAa,OAAQ,QAAStZ,EAAM,OAEvCiK,GAAGyD,QAAQ,WAAY,cAErB1N,EAAM,OACRiK,GAAGqP,aAAa,OAAQ,SAAU,KAAMtZ,EAAM,QAE9CiK,GAAGyD,QAAQ,WAAY,eAErB1N,EAAM,OACRiK,GAAGqP,aAAa,OAAQ,SAAU,KAAMtZ,EAAM,QAE9CiK,GAAGyD,QAAQ,YAAa,eAEdzD,GAAGzkB,KAAK,aAAc,KACrBykB,GAAGzkB,KAAK,cAAe,KACvBykB,GAAGzkB,KAAK,cAAe,MAEtCi0B,iBAAkB,WACZxP,GAAG0B,aAEP1B,GAAG0B,WAAa,SAAoBmG,EAAOrG,GACzCtoB,KAAKsoB,KAAOA,EACZtoB,KAAKu2B,SAAW,SAAS5H,GACvB3uB,KAAK2uB,MAAQA,GAGf3uB,KAAKu2B,SAAS5H,GACd3uB,KAAK+zB,QAAU,YAGjBjN,GAAG0B,WAAW1E,UAAY,IAAItiB,MAC9BslB,GAAG0B,WAAW1E,UAAUziB,YAAcylB,GAAG0B,WACzC,CAAC,IAAIvkB,SAAQ,SAASuyB,GACpB1P,GAAG0F,cAAcgK,GAAQ,IAAI1P,GAAG0B,WAAWgO,GAC3C1P,GAAG0F,cAAcgK,GAAM9R,MAAQ,iCAGnC+R,WAAY,WACV3P,GAAGwP,mBACHxP,GAAGiH,UAAY,IAAIhf,MAAM,MACzB+X,GAAG2C,MAAMF,GAAO,GAAI,KACpBzC,GAAG+O,2BACH/O,GAAGgP,uBACHhP,GAAGsP,2BACHtP,GAAG0H,YAAc,CACf,MAASjF,KAGb3B,KAAM,SAAS/Z,EAAOoa,EAAQtkB,GAC5BmjB,GAAGc,KAAKqG,aAAc,EACtBnH,GAAGwP,mBACHzZ,EAAM,MAAYhP,GAASgP,EAAM,MACjCA,EAAM,OAAaoL,GAAUpL,EAAM,OACnCA,EAAM,OAAalZ,GAASkZ,EAAM,OAClCiK,GAAGuP,yBAELK,KAAM,WACJ5P,GAAGc,KAAKqG,aAAc,EACtB,IAAI0I,EAAS9Z,EAAM,QACf8Z,GACFA,EAAO,GACT,IAAK,IAAI3uB,EAAI,EAAGA,EAAI8e,GAAG+G,QAAQ5lB,OAAQD,IAAK,CAC1C,IAAIogB,EAAStB,GAAG+G,QAAQ7lB,GACnBogB,GAGLtB,GAAG4B,MAAMN,KAGbwO,QAAS,SAASC,EAASC,GACzB,IAAInN,EAAO,EAKX,OAJIkN,IACFlN,GAAQ,KACNmN,IACFnN,GAAQ,KACHA,GAEToN,SAAU,SAASlqB,EAAOmqB,GACxB,IAAIhT,EAAOkB,GAAKY,KAAK0M,MAAM,KAAM3lB,GAGjC,OAFImqB,GAA4B,KAAXhT,EAAK,KACxBA,EAAOA,EAAKvW,OAAO,IACduW,GAETiT,aAAc,SAAShQ,EAAUiQ,GAC/B,OAAOxQ,GAAQC,QAAQuQ,EAAMjQ,IAE/BkQ,gBAAiB,SAASnT,GACxB,OAAOkB,GAAKQ,UAAU1B,IAExBoT,WAAY,SAASpT,EAAMqT,GACzB,IAAIlZ,EAAM2I,GAAGwQ,YAAYtT,EAAMqT,GAC/B,OAAIlZ,EAAIoZ,OACCpZ,EAAIqT,QAEXvM,GAAY9G,EAAIxa,OACT,OAGX2zB,YAAa,SAAStT,EAAMqT,GAC1B,IAIErT,GAHIiG,EAASnD,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAASgI,KAEGrT,KACd,MAAOtjB,IACT,IAAIyd,EAAM,CACRqR,QAAQ,EACR+H,QAAQ,EACR5zB,MAAO,EACPrC,KAAM,KACN0iB,KAAM,KACNwN,OAAQ,KACRgG,cAAc,EACdC,WAAY,KACZC,aAAc,MAEhB,IACE,IAAIzN,EAASnD,GAAG8H,WAAW5K,EAAM,CAC/B3f,QAAQ,IAEV8Z,EAAIqZ,cAAe,EACnBrZ,EAAIsZ,WAAaxN,EAAOjG,KACxB7F,EAAIuZ,aAAezN,EAAO3B,KAC1BnK,EAAI7c,KAAO4jB,GAAKgB,SAASlC,GACzBiG,EAASnD,GAAG8H,WAAW5K,EAAM,CAC3BqL,QAASgI,IAEXlZ,EAAIoZ,QAAS,EACbpZ,EAAI6F,KAAOiG,EAAOjG,KAClB7F,EAAIqT,OAASvH,EAAO3B,KACpBnK,EAAI7c,KAAO2oB,EAAO3B,KAAKhnB,KACvB6c,EAAIqR,OAAyB,MAAhBvF,EAAOjG,KACpB,MAAOtjB,GACPyd,EAAIxa,MAAQjD,EAAEiuB,MAEhB,OAAOxQ,GAETwZ,aAAc,SAAStzB,EAAQ/C,EAAMu1B,EAASC,GAC5C,IAAI9S,EAAOkB,GAAKsB,MAAwB,kBAAXniB,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAAS/C,GAC5EqoB,EAAO7C,GAAG8P,QAAQC,EAASC,GAC/B,OAAOhQ,GAAGsM,MAAMpP,EAAM2F,IAExBiO,WAAY,SAASvzB,EAAQ2f,EAAM6S,EAASC,GAC1CzyB,EAA2B,kBAAXA,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAE1D,IADA,IAAIwI,EAAQmX,EAAKlX,MAAM,KAAK+qB,UACrBhrB,EAAM5E,QAAQ,CACnB,IAAI6vB,EAAOjrB,EAAMiJ,MACjB,GAAKgiB,EAAL,CAEA,IAAItzB,EAAU0gB,GAAKsB,MAAMniB,EAAQyzB,GACjC,IACEhR,GAAGsM,MAAM5uB,GACT,MAAO9D,IACT2D,EAASG,GAEX,OAAOA,GAETuzB,WAAY,SAAS1zB,EAAQ/C,EAAM02B,EAAYnB,EAASC,GACtD,IAAI9S,EAAOkB,GAAKsB,MAAwB,kBAAXniB,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAAS/C,GAC5EqoB,EAAO7C,GAAG8P,QAAQC,EAASC,GAC/B,OAAOhQ,GAAGqM,OAAOnP,EAAM2F,IAEzBsO,eAAgB,SAAS5zB,EAAQ/C,EAAM8F,EAAMyvB,EAASC,EAAU5J,GAC9D,IAAIlJ,EAAO1iB,EAAO4jB,GAAKsB,MAAwB,kBAAXniB,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAAS/C,GAAQ+C,EAC3FslB,EAAO7C,GAAG8P,QAAQC,EAASC,GAC3BxO,EAAOxB,GAAGqM,OAAOnP,EAAM2F,GAC3B,GAAIviB,EAAM,CACR,GAAoB,kBAATA,EAAmB,CAE5B,IADA,IAAIggB,EAAM,IAAIrY,MAAM3H,EAAKa,QAChBD,EAAI,EAAG4Z,EAAMxa,EAAKa,OAAQD,EAAI4Z,IAAO5Z,EAC5Cof,EAAIpf,GAAKZ,EAAKoa,WAAWxZ,GAC3BZ,EAAOggB,EAETN,GAAGqN,MAAM7L,EAAa,IAAPqB,GACf,IAAIvB,EAAStB,GAAGzkB,KAAKimB,EAAM,KAC3BxB,GAAGmC,MAAMb,EAAQhhB,EAAM,EAAGA,EAAKa,OAAQ,EAAGilB,GAC1CpG,GAAG4B,MAAMN,GACTtB,GAAGqN,MAAM7L,EAAMqB,GAEjB,OAAOrB,GAET6N,aAAc,SAAS9xB,EAAQ/C,EAAMuM,EAAOoa,GAC1C,IAAIjE,EAAOkB,GAAKsB,MAAwB,kBAAXniB,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAAS/C,GAC5EqoB,EAAO7C,GAAG8P,UAAU/oB,IAASoa,GAC5BnB,GAAGqP,aAAalE,QACnBnL,GAAGqP,aAAalE,MAAQ,IAC1B,IAAIlK,EAAMjB,GAAGqL,QAAQrL,GAAGqP,aAAalE,QAAS,GA8C9C,OA7CAnL,GAAGoB,eAAeH,EAAK,CACrB1lB,KAAM,SAAS+lB,GACbA,EAAOK,UAAW,GAEpBC,MAAO,SAASN,GACVH,GAAUA,EAAOnP,QAAUmP,EAAOnP,OAAO7Q,QAC3CggB,EAAO,KAGXW,KAAM,SAASR,EAAQtP,EAAQ+B,EAAQ5S,EAAQ4gB,GAE7C,IADA,IAAIE,EAAY,EACP/gB,EAAI,EAAGA,EAAIC,EAAQD,IAAK,CAC/B,IAAI0D,EACJ,IACEA,EAASmC,IACT,MAAOnN,GACP,MAAM,IAAIomB,GAAG0B,WAAW,IAE1B,QAAetI,IAAXxU,GAAsC,IAAdqd,EAC1B,MAAM,IAAIjC,GAAG0B,WAAW,GAE1B,GAAe,OAAX9c,QAA8BwU,IAAXxU,EACrB,MACFqd,IACAjQ,EAAO+B,EAAS7S,GAAK0D,EAKvB,OAHIqd,IACFX,EAAOE,KAAKU,UAAYte,KAAKG,OAExBke,GAETE,MAAO,SAASb,EAAQtP,EAAQ+B,EAAQ5S,EAAQ4gB,GAC9C,IAAK,IAAI7gB,EAAI,EAAGA,EAAIC,EAAQD,IAC1B,IACEigB,EAAOnP,EAAO+B,EAAS7S,IACvB,MAAOtH,GACP,MAAM,IAAIomB,GAAG0B,WAAW,IAM5B,OAHIvgB,IACFmgB,EAAOE,KAAKU,UAAYte,KAAKG,OAExB7C,KAGJ8e,GAAGyM,MAAMvP,EAAM2F,EAAM5B,IAE9BmQ,WAAY,SAAS7zB,EAAQ/C,EAAM2E,EAAQ4wB,EAASC,GAClD,IAAI9S,EAAOkB,GAAKsB,MAAwB,kBAAXniB,EAAsBA,EAASyiB,GAAGyI,QAAQlrB,GAAS/C,GAChF,OAAOwlB,GAAGyD,QAAQtkB,EAAQ+d,IAE5BmU,cAAe,SAASC,GACtB,GAAIA,EAAIC,UAAYD,EAAIE,UAAYF,EAAIxN,MAAQwN,EAAInN,SAClD,OAAO,EACT,IAAIsN,GAAU,EACd,GAA8B,qBAAnB7a,eACT,MAAM,IAAIlc,MAAM,oMACX,IAAIwb,EAQT,MAAM,IAAIxb,MAAM,iDAPhB,IACE42B,EAAInN,SAAW5B,GAAmBrM,EAAMob,EAAI5a,MAAM,GAClD4a,EAAIjN,UAAYiN,EAAInN,SAAShjB,OAC7B,MAAOvH,GACP63B,GAAU,EAOd,OAFKA,GACHtT,GAAY,IACPsT,GAETC,eAAgB,SAASn0B,EAAQ/C,EAAMkc,EAAKqZ,EAASC,GACnD,SAAS2B,IACPz4B,KAAK04B,aAAc,EACnB14B,KAAK24B,OAAS,GA0EhB,GAxEAF,EAAe3U,UAAU2N,IAAM,SAA4BpR,GACzD,KAAIA,EAAMrgB,KAAKiI,OAAS,GAAKoY,EAAM,GAAnC,CAGA,IAAIuY,EAAcvY,EAAMrgB,KAAK64B,UACzBC,EAAWzY,EAAMrgB,KAAK64B,UAAY,EACtC,OAAO74B,KAAK+4B,OAAOD,GAAUF,KAG/BH,EAAe3U,UAAUkV,cAAgB,SAAsCD,GAC7E/4B,KAAK+4B,OAASA,GAGhBN,EAAe3U,UAAUmV,YAAc,WACrC,IAAIxb,EAAM,IAAIC,eAGd,GAFAD,EAAIpb,KAAK,OAAQmb,GAAK,GACtBC,EAAIE,KAAK,QACHF,EAAIyb,QAAU,KAAOzb,EAAIyb,OAAS,KAAsB,MAAfzb,EAAIyb,QACjD,MAAM,IAAI13B,MAAM,iBAAmBgc,EAAM,aAAeC,EAAIyb,QAC9D,IACIxzB,EADAyzB,EAAaza,OAAOjB,EAAI2b,kBAAkB,mBAE1CC,GAAkB3zB,EAAS+X,EAAI2b,kBAAkB,mBAAgC,UAAX1zB,EACtE4zB,GAAY5zB,EAAS+X,EAAI2b,kBAAkB,sBAAmC,SAAX1zB,EACnEmzB,EAAY,QACXQ,IACHR,EAAYM,GACd,IAuBII,EAAYv5B,KAChBu5B,EAAUP,eAAc,SAASF,GAC/B,IAAI7jB,EAAQ6jB,EAAWD,EACnB3jB,GAAO4jB,EAAW,GAAKD,EAAY,EAKvC,GAJA3jB,EAAMjK,KAAK9E,IAAI+O,EAAKikB,EAAa,GACS,qBAA/BI,EAAUZ,OAAOG,KAC1BS,EAAUZ,OAAOG,GA7BT,SAAS5R,EAAM7L,GACzB,GAAI6L,EAAO7L,EACT,MAAM,IAAI7Z,MAAM,kBAAoB0lB,EAAO,KAAO7L,EAAK,4BACzD,GAAIA,EAAK8d,EAAa,EACpB,MAAM,IAAI33B,MAAM,QAAU23B,EAAa,uCACzC,IAAI1b,EAAM,IAAIC,eAUd,GATAD,EAAIpb,KAAK,MAAOmb,GAAK,GACjB2b,IAAeN,GACjBpb,EAAI+b,iBAAiB,QAAS,SAAWtS,EAAO,IAAM7L,GAC/B,oBAAdgH,aACT5E,EAAIgc,aAAe,eACjBhc,EAAIic,kBACNjc,EAAIic,iBAAiB,sCAEvBjc,EAAIE,KAAK,QACHF,EAAIyb,QAAU,KAAOzb,EAAIyb,OAAS,KAAsB,MAAfzb,EAAIyb,QACjD,MAAM,IAAI13B,MAAM,iBAAmBgc,EAAM,aAAeC,EAAIyb,QAC9D,YAAqBhZ,IAAjBzC,EAAIkc,SACC,IAAItX,WAAW5E,EAAIkc,UAAY,IAE/BtQ,GAAmB5L,EAAIG,cAAgB,IAAI,GASrBgc,CAAM3kB,EAAOC,IAEF,qBAA/BqkB,EAAUZ,OAAOG,GAC1B,MAAM,IAAIt3B,MAAM,iBAClB,OAAO+3B,EAAUZ,OAAOG,OAEtBQ,GAAaH,IACfN,EAAYM,EAAa,EACzBA,EAAan5B,KAAK+4B,OAAO,GAAG9wB,OAC5B4wB,EAAYM,EACZpb,EAAI,gFAEN/d,KAAK65B,QAAUV,EACfn5B,KAAK85B,WAAajB,EAClB74B,KAAK04B,aAAc,GAGS,qBAAnBhb,eAEP,KAAM,sHAyBR,IAAIsa,EAAa,CACfK,UAAU,EACV7a,IAAKA,GAGL8K,EAAOxB,GAAGiR,WAAW1zB,EAAQ/C,EAAM02B,EAAYnB,EAASC,GACxDkB,EAAW/M,SACb3C,EAAK2C,SAAW+M,EAAW/M,SAClB+M,EAAWxa,MACpB8K,EAAK2C,SAAW,KAChB3C,EAAK9K,IAAMwa,EAAWxa,KAExB7O,OAAOorB,iBAAiBzR,EAAM,CAC5B6C,UAAW,CACTsG,IAAK,WACH,OAAOzxB,KAAKirB,SAAShjB,WAI3B,IAAIkgB,EAAa,GAgCjB,OA/BWxZ,OAAOC,KAAK0Z,EAAKH,YACvBlkB,SAAQ,SAAS2C,GACpB,IAAImO,EAAKuT,EAAKH,WAAWvhB,GACzBuhB,EAAWvhB,GAAO,WAChB,IAAKkgB,GAAGqR,cAAc7P,GACpB,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,OAAOzT,EAAGyd,MAAM,KAAMjM,eAG1B4B,EAAWS,KAAO,SAAyBR,EAAQtP,EAAQ+B,EAAQ5S,EAAQglB,GACzE,IAAKnG,GAAGqR,cAAc7P,GACpB,MAAM,IAAIxB,GAAG0B,WAAW,IAE1B,IAAIyC,EAAW7C,EAAOE,KAAK2C,SAC3B,GAAIgC,GAAYhC,EAAShjB,OACvB,OAAO,EACT,IAAIiW,EAAOjT,KAAK9E,IAAI8kB,EAAShjB,OAASglB,EAAUhlB,GAChD,GAAIgjB,EAAS9d,MACX,IAAK,IAAInF,EAAI,EAAGA,EAAIkW,EAAMlW,IACxB8Q,EAAO+B,EAAS7S,GAAKijB,EAASgC,EAAWjlB,QAG3C,IAASA,EAAI,EAAGA,EAAIkW,EAAMlW,IACxB8Q,EAAO+B,EAAS7S,GAAKijB,EAASwG,IAAIxE,EAAWjlB,GAGjD,OAAOkW,GAGToK,EAAKH,WAAaA,EACXG,GAET0R,oBAAqB,SAAS31B,EAAQ/C,EAAMkc,EAAKqZ,EAASC,EAAUmD,EAAQC,EAASC,EAAgBjN,EAAQkN,GAC3GC,QAAQzS,OACR,IAAI0S,EAAWh5B,EAAOolB,GAAQC,QAAQzB,GAAKsB,MAAMniB,EAAQ/C,IAAS+C,EAElE,SAASk2B,EAAYC,GACnB,SAASC,EAAOD,GACVJ,GACFA,IACGD,GACHrT,GAAGmR,eAAe5zB,EAAQ/C,EAAMk5B,EAAW3D,EAASC,EAAU5J,GAE5D+M,GACFA,IACFxW,IAEF,IAAIiX,GAAU,EACd7d,EAAM,eAAmB5Y,SAAQ,SAAS02B,GACpCD,GAEAC,EAAM,UAAcL,KACtBK,EAAM,OAAWH,EAAWF,EAAUG,GAAQ,WACxCP,GACFA,IACFzW,OAEFiX,GAAU,MAGTA,GACHD,EAAOD,GAEXhX,IACkB,iBAAPhG,EACT6c,QAAQO,UAAUpd,GAAK,SAASgd,GAC9BD,EAAYC,KACXN,GAEHK,EAAY/c,IAGhBqd,UAAW,WACT,OAAOh2B,OAAOg2B,WAAah2B,OAAOi2B,cAAgBj2B,OAAOk2B,iBAAmBl2B,OAAOm2B,aAErFC,QAAS,WACP,MAAO,SAAWp2B,OAAOqP,SAASgnB,UAEpCC,WAAY,GACZC,cAAe,YACfC,cAAe,SAAShV,EAAO4T,EAAQC,GACrCD,EAASA,GAAU,aAEnBC,EAAUA,GAAW,aAErB,IAAIW,EAAY/T,GAAG+T,YACnB,IACE,IAAIS,EAAcT,EAAUx4B,KAAKykB,GAAGmU,UAAWnU,GAAGqU,YAClD,MAAOz6B,GACP,OAAOw5B,EAAQx5B,GAEjB46B,EAAYC,gBAAkB,WAC5Bxd,EAAI,eACKud,EAAY5vB,OAClB8vB,kBAAkB1U,GAAGsU,gBAG1BE,EAAYG,UAAY,WACtB,IACIC,EADKJ,EAAY5vB,OACAgwB,YAAY,CAAC5U,GAAGsU,eAAgB,aACjDO,EAAQD,EAAYE,YAAY9U,GAAGsU,eACnCS,EAAK,EACHC,EAAO,EACPC,EAAQ1V,EAAMpe,OACpB,SAASwyB,IACK,GAARqB,EACF7B,IAEAC,IAEJ7T,EAAMpiB,SAAQ,SAAS+f,GACrB,IAAIgY,EAAaL,EAAMM,IAAInV,GAAGwQ,YAAYtT,GAAMwN,OAAOvG,SAAUjH,GACjEgY,EAAWP,UAAY,aACrBI,EACSC,GAAQC,GACftB,KAGJuB,EAAW9B,QAAU,WACnB4B,IACID,EAAKC,GAAQC,GACftB,QAGNiB,EAAYxB,QAAUA,GAGxBoB,EAAYpB,QAAUA,GAExBgC,gBAAiB,SAAS7V,EAAO4T,EAAQC,GACvCD,EAASA,GAAU,aAEnBC,EAAUA,GAAW,aAErB,IAAIW,EAAY/T,GAAG+T,YACnB,IACE,IAAIS,EAAcT,EAAUx4B,KAAKykB,GAAGmU,UAAWnU,GAAGqU,YAClD,MAAOz6B,GACP,OAAOw5B,EAAQx5B,GAEjB46B,EAAYC,gBAAkBrB,EAC9BoB,EAAYG,UAAY,WACtB,IAAIU,EAAKb,EAAY5vB,OACrB,IACE,IAAIgwB,EAAcS,EAAGT,YAAY,CAAC5U,GAAGsU,eAAgB,YACrD,MAAO16B,GAEP,YADAw5B,EAAQx5B,GAGV,IAAIi7B,EAAQD,EAAYE,YAAY9U,GAAGsU,eACnCS,EAAK,EACHC,EAAO,EACPC,EAAQ1V,EAAMpe,OACpB,SAASwyB,IACK,GAARqB,EACF7B,IAEAC,IAEJ7T,EAAMpiB,SAAQ,SAAS+f,GACrB,IAAIoY,EAAaT,EAAMlK,IAAIzN,GAC3BoY,EAAWX,UAAY,WACjB3U,GAAGwQ,YAAYtT,GAAMuT,QACvBzQ,GAAGsD,OAAOpG,GAEZ8C,GAAGmR,eAAe/S,GAAKa,QAAQ/B,GAAOkB,GAAKgB,SAASlC,GAAOoY,EAAW1wB,QAAQ,GAAM,GAAM,KAC1FmwB,EACSC,GAAQC,GACftB,KAGJ2B,EAAWlC,QAAU,WACnB4B,IACID,EAAKC,GAAQC,GACftB,QAGNiB,EAAYxB,QAAUA,GAGxBoB,EAAYpB,QAAUA,IAGtBmC,GAAW,CACbC,SAAU,GACVC,iBAAkB,EAClBC,MAAO,IACPC,YAAa,SAASC,EAAO1Y,GAC3B,GAAgB,MAAZA,EAAK,GAAY,CACnB,IAAIiC,EACJ,IAAe,MAAXyW,EACFzW,EAAMa,GAAGC,UACJ,CACL,IAAI4V,EAAY7V,GAAGuK,UAAUqL,GAC7B,IAAKC,EACH,MAAM,IAAI7V,GAAG0B,WAAW,GAC1BvC,EAAM0W,EAAU3Y,KAElBA,EAAOkB,GAAKsB,MAAMP,EAAKjC,GAEzB,OAAOA,GAET4Y,OAAQ,SAAS56B,EAAMgiB,EAAM/B,GAC3B,IACE,IAAI+R,EAAOhyB,EAAKgiB,GAChB,MAAOtjB,GACP,GAAIA,GAAKA,EAAE4nB,MAAQpD,GAAKQ,UAAU1B,KAAUkB,GAAKQ,UAAUoB,GAAGyI,QAAQ7uB,EAAE4nB,OACtE,OAAQ,GAEV,MAAM5nB,EA2BR,OAzBA0d,EAAO6D,GAAO,GAAK+R,EAAKjM,IACxB3J,EAAO6D,EAAM,GAAK,GAAK,EACvB7D,EAAO6D,EAAM,GAAK,GAAK+R,EAAKjI,IAC5B3N,EAAO6D,EAAM,IAAM,GAAK+R,EAAKrK,KAC7BvL,EAAO6D,EAAM,IAAM,GAAK+R,EAAKhI,MAC7B5N,EAAO6D,EAAM,IAAM,GAAK+R,EAAK/H,IAC7B7N,EAAO6D,EAAM,IAAM,GAAK+R,EAAK9H,IAC7B9N,EAAO6D,EAAM,IAAM,GAAK+R,EAAKzL,KAC7BnK,EAAO6D,EAAM,IAAM,GAAK,EACxBhD,GAAU,CAAC+U,EAAK9V,OAAS,GAAIgB,EAAa8U,EAAK9V,MAC1CiB,EAASD,IAAe,EAAIA,EAAa,GAAkE,EAA7DE,GAAUC,EAAWH,EAAa,YAAa,eAAqB,KAAOI,GAAWJ,MAAiBA,IAAe,IAAM,cAAgB,EAAI,IAC/Ld,EAAO6D,EAAM,IAAM,GAAKhD,GAAQ,GAChCb,EAAO6D,EAAM,IAAM,GAAKhD,GAAQ,GACpCb,EAAO6D,EAAM,IAAM,GAAK,KACxB7D,EAAO6D,EAAM,IAAM,GAAK+R,EAAKzH,OAC7BnO,EAAO6D,EAAM,IAAM,GAAK+R,EAAK7H,MAAMxhB,UAAY,IAAM,EACrDyT,EAAO6D,EAAM,IAAM,GAAK,EACxB7D,EAAO6D,EAAM,IAAM,GAAK+R,EAAK5H,MAAMzhB,UAAY,IAAM,EACrDyT,EAAO6D,EAAM,IAAM,GAAK,EACxB7D,EAAO6D,EAAM,IAAM,GAAK+R,EAAK3H,MAAM1hB,UAAY,IAAM,EACrDyT,EAAO6D,EAAM,IAAM,GAAK,EACxBhD,GAAU,CAAC+U,EAAKjI,MAAQ,GAAI7M,EAAa8U,EAAKjI,KACzC5M,EAASD,IAAe,EAAIA,EAAa,GAAkE,EAA7DE,GAAUC,EAAWH,EAAa,YAAa,eAAqB,KAAOI,GAAWJ,MAAiBA,IAAe,IAAM,cAAgB,EAAI,IAC/Ld,EAAO6D,EAAM,IAAM,GAAKhD,GAAQ,GAChCb,EAAO6D,EAAM,IAAM,GAAKhD,GAAQ,GAC7B,GAET4d,QAAS,SAASC,EAAM1U,EAAQxG,EAAKyL,EAAOxS,GAC1C,IAAI/B,EAASiH,EAAO5S,MAAM2vB,EAAMA,EAAOlb,GACvCkF,GAAG6D,MAAMvC,EAAQtP,EAAQ+B,EAAQ+G,EAAKyL,IAExC0P,QAAS,SAAS/Y,EAAM2F,GAKtB,MAH8B,OAD9B3F,EAAOkB,GAAKQ,UAAU1B,IACbA,EAAK/b,OAAS,KACrB+b,EAAOA,EAAKvW,OAAO,EAAGuW,EAAK/b,OAAS,IACtC6e,GAAGsM,MAAMpP,EAAM2F,EAAM,GACd,GAETqT,QAAS,SAAShZ,EAAM2F,EAAM5B,GAC5B,OAAe,MAAP4B,GACN,KAAK,MACL,KAAK,KACL,KAAK,MACL,KAAK,KACL,KAAK,MACH,MACF,QACE,OAAQ,GAGZ,OADA7C,GAAGoD,MAAMlG,EAAM2F,EAAM5B,GACd,GAETkV,WAAY,SAASjZ,EAAM/B,EAAKib,GAC9B,GAAIA,GAAW,EACb,OAAQ,GACV,IAAI/e,EAAM2I,GAAG+D,SAAS7G,GAClBpC,EAAM3W,KAAK9E,IAAI+2B,EAASvb,EAAgBxD,IACxCgf,EAAUpe,EAAMkD,EAAML,GAG1B,OAFAH,EAAatD,EAAK8D,EAAKib,EAAU,GACjCne,EAAMkD,EAAML,GAAOub,EACZvb,GAETwb,SAAU,SAASpZ,EAAMqZ,GACvB,IAAY,EAARA,EACF,OAAQ,GAEV,IAAI/U,EAKJ,KADAA,EAHaxB,GAAG8H,WAAW5K,EAAM,CAC/BqL,QAAQ,IAEI/G,MAEZ,OAAQ,GAEV,IAAIoI,EAAQ,GAOZ,OANY,EAAR2M,IACF3M,GAAS,KACC,EAAR2M,IACF3M,GAAS,KACC,EAAR2M,IACF3M,GAAS,KACPA,GAAS5J,GAAG6J,gBAAgBrI,EAAMoI,IAC5B,EAEH,GAET4M,MAAO,SAAStZ,EAAMqJ,EAAOkQ,GAC3B,IAAIC,EAAU1W,GAAGuK,UAAUkM,GAG3B,OAFIC,GACF1W,GAAG4B,MAAM8U,GACJ1W,GAAGzkB,KAAK2hB,EAAMqJ,EAAO,EAAGkQ,EAAWA,GAAWnM,IAEvDqM,QAAS,SAASrV,EAAQsV,EAAKC,EAAQ9iB,GAErC,IADA,IAAIsD,EAAM,EACDnW,EAAI,EAAGA,EAAI21B,EAAQ31B,IAAK,CAC/B,IAAIiT,EAAMmD,EAAOsf,EAAU,EAAJ11B,GAAS,GAC5B4Z,EAAMxD,EAAOsf,GAAW,EAAJ11B,EAAQ,IAAM,GAClC41B,EAAO9W,GAAG8B,KAAKR,EAAQrJ,EAAO9D,EAAK2G,EAAK/G,GAC5C,GAAI+iB,EAAO,EACT,OAAQ,EAEV,GADAzf,GAAOyf,EACHA,EAAOhc,EACT,MAEJ,OAAOzD,GAET0f,SAAU,SAASzV,EAAQsV,EAAKC,EAAQ9iB,GAEtC,IADA,IAAIsD,EAAM,EACDnW,EAAI,EAAGA,EAAI21B,EAAQ31B,IAAK,CAC/B,IAAIiT,EAAMmD,EAAOsf,EAAU,EAAJ11B,GAAS,GAC5B4Z,EAAMxD,EAAOsf,GAAW,EAAJ11B,EAAQ,IAAM,GAClC41B,EAAO9W,GAAGmC,MAAMb,EAAQrJ,EAAO9D,EAAK2G,EAAK/G,GAC7C,GAAI+iB,EAAO,EACT,OAAQ,EACVzf,GAAOyf,EAET,OAAOzf,GAET2f,aAAS5d,EACTuR,IAAK,WAGH,OAFA4K,GAASyB,SAAW,EACV1f,EAAOie,GAASyB,QAAU,GAAK,IAG3CC,OAAQ,SAAS9iB,GAEf,OADUU,EAAaV,IAGzB+iB,gBAAiB,SAAS5M,GACxB,IAAIhJ,EAAStB,GAAGuK,UAAUD,GAC1B,IAAKhJ,EACH,MAAM,IAAItB,GAAG0B,WAAW,GAC1B,OAAOJ,GAET6V,MAAO,SAASC,EAAKC,GACnB,OAAOD,IAkKPE,GAAOjf,EACX,SAASb,KACP,OAAOyB,EAAO9X,OAKhB,SAASo2B,GAA0BngB,GACjC,IAGE,OAFAJ,EAAWwgB,KAAKpgB,EAAOpF,EAAOiK,WAAa,OAAS,IACpDf,EAA2BlE,EAAWhF,QAC/B,EACP,MAAOpY,KAqBX,IAAI69B,GAAM,GAIV,SAASC,KACP,IAAKA,GAAwBC,QAAS,CACpC,IAAIvmB,EAAM,CACR,KAAQ,WACR,QAAW,WACX,KAAQ,IACR,IAAO,IACP,KAAQ,iBACR,MAA8B,kBAAdwmB,WAA0BA,UAAUC,WAAaD,UAAUC,UAAU,IAAM,KAAK7zB,QAAQ,IAAK,KAAO,SACpH,EAXGqS,GAAe,kBAapB,IAAK,IAAIyH,KAAK2Z,GACZrmB,EAAI0M,GAAK2Z,GAAI3Z,GAEf,IAAI6Z,EAAU,GACd,IAAK,IAAI7Z,KAAK1M,EACZumB,EAAQn6B,KAAKsgB,EAAI,IAAM1M,EAAI0M,IAE7B4Z,GAAwBC,QAAUA,EAEpC,OAAOD,GAAwBC,QAyFjC,SAASG,GAAaC,GACpB,OAAOA,EAAO,IAAM,IAAMA,EAAO,MAAQ,GAAKA,EAAO,MAAQ,GAE/D,SAASC,GAAWhd,EAAOnN,GAEzB,IADA,IAAIoqB,EAAM,EACD/2B,EAAI,EAAGA,GAAK2M,EAAOoqB,GAAOjd,EAAM9Z,MACzC,OAAO+2B,EAET,IAAIC,GAAoB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IACjEC,GAAuB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IACxE,SAASC,GAAUC,EAAMC,GAEvB,IADA,IAAIC,EAAU,IAAI30B,KAAKy0B,EAAKx0B,WACrBy0B,EAAO,GAAG,CACf,IAAIE,EAAOV,GAAaS,EAAQE,eAC5BC,EAAeH,EAAQI,WACvBC,GAAsBJ,EAAON,GAAoBC,IAAsBO,GAC3E,KAAIJ,EAAOM,EAAqBL,EAAQM,WAWtC,OADAN,EAAQO,QAAQP,EAAQM,UAAYP,GAC7BC,EAVPD,GAAQM,EAAqBL,EAAQM,UAAY,EACjDN,EAAQO,QAAQ,GACZJ,EAAe,GACjBH,EAAQQ,SAASL,EAAe,IAEhCH,EAAQQ,SAAS,GACjBR,EAAQS,YAAYT,EAAQE,cAAgB,IAOlD,OAAOF,EAmQT,SAASU,GAAiBC,EAAQ/d,GAC3B8d,GAAiBje,QACpBie,GAAiBje,MAAQ,IAE3B,IAEIb,EAFAgf,EAAOF,GAAiBje,MAG5B,IAFAme,EAAKh4B,OAAS,EAEPgZ,EAAKlB,EAAOigB,MACN,MAAP/e,GAAqB,MAAPA,GAChBgB,EAAMA,EAAM,GAAI,EAChBge,EAAK37B,KAAKkb,EAAQyC,GAAO,IACzBA,GAAO,IAEPA,EAAMA,EAAM,GAAI,EAChBge,EAAK37B,KAAK8Z,EAAO6D,GAAO,IACxBA,GAAO,GAGX,OAAOge,EAET,IAAI9P,GAAS,SAAS9rB,EAAQ/C,EAAMqoB,EAAMpB,GACnClkB,IACHA,EAASrE,MAEXA,KAAKqE,OAASA,EACdrE,KAAKypB,MAAQplB,EAAOolB,MACpBzpB,KAAKovB,QAAU,KACfpvB,KAAK4P,GAAKkX,GAAGgH,YACb9tB,KAAKsB,KAAOA,EACZtB,KAAK2pB,KAAOA,EACZ3pB,KAAK+pB,SAAW,GAChB/pB,KAAKmoB,WAAa,GAClBnoB,KAAKuoB,KAAOA,GAkCd,SAASc,GAAmB6W,EAASC,EAAal4B,GAChD,IAAI2Z,EAAM3Z,EAAS,EAAIA,EAAS0Z,EAAgBue,GAAW,EACvDE,EAAU,IAAIrxB,MAAM6S,GACpBye,EAAkBnf,EAAkBgf,EAASE,EAAS,EAAGA,EAAQn4B,QAGrE,OAFIk4B,IACFC,EAAQn4B,OAASo4B,GACZD,EApCTzxB,OAAOorB,iBAAiB5J,GAAOrM,UAAW,CACxC8E,KAAM,CACJ6I,IAAK,WACH,OALS,WAKDzxB,KAAK2pB,OAEf5H,IAAK,SAAS9F,GACZA,EAAMjc,KAAK2pB,MARF,IAQqB3pB,KAAK2pB,OAAQ,MAG/CV,MAAO,CACLwI,IAAK,WACH,OAZU,WAYFzxB,KAAK2pB,OAEf5H,IAAK,SAAS9F,GACZA,EAAMjc,KAAK2pB,MAfD,IAeqB3pB,KAAK2pB,OAAQ,MAGhD2O,SAAU,CACR7G,IAAK,WACH,OAAO3K,GAAGkE,MAAMhrB,KAAK2pB,QAGzB0O,SAAU,CACR5G,IAAK,WACH,OAAO3K,GAAGuE,SAASrrB,KAAK2pB,UAI9B7C,GAAGqJ,OAASA,GACZrJ,GAAG2P,aASH,IAAI6J,GAAgB,CAClB,EA/oGF,SAAwBzgB,EAAWpL,EAAU8rB,EAAMv+B,GACjDuc,EAAM,qBAAuB5C,EAAakE,GAAa,SAAW,CAACpL,EAAWkH,EAAalH,GAAY,mBAAoB8rB,EAAMv+B,EAAO2Z,EAAa3Z,GAAQ,sBA+oG7J,EA7oGF,SAAmCkc,GACjC,OAAOsP,GAAQtP,IA6oGf,EAtoGF,SAAsBjD,EAAK/U,EAAMs6B,GAgB/B,MAfA1b,GAAmB7J,GAAO,CACxBA,IAAKA,EACLwlB,SAAU,CAACxlB,GACX/U,KAAMA,EACNs6B,WAAYA,EACZE,SAAU,EACVC,QAAQ,EACRC,UAAU,GAGN,uBAAuB7b,GAG3BA,GAA2BC,sBAF3BD,GAA2BC,oBAAsB,EAI7C/J,GAunGN,EAhnGF,SAAqBigB,EAAUhd,GAE7B,OADA+G,GAAY,KACJ,GA+mGR,EAjqBF,SAAuBmM,EAAIkE,EAAKwI,GAC9BzB,GAASyB,QAAUA,EACnB,IACE,IAAI1V,EAASiU,GAAS2B,gBAAgB5M,GACtC,OAAQkE,GACN,KAAK,EAGH,OADIzS,EAAMwZ,GAAS5K,OACT,GACA,GAGE3K,GAAGzkB,KAAK+lB,EAAOpE,KAAMoE,EAAOiF,MAAO,EAAGxK,GACjCuO,GAEnB,KAAK,EACL,KAAK,EACH,OAAO,EACT,KAAK,EACH,OAAOhJ,EAAOiF,MAChB,KAAK,EAEH,IAAIxK,EAAMwZ,GAAS5K,MAEnB,OADArJ,EAAOiF,OAASxK,EACT,EAET,KAAK,GAKH,OAHIA,EAAMwZ,GAAS5K,MAEnBzS,EAAO6D,EADM,GACU,GAAK,EACrB,EAET,KAAK,GACL,KAAK,GACH,OAAO,EACT,KAAK,GACL,KAAK,EACH,OAAQ,GACV,KAAK,EAEH,OADAoC,GAAY,KACJ,EACV,QAEE,OAAQ,IAGZ,MAAOvkB,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,IACAA,EAAEiuB,QAgnBZ,EA7mBF,SAAqB3K,EAAMqJ,EAAOyQ,GAChCzB,GAASyB,QAAUA,EACnB,IACE,IAAI5C,EAAWmB,GAAS0B,OAAO/Z,GAC3B2F,EAAO0S,GAAS5K,MAEpB,OADa3K,GAAGzkB,KAAK64B,EAAU7N,EAAO1D,GACxByH,GACd,MAAO1wB,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,IACAA,EAAEiuB,QAomBZ,EAjmBF,SAAsByC,EAAIyP,EAAI/C,GAC5BzB,GAASyB,QAAUA,EACnB,IACE,IAAI1V,EAASiU,GAAS2B,gBAAgB5M,GACtC,OAAQyP,GACN,KAAK,MACL,KAAK,MAEH,OAAKzY,EAAOC,IAEL,GADG,GAGZ,KAAK,MACL,KAAK,MACL,KAAK,MACL,KAAK,MACL,KAAK,MACL,KAAK,MAEH,OAAKD,EAAOC,IAEL,GADG,GAGZ,KAAK,MAEH,IAAKD,EAAOC,IACV,OAAQ,GACV,IAAIyY,EAAOzE,GAAS5K,MAEpB,OADArT,EAAO0iB,GAAQ,GAAK,EACb,EAET,KAAK,MAEH,OAAK1Y,EAAOC,KAEJ,IADE,GAGZ,KAAK,MAGH,OADIyY,EAAOzE,GAAS5K,MACb3K,GAAGuO,MAAMjN,EAAQyY,EAAIC,GAE9B,KAAK,MAML,KAAK,MAEH,OAAK1Y,EAAOC,IAEL,GADG,GAGZ,QACE9J,EAAM,qBAAuBsiB,IAEjC,MAAOngC,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,IACAA,EAAEiuB,QAsiBZ,EAjhBF,SAAsBmO,EAAMlb,GAC1B,IACE,OApBJ,SAAuBkb,EAAMlb,GAC3B,IAAc,IAAVkb,GAAuB,IAARlb,EACjB,OAAQ,GAEV,IAAI/a,EAAOw1B,GAASC,SAASQ,GAC7B,IAAKj2B,EACH,OAAO,EACT,GAAI+a,IAAQ/a,EAAK+a,IAAK,CACpB,IAAIwG,EAAStB,GAAGuK,UAAUxqB,EAAKuqB,IAC/BiL,GAASQ,QAAQC,EAAM1U,EAAQxG,EAAK/a,EAAKwmB,MAAOxmB,EAAKgU,QACrDiM,GAAGsO,OAAOhN,GACViU,GAASC,SAASQ,GAAQ,KACtBj2B,EAAKymB,WACPyT,GAAMl6B,EAAKm6B,QAGf,OAAO,EAIEC,CAAcnE,EAAMlb,GAC3B,MAAOlhB,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,IACAA,EAAEiuB,QA4gBZ,EAzgBF,WACEpQ,KAygBA,EAAK6f,GACL,EAhsGF,SAAmC5H,EAAMwJ,EAAQkB,GAC/C,IAAIjB,EAAOF,GAAiBC,EAAQkB,GACpC,OAAO/c,GAAWqS,GAAMhE,MAAM,KAAMyN,IA+rGpC,EArgBF,SAAgCkB,EAAM7jB,EAAK8jB,GACzCrhB,EAAOshB,WAAWF,EAAM7jB,EAAKA,EAAM8jB,IAqgBnC,EA5fF,SAAiCE,GAC/B,IAAIC,EAAUjjB,KAGd,GAAIgjB,EADc,WAEhB,OAAO,EAGT,IADA,IAj8Fe1c,EAAG4c,EAk8FTC,EAAU,EAAGA,GAAW,EAAGA,GAAW,EAAG,CAChD,IAAIC,EAAoBH,GAAW,EAAI,GAAKE,GAI5C,GAHAC,EAAoBz2B,KAAK9E,IAAIu7B,EAAmBJ,EAAgB,WAE9CjD,GADJpzB,KAAK9E,IARH,aA77FHye,EAq8F+B3Z,KAAK7E,IAJjC,SAIkDk7B,EAAeI,KAr8FjEF,EA47FE,OA37FD,IACjB5c,GAAK4c,EAAW5c,EAAI4c,GAEf5c,KAo8FH,OAAO,EAGX,OAAO,GA4eP,EAhdF,SAAsB+c,EAAWC,GAC/B,IAAInD,EAAUD,KACVqD,EAAU,EAOd,OANApD,EAAQx6B,SAAQ,SAAS69B,EAAQ95B,GAC/B,IAAIiT,EAAM2mB,EAAcC,EACxBzjB,EAAOujB,EAAgB,EAAJ35B,GAAS,GAAKiT,EAp/FrC,SAA4B0F,EAAK7H,EAAQqnB,GACvC,IAAK,IAAIn4B,EAAI,EAAGA,EAAI2Y,EAAI1Y,SAAUD,EAChC+W,EAAMjG,KAAY,GAAK6H,EAAIa,WAAWxZ,GAEnCm4B,IACHphB,EAAMjG,GAAU,GAAK,GAg/FrBipB,CAAmBD,EAAQ7mB,GAC3B4mB,GAAWC,EAAO75B,OAAS,KAEtB,GAwcP,EAtcF,SAA4B+5B,EAAgBC,GAC1C,IAAIxD,EAAUD,KACdpgB,EAAO4jB,GAAkB,GAAKvD,EAAQx2B,OACtC,IAAI45B,EAAU,EAKd,OAJApD,EAAQx6B,SAAQ,SAAS69B,GACvBD,GAAWC,EAAO75B,OAAS,KAE7BmW,EAAO6jB,GAAqB,GAAKJ,EAC1B,GA+bP,EA7bF,SAAmBzQ,GACjB,IACE,IAAIhJ,EAASiU,GAAS2B,gBAAgB5M,GAEtC,OADAtK,GAAG4B,MAAMN,GACF,EACP,MAAO1nB,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,GACDA,EAAEiuB,QAsbX,EAnbF,SAAkByC,EAAIsM,EAAKC,EAAQuE,GACjC,IACE,IAAI9Z,EAASiU,GAAS2B,gBAAgB5M,GAClCgQ,EAAM/E,GAASoB,QAAQrV,EAAQsV,EAAKC,GAExC,OADAvf,EAAO8jB,GAAQ,GAAKd,EACb,EACP,MAAO1gC,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,GACDA,EAAEiuB,QA2aX,EAxaF,SAAkByC,EAAI+Q,EAAYC,EAAajV,EAAQkV,GACrD,IACE,IAAIja,EAASiU,GAAS2B,gBAAgB5M,GAElCvW,EADc,WACLunB,GAA6BD,IAAe,GAEzD,OAAItnB,IADe,kBACYA,GADZ,kBAET,IAEViM,GAAG0D,OAAOpC,EAAQvN,EAAQsS,GAC1BlO,GAAU,CAACmJ,EAAO6E,WAAa,GAAI/N,EAAakJ,EAAO6E,UAClD9N,EAASD,IAAe,EAAIA,EAAa,GAAkE,EAA7DE,GAAUC,EAAWH,EAAa,YAAa,eAAqB,KAAOI,GAAWJ,MAAiBA,IAAe,IAAM,cAAgB,EAAI,IAC/Ld,EAAOikB,GAAa,GAAKpjB,GAAQ,GACjCb,EAAOikB,EAAY,GAAK,GAAKpjB,GAAQ,GACrCmJ,EAAO6M,UAAuB,IAAXpa,GAA2B,IAAXsS,IACrC/E,EAAO6M,SAAW,MACb,GACP,MAAOv0B,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,GACDA,EAAEiuB,QAqZX,EAlZF,SAAmByC,EAAIsM,EAAKC,EAAQuE,GAClC,IACE,IAAI9Z,EAASiU,GAAS2B,gBAAgB5M,GAClCgQ,EAAM/E,GAASwB,SAASzV,EAAQsV,EAAKC,GAEzC,OADAvf,EAAO8jB,GAAQ,GAAKd,EACb,EACP,MAAO1gC,GAGP,MAFkB,qBAAPomB,IAAwBpmB,aAAaomB,GAAG0B,YACjDjK,EAAM7d,GACDA,EAAEiuB,QA0YX,OAAU7Q,EACV,EAxYF,SAAgBrT,GAEd,OADAA,GAAKA,IACO,GAAM4U,EAAW5U,EAAI,KAAQ6U,EAAU7U,EAAI,KAuYvD,EArYF,SAAiBA,GAEf,OADAA,GAAKA,IACO,GAAM4U,EAAW5U,EAAI,KAAQ6U,EAAU7U,EAAI,KAoYvD,EApGF,SAAqB63B,EAAGC,EAASC,EAAQC,GACvC,OA/PF,SAAmBH,EAAGC,EAASC,EAAQC,GACrC,IAAIC,EAAUtkB,EAAOqkB,EAAK,IAAM,GAC5BtD,EAAO,CACTwD,OAAQvkB,EAAOqkB,GAAM,GACrBG,OAAQxkB,EAAOqkB,EAAK,GAAK,GACzBI,QAASzkB,EAAOqkB,EAAK,GAAK,GAC1BK,QAAS1kB,EAAOqkB,EAAK,IAAM,GAC3BM,OAAQ3kB,EAAOqkB,EAAK,IAAM,GAC1BO,QAAS5kB,EAAOqkB,EAAK,IAAM,GAC3BQ,QAAS7kB,EAAOqkB,EAAK,IAAM,GAC3BS,QAAS9kB,EAAOqkB,EAAK,IAAM,GAC3BU,SAAU/kB,EAAOqkB,EAAK,IAAM,GAC5BW,UAAWhlB,EAAOqkB,EAAK,IAAM,GAC7BC,QAASA,EAAU/mB,EAAa+mB,GAAW,IAEzCW,EAAU1nB,EAAa6mB,GACvBc,EAAoB,CACtB,KAAM,uBACN,KAAM,WACN,KAAM,WACN,KAAM,KACN,KAAM,cACN,KAAM,QACN,KAAM,WACN,KAAM,WACN,KAAM,WACN,MAAO,KACP,MAAO,KACP,MAAO,WACP,MAAO,WACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,MAET,IAAK,IAAIC,KAAQD,EACfD,EAAUA,EAAQv4B,QAAQ,IAAI04B,OAAOD,EAAK,KAAMD,EAAkBC,IAEpE,IAAIE,EAAW,CAAC,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,YAC9EC,EAAS,CAAC,UAAW,WAAY,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,YAC5H,SAASC,EAAiBtgC,EAAOugC,EAAQC,GAEvC,IADA,IAAIljB,EAAuB,kBAAVtd,EAAqBA,EAAM+H,WAAa/H,GAAS,GAC3Dsd,EAAI1Y,OAAS27B,GAClBjjB,EAAMkjB,EAAU,GAAKljB,EAEvB,OAAOA,EAET,SAASmjB,EAAazgC,EAAOugC,GAC3B,OAAOD,EAAiBtgC,EAAOugC,EAAQ,KAEzC,SAASG,EAAaC,EAAOC,GAC3B,SAASC,EAAI7gC,GACX,OAAOA,EAAQ,GAAK,EAAIA,EAAQ,EAAI,EAAI,EAE1C,IAAI8gC,EAMJ,OALmE,KAA9DA,EAAUD,EAAIF,EAAMzE,cAAgB0E,EAAM1E,iBACgB,KAAxD4E,EAAUD,EAAIF,EAAMvE,WAAawE,EAAMxE,eAC1C0E,EAAUD,EAAIF,EAAMrE,UAAYsE,EAAMtE,YAGnCwE,EAET,SAASC,EAAsBC,GAC7B,OAAQA,EAAUC,UAChB,KAAK,EACH,OAAO,IAAI55B,KAAK25B,EAAU9E,cAAgB,EAAE,GAAG,IACjD,KAAK,EACH,OAAO8E,EACT,KAAK,EACH,OAAO,IAAI35B,KAAK25B,EAAU9E,cAAc,EAAE,GAC5C,KAAK,EACH,OAAO,IAAI70B,KAAK25B,EAAU9E,cAAc,EAAE,GAC5C,KAAK,EACH,OAAO,IAAI70B,KAAK25B,EAAU9E,cAAc,EAAE,GAC5C,KAAK,EACH,OAAO,IAAI70B,KAAK25B,EAAU9E,cAAgB,EAAE,GAAG,IACjD,KAAK,EACH,OAAO,IAAI70B,KAAK25B,EAAU9E,cAAgB,EAAE,GAAG,KAGrD,SAASgF,EAAiBpF,GACxB,IAAIqF,EAAWtF,GAAU,IAAIx0B,KAAKy0B,EAAK6D,QAAU,KAAK,EAAE,GAAI7D,EAAK+D,SAC7DuB,EAAoB,IAAI/5B,KAAK85B,EAASjF,cAAc,EAAE,GACtDmF,EAAoB,IAAIh6B,KAAK85B,EAASjF,cAAgB,EAAE,EAAE,GAC1DoF,EAAyBP,EAAsBK,GAC/CG,EAAyBR,EAAsBM,GACnD,OAAIX,EAAaY,EAAwBH,IAAa,EAChDT,EAAaa,EAAwBJ,IAAa,EAC7CA,EAASjF,cAAgB,EAEzBiF,EAASjF,cAGXiF,EAASjF,cAAgB,EAGpC,IAAIsF,EAAoB,CACtB,KAAM,SAAS1F,GACb,OAAOsE,EAAStE,EAAK8D,SAAS6B,UAAU,EAAG,IAE7C,KAAM,SAAS3F,GACb,OAAOsE,EAAStE,EAAK8D,UAEvB,KAAM,SAAS9D,GACb,OAAOuE,EAAOvE,EAAK4D,QAAQ+B,UAAU,EAAG,IAE1C,KAAM,SAAS3F,GACb,OAAOuE,EAAOvE,EAAK4D,SAErB,KAAM,SAAS5D,GAEb,OAAO2E,GADI3E,EAAK6D,QAAU,MACC,IAAM,EAAG,IAEtC,KAAM,SAAS7D,GACb,OAAO2E,EAAa3E,EAAK2D,QAAS,IAEpC,KAAM,SAAS3D,GACb,OAAOwE,EAAiBxE,EAAK2D,QAAS,EAAG,MAE3C,KAAM,SAAS3D,GACb,OAAOoF,EAAiBpF,GAAM/zB,WAAW05B,UAAU,IAErD,KAAM,SAAS3F,GACb,OAAOoF,EAAiBpF,IAE1B,KAAM,SAASA,GACb,OAAO2E,EAAa3E,EAAK0D,QAAS,IAEpC,KAAM,SAAS1D,GACb,IAAI4F,EAAa5F,EAAK0D,QAKtB,OAJkB,GAAdkC,EACFA,EAAa,GACNA,EAAa,KACpBA,GAAc,IACTjB,EAAaiB,EAAY,IAElC,KAAM,SAAS5F,GACb,OAAO2E,EAAa3E,EAAK2D,QAAUhE,GAAWF,GAAaO,EAAK6D,QAAU,MAAQhE,GAAoBC,GAAsBE,EAAK4D,OAAS,GAAI,IAEhJ,KAAM,SAAS5D,GACb,OAAO2E,EAAa3E,EAAK4D,OAAS,EAAG,IAEvC,KAAM,SAAS5D,GACb,OAAO2E,EAAa3E,EAAKyD,OAAQ,IAEnC,KAAM,WACJ,MAAO,MAET,KAAM,SAASzD,GACb,OAAIA,EAAK0D,SAAW,GAAK1D,EAAK0D,QAAU,GAC/B,KAEA,MAGX,KAAM,SAAS1D,GACb,OAAO2E,EAAa3E,EAAKwD,OAAQ,IAEnC,KAAM,WACJ,MAAO,MAET,KAAM,SAASxD,GACb,OAAOA,EAAK8D,SAAW,GAEzB,KAAM,SAAS9D,GACb,IAAI6F,EAAW,IAAIt6B,KAAKy0B,EAAK6D,QAAU,KAAK,EAAE,GAC1CiC,EAAoC,IAAtBD,EAASV,SAAiBU,EAAW9F,GAAU8F,EAAU,EAAIA,EAASV,UACpFY,EAAU,IAAIx6B,KAAKy0B,EAAK6D,QAAU,KAAK7D,EAAK4D,OAAO5D,EAAK2D,SAC5D,GAAIiB,EAAakB,EAAaC,GAAW,EAAG,CAC1C,IAAIC,EAA6BrG,GAAWF,GAAasG,EAAQ3F,eAAiBP,GAAoBC,GAAsBiG,EAAQzF,WAAa,GAAK,GAElJL,EAD6B,GAAK6F,EAAYtF,UACVwF,EAA6BD,EAAQvF,UAC7E,OAAOmE,EAAa74B,KAAKmY,KAAKgc,EAAO,GAAI,GAE3C,OAA+C,IAAxC2E,EAAakB,EAAaD,GAAkB,KAAO,MAE5D,KAAM,SAAS7F,GACb,IAWIiG,EAXAX,EAAoB,IAAI/5B,KAAKy0B,EAAK6D,QAAU,KAAK,EAAE,GACnD0B,EAAoB,IAAIh6B,KAAKy0B,EAAK6D,QAAU,KAAK,EAAE,GACnD2B,EAAyBP,EAAsBK,GAC/CG,EAAyBR,EAAsBM,GAC/CQ,EAAUhG,GAAU,IAAIx0B,KAAKy0B,EAAK6D,QAAU,KAAK,EAAE,GAAI7D,EAAK+D,SAChE,OAAIa,EAAamB,EAASP,GAA0B,EAC3C,KAELZ,EAAaa,EAAwBM,IAAY,EAC5C,MAIPE,EADET,EAAuBpF,cAAgBJ,EAAK6D,QAAU,KACvC7D,EAAK+D,QAAU,GAAKyB,EAAuBhF,UAE3CR,EAAK+D,QAAU,EAAIyB,EAAuBhF,UAEtDmE,EAAa74B,KAAKmY,KAAKgiB,EAAiB,GAAI,KAErD,KAAM,SAASjG,GACb,OAAOA,EAAK8D,SAEd,KAAM,SAAS9D,GACb,IAAI6F,EAAW,IAAIt6B,KAAKy0B,EAAK6D,QAAQ,EAAE,GACnCqC,EAAoC,IAAtBL,EAASV,SAAiBU,EAAW9F,GAAU8F,EAAgC,IAAtBA,EAASV,SAAiB,EAAI,EAAIU,EAASV,SAAW,GAC7HY,EAAU,IAAIx6B,KAAKy0B,EAAK6D,QAAU,KAAK7D,EAAK4D,OAAO5D,EAAK2D,SAC5D,GAAIiB,EAAasB,EAAaH,GAAW,EAAG,CAC1C,IAAIC,EAA6BrG,GAAWF,GAAasG,EAAQ3F,eAAiBP,GAAoBC,GAAsBiG,EAAQzF,WAAa,GAAK,GAElJL,EAD6B,GAAKiG,EAAY1F,UACVwF,EAA6BD,EAAQvF,UAC7E,OAAOmE,EAAa74B,KAAKmY,KAAKgc,EAAO,GAAI,GAE3C,OAA+C,IAAxC2E,EAAasB,EAAaL,GAAkB,KAAO,MAE5D,KAAM,SAAS7F,GACb,OAAQA,EAAK6D,QAAU,MAAM53B,WAAW05B,UAAU,IAEpD,KAAM,SAAS3F,GACb,OAAOA,EAAK6D,QAAU,MAExB,KAAM,SAAS7D,GACb,IAAImG,EAAMnG,EAAKiE,UACXmC,EAAQD,GAAO,EAGnB,OADAA,GADAA,EAAMr6B,KAAK6M,IAAIwtB,GAAO,IACV,GAAK,IAAMA,EAAM,IACrBC,EAAQ,IAAM,KAAOxkB,OAAO,OAASukB,GAAKn4B,OAAO,IAE3D,KAAM,SAASgyB,GACb,OAAOA,EAAKuD,SAEd,KAAM,WACJ,MAAO,MAGX,IAAK,IAAIa,KAAQsB,EACXxB,EAAQ11B,QAAQ41B,IAAS,IAC3BF,EAAUA,EAAQv4B,QAAQ,IAAI04B,OAAOD,EAAK,KAAMsB,EAAkBtB,GAAMpE,KAG5E,IAAIqG,EAAQnc,GAAmBga,GAAS,GACxC,OAAImC,EAAMv9B,OAASs6B,EACV,GAET1gB,EAAmB2jB,EAAOlD,GACnBkD,EAAMv9B,OAAS,GAGfw9B,CAAUnD,EAAGC,EAASC,EAAQC,IAoGrC,MAAS/iB,GAEPgmB,GA7wGJ,WACE,IAAI7+B,EAAO,CACT,EAAKy5B,IAEP,SAASqF,EAAgBC,EAAUC,GACjC,IAAIC,EAAUF,EAASE,QACvBjpB,EAAM,IAAUipB,EAChBriB,IAGF,SAASsiB,EAA0B9d,GACjC0d,EAAgB1d,EAAM,UAExB,SAAS+d,EAAuBC,GAC9B,OA/BGpoB,GAAgF,oBAAVqoB,MAYpE,IAAItiC,SAAQ,SAAS+iB,EAASwf,GAC/Bxf,EAAQzC,SAZLgiB,MAAMjiB,GAAgB,CAC3BmiB,YAAa,gBACZC,MAAK,SAAS1M,GACf,IAAKA,EAAQ,GACX,KAAM,uCAAyC1V,GAAiB,IAElE,OAAO0V,EAAQ,iBACd2M,OAAM,WACP,OAAOpiB,SAsBiBmiB,MAAK,SAASE,GACtC,OAAO9mB,YAAY+mB,YAAYD,EAAQ1/B,MACtCw/B,KAAKJ,GAAU,SAASQ,GACzBzoB,EAAI,0CAA4CyoB,GAChDloB,EAAMkoB,MAmBV,GA5BAjjB,IA4BI3G,EAAM,gBACR,IAEE,OADcA,EAAM,gBAAoBhW,EAAM8+B,GAE9C,MAAOjlC,GAEP,OADAsd,EAAI,sDAAwDtd,IACrD,EAIX,OA1BA,WACE,GAAKmd,GAA0D,oBAArC4B,YAAYinB,sBAAwC7iB,EAAUI,KAAoC,oBAAViiB,MAYhH,OAAOF,EAAuBD,GAX9BG,MAAMjiB,GAAgB,CACpBmiB,YAAa,gBACZC,MAAK,SAAS1M,GAEf,OADala,YAAYinB,qBAAqB/M,EAAU9yB,GAC1Cw/B,KAAKN,GAA2B,SAASU,GACrDzoB,EAAI,kCAAoCyoB,GACxCzoB,EAAI,6CACJgoB,EAAuBD,SAgB/BY,GACO,GA8tGCC,GACV/pB,EAAM,IAAU6oB,GAChB,IAwaImB,GAxaAhiB,GAAqBhI,EAAM,mBAAyB,WAClD,OAAQgI,GAAqBhI,EAAM,mBAAyBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG9Fwa,GAAQlkB,EAAM,MAAY,WACxB,OAAQkkB,GAAQlkB,EAAM,MAAYA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGpEiH,GAAU3Q,EAAM,QAAc,WAC5B,OAAQ2Q,GAAU3Q,EAAM,QAAcA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAmYxEugB,IAhYiBjqB,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGxE1J,EAAM,YAAkB,WACpC,OAAsBA,EAAM,YAAkBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG7D1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGxE1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGrE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG9E1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG5D1J,EAAM,cAAoB,WACxC,OAAwBA,EAAM,cAAoBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGjE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGvE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGvE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGvE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGpE1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG/E1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGnE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGxE1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG5E1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGzD1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGvE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG3E1J,EAAM,aAAmB,WACtC,OAAuBA,EAAM,aAAmBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG7D1J,EAAM,mBAAyB,WAClD,OAA6BA,EAAM,mBAAyBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG1E1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGnE1J,EAAM,uBAA6B,WAC1D,OAAiCA,EAAM,uBAA6BA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGtF1J,EAAM,cAAoB,WACxC,OAAwBA,EAAM,cAAoBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGvE1J,EAAM,WAAiB,WAClC,OAAqBA,EAAM,WAAiBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGzD1J,EAAM,mBAAyB,WAClD,OAA6BA,EAAM,mBAAyBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG7E1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGpE1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAG5D1J,EAAM,0BAAgC,WAChE,OAAoCA,EAAM,0BAAgCA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGjF1J,EAAM,yBAA+B,WAC9D,OAAmCA,EAAM,yBAA+BA,EAAM,IAAN,GAAoB2V,MAAM,KAAMjM,YAGpF1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG7E1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1D1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGpE1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG5E1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGpF1J,EAAM,aAAmB,WACtC,OAAuBA,EAAM,aAAmBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlE1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1E1J,EAAM,WAAiB,WAClC,OAAqBA,EAAM,WAAiBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG3D1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG3E1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGtE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGrE1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1E1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG7E1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9E1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGrE1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGhF1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnE1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG3E1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlE1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG/E1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9D1J,EAAM,6BAAmC,WACtE,OAAuCA,EAAM,6BAAmCA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG7F1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGxE1J,EAAM,uBAA6B,WAC1D,OAAiCA,EAAM,uBAA6BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9E1J,EAAM,uBAA6B,WAC1D,OAAiCA,EAAM,uBAA6BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9E1J,EAAM,uBAA6B,WAC1D,OAAiCA,EAAM,uBAA6BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGpF1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjE1J,EAAM,wBAA8B,WAC5D,OAAkCA,EAAM,wBAA8BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnF1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1E1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGtE1J,EAAM,2BAAiC,WAClE,OAAqCA,EAAM,2BAAiCA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,4BAAkC,WACpE,OAAsCA,EAAM,4BAAkCA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGtF1J,EAAM,yBAA+B,WAC9D,OAAmCA,EAAM,yBAA+BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGrF1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnF1J,EAAM,YAAkB,WACpC,OAAsBA,EAAM,YAAkBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlE1J,EAAM,aAAmB,WACtC,OAAuBA,EAAM,aAAmBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9D1J,EAAM,mBAAyB,WAClD,OAA6BA,EAAM,mBAAyBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9E1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlE1J,EAAM,mBAAyB,WAClD,OAA6BA,EAAM,mBAAyBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGxE1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGtF1J,EAAM,WAAiB,WAClC,OAAqBA,EAAM,WAAiBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnE1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGzD1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlE1J,EAAM,SAAe,WAC9B,OAAmBA,EAAM,SAAeA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGzD1J,EAAM,gBAAsB,WAC5C,OAA0BA,EAAM,gBAAsBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnE1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGtF1J,EAAM,SAAe,WAC9B,OAAmBA,EAAM,SAAeA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGrD1J,EAAM,oBAA0B,WACpD,OAA8BA,EAAM,oBAA0BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,cAAoB,WACxC,OAAwBA,EAAM,cAAoBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1E1J,EAAM,SAAe,WAC9B,OAAmBA,EAAM,SAAeA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGhE1J,EAAM,SAAe,WAC9B,OAAmBA,EAAM,SAAeA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGpD1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9E1J,EAAM,mBAAyB,WAClD,OAA6BA,EAAM,mBAAyBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG3E1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG5E1J,EAAM,eAAqB,WAC1C,OAAyBA,EAAM,eAAqBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG9D1J,EAAM,uBAA6B,WAC1D,OAAiCA,EAAM,uBAA6BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG7E1J,EAAM,wBAA8B,WAC5D,OAAkCA,EAAM,wBAA8BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGlF1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGpF1J,EAAM,aAAmB,WACtC,OAAuBA,EAAM,aAAmBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG5D1J,EAAM,qBAA2B,WACtD,OAA+BA,EAAM,qBAA2BA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGvF1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjE1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG1D1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGxE1J,EAAM,iBAAuB,WAC9C,OAA2BA,EAAM,iBAAuBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGvE1J,EAAM,kBAAwB,WAChD,OAA4BA,EAAM,kBAAwBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,UAAgB,WAChC,OAAQiqB,GAAYjqB,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,aAG7EwgB,GAAalqB,EAAM,WAAiB,WAClC,OAAQkqB,GAAalqB,EAAM,WAAiBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAG/EygB,GAAenqB,EAAM,aAAmB,WACtC,OAAQmqB,GAAenqB,EAAM,aAAmBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAyCvF,SAAS0gB,GAAIhH,GAQX,SAASiH,IACHL,KAEJA,IAAY,EACZhqB,EAAM,WAAgB,EAClB+C,IA10HD/C,EAAM,UAAiBiK,GAAGc,KAAKqG,aAClCnH,GAAGc,OACLF,GAAIE,OACJjF,EAAqBM,GAGrB6D,GAAGoH,mBAAoB,EACvBvL,EAAqBO,GAu0HfrG,EAAM,sBACRA,EAAM,uBAt0HZ,WACE,GAAIA,EAAM,QAGR,IAFgC,mBAArBA,EAAM,UACfA,EAAM,QAAc,CAACA,EAAM,UACtBA,EAAM,QAAY5U,QASPzH,EARHqc,EAAM,QAAY7G,QASnCmN,EAAchU,QAAQ3O,GADxB,IAAsBA,EALpBmiB,EAAqBQ,GA+zHnBgkB,KAlBFlH,EAAOA,GAAQ/iB,EACXmG,EAAkB,IA30HxB,WACE,GAAIxG,EAAM,OAGR,IAF+B,mBAApBA,EAAM,SACfA,EAAM,OAAa,CAACA,EAAM,SACrBA,EAAM,OAAW5U,QA2BPzH,EA1BHqc,EAAM,OAAW7G,QA2BjCgN,EAAa7T,QAAQ3O,GADvB,IAAqBA,EAvBnBmiB,EAAqBK,GAs0HrBokB,GACI/jB,EAAkB,IAelBxG,EAAM,WACRA,EAAM,UAAc,cACpB/Y,YAAW,WACTA,YAAW,WACT+Y,EAAM,UAAc,MACnB,GACHqqB,MACC,IAEHA,MAIJ,GAxEiBrqB,EAAM,WAAiB,WAClC,OAAqBA,EAAM,WAAiBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGnE1J,EAAM,UAAgB,WAChC,OAAoBA,EAAM,UAAgBA,EAAM,IAAN,IAAqB2V,MAAM,KAAMjM,YAGjF1J,EAAM,IAAU6oB,GAChB7oB,EAAM,MA5jIN,SAAewqB,EAAOC,EAAYC,EAAUtH,EAAMpR,GAChD,IAAI2Y,EAAM,CACR,OAAU,SAAS7mB,GACjB,IAAIxC,EAAM,EACV,GAAY,OAARwC,QAAwBT,IAARS,GAA6B,IAARA,EAAW,CAClD,IAAIiB,EAA0B,GAAnBjB,EAAI1Y,QAAU,GAEzBwZ,EAAad,EADbxC,EAAM4oB,GAAWnlB,GACMA,GAEzB,OAAOzD,GAET,MAAS,SAASiJ,GAChB,IAAIjJ,EAAM4oB,GAAW3f,EAAInf,QAEzB,OADA4Z,EAAmBuF,EAAKjJ,GACjBA,IAUPnc,EA7BN,SAAkBqlC,GAChB,IAAIrlC,EAAO6a,EAAO,IAAMwqB,GAExB,OADA1oB,EAAO3c,EAAM,gCAAkCqlC,EAAQ,8BAChDrlC,EA0BIylC,CAASJ,GAChBK,EAAQ,GACRhjB,EAAQ,EACZ,GAAIub,EACF,IAAK,IAAIj4B,EAAI,EAAGA,EAAIi4B,EAAKh4B,OAAQD,IAAK,CACpC,IAAI2/B,EAAYH,EAAID,EAASv/B,IACzB2/B,GACY,IAAVjjB,IACFA,EAAQoiB,MACVY,EAAM1/B,GAAK2/B,EAAU1H,EAAKj4B,KAE1B0/B,EAAM1/B,GAAKi4B,EAAKj4B,GAItB,IAAImW,EAAMnc,EAAKwwB,MAAM,KAAMkV,GAI3B,OAHAvpB,EAvBA,SAA4BA,GAC1B,MAAmB,WAAfmpB,EACK3rB,EAAawC,GACH,YAAfmpB,EACKM,QAAQzpB,GACVA,EAkBH0pB,CAAmB1pB,GACX,IAAVuG,GACFsiB,GAAatiB,GACRvG,GAkhITtB,EAAM,SAAe+B,EACrB/B,EAAM,SAxmIN,SAAkB5B,EAAK/U,EAAM2Y,GAI3B,OAFqC,OADrC3Y,EAAOA,GAAQ,MACN4Y,OAAO5Y,EAAK+B,OAAS,KAC5B/B,EAAO,OACDA,GACN,IAAK,KAEL,IAAK,KACH,OAAO6Y,EAAM9D,GAAO,GACtB,IAAK,MACH,OAAO+D,EAAO/D,GAAO,GACvB,IAAK,MAEL,IAAK,MACH,OAAOmD,EAAOnD,GAAO,GACvB,IAAK,QACH,OAAOsE,EAAQtE,GAAO,GACxB,IAAK,SACH,OAAOuE,EAAQvE,GAAO,GACxB,QACEsD,EAAM,8BAAgCrY,GAE1C,OAAO,MAmlIT2W,EAAM,SAhhIN,SAAkBirB,EAAMC,EAAOC,EAAW/sB,GACxC,IAAIgtB,EAAU/pB,EACM,kBAAT4pB,GACTG,GAAW,EACX/pB,EAAO4pB,IAEPG,GAAW,EACX/pB,EAAO4pB,EAAK7/B,QAEd,IACIkW,EADA+pB,EAA8B,kBAAVH,EAAqBA,EAAQ,KAOrD,GAJE5pB,EAba,GAYX6pB,EACI/sB,EAEA,CAACuS,GAASuZ,GAAY9oB,GAAc+pB,GAAW/8B,KAAK7E,IAAI8X,EAAMgqB,EAAa,EAAIH,EAAM9/B,SAEzFggC,EAAU,CACZ,IAAIxtB,EAIJ,IAHAQ,EAAMkD,EACNQ,EAAoB,IAAN,EAANR,IACR1D,EAAO0D,IAAc,EAAPD,GACPjD,EAAMR,EAAMQ,GAAO,EACxBmD,EAAOnD,GAAO,GAAK,EAGrB,IADAR,EAAO0D,EAAMD,EACNjD,EAAMR,GACXsE,EAAM9D,KAAS,GAAK,EAEtB,OAAOkD,EAET,GAAmB,OAAf+pB,EAMF,OALIJ,EAAKrnB,UAAYqnB,EAAK36B,MACxB4S,EAAOgC,IAAI+lB,EAAM3pB,GAEjB4B,EAAOgC,IAAI,IAAIM,WAAWylB,GAAO3pB,GAE5BA,EAGT,IADA,IAAWjY,EAAMiiC,EAAUC,EAAvBpgC,EAAI,EACDA,EAAIkW,GAAM,CACf,IAAI0f,EAAOkK,EAAK9/B,GAEH,KADb9B,EAAOgiC,GAAcH,EAAM//B,KAKf,OAAR9B,IACFA,EAAO,OACT0Y,EAAST,EAAMnW,EAAG41B,EAAM13B,GACpBkiC,IAAiBliC,IACnBiiC,EAAW3pB,EAAkBtY,GAC7BkiC,EAAeliC,GAEjB8B,GAAKmgC,GAVHngC,IAYJ,OAAOmW,GA09HTtB,EAAM,aAAmBlB,EACzBkB,EAAM,GAASiK,GACfjK,EAAM,aArhIa,EAuhInBA,EAAM,KAAW,SAAS7a,GACxB,GAAI6kC,GACF7kC,EAAK6a,OACA,CACL,IAAIwrB,EAAMxrB,EAAM,qBAChBA,EAAM,qBAA2B,WAC3BwrB,GACFA,IACFrmC,EAAK6a,IAGT,OAAOA,GAGT0G,EAAwB,SAAS+kB,IAC1BzB,IACHI,KACGJ,KACHtjB,EAAwB+kB,IAoC5BzrB,EAAM,IAAUoqB,GACZpqB,EAAM,QAGR,IAFgC,mBAArBA,EAAM,UACfA,EAAM,QAAc,CAACA,EAAM,UACtBA,EAAM,QAAY5U,OAAS,GAChC4U,EAAM,QAAY/G,KAAlB+G,GAMJ,OAFAoqB,KAEOrqB,IExsIJ2rB,E,oOAhJD,IAAI3kC,SAAQ,SAAC+iB,EAASwf,GAExB,IACI,EAAK9yB,SAAW,IAAIm1B,EAAS,CAEzBC,WAAY,SAACzkB,EAAM0kB,GACf,OAAI1kB,EAAK2kB,SAAS,UAAY3kB,EAAK2kB,SAAS,SAClC,GAAN,OAAU5wB,IAAV,YAAoCiM,GACjC0kB,EAAS1kB,GAEpB4kB,qBAAsB,SAACloC,GACnBS,QAAQmU,IAAI,uBAAwB5U,GACpCimB,OAqCV,MAAOjmB,GAEL,MAAMA,M,4IAOGmoC,EAAcl1B,EAAiBmF,EAAQlD,GAAW,IAC/DkzB,EAD8D,OAElEA,EAAa,IAAIzmB,WAAWvJ,GAG5B,IAAMiwB,EAAS,IAAIzwB,EAAUuwB,EAAcl1B,EAAiB3T,KAAKqT,UAAU,SAAA3S,GAAC,OAAI,EAAK4S,oBAAoB5S,MACzG,IACIqoC,EAAOC,SAASF,EAAYlzB,GAC9B,MAAOlV,GACL,MAAMA,EAMV,IAAMuoC,EAAYF,EAAOG,eAIzB,OAHAH,EAAOI,SAAS,GAChBJ,EAAOK,UAAU,YAAIr6B,MAAMk6B,IAAYtzB,MAAK,IAC5CozB,EAAOtuB,OACAsuB,I,0CAKSroC,GAChBS,QAAQmU,IAAI5U,K,6CAKOoY,EAAQlD,GAC3B,IAAIzC,EAAW,IAAIk2B,aACbN,EAAS/oC,KAAKspC,qBAAqBn2B,EAAUA,EAASjM,YAAa4R,EAAQlD,GACjF,OAAO5V,KAAKupC,uBAAuBR,EAAQnzB,K,6CAGxBmzB,EAAQnzB,GAC3B,IAAMlC,EAAWq1B,EAAOr1B,SACxBvS,QAAQmU,IAAI,WAAY5B,GAExB,IAEMtH,EAAiB,EAAAsH,EAASzL,OAFX,GA8BrB,MA1BiB,CACbjH,MAAO0S,EAAS1S,MAEhBiV,KAAMvC,EAASuC,KACfF,OAAQrC,EAASqC,OACjBG,OAAQxC,EAASwC,OACjBuF,UAAW/H,EAAS+H,UACpB+tB,QAAS,OACT5U,SAAS,IAAIlqB,MAAOC,UACpBb,aAbiB,GAcjBmC,eAbmB,IAenBw9B,UAAW,OACXpiC,SAAU,CACN,CACI,UAAa,uBACbqiC,QAAS9zB,IAGjB+zB,aAAc,CACV,KAAQ,CACJ,CAAC,KAAM,EAAGv9B,Q,mFAQAwJ,G,iIAAmB,G,SAClBswB,MAAMtwB,G,cAAvB+jB,E,gBACeA,EAASiQ,c,cAAxB9wB,E,OACF3F,EAAW,IAAIk2B,aACbN,EAAS/oC,KAAKspC,qBAAqBn2B,EAAUA,EAASjM,YAAa4R,EAAQlD,GAC3E1E,EAAWlR,KAAKupC,uBAAuBR,EAAQnzB,G,kBAC9C1E,G,+GCvHA24B,E,2JAvBqBpf,G,uFACH,IAAI7mB,SAAQ,SAAC+iB,EAASwf,GAC3C,IAAI2D,EAAS,IAAIC,WACjBD,EAAOE,WAAWvf,GAClBqf,EAAO7P,OAAU,SAACv5B,GACdimB,EAAQjmB,EAAEuF,OAAOyF,Y,cAJnBu+B,E,yBASCr5B,KAAKK,MAAMg5B,I,qLAIIzsB,G,2HAAc,G,SACb0oB,MAAM1oB,G,cAAvBmc,E,gBACiBA,EAASnpB,O,cAA1BU,E,yBACCA,G,yGClBTg5B,EAAiB,GACjBC,EAAe,GACfC,EAAc,CAChB,0BACA,mCACA,gCACA,yCACA,kCAEA,0BACA,iCACA,4B,SA4KWC,I,2EAAf,kCAAAzhC,EAAA,sDACU0hC,EAAoBC,eAAe9Y,IAAI,uBACvC+Y,EAAqB,6CAEvBC,EAAYH,EAAkBI,WAAWF,GAAoB,MAE7D3lC,OAAOihC,QAAU,GACjBjhC,OAAOghC,OAAS,CAACC,QAASjhC,OAAOihC,UAEjC2E,EAAYv4B,SAASC,cAAc,WAEzBw4B,UAAYF,EAAUE,UAAY,IAAIljB,OAAO,IAAI7jB,QAAJ,uCAAY,WAAO+iB,EAASwf,GAAhB,SAAAv9B,EAAA,sDAC/D6hC,EAAUxQ,OAAS,SAAAv5B,GACf+pC,EAAU3E,QAAUjhC,OAAOghC,OAAOC,eAC3BjhC,OAAOghC,cAAehhC,OAAOihC,QACpCnf,KAEJzU,SAAS04B,KAAKr4B,YAAYk4B,GANqC,2CAAZ,2DASlDziC,EAAE,EApBf,YAoBkBA,EAAEyiC,EAAUE,SAAS1iC,QApBvC,iCAqBcwiC,EAAUE,SAAS3iC,GArBjC,OAoB+CA,IApB/C,gDAsBWyiC,EAAU3E,SACT,WAAQ,MAAM,IAAItkC,MAAM,iCAAmCgpC,GAA3D,IAvBZ,6C,sBA0BeK,M,4FA9LP9W,GACA5yB,QAAQ0F,KAAKktB,K,iFAMOvW,G,6EAEjBA,EAAIpS,WAAW2Y,WAAW,c,uBACzB5iB,QAAQ2pC,KAAK,4B,SACQ9qC,KAAK+qC,yBAAyBvtB,G,cAA7C1E,E,OACN3X,QAAQ6pC,QAAQ,4B,kBACTlyB,G,uBAGYotB,MAAM1oB,G,cAAvBmc,E,iBACOA,EAASiQ,c,oLAGbqB,GAGT,MADe,8BAA0BA,EAA1B,uBAAkDb,EAAY5/B,KAAI,SAAA0gC,GAAC,MAAI,MAAMA,KAAGplB,KAAK,Q,wFAIzEqlB,G,sBAgCZC,E,sHAAf,WAAyB3gB,GAAzB,SAAA7hB,EAAA,sEACiB,IAAIhF,SAAQ,SAAC+iB,EAASwf,GAC/B1b,EAAK2gB,UAAL,uCAAe,WAAeptB,EAAKlF,GAApB,SAAAlQ,EAAA,0DACRoV,EADQ,sBACG,IAAIxc,MAAMwc,GADb,OAEX2I,EAAQ7N,GAFG,2CAAf,4DAFR,oF,uBAAesyB,E,4CA/BX7wB,EAAQ4wB,EAAW5wB,MAAM,+EACvB8wB,EAAY9wB,GAAS,CACvB+wB,SAAU/wB,EAAM,GAChB2gB,SAAU3gB,EAAM,IAGd0wB,EAAYI,EAAUC,SACtBC,EAAWF,EAAUnQ,SAASztB,OAAO,G,SAErBzN,KAAKwrC,WAAWP,G,OAAhCQ,E,OACEzjC,EAAE,E,aAAGA,EAAEyjC,EAAQ9P,MAAM1zB,Q,oBACnBwiB,EAAOghB,EAAQ9P,MAAM3zB,GACxBujC,IAAa9gB,EAAKzG,K,kCACJonB,EAAU3gB,G,qDAExB8gB,EAASxnB,WAAW0G,EAAKzG,M,oBAClB0nB,EAAkBH,EAAS99B,OAAOgd,EAAKzG,KAAK/b,QAC9C0jC,O,EACoC,qBAA9BzB,EAAezf,EAAKzG,MAC1B2nB,EAAgBzB,EAAezf,EAAKzG,OAEpC2nB,EAAgBP,EAAU3gB,GAC1Byf,EAAezf,EAAKzG,MAAQ2nB,KAE7BA,aAAyB/nC,S,kCACF+nC,E,QAAtBA,E,gCACS3rC,KAAK4rC,yBAAyBD,EAAeD,G,iDAhB7B1jC,I,8BAmB/B,IAAIxG,MAAM,2BAA6B+pC,G,gMAYlBI,EAAeJ,G,2FACtBvrC,KAAK6rC,sBAAsBF,G,OAAzChQ,E,OACE3zB,EAAE,E,YAAGA,EAAE2zB,EAAM1zB,Q,qBACXwiB,EAAOkR,EAAM3zB,IACXgc,OAASunB,E,yCACN9gB,EAAKrjB,M,OAHSY,I,6BAMvB,IAAIxG,MAAM,2BAA6B+pC,G,oLAIhCN,G,oGACUZ,I,UAAnByB,E,QAED3B,EAAac,G,qBACTd,EAAac,aAAsBrnC,S,gCAC5BumC,EAAac,G,gCAChBd,EAAac,I,cAGlBc,EAAY/rC,KAAKgsC,aAAaf,GAEhCgB,EAAS,IAAIH,EAEjB3B,EAAac,GAAa,IAAIrnC,SAAQ,SAAC+iB,EAASwf,GAC5C,EAAK7wB,IAAI,4BAA8By2B,GACvCE,EAAOjnC,IAAI+mC,GAAW,SAAUN,GAE5B9kB,EAAQ8kB,S,UAGgBtB,EAAac,G,eAA7Cd,EAAac,G,OACPQ,EAAUtB,EAAac,GAC7BjrC,KAAKsV,IAAI,uBAAyBm2B,EAAQS,U,kBACnCT,G,6LAGiBE,G,YAgDfQ,E,wEA9CS,UACdC,GAAY,EACD,QACA,cAJTC,EAAM,IAKR/nC,KAAK,IA0CA6nC,E,SAAYnoB,EAAK8M,EAAM1pB,GAC5BpH,KAAKgkB,KAAOA,EACZhkB,KAAK8wB,MAAQA,EACb9wB,KAAKoH,KAAOA,IA/CD,SAEmB,EAAK,OACjCklC,EAAW,IAAIjqB,WAAWspB,GAChCU,EAAI/nC,KAAK,IAAI6nC,EAAYI,oBAA2B,EAAMD,IAEvC,+CAEfE,EAAW,IAAIC,OAFA,gD,UAIN,IAAI7oC,SAAQ,SAAC+iB,EAASwf,GAC/BqG,EAAStS,QAAU/4B,QAAQwC,MAC3B6oC,EAASE,UAAY,SAAS13B,GAC1B,GAAIo3B,EAEA,OAsBJI,EAASG,YACTH,OAAWtsB,OACXksB,GAAY,GAtBY,IAApBp3B,EAAM5N,KAAKlB,MAEgB,IAApB8O,EAAM5N,KAAKlB,MAES,IAApB8O,EAAM5N,KAAKlB,OAClBygB,EAAQ3R,EAAM5N,KAAK4C,SACnBwiC,EAASG,cAGjB,IAAIC,EAAO,CAACP,EAAI,GAAGA,EAAI,IACnBpM,EAAO,CAAC,IAAM2M,EAAK,GAAG5oB,KAAM,aAChCwoB,EAASK,YAAY,CACjBj9B,GAAG,EACHk9B,OAAO,OACPvmB,UAAU0Z,EACV8M,YAlCU,UAmCVC,eAAgBJ,O,mJCnK1BK,EAASC,OAAO,gBAChBC,EAAWD,OAAO,kBAEXE,EAAb,WACI,WAAYpmC,GAAgB,IAAVgd,EAAS,uDAAJ,GAAI,oBACvBhkB,KAAKgkB,KAAOA,EACZhkB,KAAKgH,KAAOA,EACZhH,KAAKqtC,cAAgB,KACrBrtC,KAAKstC,gBAAkB,GAL/B,8DASsBC,GACdvtC,KAAKstC,gBAAgBC,KAV7B,2CAYyBA,GACjB,IAAMvlC,EAAIhI,KAAKstC,gBAAgB3/B,QAAQ4/B,IAC7B,IAAPvlC,GACChI,KAAKstC,gBAAgB7nB,OAAOzd,KAfxC,0BAmBQowB,EAAKoV,GAAO,IAAD,OACX,OAAOA,GACH,KAAKP,EAAQ,OAAO7U,EACpB,KAAK+U,EAAU,OAAOntC,KACtB,IAAK,UAAW,OAAO,SAACytC,EAAEC,EAAEhtC,GAAL,OAAW03B,EAAIzqB,QAAQ8/B,EAAEC,EAAEhtC,IAClD,IAAK,SAAU,OAAO,SAACitC,EAAQC,GAAT,2BAAyBC,EAAzB,iCAAyBA,EAAzB,yBAAuC,EAAKpoB,OAAL,QAAI,CAAQ2S,EAAK,EAAKpU,KAAKyD,OAAOkmB,GAASA,EAAQC,GAA/C,OAA+DC,KAChI,QACI,IAAM7pB,EAAOhkB,KAAKgkB,KAAKyD,OAAO+lB,GAC9B,MAAwB,kBAAdpV,EAAIoV,GACH,IAAIM,MAAM1V,EAAIoV,GAAO,IAAIJ,EAAeptC,KAAKgH,KAAMgd,IAEvDoU,EAAIoV,MA9B3B,0BAkCQpV,EAAKoV,EAAMnqC,GAGX,OAFA+0B,EAAIoV,GAAQnqC,EACZrD,KAAK+tC,YAAY,MAAO/tC,KAAKgkB,KAAKyD,OAAO+lB,GAAOnqC,IACzC,IArCf,qCAwCmB+0B,EAAKoV,GAKhB,OAJIA,KAAQpV,WACDA,EAAIoV,GACXxtC,KAAK+tC,YAAY,SAAU/tC,KAAKgkB,KAAKyD,OAAO+lB,MAEzC,IA7Cf,kCAgDgBV,EAAQ9oB,GAChBhkB,KAAKgH,KAAKgnC,mBAAmBlB,EAAQ9oB,GACrC,IAAI,IAAIhc,EAAE,EAAGA,EAAEhI,KAAKstC,gBAAgBrlC,OAAQD,IACxChI,KAAKstC,gBAAgBtlC,GAAG8kC,EAAQ9oB,KAnD5C,6BAyDWoU,EAAKpU,EAAM2pB,EAAQC,GACtB,IAAI7+B,MAAMC,QAAQopB,GACd,MAAM,IAAI52B,MAAJ,6DAAgEwiB,EAAK8B,KAAK,OAFnC,2BAAX+nB,EAAW,iCAAXA,EAAW,kBAIjDzV,EAAI3S,OAAJ,MAAA2S,EAAG,CAAQuV,EAAQC,GAAhB,OAAgCC,IACnC7tC,KAAK+tC,YAAL,MAAA/tC,KAAA,CAAiB,SAAUgkB,EAAM2pB,EAAQC,GAAzC,OAAyDC,OA9DjE,4CAsEgCI,GACxB,OAAOA,EAAYhB,IAAWgB,IAvEtC,wCA0E6BA,EAAaV,GACXU,EAAYd,GACpBe,kBAAkBX,OA5EzC,KAAaH,EAmEFH,OAASA,EAnEPG,EAoEFD,SAAWA,E,YC+EPgB,E,WAnJX,WAAYr/B,EAAiBhF,EAAcmC,GAAiB,oBACxDjM,KAAK2pC,aAAe76B,EACpB9O,KAAKiM,eAAiBA,EACtBjM,KAAK8J,aAAeA,EAEpB9J,KAAKouC,cAAgB,EACrBpuC,KAAKquC,cAAgB,EACrBruC,KAAKsuC,iBAAmB,EACxBtuC,KAAKuuC,gBAAkB,EACvBvuC,KAAKwuC,mBAAqB,EAC1BxuC,KAAKyuC,+BAAiC,EACtCzuC,KAAK0uC,iCAAmC,EACxC1uC,KAAK2uC,SAAW,EAChB3uC,KAAK4uC,eAAiB,E,4DAQtB,OAAO5uC,KAAKouC,cAAgBpuC,KAAK2pC,aAAa1hC,OAAS,I,qDAG5BgH,GAA6B,IAAhB5D,EAAe,uDAAN,KAC3CwjC,EAAqB5/B,EAAY4/B,mBACvC7uC,KAAKquC,cAAgBruC,KAAKyuC,+BAAiCI,EAC3D7uC,KAAKyuC,+BAAiCzuC,KAAKquC,cAE3C,IAAMS,EAAeD,EAAqB7uC,KAAK8J,cAAiB9J,KAAKiM,eAAiB,IACtFjM,KAAKuuC,gBAAkBvuC,KAAK0uC,iCAAmCI,EAC/D9uC,KAAK0uC,iCAAmC1uC,KAAKuuC,gBAE7C,IAAMlgC,EAAgBY,EAAYZ,eAAiB,EACnD,GAAGA,EAAe,CAEd,IAAM0gC,EAA0B/uC,KAAKquC,cAAgBhgC,EACjD0gC,EAA0B/uC,KAAKsuC,mBAC/BtuC,KAAKsuC,iBAAmBS,GAC5B,IAAMC,EAAuBhvC,KAAKuuC,gBAAmBlgC,EAAgBrO,KAAK8J,cAAiB9J,KAAKiM,eAAiB,IAC7G+iC,EAAuBhvC,KAAKwuC,qBAC5BxuC,KAAKwuC,mBAAqBQ,GAG/B3jC,GACCA,EAAS4D,GACbjP,KAAK4uC,mB,qCAKMj6B,GACX,IAAMvG,EAAkBpO,KAAK2pC,aAAah1B,GAC1C,OAAOxG,IAAYiB,eAAehB,K,2CAKlC,IAA2B,IAAvBpO,KAAKouC,aACL,MAAM,IAAI5sC,MAAM,iCACpB,OAAOxB,KAAKoP,eAAepP,KAAKouC,gB,wCAGJ,IAAhB/iC,EAAe,uDAAN,KACrB,GAAIrL,KAAKivC,gBACL,OAAO,KAEXjvC,KAAKouC,eACL,IAAIc,EAAqBlvC,KAAKkvC,qBAE9B,OADAlvC,KAAKmvC,+BAA+BD,EAAoB7jC,GACjD6jC,I,2CAGqD,IAA7CE,EAA4C,uDAAhC,KAAMC,EAA0B,uDAAN,KACrD,GAAGrvC,KAAKivC,gBACJ,OAAO,KAGX,IADA,IAAMngC,EAAkB,KACZ,CACR,IAAMG,EAAcjP,KAAKsvC,gBAAgBD,GAIzC,GAFAvgC,EAAgBxK,KAAK2K,GAElBjP,KAAKivC,gBACJ,MAGJ,IAAMK,EAAkBtvC,KAAKoP,eAAepP,KAAKouC,aAAe,GAGhE,GAAIkB,EAAgBT,mBAAqB,EAErC,MAWR,OAJGO,GACCA,EAAYtgC,GAChB9O,KAAK2uC,WACL3uC,KAAK4uC,iBACE9/B,I,kCAMC6F,GAAuB,IAAhBtJ,EAAe,uDAAN,KACxB,IAAKqT,OAAO6wB,UAAU56B,GAClB,MAAM,IAAInT,MAAM,sBACpB,MAAQxB,KAAKivC,mBACLt6B,GAAS3U,KAAKouC,eAEbpuC,KAAKsvC,gBAAgBjkC,Q,kCAM9B,IADsB,IAAhBA,EAAe,uDAAN,MACPrL,KAAKivC,iBACTjvC,KAAKsvC,gBAAgBjkC,K,qCAGdkjC,GACX,IAD4C,IAAhBljC,EAAe,uDAAN,MAC7BrL,KAAKivC,iBAAiB,CAC1B,IAAMK,EAAkBtvC,KAAKoP,eAAepP,KAAKouC,aAAe,GAC1DU,EAAeQ,EAAgBT,mBAAqB7uC,KAAK8J,cAAiB9J,KAAKiM,eAAiB,IACtG,GAAGjM,KAAKuuC,gBAAkBO,GAAeP,EACrC,MAEJvuC,KAAKsvC,gBAAgBjkC,M,0CAITgjC,GAChB,IAD+C,IAAhBhjC,EAAe,uDAAN,MAChCrL,KAAKivC,iBAAmBjvC,KAAKquC,eAAiBA,GAAe,CACjE,IAAMiB,EAAkBtvC,KAAKoP,eAAepP,KAAKouC,aAAe,GAChE,GAAGpuC,KAAKquC,cAAgBiB,EAAgBT,mBAAqBR,EACzD,MAEJruC,KAAKsvC,gBAAgBjkC,Q,KC9IZmkC,E,YACjB,WAAY1gC,EAAiB2gC,EAAmB3lC,EAAcmC,GAAiB,IAAD,EAE1E,GAF0E,oBAC1E,4CAAM6C,EAAiBhF,EAAcmC,KACjCwjC,EACA,MAAM,IAAIjuC,MAAM,6BAHsD,OAI1E,EAAKiuC,kBAAoBA,EAEzB,EAAKC,6BAA+B,EANsC,E,iGAU1E,OAAG1vC,KAAKivC,gBACG,KACOjvC,KAAKoP,eAAepP,KAAKouC,aAAe,GACvCS,mBAAqB7uC,KAAKyuC,iC,2DAa7C,IAAIkB,EAAoB3vC,KAAK4vC,oCAG7B,IAFGD,EAAoB3vC,KAAKquC,gBACxBsB,EAAoB3vC,KAAKquC,eACvBruC,KAAK0vC,8BAAgCC,GACvC3vC,KAAK0vC,8BAAgC1vC,KAAKyvC,oB,gDAI9C,IAAMC,EAA+B1vC,KAAK0vC,6BAE1C,GAAG1vC,KAAKivC,gBACJ,OAAOS,EAEX,IACMC,EADY3vC,KAAKoP,eAAepP,KAAKouC,aAAe,GACpBS,mBAAqB7uC,KAAKyuC,+BAEhE,OAAGkB,EAAoBD,EACZC,EACJD,I,oDAI8D,IAAD,OAA5CN,EAA4C,uDAAhC,KAAMC,EAA0B,uDAAN,KAIxDK,EAA+B1vC,KAAK0vC,6BACpCG,EAAQ,WACV,IAAMf,GAAgBY,EAA+B,EAAKrB,eAAiB,EAAKvkC,cAAiB,EAAKmC,eAAiB,IACvH,EAAKsiC,iBAAmBO,EACxB,EAAKT,cAAgBqB,EACrB,EAAKA,8BAAgC,EAAKD,kBAG1C,IAAMK,EAAM,GAMZ,OALGV,GACCA,EAAYU,GAEhB,EAAKnB,WACL,EAAKC,iBACEkB,GAGX,IAAI9vC,KAAKivC,gBAAiB,CAEtB,IAAMU,EAAoB3vC,KAAK4vC,oCAC/B,OACIF,EAA+BC,EAGxBE,KAGX7vC,KAAK+vC,qCAEE/vC,KAAKgwC,mBAAmBZ,EAAaC,IAIhD,OAAOQ,M,kCAiECl7B,GAAuB,IAAhBtJ,EAAe,uDAAN,KACxB,IAAKqT,OAAO6wB,UAAU56B,GAClB,MAAM,IAAInT,MAAM,sBACpB,KACQmT,IAAU3U,KAAKouC,eAEnBpuC,KAAKsvC,gBAAgBjkC,GAChBrL,KAAKiwC,4BAA4B,KAAM5kC,S,kCAMhD,IADsB,IAAhBA,EAAe,uDAAN,MACPrL,KAAKivC,iBACTjvC,KAAKiwC,4BAA4B,KAAM5kC,K,qCAGhCkjC,GACX,IAD4C,IAAhBljC,EAAe,uDAAN,KAC9BrL,KAAKuuC,gBAAkBA,GAC1BvuC,KAAKiwC,4BAA4B,KAAM5kC,K,0CAI3BgjC,GAChB,IAD+C,IAAhBhjC,EAAe,uDAAN,KACjCrL,KAAKquC,cAAgBA,GACxBruC,KAAKiwC,4BAA4B,KAAM5kC,O,GAhLO8iC,G,gBCkD3C+B,E,WApDX,aAA2C,IAA/BzoC,EAA8B,uDAAvB,GAAIohC,EAAmB,uDAAN,KAAM,oBACtC7oC,KAAKyH,OAASA,EACdzH,KAAK6oC,aAAeA,EACpB7oC,KAAKmwC,YAAc,KACnBnwC,KAAKowC,kB,gMAGkBlK,MAAMlmC,KAAKyH,OAAO+V,K,cAAnCmc,E,gBACeA,EAASiQ,c,OAAxB9wB,E,OACN9Y,KAAKmwC,YAAcnwC,KAAK6oC,aAAawH,gBAAgBv3B,G,0IAK3C5R,EAAaopC,EAAgBC,EAAWviC,EAAU7D,GAAyB,IAAfqmC,EAAc,uDAAN,KAE1EC,EAAevpC,EAAYtG,QAAQ8vC,aACvCD,EAAa75B,KAAKvT,MAAQ2C,WAAWmE,GAAY,KAAO,IACxDsmC,EAAa57B,QAAQ3N,GAIrB,IAAM5G,GAHN4G,EAAcupC,GAGa7vC,QAAQ+vC,qBACnCrwC,EAAOwY,OAAS9Y,KAAKmwC,YACU,qBAArBnwC,KAAKyH,OAAOmpC,OAClBtwC,EAAOswC,OAAS5wC,KAAKyH,OAAOmpC,MAChC,IAAMC,EAAeP,GAAkBtwC,KAAKyH,OAAOue,KAAOhmB,KAAK8wC,oBAAoB9wC,KAAKyH,OAAOue,MAAQ,KAqBvG,OApBA1lB,EAAOuwC,aAAaxtC,MAAQwtC,EACK,qBAAvB7wC,KAAKyH,OAAOspC,SAClBzwC,EAAOywC,OAAO1tC,MAAQrD,KAAKyH,OAAOspC,QAGtCzwC,EAAOuU,QAAQ3N,GACf5G,EAAO2U,MAAMs7B,GACbjwC,EAAOma,KAAK81B,EAAYviC,GACrBwiC,IACClwC,EAAOkwC,QAAUA,GAWdlwC,M,4BC2QA0wC,G,mBA3SX,WAAY/wC,GAAQ,IAAD,8BACf,4CAAMA,KACDmC,MAAQ,CACTC,MAAM,GAHK,E,uEAOP,OAAOrC,KAAKC,MAAM+G,O,oCACd,OAAOhH,KAAKC,MAAMgxC,W,wCACd,OAAOjxC,KAAKC,MAAMixC,e,sCACpB,OAAOlxC,KAAKC,MAAMkxC,a,+BAE1B,IAAD,OACCv5B,EAAS5X,KAAKoxC,gBAEdC,EAAaz5B,EAAO4F,IAAI1S,QAAQ,eAAgB,IAElDzK,EAAY,kCAIhB,OAHGL,KAAKoC,MAAMC,OACVhC,GAAa,SAGb,kBAAC,IAAD,CACIA,UAAWA,GAEX,kBAAC,IAAD,CACIW,MAAM,gBACNX,UAAU,OACVkB,SAAU,SAAAb,GAAC,OAAI,EAAK4wC,WAAW5wC,KAC9B2wC,GAAc,WAEjBrxC,KAAKoC,MAAMC,KACT,oCAC6B,qBAAjBuV,EAAO25B,MAAwB,KACnC,kBAAC,IAAD,CAASvwC,MAAM,aAAaX,UAAU,SAClC,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAK8wC,oBAAoB9wC,IAAIwC,UAAQ,EAACuuC,aAAa,GACzE75B,EAAO25B,MAAM,MAIA,qBAAlB35B,EAAOm5B,OAAyB,KACpC,kBAAC,IAAD,CAAS/vC,MAAK,oBAAe4W,EAAOm5B,OAAtB,UAAsC1wC,UAAU,UAC1D,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAKgxC,qBAAqBhxC,IAAIwC,UAAQ,EAACuuC,aAAa,GAC1E75B,EAAOm5B,OAAO,MAIH,qBAAhBn5B,EAAOoO,KAAuB,KAClC,kBAAC,IAAD,CAAShlB,MAAK,sBAAiB4W,EAAOoO,MAAQ3lB,UAAU,QACpD,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAKixC,sBAAsBjxC,IAAIwC,UAAQ,EAACuuC,aAAa,GAC3E75B,EAAOoO,OAIK,qBAAjBpO,EAAOg6B,MAAwB,KACnC,kBAAC,IAAD,CAAS5wC,MAAK,uBAAkB4W,EAAOg6B,OAASvxC,UAAU,SACtD,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAKmxC,uBAAuBnxC,IAAIwC,UAAQ,EAACuuC,aAAa,GAC5E75B,EAAOg6B,QAIK,qBAAjBh6B,EAAOk6B,MAAwB,KACnC,kBAAC,IAAD,CAAS9wC,MAAK,uBAAkB4W,EAAOk6B,OAASzxC,UAAU,SACtD,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAKqxC,uBAAuBrxC,IAAIwC,UAAQ,EAACuuC,aAAa,GAC5E75B,EAAOk6B,QAII,qBAAhBl6B,EAAOg5B,KAAuB,KAClC,kBAAC,IAAD,CAAS5vC,MAAM,cAAcX,UAAU,QACnC,kBAAC,IAAD,CAAYW,MAAM,GAAGO,SAAU,SAAAb,GAAC,OAAI,EAAKsxC,YAAYp6B,EAAOg5B,OAAOvrC,OAAO,EAAOnC,UAAQ,EAACuuC,aAAa,GAClG75B,EAAOg5B,KAAK,SAAI,YAxCjB,KA8CpB,kBAAC,IAAD,CAAS5vC,MAAK,uBAAkBqwC,EAAlB,KAAiChxC,UAAU,UACrD,kBAAC,IAAD,CAAYkB,SAAU,SAAAb,GAAC,OAAI,EAAKuxC,aAAavxC,IAAIwC,UAAQ,EAACuuC,aAAa,GACnE,kBAAC,IAAD,CAAUnxC,OAAO,gB,+BAQ5BI,EAAGyC,GACR,GAAkC,oBAAxBnD,KAAKC,MAAMwD,SAGjB,MAAM,IAAIjC,MAAM,4BAFhBxB,KAAKC,MAAMwD,SAAS/C,EAAGyC,K,mCAKlBzC,GAAI,IAAD,OACZV,KAAKyD,SAAS/C,EAAG,oCACb,kBAAC,IAAD,CAAgBa,SAAU,aAAQT,UAAQ,GAA1C,UAAmDd,KAAKC,MAAMgxC,UAC9D,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkBrqC,IAAI,QAAQrF,SAAU,SAAAb,GAAC,OAAI,EAAK8wC,oBAAoB9wC,KAAtE,cACA,kBAAC,IAAD,CAAkBkG,IAAI,SAASrF,SAAU,SAAAb,GAAC,OAAI,EAAKgxC,qBAAqBhxC,KAAxE,eACA,kBAAC,IAAD,CAAkBkG,IAAI,OAAOrF,SAAU,SAAAb,GAAC,OAAI,EAAKixC,sBAAsBjxC,KAAvE,iBACA,kBAAC,IAAD,CAAkBkG,IAAI,QAAQrF,SAAU,SAAAb,GAAC,OAAI,EAAKmxC,uBAAuBnxC,KAAzE,kBACA,kBAAC,IAAD,CAAkBkG,IAAI,QAAQrF,SAAU,SAAAb,GAAC,OAAI,EAAKqxC,uBAAuBrxC,KAAzE,kBACA,kBAAC,IAAD,CAAkBkG,IAAI,OAAOrF,SAAU,SAAAb,GAAC,OAAI,EAAKwxC,mBAAmBxxC,KAApE,eACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkBkG,IAAI,SAASrF,SAAU,SAAAb,GAAC,OAAI,EAAKyxC,qBAAqBzxC,KAAxE,iBACA,kBAAC,IAAD,CAAgBkG,IAAI,SAASrF,SAAU,SAAAb,GAAC,OAAI,EAAK0xC,WAAW,kBAA5D,qB,2CAIa1xC,GACjB,IAAMkX,EAAS5X,KAAKoxC,gBACpBpxC,KAAKyD,SAAS/C,EAAG,kBAAC,IAAD,CAAgByF,IAAK,EAAGC,IAAK,IAAK/C,MAAOuU,EAAO25B,W,0CAGjD7wC,GAAI,IAAD,OACbkX,EAAS5X,KAAKoxC,gBACpBpxC,KAAKyD,SAAS/C,EAAG,kBAAC,IAAD,CACbyF,IAAK,EACLC,IAAK,IACL/C,MAA+B,qBAAjBuU,EAAO25B,MAAwB35B,EAAO25B,MAAQ,IAC5D1rC,SAAU,SAACnF,EAAG0J,GAAJ,OAAmB,EAAKioC,YAAYjoC,S,2CAIjC1J,GAAI,IAAD,OACdkX,EAAS5X,KAAKoxC,gBACpBpxC,KAAKyD,SAAS/C,EAAG,kBAAC,IAAD,CACbyF,KAAM,IACNC,IAAK,IACL/C,MAAgC,qBAAlBuU,EAAOm5B,OAAyBn5B,EAAOm5B,OAAS,IAC9DlrC,SAAU,SAACnF,EAAG4xC,GAAJ,OAAoB,EAAKC,aAAaD,S,4CAKlC5xC,GAAI,IAAD,OACfqI,EAAS/I,KAAKwyC,UAAUzpC,OAC9B/I,KAAKyD,SAAS/C,EAAG,oCACb,kBAAC,IAAD,CAAgBa,SAAU,KAAMT,UAAQ,GAAxC,iBACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACnB,kBAAC,IAAD,CAAkBpI,SAAU,SAAAb,GAAC,OAAI,EAAK+C,SAAS/C,EAC3CqI,EAAOS,oBAAmB,SAACP,GAAD,OACtB,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAK+xC,WAAWxpC,EAASU,KAAcV,EAASU,SAEnFA,U,6CAIOjJ,GAAI,IAAD,OAChBqI,EAAS/I,KAAKwyC,UAAUzpC,OAC9B/I,KAAKyD,SAAS/C,EAAG,oCACb,kBAAC,IAAD,CAAgBa,SAAU,KAAMT,UAAQ,GAAxC,iBACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACnB,kBAAC,IAAD,CAAkBpI,SAAU,SAAAb,GAAC,OAAI,EAAK+C,SAAS/C,EAC3CqI,EAAOS,oBAAmB,SAACP,GAAD,OACtB,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAKgyC,YAAYzpC,EAASU,KAAcV,EAASU,SAEpFA,U,6CAIOjJ,GACnBV,KAAKyD,SAAS/C,K,yCAGCA,GACfV,KAAKyD,SAAS/C,K,mCAKQ,IAAD,OAAdiyC,EAAc,uDAAN,KAET5pC,EAAS/I,KAAKwyC,UAAUzpC,OAC9B,OAAO4pC,GACH,IAAK,aACL,IAAK,eACL,KAAK,KACD,OAEJ,IAAK,eACD,OAAO,qCAIX,IAAK,cACD,OAAO,oCAEH,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAgBpxC,SAAU,KAAMT,UAAQ,GAAxC,eAGR,IAAK,eACD,OAAO,oCAEH,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAgBS,SAAU,KAAMT,UAAQ,GAAxC,gBAGR,IAAK,aACD,OAAO,oCACH,kBAAC,IAAD,CAAgBS,SAAU,KAAMT,UAAQ,GAAxC,iBACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACvB,kBAAC,IAAD,CAAgBpI,SACZ,kBAAMwH,EAAOS,oBAAmB,SAACP,GAAD,OAC5B,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAK+xC,WAAWxpC,EAASU,KAAcV,EAASU,QAEpFA,OAGX,IAAK,cACD,OAAO,oCACH,kBAAC,IAAD,CAAgBpI,SAAU,KAAMT,UAAQ,GAAxC,kBACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACvB,kBAAC,IAAD,CAAgBpI,SACZ,kBAAMwH,EAAOS,oBAAmB,SAACP,GAAD,OAC5B,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAKgyC,YAAYzpC,EAASU,KAAcV,EAASU,QAErFA,OAGX,IAAK,cACD,OAAO,oCACH,kBAAC,IAAD,CAAgBpI,SAAU,KAAMT,UAAQ,GAAxC,kBACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAgBS,SAAU,SAAAb,GAAC,OAAI,EAAK0xC,WAAW,uBAA/C,mBACA,kBAAC,IAAD,CAAgB7wC,SAAU,SAAAb,GAAC,OAAI,EAAK0xC,WAAW,qBAA/C,kBAGR,IAAK,oBACD,OAAQ,oCACJ,kBAAC,IAAD,CAAgB7wC,SAAU,KAAMT,UAAQ,GAAxC,eACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACnB,kBAAC,IAAD,CAAgBpI,SACZ,kBAAMwH,EAAOS,oBAAmB,SAACP,GAAD,OAC5B,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAKkyC,YAAY3pC,EAASU,KAAcV,EAASU,QAErFA,OAGf,IAAK,kBACD,OAAQ,oCACJ,kBAAC,IAAD,CAAgBpI,SAAU,KAAMT,UAAQ,GAAxC,aACA,kBAAC,IAAD,MACCiI,EAAOW,gBAAe,SAACC,GAAD,OACnB,kBAAC,IAAD,CAAgBpI,SACZ,kBAAMwH,EAAOS,oBAAmB,SAACP,GAAD,OAC5B,kBAAC,IAAD,CAAgB1H,SAAU,SAAAb,GAAC,OAAI,EAAKkyC,YAAY,KAAM3pC,EAASU,KAAcV,EAASU,QAE3FA,OAKf,QACI,MAAM,IAAInI,MAAM,qBAAuBmxC,M,iCAMxCjyC,GACPV,KAAK6D,SAAS,CAACxB,MAAOrC,KAAKoC,MAAMC,S,kCAGzBwwC,GACR,IAAIn0B,OAAO6wB,UAAUsD,GACjB,MAAM,IAAIrxC,MAAM,oCAAsCqxC,GAC1D7yC,KAAKyH,OAAOqrC,QAAQ9yC,KAAK+yC,eAAexB,MAAQsB,I,mCAGvCG,GACT,IAAIt0B,OAAO6wB,UAAUyD,GACjB,MAAM,IAAIxxC,MAAM,qCAAuCwxC,GAC3DhzC,KAAKyH,OAAOqrC,QAAQ9yC,KAAK+yC,eAAehC,OAASiC,I,iCAG1CC,GACPjzC,KAAKyH,OAAOqrC,QAAQ9yC,KAAK+yC,eAAe/sB,KAAOitB,I,kCAGvCC,GACRlzC,KAAKyH,OAAOqrC,QAAQ9yC,KAAK+yC,eAAenB,MAAQsB,I,mCAGrB,IAApBC,EAAmB,uDAAN,KACA,OAAjBA,IACCA,GAAgBnzC,KAAKoxC,gBAAgBR,MACzC5wC,KAAKyH,OAAOqrC,QAAQ9yC,KAAK+yC,eAAenC,KAAOuC,EAAa,EAAE,M,yIChTrBjzC,IAAMC,aCNlCizC,E,WACjB,WAAYvK,GAAe,oBACvB7oC,KAAK6oC,aAAeA,E,oEAGArrB,GACpB,QAAS41B,EAAmBC,aAAa71B,K,mDAEhBA,GACzB,OAAO41B,EAAmBC,aAAa71B,K,uFAGbA,G,6EACvB41B,EAAmBC,aAAa71B,G,yCACxB41B,EAAmBC,aAAa71B,I,uBAGpB0oB,MAAM1oB,G,cAAvBmc,E,gBACiBA,EAASnpB,O,WAA1B8iC,E,QACQC,K,uBACJ,IAAI/xC,MAAM,8C,WACf8xC,EAASE,K,uBACJ,IAAIhyC,MAAM,8C,iCAEb4xC,EAAmBC,aAAa71B,GAAOxd,KAAK6oC,aAAa4K,mBAC5D,IAAIjxB,aAAa8wB,EAASC,MAC1B,IAAI/wB,aAAa8wB,EAASE,Q,+GA1BjBJ,EAmCVC,aAAe,G,IChCpBK,G,WACF,aAAwB,IAAZjsC,EAAW,uDAAJ,GAAI,oBAEnBzH,KAAKyH,OAASA,E,2DAKHksC,GACX,OAAO,O,oCAKGzsC,EAAagC,EAAWqnC,EAAWviC,EAAU7D,GAAyB,IAAfqmC,EAAc,uDAAN,KACnE3H,EAAe3hC,EAAYtG,QAC3BgzC,EAAa,IAAIR,EAAmBvK,GAwB1C,GAAgB,OAAb1+B,EAAmB,CAClB,IAAIsmC,EAAevpC,EAAYtG,QAAQ8vC,aACvCD,EAAa75B,KAAKvT,MAAQ2C,WAAWmE,GAAY,KAAO,IACxDsmC,EAAa57B,QAAQ3N,GACrBA,EAAcupC,EAGlB,IAAMoD,EAAM3sC,EAAYtG,QAAQkzC,mBAKhC,OAJAD,EAAI3qC,UAAU7F,MAAQ6F,EACY,qBAAvBlJ,KAAKyH,OAAOspC,SACnB8C,EAAI9C,OAAO1tC,MAAQrD,KAAKyH,OAAOspC,QAE5B/wC,KAAKyH,OAAOvB,MACf,QACI2tC,EAAI3tC,KAAOlG,KAAKyH,OAAOvB,KACvB,MAGJ,IAAK,SACD,IAAIlG,KAAKyH,OAAO+V,IACZ,MAAM,IAAIhc,MAAM,6BACjBoyC,EAAWG,wBAAwB/zC,KAAKyH,OAAO+V,KAC9Cq2B,EAAIG,gBAAgBJ,EAAWK,6BAA6Bj0C,KAAKyH,OAAO+V,MAExEo2B,EAAWM,wBAAwBl0C,KAAKyH,OAAO+V,KAC1C6oB,MAAK,SAAA8N,GAAY,OAAIN,EAAIG,gBAAgBG,MAK1DN,EAAIh/B,QAAQ3N,GACZ2sC,EAAI5+B,MAAMs7B,GACVsD,EAAIp5B,KAAK81B,EAAYviC,GAErB0lC,EAAqBU,YAAY9vC,KAAKuvC,GACtCA,EAAIrD,QAAU,WACV,IAAMxoC,EAAI0rC,EAAqBU,YAAYzmC,QAAQkmC,IACzC,IAAP7rC,GACC0rC,EAAqBU,YAAY3uB,OAAOzd,EAAG,GAC/CwoC,GAAWA,Q,sCAcf,IAAK,IAAIxoC,EAAI,EAAGA,EAAIhI,KAAKo0C,YAAYnsC,OAAQD,IACzC,IACIhI,KAAKo0C,YAAYpsC,GAAGyS,OACtB,MAAO/Z,GACLS,QAAQC,KAAKV,GAGrBV,KAAKo0C,YAAc,K,kCAOnBp0C,KAAKqzC,aAAe,O,KA3GtBK,GAwFKU,YAAc,GAxFnBV,GAwGKL,aAAe,GAQXK,U,iBC/GTW,G,mGAGE,OAAOr0C,KAAKqB,YAAYC,O,qCAIxB,MAAO,K,mCAKP,MAAO,K,sCAOKgzC,GAEZ,IADA,IAAMC,EAAUv0C,KAAKw0C,aACbxsC,EAAE,EAAGA,EAAEusC,EAAQtsC,OAAQD,IAAK,CAEhC,GAFgC,YACZusC,EAAQvsC,GADI,QAEfssC,EACb,OAAO,EAEf,OAAO,I,2CAMUG,GAAoC,IAAD,OAAnB3kC,EAAmB,uDAAN,KAC9C,OAAQ,oCACJ,kBAAC,KAAD,CAAkB3M,QAAS,kBAAM,EAAKuxC,qBAAqBD,EAAgB3kC,KAA3E,eACA,kBAAC,KAAD,MACA,kBAAC,KAAD,CAAkB3M,QAAS,kBAAM,EAAKwxC,4BAA4BF,EAAgB3kC,GAAc,KAAhG,mB,2CAIa2kC,GACjB,OAAQ,oCACH1tC,IAAcwD,wBAAwBC,KAAI,SAAC/C,EAAQO,GAAT,OACvC,kBAAC,KAAD,CAAgBpB,IAAKoB,EAAGzG,SAAU,SAAAb,GAAC,OAAI+zC,EAAehtC,EAAOpH,aAAaoH,EAAOzG,OAAS,oBAAsBgH,S,kDAKhGysC,GAAwD,IAAD,OAAvC3kC,EAAuC,uDAA1B,KAAM8kC,IAAoB,yDAC/E,OAAQ,oCAKkB,KACrBA,GAAiBP,EAAQQ,oBAAsB,kBAAC,KAAD,CAC5C/zC,SAA8D,IAApDuzC,EAAQQ,oBAAoBL,aAAavsC,OACnD9E,QAAS,kBAAMkxC,EAAQQ,oBAAoBC,yBAAyBL,EAAgB3kC,KAFxC,mBAI1B,KACtB,kBAAC,KAAD,CACIhP,SAAuC,IAA7Bd,KAAKw0C,aAAavsC,OAC5B9E,QAAS,kBAAM,EAAK2xC,yBAAyBL,EAAgB3kC,KAFjE,WAKA,kBAAC,KAAD,CACIhP,SAAyC,IAA/Bd,KAAK+0C,eAAe9sC,OAC9B9E,QAAS,kBAAM,EAAK6xC,0BAAyB,SAAAC,GAAO,OAChDA,EAAQN,4BAA4BF,EAAgB3kC,GAAc,KAChEA,KAJV,sB,qDAWuB2kC,GAAoC,IAApB3kC,EAAmB,uDAAN,KAExD,OAAQ,oCACJ,kBAAC,KAAD,CAAgBvO,SAAU,aAAQT,UAAQ,GAAEd,KAAKk1C,YACjD,kBAAC,KAAD,MACCl1C,KAAKw0C,aAAahqC,KAAI,WAA4BxC,GAAO,IAAD,mBAAhC3H,EAAgC,KAArB80C,EAAqB,KACrD,OAAwB,OAAjBrlC,GAAyBA,IAAiBzP,EAC3C,kBAAC,KAAD,CAAgBuG,IAAKoB,EAAGzG,SAAU,SAAAb,GAAC,OAAI+zC,EAAep0C,EAAW80C,KAAgBA,EAAan0C,OAAS,oBAAsBgH,GAC7H,W,+CAMOysC,GAAoC,IAApB3kC,EAAmB,uDAAN,KAClD,OAAQ,oCACJ,kBAAC,KAAD,CAAgBvO,SAAU,aAAQT,UAAQ,GAAEd,KAAKk1C,YACjD,kBAAC,KAAD,MACCl1C,KAAKw0C,aAAahqC,KAAI,WAA4BxC,GAAO,IAAD,mBAAhC3H,EAAgC,KAArB80C,EAAqB,KACrD,OAAwB,OAAjBrlC,GAAyBA,IAAiBzP,EAC3C,kBAAC,KAAD,CAAgBuG,IAAKoB,EAAGzG,SAAU,SAAAb,GAAC,OAAI+zC,EAAep0C,EAAW80C,KAAgBA,EAAan0C,OAAS,oBAAsBgH,GAC7H,W,+CAKOotC,GAA2C,wDAChE,OAAOp1C,KAAK+0C,eAAevqC,KAAI,SAACyqC,EAASjtC,GAGrC,OACI,kBAAC,KAAD,CAAkBpB,IAAKoB,IACL7E,QAAS,WAET,OADAkxC,EAAQQ,oBAAsBI,EACvBG,EAAuBH,KAE3CA,EAAQC,kB,8CAyDrB,OAAOvmC,OAAO5F,OAAOsrC,EAAQgB,OAAOptC,S,0CAGboD,GACvB,IAAMrB,EAAU,GAChB,IAAK,IAAIsrC,KAAYjB,EAAQgB,MACzB,GAAIhB,EAAQgB,MAAMt4B,eAAeu4B,GAAW,CACxC,IAAIC,EAAgBlB,EAAQgB,MAAMC,GAClC,GAAIC,aAAyB3xC,QACzB,SAEJ2xC,EAAcj0C,KAAOi0C,EAAcj0C,MAAQi0C,EAAc/3B,IAAI1Q,MAAM,KAAKgJ,MACxE,IAAMpK,EAASL,EAASkqC,GACxB,IAAe,IAAX7pC,EACA,MACW,OAAXA,GACA1B,EAAQ1F,KAAKoH,GAGzB,OAAO1B,I,oCAKP,OAAO,IAAIwrC,EADYnmC,EAAQ,KAA4BomC,W,2EAQtCj4B,G,4EAChBA,E,sBACK,IAAIhc,MAAM,e,uBACG0kC,MAAM1oB,G,cAAvBmc,E,gBACoBA,EAASnpB,O,aACJ,qBADzBklC,E,QACiBl4B,MACnBk4B,EAAYl4B,IAAMA,EAAIpS,YAC1BjK,QAAQmU,IAAI,UAAWogC,G,kBAChB,IAAIrB,EAAQqB,I,+KAGGl4B,G,0EACjBA,E,sBACK,IAAIhc,MAAM,e,UACpBgc,EAAM,IAAIm4B,IAAKn4B,EAAIpS,WAAY0B,MAAM,KAAK,GAAIoF,SAASgC,UAAU9I,WAG5DipC,EAAQgB,MAAM73B,KACf62B,EAAQgB,MAAM73B,GAAO,IAAI5Z,SAAQ,SAAC+iB,EAASwf,GACvC,IAAM1oB,EAAM,IAAIC,eAChBD,EAAIpb,KAAK,MAAOmb,EAAIpS,YAAY,GAChCqS,EAAIgc,aAAe,OACnBhc,EAAIwc,OAAS,WACT,GAAmB,MAAfxc,EAAIyb,OACJ,OAAOiN,EAAO,6BAA+B3oB,GAEjD,IAAMk4B,EAAcj4B,EAAIkc,SACxB+b,EAAYl4B,IAAMA,EAAIpS,WAEtBuD,OAAOC,KAAKylC,EAAQgB,OAAOpxC,SAAQ,SAAAqxC,GAC3B3mC,OAAO5F,OAAOsrC,EAAQgB,OAAS,UACxBhB,EAAQgB,MAAMC,MAE7BjB,EAAQgB,MAAM73B,GAAOk4B,EAErBv0C,QAAQ0F,KAAK,0BAA2B2W,EAAK62B,EAAQgB,OACrD1uB,EAAQ+uB,IAEZj4B,EAAIE,cAGZ+3B,EAAcrB,EAAQgB,MAAM73B,cACD5Z,S,gCACH8xC,E,OAApBA,E,uCACG,IAAIrB,EAAQqB,I,0GApPrBrB,GAsKKQ,oBAAsB,KAwFjCR,GAAQgB,MAAQ,GACDhB,UCjOAuB,G,iLA1BD,IAAD,OACDv1C,EAAY,sCACbL,KAAKoC,MAAMC,OACVhC,GAAa,SACjB,IAAIW,EAAQhB,KAAKk1C,WAGjB,OAAO,yBAAK70C,UAAWA,GACnB,yBACIA,UAAU,QACVW,MAAK,sBAAiBA,GACtBC,QAASjB,KAAKQ,GAAGS,SAEhBD,GAEJhB,KAAK61C,mBACN,kBAAC,IAAD,CACIxwC,OAAO,EACPhF,UAAU,SACV8C,QAAS,kBAAM,EAAK2yC,mBAEpB,kBAAC,IAAD,CAAUx1C,OAAO,iB,eCjB7B,WAAYL,GAAQ,IAAD,8BACf,4CAAMA,KACDmC,MAAQ,CACTC,MAAM,GAEV,EAAK7B,GAAK,CACNS,QAAS,SAAAP,GAAC,OAAI,EAAK4wC,eAEvB,EAAK2D,QAAUZ,GAAQ0B,cARR,E,gFAYAtzC,EAAWC,EAAWC,GACjC3C,KAAKC,MAAMwH,OAAOvB,OAClB/E,QAAQC,KAAK,6DACbpB,KAAKC,MAAMwH,OAAOvB,KAAO,c,iCAK7B,OAAOlG,KAAKC,MAAMwH,OAAOzG,OAClBhB,KAAKC,MAAMwH,OAAOvB,MAClB,gB,yCAIS,IAAD,OACf,IAAIlG,KAAKoC,MAAMC,KACX,MAAO,GACX,IAAMoF,EAASzH,KAAKC,MAAMwH,OAC1B,OAAQ,oCACJ,kBAAC,IAAD,CAAkBzG,MAAM,aACNX,UAAU,QACV8C,QAAS,kBAAM,EAAK6yC,yBACpB3wC,OAAO,EACPnC,UAAQ,GACG,qBAAjBuE,EAAO8pC,MAAwB9pC,EAAO8pC,MAAM,IAAM,QAE9D,kBAAC,IAAD,CAAkBvwC,MAAK,oBAAeyG,EAAOspC,OAAtB,UACL1wC,UAAU,SACV8C,QAAS,kBAAM,EAAK8yC,0BACpB5wC,OAAO,EACPnC,UAAQ,GACI,qBAAlBuE,EAAOspC,OAAyBtpC,EAAOspC,OAAO,IAAM,MAE/DtpC,EAAOue,KAAO,kBAAC,IAAD,CAAkBhlB,MAAK,sBAAiByG,EAAOue,MAC7B3lB,UAAU,OACV8C,QAAS,kBAAM,EAAK+yC,2BACpB7wC,OAAO,EACPnC,UAAQ,GACpCuE,EAAOue,KAAOve,EAAOue,KAAO,KACX,KACrBve,EAAOmqC,MAAQ,kBAAC,IAAD,CAAkB5wC,MAAK,uBAAkByG,EAAOmqC,OAC9BvxC,UAAU,QACV8C,QAAS,kBAAM,EAAKgzC,4BACpB9wC,OAAO,EACPnC,UAAQ,GACrCuE,EAAOmqC,MAAQnqC,EAAOmqC,MAAQ,KACb,KACrBnqC,EAAOqqC,MAAQ,kBAAC,IAAD,CAAkB9wC,MAAK,uBAAkByG,EAAOqqC,OAC9BzxC,UAAU,QACV8C,QAAS,kBAAM,EAAKizC,4BACpB/wC,OAAO,EACPnC,UAAQ,GACrCuE,EAAOqqC,MAAQrqC,EAAOqqC,MAAQ,KACb,KACtB,kBAAC,IAAD,CACQzxC,UAAU,OACVW,MAAM,cACNO,SAAU,SAAAb,GAAC,OAAI,EAAKsxC,YAAYvqC,EAAOmpC,OACvCvrC,OAAO,EACPnC,UAAQ,GACPuE,EAAOmpC,KAAK,SAAI,Q,mCAS7B5wC,KAAK6D,SAAS,CAACxB,MAAOrC,KAAKoC,MAAMC,S,kCAGzBwwC,GACR,IAAIn0B,OAAO6wB,UAAUsD,GACjB,MAAM,IAAIrxC,MAAM,oCAAsCqxC,GAC1D7yC,KAAKC,MAAMwH,OAAO8pC,MAAQsB,I,mCAGjBG,GACT,IAAIt0B,OAAO6wB,UAAUyD,GACjB,MAAM,IAAIxxC,MAAM,qCAAuCwxC,GAC3DhzC,KAAKC,MAAMwH,OAAOspC,OAASiC,I,iCAGpBC,GACPjzC,KAAKC,MAAMwH,OAAOue,KAAOitB,I,kCAGjBC,GACRlzC,KAAKC,MAAMwH,OAAOmqC,MAAQsB,I,uCAIbmD,GACE,WAAZA,WAEQr2C,KAAKC,MAAMwH,OAAO+V,WAClBxd,KAAKC,MAAMwH,OAAO8rC,YAClBvzC,KAAKC,MAAMwH,OAAO+rC,YAClBxzC,KAAKC,MAAMwH,OAAOzG,MACzBhB,KAAKC,MAAMwH,OAAOvB,KAAOmwC,K,mCAIF,IAApBlD,EAAmB,uDAAN,KACA,OAAjBA,IACCA,GAAgBnzC,KAAKC,MAAMwH,OAAOmpC,MACtC5wC,KAAKC,MAAMwH,OAAOmpC,KAAOuC,EAAa,EAAE,I,iCAGjCmD,GACPn1C,QAAQmU,IAAI,mBAAoBghC,GAChCA,EAAOpwC,KAAO,SACdyI,OAAOmD,OAAO9R,KAAKC,MAAMwH,OAAQ6uC,K,uCAKnB,IAAD,OACb,OAAQ,oCACJ,kBAAC,IAAD,CAAgB/0C,SAAU,aAAQT,UAAQ,GAA1C,eAAwDd,KAAKk1C,YAC7D,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkB/xC,QAAS,kBAAM,EAAKozC,+BAAtC,qBACA,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAkBpzC,QAAS,kBAAM,EAAK6yC,0BAAtC,cACA,kBAAC,IAAD,CAAkB7yC,QAAS,kBAAM,EAAK8yC,2BAAtC,eACA,kBAAC,IAAD,CAAkB9yC,QAAS,kBAAM,EAAK+yC,4BAAtC,iBACA,kBAAC,IAAD,CAAkB/yC,QAAS,kBAAM,EAAKgzC,6BAAtC,kBACA,kBAAC,IAAD,CAAkBhzC,QAAS,kBAAM,EAAKizC,6BAAtC,kBACA,kBAAC,IAAD,CAAkBjzC,QAAS,kBAAM,EAAKqzC,yBAAtC,eACA,kBAAC,IAAD,CAAgB11C,UAAWd,KAAKC,MAAMw2C,SAAUl1C,SAAU,SAACb,GAAD,OAAO,EAAKT,MAAMw2C,SAAS,EAAKx2C,MAAMixC,gBAAhG,wB,mDAIsB,IAAD,OACzB,OAAQ,oCACJ,kBAAC,IAAD,CAAkB/tC,QAAS,kBAAM,EAAKuzC,uCAAtC,YAEA,kBAAC,IAAD,MACC12C,KAAKi1C,QAAQN,6BAA4B,YAAgC,IAAD,mBAA7Bt0C,EAA6B,KAAlB80C,EAAkB,KACrE,EAAKwB,WAAWt2C,EAAW80C,S,2DAKD,IAAD,OACjC,OAAQ,oCACJ,kBAAC,IAAD,CAAgB5zC,SAAU,SAAAb,GAAC,OAAI,EAAKk2C,iBAAiB,UAArD,QACA,kBAAC,IAAD,CAAgBr1C,SAAU,SAAAb,GAAC,OAAI,EAAKk2C,iBAAiB,YAArD,UACA,kBAAC,IAAD,CAAgBr1C,SAAU,SAAAb,GAAC,OAAI,EAAKk2C,iBAAiB,cAArD,YACA,kBAAC,IAAD,CAAgBr1C,SAAU,SAAAb,GAAC,OAAI,EAAKk2C,iBAAiB,cAArD,e,8CAMiB,IAAD,OACdnvC,EAASzH,KAAKC,MAAMwH,OAC1B,OAAO,kBAAC,IAAD,CACHtB,IAAK,EACLC,IAAK,IACL/C,MAA+B,qBAAjBoE,EAAO8pC,MAAwB9pC,EAAO8pC,MAAQ,IAC5D1rC,SAAU,SAACnF,EAAG0J,GAAJ,OAAmB,EAAKioC,YAAYjoC,Q,+CAI5B,IAAD,OACf3C,EAASzH,KAAKC,MAAMwH,OAC1B,OAAS,kBAAC,IAAD,CACLtB,KAAM,IACNC,IAAK,IACL/C,MAAgC,qBAAlBoE,EAAOspC,OAAyBtpC,EAAOspC,OAAS,IAC9DlrC,SAAU,SAACnF,EAAG4xC,GAAJ,OAAoB,EAAKC,aAAaD,Q,gDAI7B,IAAD,OACtB,OAAOjqC,IAAOwuC,yBAAwB,SAAAC,GAClC,EAAKrE,WAAWqE,Q,iDAII,IAAD,OACvB,OAAOzuC,IAAOwuC,yBAAwB,SAAAC,GAClC,EAAKpE,YAAYoE,Q,iDAMrB,OAAQ,8C,6CAIR,OAAQ,gD,GA/M+B52C,IAAMC,YC0CtC42C,G,WAjDX,aAAwB,IAAZtvC,EAAW,uDAAJ,GAAI,oBACnBzH,KAAKyH,OAASA,E,sDAKRuvC,GACN,IAAIh3C,KAAKyH,OAAO2U,OAAO46B,GACnB,MAAM,IAAIx1C,MAAM,4BAA8Bw1C,GAFnC,kBAGuBh3C,KAAKyH,OAAO2U,OAAO46B,GAH1C,GAGRC,EAHQ,KAGQC,EAHR,KAKf,OAAO,IAAIC,EADqBpwC,IAAcQ,oBAAoB0vC,GAA7DzvC,cACiB0vC,K,oCAMZhwC,EAAagC,EAAWqnC,EAAWviC,GAC7C,IADqF,IAA9B7D,EAA6B,uDAApB,KAAMqmC,EAAc,uDAAN,KACrExoC,EAAI,EAAGA,EAAIhI,KAAKyH,OAAO2U,OAAOnU,OAAQD,IAAK,CAChD,IAAMovC,EAAQp3C,KAAKq3C,UAAUrvC,GAC7BovC,EAAME,cAAcpwC,EAAagC,EAAWqnC,EAAWviC,EAAU7D,EAAUqmC,M,qCAO/E,IAAK,IAAIxoC,EAAI,EAAGA,EAAIhI,KAAKyH,OAAO2U,OAAOnU,OAAQD,IAC3C,IACkBhI,KAAKq3C,UAAUrvC,GACvBF,eACR,MAAOpH,GACLS,QAAQC,KAAKV,M,8DC5BR62C,G,iLAEP,IAAD,OACCn7B,EAASpc,KAAKC,MAAMwH,OAAO2U,OAGjC,OACI,yBAAK/b,UAAU,iCACX,yBAAKA,UAAU,UACV+b,EAAO5R,KAAI,SAACgtC,EAAWR,GAAa,IAAD,cACJQ,EADI,GACzBn3C,EADyB,KACdoH,EADc,KAEVE,EAAYZ,IAAcQ,oBAAoBlH,GAA7DuH,cACP,OAAO,kBAACD,EAAD,CACH8uC,SAAU,EAAKj2C,GAAGi2C,SAClB7vC,IAAKowC,EACL9F,aAAc8F,EACdvvC,OAAQA,QAIpB,kBAAC,IAAD,CACIzG,MAAM,gBACNX,UAAU,YACVgF,OAAO,EACPlC,QAAS,kBAAM,EAAKs0C,uBAJxB,U,eChBZ,WAAYx3C,GAAQ,IAAD,8BACf,4CAAMA,KACDO,GAAK,CACNi2C,SAAU,SAACO,GAAD,OAAa,EAAKU,YAAYV,IACxCz1C,SAAU,SAACb,GAAD,OAAO,EAAKi3C,aAJX,E,uEAWT5jB,GAAW5yB,QAAQ0F,KAAK7G,KAAKqB,YAAYC,KAAM,YAAayyB,K,+BAC7DA,GAAW5yB,QAAQwC,MAAM3D,KAAKqB,YAAYC,KAAM,YAAayyB,K,iDAE3CijB,M,wEAIZY,G,8FAAqBC,I,iCAC3BD,E,sBACK,IAAIp2C,MAAJ,kC,YACMuF,IAAcQ,oBAAoBqwC,GAA3C52C,E,EAAAA,MACD82C,EAAmB,G,MAMN,IAAfD,E,sCAA8BhvC,KAAckvC,kBAAd,2BAAoD/2C,EAApD,qB,qDACxBg3C,EAAah4C,KAAKC,MAAMwH,OAAO2U,OAAOnU,OAC5CjI,KAAKC,MAAMwH,OAAO2U,OAAO47B,GAAc,CAACJ,EAAqBE,GAC7D93C,KAAKi4C,UAAL,sBAA8BL,EAA9B,4BAAqEI,I,wBAGrEh4C,KAAKk4C,SAAL,8BAAqCN,I,0IAKjCZ,EAASmB,M,kCAITnB,GACR,IAAM56B,EAASpc,KAAKC,MAAMwH,OAAO2U,OACjC,GAA8B,qBAApBA,EAAO46B,GACb,MAAM,IAAIx1C,MAAM,uBAAyBw1C,GAC7C56B,EAAOqJ,OAAOuxB,EAAS,K,2CAKL,IAAD,OACX/B,EAAUZ,GAAQ0B,cACxB,OAAQ,oCACJ,kBAAC,IAAD,CAAgBj1C,UAAQ,EAACgsC,OAAQ,cAAjC,4BACA,kBAAC,IAAD,MACCmI,EAAQmD,sBAAqB,YAAgC,IAAD,mBAA7B/3C,EAA6B,KAAlB80C,EAAkB,KACzD,EAAKwC,SAASt3C,EAAW80C,W,GA3DKj1C,IAAMC,YCRhDk4C,GAAgB,KAyOLC,G,WAvOX,aAAwB,IAAZ7wC,EAAW,uDAAJ,GAAI,oBACnBzH,KAAKyH,OAASA,EACO,OAAlB4wC,KACCA,GAAgB,IAAI9P,GACN3gB,O,oDAId1gB,M,wJAKAlH,KAAKu4C,aACCj7B,EAAMtd,KAAKyH,OAAOiiC,QAClB8O,EAAU,IAAI3N,EACpB7qC,KAAKu4C,WAAaC,EAAQC,kBAAkBn7B,GAC5Cnc,QAAQ0F,KAAK,0BAEd7G,KAAKu4C,sBAAsB30C,S,gCACH5D,KAAK04C,U,OAA5B14C,KAAK04C,U,uCACF14C,KAAKu4C,Y,mLAGIrxC,G,uFACKlH,KAAK24C,a,cAApB7/B,E,yBACCu/B,GAAc/O,qBAAqBpiC,EAAYtG,QAASsG,EAAa4R,EAAQ,OAAQ,CACxF5R,iB,2KAMG2hC,G,oEACP7oC,KAAK6oC,aAAeA,GAChB7oC,KAAKyH,OAAOiiC,Q,gCACN1pC,KAAK24C,a,OACfx3C,QAAQ0F,KAAK,4B,2KAONK,EAAa0xC,EAAgBrI,EAAWviC,EAAU7D,G,+FACjCnK,KAAK64C,cAAc3xC,G,UAArC4xC,E,OACN94C,KAAK+4C,WAAWz0C,KAAKw0C,GAEjBE,EAAc9xC,EAAYtG,QAAQo4C,eACtCzI,EAA0B,OAAdA,EAAqBA,EAAYyI,GAC9BA,G,wBACLC,EAAW1I,EAAYyI,E,UACvB,IAAIp1C,SAAQ,SAAC+iB,EAASwf,GAAV,OAAqBriC,WAAW6iB,EAAoB,IAAXsyB,M,WAI5D1I,EAAYyI,IACLE,EAAsC,KAA3BF,EAAczI,GAC/BuI,EAAUK,qBAAqBD,IAEnCJ,EAAUM,KAAKlyC,IAEZ8G,E,wBACOirC,EAAY1I,EAAYviC,EAAY9G,EAAYtG,QAAQo4C,Y,UACxD,IAAIp1C,SAAQ,SAAC+iB,EAASwf,GAAV,OAAqBriC,WAAW6iB,EAAoB,IAAXsyB,M,QAC3DH,EAAUO,Q,qJAKd,IAAI,IAAIrxC,EAAE,EAAGA,EAAEhI,KAAK+4C,WAAW9wC,OAAQD,IAEnChI,KAAK+4C,WAAW/wC,GAAGqxC,U,4CAMLC,GAClB,OAAO,O,0CAGSC,GAChB,IAAMlsC,EAAYrN,KAAKw5C,oBAAoBD,GAC3C,OAAO,IAAMtuC,KAAKqC,IAAI,GAAID,EAAY,IAAM,M,0CAG5BksC,GAChB,GAAI76B,OAAO66B,KAAaA,GAAWA,EAAU,IAAM,EAC/C,OAAOA,EACX,IAAKA,EACD,OAAO,KAEX,IAAME,EAAez5C,KAAK4L,gBACtBjC,EAA4B,IAAnB4vC,EAAQtxC,OAAesxC,EAAQz6B,OAAO,GAAKy6B,EAAQz6B,OAAO,GACnEzR,EAAYosC,EAAa9rC,QAAQ4rC,EAAQpsC,MAAM,GAAI,IAGvD,OAFmBE,EAAfA,EAAY,EAAeA,EAAY,GAAqB,IAAd1D,EAAS,GAAW,EACrD0D,EAA4B,IAAd1D,EAAS,GAAW,I,sCAMnD,MAAO,CAAC,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,U,KCiB5D+vC,G,YAvHX,aAAuB,IAAD,EAAVz5C,EAAU,uDAAJ,GAAI,2BAClBkB,QAAQmU,IAAIrV,IACZ,4CAAMA,KACDwH,OAASxH,EAAMwH,QAAU,GAC9B,EAAKrF,MAAQ,GAJK,E,2BADiBlC,IAAMC,WCYlCw5C,G,WAfX,aAA0C,wDAAC,IAApB9Q,EAAmB,uDAAN,KAAM,oBACtC7oC,KAAKyH,OAAS,GACdzH,KAAK6oC,aAAeA,E,0DAMV3hC,EAAagC,EAAWqnC,GAAwD,IAA7CviC,EAA4C,uDAAnC,KAAM7D,EAA6B,uDAApB,KAAoB,wDACzFhJ,QAAQ0F,KAAK,iBAAkBqC,EAAWqnC,EAAWviC,EAAU7D,EAAU,S,KCAlE,GAUK,WACZpD,IAAc6yC,gBAAgB,wBAAyB1J,EAAuBc,EAA+B,0BAC7GjqC,IAAc6yC,gBAAgB,uBAAwBlG,GAAsBkC,GAA8B,6BAC1G7uC,IAAc6yC,gBAAgB,sBAAuB7C,GAAqBQ,GAA6B,4BACvGxwC,IAAc6yC,gBAAgB,uBAAwBtB,GAAsBoB,GAA8B,mCAC1G3yC,IAAc6yC,gBAAgB,iBAAkBD,GAAgB,KAAM,oB,SCrBzDE,G,WACjB,WAAY7pC,EAAQ8pC,EAAmBC,EAAwBC,GAAqC,IAAfC,EAAc,uDAAN,KAEzF,GAF+F,oBAC/Fj6C,KAAKgQ,OAASA,GACThQ,KAAKgQ,OAAO8pC,GACb,MAAM,IAAIt4C,MAAM,8BAAgCs4C,GAEpD95C,KAAKi6C,QAAUA,GAAW,aAG1Bj6C,KAAKuuC,gBAAkB,EAEvBvuC,KAAKk6C,aAAe,GAGpBl6C,KAAK+5C,uBAAyBA,EAC9B/5C,KAAKg6C,qBAAuBA,EAE5B,IAAMG,EAAgB,CAGlBC,cAAe,EACf/wC,UAAWywC,GAIf95C,KAAKq6C,oBAAoBF,G,mEAGN9wC,GAAoD,IAAzCS,EAAwC,uDAA3B,KAAMmC,EAAqB,uDAAN,KAChE,IAAIjM,KAAKgQ,OAAO3G,GACZ,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,IAAMyF,EAAkB9O,KAAKgQ,OAAO3G,GAEpC,OAAO,IAAI8kC,EACPr/B,EACAhF,GAAgB9J,KAAKg6C,qBACrB/tC,GAAkBjM,KAAK+5C,0B,0CAKXO,GAGhB,OAFAA,EAAWC,SAAWv6C,KAAKw6C,uBAAuBF,EAAWjxC,UAAWixC,EAAWxwC,aAAcwwC,EAAWruC,gBAC5GjM,KAAKk6C,aAAa51C,KAAKg2C,GAChBA,I,6CAMP,IADA,IAAIG,EAAuB,EACnBzyC,EAAE,EAAGA,EAAEhI,KAAKk6C,aAAajyC,OAAQD,IAAK,CAAC,IAAD,EACRhI,KAAKk6C,aAAalyC,GAA7CuyC,EADmC,EACnCA,SACDhM,EAFoC,EACzB6L,cACuBG,EAAShM,gBAC7CA,EAAkBkM,IAClBA,EAAuBlM,GAE/B,OAAOkM,I,gDAKP,IADA,IAAIC,EAA0B,EACtB1yC,EAAE,EAAGA,EAAEhI,KAAKk6C,aAAajyC,OAAQD,IAAK,CAAC,IAAD,EACRhI,KAAKk6C,aAAalyC,GAA7CuyC,EADmC,EACnCA,SACD/L,EAFoC,EACzB4L,cAC0BG,EAAS/L,mBAChDA,EAAqBkM,IACrBA,EAA0BlM,GAElC,OAAOkM,I,sCAWP,IAAI,IAAI1yC,EAAE,EAAGA,EAAEhI,KAAKk6C,aAAajyC,OAAQD,IAAK,CAE1C,GADmBhI,KAAKk6C,aAAalyC,GAA9BuyC,SACKtL,gBACR,OAAO,EAEf,OAAO,I,8CAQahgC,EAAaqrC,GAGjC,IAAMK,EAAgB,CAIlBP,cAAeE,EAAWC,SAAShM,gBACnCllC,UAAW4F,EAAY2rC,eACvB3uC,eAAgBquC,EAAWruC,gBAGE,qBAAvBquC,EAAWO,SAA2BP,EAAWO,UACvDF,EAAcE,QAAUP,EAAWO,SACF,qBAA3BP,EAAWpzC,aAA+BozC,EAAWpzC,cAC3DyzC,EAAczzC,YAAcozC,EAAWpzC,aAE3ClH,KAAKq6C,oBAAoBM,K,gDAOH1rC,EAAaqrC,M,yCAIpBrrC,EAAaqrC,GAA4B,IAAhBjvC,EAAe,uDAAN,KAC9C4D,aAAuB6rC,WACtB96C,KAAK+6C,0BAA0B9rC,EAAaqrC,GACxCrrC,aAAuB+rC,WAC3Bh7C,KAAKi7C,wBAAwBhsC,EAAaqrC,GAC9CjvC,GAAYA,EAAS4D,EAAaqrC,K,kCAUlC,IAFoC,IAA9BjvC,EAA6B,uDAApB,KAAM6vC,EAAc,uDAAH,EAC5BC,EAAa,EAAGC,GAAW,GACxBA,GACHD,GAAgBD,EAChBE,EAAWp7C,KAAKq7C,eAAeF,EAAc9vC,K,qCAKtCkjC,GAEX,IAF4C,IAAD,OAAfljC,EAAe,uDAAN,KACjC+vC,GAAW,EAD4B,WAEnCpzC,GACJ,IAAMsyC,EAAa,EAAKJ,aAAalyC,GAC9BuyC,EAA2BD,EAA3BC,SAAUH,EAAiBE,EAAjBF,cACjB7L,GAAmB6L,EACfG,EAAStL,kBACTsL,EAASc,eAAe9M,GAAiB,SAACt/B,GACtC,EAAKqsC,mBAAmBrsC,EAAaqrC,EAAYjvC,MAEhDkvC,EAAStL,kBACVmM,GAAW,KATfpzC,EAAE,EAAGA,EAAEhI,KAAKk6C,aAAajyC,OAAQD,IAAM,EAAvCA,GAYR,OAAOozC,I,+CAGczmC,GAAuB,IAAhBtJ,EAAe,uDAAN,KAC/BivC,EAAat6C,KAAKk6C,aAAa,GAC/BK,EAAWv6C,KAAKw6C,uBAAuBF,EAAWjxC,UAAWixC,EAAWxwC,aAAcwwC,EAAWruC,gBACvGsuC,EAASgB,YAAY5mC,EAAOtJ,GAC5B,IAAM+uC,EAAgBG,EAAShM,gBAC/BvuC,KAAKq7C,eAAejB,EAAe/uC,O,cCpKtBmwC,G,YACjB,WAAYx0C,GAA+C,IAAD,EAAxC8yC,EAAwC,uDAApB,KAAMG,EAAc,uDAAN,KAAM,4BACtD,4CAAMjzC,EAAKI,KAAK4I,OACZ8pC,GAAqB9yC,EAAKy0C,oBAC1Bz0C,EAAKI,KAAK6E,eACVjF,EAAKI,KAAK0C,aACVmwC,KAECjzC,KAAOA,EACZ,EAAKk0C,WAAa,GAClB,EAAKQ,QAAS,EAEd,EAAKC,WAAa,IAAI/3C,SAAQ,SAAC+iB,EAASwf,GACpC,EAAKyV,WAAaj1B,KAGtB,EAAKk1B,6BAA+B,EAAKC,qBAAqB/4C,KAA1B,gBAfkB,E,iFAmBtCu3C,GAChB,4EAA0BA,GACtBA,EAAWyB,iBACXzB,EAAWyB,eAAiB,IAChC/7C,KAAKi6C,QAAQ,CACT/zC,KAAM,cACN81C,SAAUh8C,KACVs6C,iB,2CAIa2B,GACjB,IAAMC,EAAcl8C,KAAK67C,6BACzB77C,KAAK67C,6BAA+B,SAAS5sC,EAAaqrC,GAEtD,GADArrC,EAAcgtC,EAAehtC,EAAaqrC,GAC1C,CAEA,IAAIrrC,aAAuBd,IACvB,MAAM,IAAI3M,MAAM,uBACpB06C,EAAYjtC,EAAaqrC,O,2BAI5BpzC,GAAkC,IAAD,OAApBkzC,EAAoB,uDAAN,KAC5B,IAAKlzC,IAAgBA,EAAYtG,QAC7B,MAAM,IAAIY,MAAM,uBACpBxB,KAAK6oC,aAAe3hC,EAAYtG,QAChCZ,KAAKkH,YAAcA,EAEnBlH,KAAKuwC,UAAYvwC,KAAK6oC,aAAamQ,YAEnCh5C,KAAKm8C,aAAeC,aAAY,kBAAM,EAAKC,mBAAkBr8C,KAAKk7C,WAAa,IAE1D,OAAlBd,IACCp6C,KAAKq7C,eAAejB,GACpBp6C,KAAKuwC,WAAa6J,GAEtBp6C,KAAKq8C,mB,+CAIgBn1C,EAAayN,GAAuB,IAAhBtJ,EAAe,uDAAN,KAC5CivC,EAAat6C,KAAKk6C,aAAa,GAC/BK,EAAWv6C,KAAKw6C,uBAAuBF,EAAWjxC,UAAWixC,EAAWxwC,aAAcwwC,EAAWruC,gBACvGsuC,EAASgB,YAAY5mC,EAAOtJ,GAC5B,IAAM+uC,EAAgBG,EAAShM,gBAC/BvuC,KAAKo5C,KAAKlyC,EAAakzC,K,4CAMvB,OAAOp6C,KAAK6oC,aAAamQ,YAAch5C,KAAKuwC,Y,0KAS/BvwC,KAAK27C,W,qLAGJ,IAAD,OACPW,EAAyBt8C,KAAKu8C,sBAEpC,IAAIv8C,KAAK07C,QAAU17C,KAAKivC,gBAAiB,CACrCvrB,cAAc1jB,KAAKm8C,cACnB,IACMK,EADqBx8C,KAAKy8C,0BACcH,EAC9Cn7C,QAAQmU,IAAR,4BAAiCknC,EAAjC,aACGA,EAAmB,EAClB14C,YAAW,kBAAM,EAAKgE,iBAAmC,IAAnB00C,GAEtCx8C,KAAK8H,oBAET9H,KAAKq7C,eAAeiB,EAAyBt8C,KAAKk7C,WAAYl7C,KAAK67C,gC,qCAKpE77C,KAAK07C,SACJ17C,KAAK07C,QAAS,EACd17C,KAAK47C,gB,2CAKQ3sC,EAAaqrC,GAAa,IAAD,OAC1C,GAAiC,qBAAvBA,EAAWO,QACjB,OAAO15C,QAAQwC,MAAM,gCAAiC22C,EAAWjxC,WACrE,GAAG4F,aAAuBytC,UAAiB,CACvC,IAAMx1C,EAAcozC,EAAWpzC,aAAelH,KAAKkH,YAC7Cy1C,EAAgB38C,KAAKuwC,UAAY+J,EAAWF,cAAgBE,EAAWC,SAAShM,gBACtF,GAAGoO,EAAgB,EAAG,CAClB,IAAMC,EAAYtC,EAAWC,SAASnM,aAChC2N,EAAiBzB,EAAWyB,eAC5B9B,EAAUj6C,KAAKi6C,QACrBj6C,KAAKgH,KAAK61C,gBAAgB31C,EAAa+H,EAAaqrC,EAAWO,QAAS8B,GACpE,YAC8C,IAAvCZ,EAAepuC,QAAQivC,KACtBb,EAAez3C,KAAKs4C,GAGpB3C,EAAQ,CACJ/zC,KAAM,mBACN81C,SAAU,EACVD,iBACAzB,mBAIZ,WACIyB,EAAet2B,OAAOs2B,EAAepuC,QAAQivC,GAAY,GAEzD3C,EAAQ,CACJ/zC,KAAM,mBACN81C,SAAU,EACVD,iBACAzB,sB,gDAaErrC,EAAaqrC,GACnCrrC,EAAY8rC,0BAA0B/6C,KAAKgH,KAAMszC,O,GA1JdT,ICa3CiD,K,IAIMC,G,WACF,aAA0B,IAAD,OAAb7rC,EAAa,uDAAJ,GAAI,oBAErBlR,KAAKg9C,eAAiB,GACtBh9C,KAAKi9C,cAAgB,IAAIl2C,IAAc/G,MAEvCA,KAAKk9C,OAAS,KACdl9C,KAAKm9C,eAAiB,KACtBn9C,KAAKg8C,SAAW,KAEhB,IAAM50C,EAAO,CACTpG,MAAO+7C,EAAKK,gBACZhsC,KAAM/I,IAAOgJ,eACbm4B,QAAS,QACT5U,SAAS,IAAIlqB,MAAOC,UACpBb,aAAc,IACdmC,eAAgB,IAChBH,gBAAiB,EACjBuxC,WAAY,OACZh2C,SAAU,CACN,CAAC,sBAAuB,CACpB+U,OAAQ,CACJ,CAAC,uBAAwB,CACrBlW,KAAM,aAEV,CAAC,uBAAwB,CACrBA,KAAM,gBAIlB,CAAC,uBAAuB,CAACA,KAAM,YAEnC8J,OAAQ,CACJgW,KAAM,CACF,CAAC,UAAW,KACZ,CAAC,YAELs3B,OAAQ,CAEJ,CAAC,KAAM,GACP,CAAC,EAAG,KAAM,IACV,CAAC,GAAI,KAAM,IACX,CAAC,GAAI,KAAM,IACX,CAAC,GAAI,KAAM,IACX,CAAC,GAAI,KAAM,IACX,CAAC,GAAI,KAAM,KAEfC,OAAQ,CACJ,CAAC,KAAM,GACP,CAAC,GAAI,KAAM,IAGX,CAAC,GAAI,OAAQ,IAGb,CAAC,GAAI,KAAM,IAGX,CAAC,GAAI,OAAQ,IAGb,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,KAAM,IAGX,CAAC,GAAI,OAAQ,IAGb,CAAC,GAAI,KAAM,IAGX,CAAC,GAAI,OAAQ,IAGb,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,MAAO,IAGZ,CAAC,GAAI,KAAM,OAKvBv9C,KAAKw9C,eAAiB,WAAa,OAAOp2C,GAC1CpH,KAAKoH,KAAO,IAAI0mC,MAAM1mC,EAAM,IAAIgmC,EAAeptC,OAC/CA,KAAKy9C,QAAU,GACfz9C,KAAK+I,OAAS,IAAI4G,EAAW3P,MAE7BA,KAAK09C,aAAaxsC,GAClBlR,KAAK29C,iBAEL39C,KAAK49C,sBAAwB,SAAAl9C,GAAC,OAAI,EAAKm9C,cAAcn9C,I,oDAIjDwG,GACJlH,KAAKkH,YAAcA,I,oCAKTxG,GACV,IAAK,IAAIsH,EAAI,EAAGA,EAAIhI,KAAKg9C,eAAe/0C,OAAQD,IAAK,CAAC,IAAD,cACXhI,KAAKg9C,eAAeh1C,GADT,GAC1C81C,EAD0C,KAC/BC,EAD+B,KAE9Cr9C,EAAEY,OAASw8C,GAA2B,MAAdA,GACvBC,EAAiBr9C,M,uCAKZo9C,EAAWC,GACxB/9C,KAAKg9C,eAAe14C,KAAK,CAACw5C,EAAWC,M,0CAGrBD,EAAWC,GAC3B,IAAK,IAAI/1C,EAAI,EAAGA,EAAIhI,KAAKg9C,eAAe/0C,OAAQD,IAAK,CAAC,IAAD,cACThI,KAAKg9C,eAAeh1C,GADX,GAC1Cg2C,EAD0C,KAC9BC,EAD8B,KAEjD,GAAGH,IAAcE,GAAcD,IAAqBE,EAAmB,CACnEj+C,KAAKg9C,eAAev3B,OAAOzd,EAAG,GAC9B,U,kCAMRhI,KAAKi9C,cAAciB,oBACnBl+C,KAAKg9C,eAAiB,K,mCAOb9rC,GACT,IAAM9J,EAAOpH,KAAKw9C,iBAUlB,GARIx9C,KAAKg8C,UACLh8C,KAAK8H,eACT6G,OAAOmD,OAAO1K,EAAM8J,GAGpBlR,KAAKm+C,iBAAmB,GAGpB/2C,EAAK4I,OACL,MAAM,IAAIxO,MAAM,gCACpB2M,IAAYiwC,yBAAyBh3C,EAAK4I,QAM1ChQ,KAAK69C,cAAc,CACf33C,KAAM,cACNc,KAAMhH,S,sCAKEmR,GACZnR,KAAKy9C,QAAUtsC,I,0CAOf,MAAuC,qBAAzBnR,KAAKoH,KAAKi2C,WAClBr9C,KAAKoH,KAAKi2C,WACV1uC,OAAOC,KAAK5O,KAAKoH,KAAK4I,QAAQ,K,+BAG/B3G,GACL,MAA8C,qBAAhCrJ,KAAKoH,KAAK4I,OAAO3G,K,qDAM/B,IAF+C,IAAtBA,EAAqB,uDAAT,QAC/B2G,EAAShQ,KAAKoH,KAAK4I,OAChBhI,EAAI,EAAGA,GAAK,IAAKA,IAAK,CAC3B,IAAMq2C,EAAmBh1C,EAAYrB,EACrC,IAAKgI,EAAO+M,eAAeshC,GACvB,OAAOA,EAEf,MAAM,IAAI78C,MAAM,mC,iCAQTyF,GACP,QAASjH,KAAKoH,KAAKC,SAASJ,K,kCAGpBC,EAAa2zC,EAASpvC,EAAekxC,GAAkF,IAAnE2B,EAAkE,uDAArD,KAAMC,EAA+C,uDAAlC,KAAMC,EAA4B,uDAApB,KAAMhO,EAAc,uDAAN,KAUxH,GAAe,OAAZgO,EAAkB,CACjB,IAAIxF,EAAc9xC,EAAYtG,QAAQo4C,YACtCl1C,WAAW06C,EAAyC,KAA/B7B,EAAgB3D,IAIzC,MAF4B,kBAAlBvtC,IACNA,EAAgBpD,IAAOo2C,qBAAqBhzC,IACzCovC,EAAQvD,cAAcpwC,EAAauE,EAAekxC,EAAe2B,EAAcC,EAAc/N,K,qCAGzFvpC,GAAqB,OAAOjH,KAAKi9C,cAAc31C,QAAQL,K,0CAClDA,GAAgB,OAAOjH,KAAKi9C,cAAcz2C,aAAaS,K,sCAC3DA,GAAoB,OAAOjH,KAAKi9C,cAAcyB,SAASz3C,K,uCACtDA,GAAmB,OAAOjH,KAAKi9C,cAAc0B,UAAU13C,K,kCAM5DoE,GACR,OAAOrL,KAAKoH,KAAKC,SAASmD,KAAI,SAASgH,EAAOvK,GAAY,IAAD,cACzBuK,EADyB,GAC9CnR,EAD8C,KACnCoH,EADmC,KAErD,OAAO4D,EAASpE,EAAW5G,EAAWoH,Q,uCAO1C,IADA,IAAMoI,EAAc7P,KAAKoH,KAAKC,SACrBJ,EAAY,EAAGA,EAAY4I,EAAY5H,OAAQhB,IAChD4I,EAAY5I,IACZjH,KAAK4+C,0BAA0B33C,K,gDAOjBA,GACtB,OAAOjH,KAAKi9C,cAAc91C,mBAAmBF,K,0CAS7BA,GAChB,OAAOjH,KAAKi9C,cAAc4B,oBAAoB53C,K,iCAIvCQ,GACP,GAAsB,kBAAXA,EACP,MAAM,IAAIjG,MAAM,kCACpB,IAAKiG,EAAOpH,UACR,MAAM,IAAImB,MAAM,yBAEpB,IACMyF,EADcjH,KAAKoH,KAAKC,SACAY,OAU9B,OARAjI,KAAKoH,KAAKC,SAASJ,GAAaQ,EAChCzH,KAAK4+C,0BAA0B33C,GAOxBA,I,qCAGIA,EAAWqtC,GAAqC,IAAnBwK,EAAkB,uDAAJ,GAKhDC,EAAY/+C,KAAKoH,KAAKC,SAASJ,GAUrC,OATAjH,KAAKoH,KAAKC,SAASJ,GAAa,CAACqtC,EAAkBwK,GACnD9+C,KAAK4+C,0BAA0B33C,GAQxB83C,I,oCAGG93C,EAAWkxC,GACNn4C,KAAKg/C,iBAAiB/3C,GAC9BjG,MAAQm3C,I,oCAGLlxC,GACV,IAAM4I,EAAc7P,KAAKoH,KAAKC,SAC9B,IAAKwI,EAAY5I,GACb,OAAO9F,QAAQwC,MAAM,wBAA0BsD,GACnD,IAAMg4C,EAAgBh4C,IAAc4I,EAAY5H,OAAS,EAEnD82C,EAAYlvC,EAAY5I,GAa9B,OAZGg4C,SACQpvC,EAAY5I,GAEnB4I,EAAY5I,GAAa,KAStB83C,I,yCAQQ11C,EAAW4F,GAI1B,GAHIA,aAAuBd,MACvBc,EAAcA,EAAY7H,OAE1BpH,KAAKoH,KAAK4I,OAAO3G,GACjB,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,IAAIyF,EAAkB9O,KAAKoH,KAAK4I,OAAO3G,GAEvC4F,EAAcm+B,EAAe8R,qBAAqBjwC,GAGlD,IAAM4W,EAAI/W,EAAgBnB,QAAQsB,GAClC,IAAW,IAAP4W,EACA,MAAM,IAAIrkB,MAAM,6CACpB,OAAOqkB,I,yCAGQxc,GACf,IAAIrJ,KAAKoH,KAAK4I,OAAO3G,GACjB,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,OAAOrJ,KAAKoH,KAAK4I,OAAO3G,K,4CAGNA,EAAWsL,GAC7B,IAAI3U,KAAKoH,KAAK4I,OAAO3G,GACjB,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,IAAIyF,EAAkB9O,KAAKm/C,mBAAmB91C,GAC9C,GAAGsL,EAAQ,GAAKA,EAAQ7F,EAAgB7G,OACpC,MAAM,IAAIzG,MAAM,0BAA4BmT,GAChD,IAAI7F,EAAgB6F,GAChB,MAAM,IAAInT,MAAM,8BAAgCmT,GACpD,OAAOxG,IAAYiB,eAAeN,EAAgB6F,M,6CAI/BtL,GAAoD,IAAzCS,EAAwC,uDAA3B,KAAMmC,EAAqB,uDAAN,KAChE,IAAIjM,KAAKoH,KAAK4I,OAAO3G,GACjB,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,IAAMyF,EAAkB9O,KAAKoH,KAAK4I,OAAO3G,GAEzC,OAAO,IAAI8kC,EACPr/B,EACAhF,GAAgB9J,KAAKoH,KAAK0C,aAC1BmC,GAAkBjM,KAAKoH,KAAK6E,kB,sDAIJ5C,EAAWomC,GAA4D,IAAzC3lC,EAAwC,uDAA3B,KAAMmC,EAAqB,uDAAN,KAC5F,IAAIjM,KAAKoH,KAAK4I,OAAO3G,GACjB,MAAM,IAAI7H,MAAM,8BAAgC6H,GACpD,IAAMyF,EAAkB9O,KAAKoH,KAAK4I,OAAO3G,GAEzC,OAAO,IAAImmC,EACP1gC,EACA2gC,EACA3lC,GAAgB9J,KAAKoH,KAAK0C,aAC1BmC,GAAkBjM,KAAKoH,KAAK6E,kB,kDAQR5C,EAAW+1C,EAAuBC,GAI1D,GAHqC,kBAA1BD,IACPA,EAAwB/2C,IAAO4H,qBAAqBmvC,EAAuBp/C,KAAKoH,KAAK0C,gBAEpF4U,OAAO6wB,UAAU6P,GAClB,MAAM,IAAI59C,MAAM,2BAA6B49C,GACjD,IAAKC,EACD,MAAM,IAAI79C,MAAM,8BAQpB,IAPA,IAAM89C,EAAoBnxC,IAAYe,iBAAiBmwC,GACnDvwC,EAAkB9O,KAAKoH,KAAK4I,OAAO3G,GAGjCkxC,EAAWv6C,KAAKw6C,uBAAuBnxC,GAEzC4F,EAAcsrC,EAASjL,kBACpBrgC,GAAa,CAEhB,IAAMswC,EAAyBhF,EAASlM,cACxC,GAAIkR,EAAyBH,EAAuB,CAEhD,IAAMI,EAAgB,CAClBJ,GAAyBG,EAAyBtwC,EAAY4/B,oBAC9D0Q,EAAyBH,GAGvBK,EAAclF,EAASnM,aAQ7B,OANApuC,KAAK0/C,gCAAgCr2C,EAAWo2C,EAAaD,EAAc,IAG3EF,EAAkBzQ,mBAAqB2Q,EAAc,GACrDx/C,KAAK2/C,yBAAyBt2C,EAAWo2C,EAAaH,GAE/CG,EAEJ,GAAIF,IAA2BH,EAAuB,CAGzD,IAAIQ,OAAe,EAEnB,IAAKA,EAAkBrF,EAASnM,aAAe,EAAGwR,EAAkB9wC,EAAgB7G,UAC5E,IAAIkG,IAAYW,EAAgB8wC,IAAkB/Q,mBAAqB,GADa+Q,KAM5F,OAFAN,EAAkBzQ,mBAAqB,EACvC7uC,KAAK2/C,yBAAyBt2C,EAAWu2C,EAAiBN,GACnDM,EAOX3wC,EAAcsrC,EAASjL,kBAG3B,GAAIiL,EAASlM,eAAiB+Q,EAC1B,MAAM,IAAI59C,MAAM,wBAEpB,IAAIq+C,EAAiB/wC,EAAgB7G,OAQrC,OAFAq3C,EAAkBzQ,mBAAqBuQ,EAAwB7E,EAASlM,cACxEruC,KAAK2/C,yBAAyBt2C,EAAWw2C,EAAgBP,GAClDO,I,+CAIcx2C,EAAWy2C,EAAaT,GAC7C,IAAKA,EACD,MAAM,IAAI79C,MAAM,8BAIpB,OAFA69C,EADwBlxC,IAAYe,iBAAiBmwC,GACXj4C,KAC1CpH,KAAKm/C,mBAAmB91C,GAAWoc,OAAOq6B,EAAa,EAAGT,GACnDS,I,+CAIcz2C,EAAW02C,GAChC,IAAMC,EAAoBhgD,KAAKigD,sBAAsB52C,EAAW02C,GAChE,GAAIC,EAAkBnR,mBAAqB,EAAG,CAC1C,IAAMS,EAAkBtvC,KAAKigD,sBAAsB52C,EAAW02C,EAAc,GAAG,GAC3EzQ,GAGAtvC,KAAK0/C,gCAAgCr2C,EAAW02C,EAAc,EAAGzQ,EAAgBT,mBAAqBmR,EAAkBnR,oBAGhI7uC,KAAKm/C,mBAAmB91C,GAAWoc,OAAOs6B,EAAa,K,sDAI3B12C,EAAW62C,EAAcC,GACrDngD,KAAKigD,sBAAsB52C,EAAW62C,GAAcrR,mBAAqBsR,I,gDAInD92C,EAAW62C,EAAc3xC,GAE/CvO,KAAKigD,sBAAsB52C,EAAW62C,GAAc3G,QAAUhrC,I,gDAGxClF,EAAW62C,EAAcj5C,GAC/CjH,KAAKigD,sBAAsB52C,EAAW62C,GAAcrF,QAAU5zC,I,iDAGvCoC,EAAW62C,EAAczxC,GACrB,kBAAhBA,IACPA,EAAcpG,IAAO4H,qBAAqBxB,EAAazO,KAAKoH,KAAK0C,eACrE9J,KAAKigD,sBAAsB52C,EAAW62C,GAAc7xC,cAAgBI,I,iDAG7CpF,EAAW62C,EAAcE,GAChD,IAAK1hC,OAAO6wB,UAAU6Q,GAClB,MAAM,IAAI5+C,MAAM,gCAAkC4+C,GACtD,GAAIA,EAAc,EACd,MAAM,IAAI5+C,MAAM,wCAA0C4+C,GAC9DpgD,KAAKigD,sBAAsB52C,EAAW62C,GAAc/1C,SAAWi2C,I,+BAM1DC,EAAcvxC,GACnB,GAAI9O,KAAKoH,KAAK4I,OAAO+M,eAAesjC,GAChC,MAAM,IAAI7+C,MAAM,6BAA+B6+C,GACnDrgD,KAAKoH,KAAK4I,OAAOqwC,GAAgBvxC,GAAmB,K,kCAI5CwxC,GACR,GAAwB,SAApBA,EACA,MAAM,IAAI9+C,MAAM,8CACpB,IAAKxB,KAAKoH,KAAK4I,OAAO+M,eAAeujC,GACjC,MAAM,IAAI9+C,MAAM,6BAA+B8+C,UAE5CtgD,KAAKoH,KAAK4I,OAAOswC,K,kCAIhBC,EAAcF,GACtB,GAAqB,SAAjBE,EACA,MAAM,IAAI/+C,MAAM,8CACpB,IAAKxB,KAAKoH,KAAK4I,OAAO+M,eAAewjC,GACjC,MAAM,IAAI/+C,MAAM,6BAA+B++C,GACnD,GAAIvgD,KAAKoH,KAAK4I,OAAO+M,eAAesjC,GAChC,MAAM,IAAI7+C,MAAM,6BAA+B6+C,GAEnD,IAAMG,EAAmBxgD,KAAKoH,KAAK4I,OAAOuwC,UACnCvgD,KAAKoH,KAAK4I,OAAOuwC,GACxBvgD,KAAKoH,KAAK4I,OAAOqwC,GAAgBG,I,+CAWjC,IAAMjG,EAAW,IAAIV,GAAc75C,KAAKoH,KAAK4I,OAAQhQ,KAAKy7C,oBAAqBz7C,KAAKoH,KAAK6E,eAAgBjM,KAAKoH,KAAK0C,cAGnH,OAFAywC,EAASkG,YAEFlG,EAASkC,4B,+CAwBKiE,GACrB,OAAO1gD,KAAK2gD,0BAA0B3gD,KAAKy7C,oBAAqBiF,K,gDAI1Cr3C,EAAWu3C,GAEjC,IADA,IAAMrG,EAAWv6C,KAAKw6C,uBAAuBnxC,KAErCkxC,EAASlM,eAAiBuS,IAAyBrG,EAASjL,oBAKpE,IAAIuR,EAAkBtG,EAAShM,gBAE/B,GAAIqS,EAAuBrG,EAASlM,cAAe,CAC/C,IAAMyS,EAAeF,EAAuBrG,EAASlM,cACrDwS,GAAmB9D,EAAKgE,eAAeD,EAAcvG,EAAStuC,eAAgBsuC,EAASzwC,mBAEpF,GAAI82C,EAAuBrG,EAASlM,cAAe,CACtD,IAAMyS,EAAevG,EAASlM,cAAgBuS,EAC9CC,GAAmB9D,EAAKgE,eAAeD,EAAcvG,EAAStuC,eAAgBsuC,EAASzwC,cAI3F,OAAO+2C,I,+CAIuC,IAA3BG,EAA0B,uDAAN,KAGvC,OAF0B,OAAtBA,IACAA,EAAoBhhD,KAAKihD,2BACtBjhD,KAAKkhD,wBAAwBlhD,KAAKy7C,oBAAqBuF,K,8CAI1C33C,EAAW23C,GAE/B,IADA,IAAMzG,EAAWv6C,KAAKw6C,uBAAuBnxC,KAErCkxC,EAAShM,iBAAmByS,IAAsBzG,EAASjL,oBAInE,IAAIiQ,EAAyBhF,EAASlM,cACtC,GAAI2S,EAAoBzG,EAAShM,gBAAiB,CAC9C,IAAMO,EAAckS,EAAoBzG,EAAShM,gBACjDgR,GAA0BxC,EAAKoE,eAAerS,EAAayL,EAAStuC,qBAEjE,GAAI+0C,EAAoBzG,EAAShM,gBAAiB,CACrD,IAAMO,EAAcyL,EAAShM,gBAAkByS,EAC/CzB,GAA0BxC,EAAKoE,eAAerS,EAAayL,EAAStuC,gBAIxE,OAAOszC,I,gCAcD6B,GACNphD,KAAKk9C,OAASkE,EACXphD,KAAKm9C,iBACJn9C,KAAKm9C,eAAevmC,KAAKvT,MAAQ+9C,K,oCAG3Bl6C,GACV,IAAIA,IAAgBA,EAAYtG,QAC5B,MAAM,IAAIY,MAAM,uBAEpB,IACIoV,EADY1P,EAAYtG,QACT8vC,aAInB,OAHA95B,EAAKA,KAAKvT,MAAwB,OAAhBrD,KAAKk9C,OAAkB,EAAIl9C,KAAKk9C,OAClDtmC,EAAK/B,QAAQ3N,GACblH,KAAKm9C,eAAiBvmC,EACfA,I,gDAOP,OAAI5W,KAAKg8C,SACEh8C,KAAKg8C,SAASnT,aAAamQ,YAAch5C,KAAKg8C,SAASzL,UAC3DvwC,KAAKm+C,mB,iDAIWuC,GACvB,IAAKhiC,OAAO6wB,UAAUmR,GAClB,MAAM,IAAIl/C,MAAM,mCAGpB,IAAM28C,EAAmBn+C,KAAKqhD,yBAAyBX,GACvD,OAAO1gD,KAAKshD,oBAAoBnD,K,0CAGhBoD,GAEhB,GADAA,EAAev7C,WAAWu7C,GACtB7iC,OAAOtR,MAAMm0C,GACb,MAAM,IAAI//C,MAAM,0BAIhBxB,KAAKg8C,UACLh8C,KAAK8H,eAET9H,KAAKm+C,iBAAmBoD,EAExBvhD,KAAK69C,cAAc,CACf33C,KAAM,YACN+mB,SAAUjtB,KAAKm+C,iBAEfn3C,KAAMhH,OAGVmB,QAAQmU,IAAI,sBAAuBisC,K,oEAc5Br6C,G,4FAAakzC,E,+BAAc,KAClClzC,EAAclH,KAAKwhD,cAAct6C,GAE7BlH,KAAKg8C,WACLh8C,KAAK8H,eACL9H,KAAKshD,oBAAoB,IAKR,OAAlBlH,IACCA,EAAgBp6C,KAAKm+C,kBACzBh9C,QAAQmU,IAAI,kBAAmB8kC,GACzB4B,EAAW,IAAIR,GAAcx7C,KAAMA,KAAKy7C,oBAAqBz7C,KAAK49C,uBACxE59C,KAAKg8C,SAAWA,EAChBA,EAAS5C,KAAKlyC,EAAakzC,GAE3Bp6C,KAAK69C,cAAc,CACf33C,KAAM,YACN81C,SAAUh8C,KAAKg8C,SAEfh1C,KAAMhH,O,UAGJg8C,EAASyF,0B,eAEfzhD,KAAK69C,cAAc,CACf33C,KAAM,WACN81C,SAAUh8C,KAAKg8C,SAEfh1C,KAAMhH,OAEPA,KAAKg8C,UACJh8C,KAAK8H,e,kBAEFk0C,G,kJAOS/0C,GAChBjH,KAAKi9C,cAAc/0C,oBAAoBjB,K,qCAQvC,IAAKjH,KAAKg8C,SACN,OAAO76C,QAAQC,KAAK,+BACxB,IAAM46C,EAAWh8C,KAAKg8C,SACtBh8C,KAAKg8C,SAAW,KAChBh8C,KAAKm+C,iBAAmBnC,EAAS0F,uBACjC1F,EAASl0C,eACT9H,KAAKi9C,cAAc0E,kBAWnBxgD,QAAQmU,IAAI,gBAAiBtV,KAAKm+C,kBAGlCn+C,KAAK69C,cAAc,CACf33C,KAAM,WACN81C,SAAUh8C,KAAKg8C,SAEfh1C,KAAMhH,S,8BAKV,GAAIA,KAAKgc,SACL,MAAM,IAAIxa,MAAM,0BACpBxB,KAAKgc,UAAW,I,+BAIhB,IAAKhc,KAAKgc,SACN,MAAM,IAAIxa,MAAM,sBACpBxB,KAAKgc,UAAW,I,kCAIhB,QAAShc,KAAKg8C,W,+CAIO90C,EAAamC,EAAWu4C,GAC7C16C,EAAclH,KAAKwhD,cAAct6C,GAG9BlH,KAAKg8C,UACJh8C,KAAK8H,eACT,IAAMk0C,EAAW,IAAIR,GAAcx7C,KAAMqJ,EAAWrJ,KAAK49C,uBACzD59C,KAAKg8C,SAAWA,EAChBA,EAAS6F,sBAAqB,SAAS5yC,EAAaqrC,GAChD,GAAGA,EAAWjxC,YAAcA,EACxB,OAAO,KAEX,IADA,IAAMsL,EAAQ2lC,EAAWC,SAASnM,aAC1BpmC,EAAE,EAAGA,EAAE45C,EAAgB35C,OAAQD,IACnC,GAAG45C,EAAgB55C,KAAO2M,EAEtB,OAAO1F,KAKhB2yC,EAAgB35C,OAAS,GACxB+zC,EAAS8F,yBAAyB56C,EAAa06C,EAAgB,M,sCAoBvD16C,EAAa+H,EAAa4rC,GAA4D,IAAnD8B,EAAkD,uDAAlC,KAAM6B,EAA4B,uDAApB,KAAMhO,EAAc,uDAAN,KAGrF3H,GAFN3hC,EAAclH,KAAKwhD,cAAct6C,IAEAtG,QACjC,IAAKqO,aAAuBd,IACxB,MAAM,IAAI3M,MAAM,uBAYpB,IAAI88C,EAAe,KACnB,GAAwC,qBAA9BrvC,EAAYZ,cAA+B,CACjD,IAAIpC,EAAiBjM,KAAKoH,KAAK6E,eAC3BnC,EAAe9J,KAAKoH,KAAK0C,aACvBi4C,EAAoB9yC,EAAYZ,cACtCiwC,EAAgByD,EAAoBj4C,GAAiBmC,EAAiB,IAG1E,IAAI+sC,EAAcnQ,EAAamQ,YAE1B2D,GAAmC,IAAlBA,IAClBA,EAAgB3D,GAGpBh5C,KAAKgiD,YAAY96C,EAAa2zC,EAAS5rC,EAAYsqC,QAASoD,EAAe2B,EAAcrvC,EAAY9E,SAAUq0C,EAAShO,K,yCAoCzG1D,EAAQmV,GAAwC,IAA9B76C,EAA6B,uDAAtB,KAAM86C,EAAgB,uDAAN,KACrDnzC,MAAMC,QAAQizC,KACbA,EAAWA,EAASn8B,KAAK,MAC7B,IAAMq8B,EAAgB,CAClBrV,EAAS,IAAMmV,GAgBnB,OAda,OAAT76C,GAA6B,OAAZ86C,GACjBC,EAAc79C,KAAK8C,GACP,OAAZ86C,GACAC,EAAc79C,KAAK49C,GAKvBliD,KAAK69C,cAAc,CACf33C,KAAM,gBACNi8C,gBACAn7C,KAAMhH,OAGHmiD,K,sCAjTWrB,EAAc70C,EAAgBnC,GAChD,OAAQg3C,EAAeh3C,GAAiB,GAAKmC,K,qCAG3B6iC,EAAa7iC,EAAgBnC,GAC/C,OAAOmB,KAAKyB,MAAOoiC,EAAchlC,GAAiB,GAAKmC,M,uCA+UnC48B,EAAc33B,GAClC,IAAMlK,EAAO,IAAI+1C,EAEjB,OADA/1C,EAAK02C,aAAaxsC,GACXlK,I,yCAIe6hC,EAAcn2B,GACpC,IAAM0vC,EAAU,IAAI9xC,EACdY,EAAWkxC,EAAQC,mBAAmB3vC,GACtCvB,EAAcixC,EAAQE,0BAA0B5vC,GAChD1L,EAAO,IAAI+1C,EAAK7rC,GAGtB,OAFAlK,EAAK02C,aAAaxsC,GAClBlK,EAAKu7C,gBAAgBpxC,GACdnK,I,4CAIkB6hC,EAAcpe,GACvC,IAAMwqB,EAAU8H,EAAKyF,qBAAqB/3B,EAAKnpB,MAC/C,GAAiD,oBAAtC2zC,EAAQwN,0BACf,MAAM,IAAIjhD,MAAM,oDAEpB,IAAMsX,EAASikC,EAAK2F,wBAAwBj4B,GACtCvZ,EAAW+jC,EAAQ0N,uBAAuB7pC,EAAQ2R,EAAKnpB,MACvD0F,EAAO,IAAI+1C,EAEjB,OADA/1C,EAAK02C,aAAaxsC,GACXlK,I,+EAIkB6hC,EAAcvrB,G,kFAEO,oBADxC23B,EAAU8H,EAAKyF,qBAAqBllC,IACvBqlC,uB,sBACT,IAAInhD,MAAM,+CAAiD8b,G,cAE/DslC,EAAc,IAAI/X,E,SACH+X,EAAYnK,kBAAkBn7B,G,cAA7CxE,E,OAEA5H,EAAW+jC,EAAQ0N,uBAAuB7pC,EAAQwE,IAClDtW,EAAO,IAAI+1C,GACZW,aAAaxsC,G,kBACXlK,G,4LAI0ByjB,G,iFACpB,IAAI7mB,SAAQ,SAAC+iB,EAASwf,GAC/B,IAAI2D,EAAS,IAAIC,WACjBD,EAAO+Y,kBAAkBp4B,GACzBqf,EAAO7P,OAAU,SAACv5B,GACdimB,EAAQjmB,EAAEuF,OAAOyF,Y,qLAOD6/B,GAGxB,IACI0J,EADE6N,EAAUvX,EAASz+B,MAAM,KAAKgJ,MAAMtB,cAE1C,OAAQsuC,GAMJ,IAAK,OAGD,OAFA7N,EAAU,IAAIpL,EAIlB,IAAK,MACL,IAAK,OACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,MAGD,OAFAoL,EAAU,IAAI1M,GACN3gB,OACDqtB,EAMX,QACI,MAAM,IAAIzzC,MAAM,sCAAwCshD,M,sCAUhE,MAAM,aAAN,QAAoB,IAAIp4C,MAAOq4C,SAAS51C,MAAM,EAAG,IAAIrC,QAAQ,KAAM,KAAnE,S,KAKRiyC,GAAKiG,eAAiB,GAePjG,UCrkCAkG,G,4GA/CyB,IAAlBC,EAAiB,uDAAN,KACzB,OAAOA,GACH,QACA,IAAK,UACD,MAAO,CACH,IAAI,MAAQ,IAAI,MAAQ,IAAI,MAAO,IAAI,MAAS,IAAI,MAAQ,IAAI,MAAQ,IAAI,MAC5E,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAChH,EAAI,MAAQ,EAAI,MAAQ,EAAI,MAAQ,EAAI,MAAQ,EAAI,MAAQ,EAAI,MAAQ,IAAI,MAC5E,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAQ,EAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,KAE1G,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MACtE,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAC9F,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,EAAI,MAAO,IAAI,MACtE,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,EAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,MAGtG,IAAK,UACD,MAAO,CAEH,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,EAAK,KAAM,EAAI,MAAO,EAAI,KAAM,IAAI,MAAO,IAAI,KACxH,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,EAAK,KAAM,EAAI,MAAO,IAAI,KAAM,IAAK,MAC9G,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,IAAK,KAAM,IAAI,MAAO,IAAI,KAGnG,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,EAAK,KAAM,EAAI,MAAO,EAAI,KAAM,IAAI,MAAO,IAAI,KACxH,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,EAAK,KAAM,EAAI,MAAO,IAAI,KAAM,IAAI,MAC7G,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,MAAO,EAAI,KAAM,EAAI,KAAM,EAAI,MAAO,IAAK,KAAM,IAAI,MAAO,IAAI,S,yCAKhGt8C,GAAqC,IAAhC+C,EAA+B,uDAAtB,EAAGu5C,EAAmB,uDAAN,KAC7C,IAAKxkC,OAAO6wB,UAAU5lC,GAClB,MAAM,IAAInI,MAAM,mCACpB,IAAM2hD,EAAiBnjD,KAAKojD,kBAAkBF,GAC9C,GAAmC,qBAAxBC,EAAev8C,GACtB,OAAO,KAGX,IADA,IAAI2yC,EAAU4J,EAAev8C,GACpBoB,EAAI,EAAGA,GAAK,EAAGA,IACpBuxC,EAAUA,EAAQzuC,QAAQ9C,EAAG2B,EAAS3B,EAAI,GAC9C,OAAOuxC,M,KC1Cf,8iB,6JCIqB73C,E,YAIjB,WAAYzB,GAAQ,IAAD,8BACf,4CAAMA,KACDO,GAAK,CACNC,aAAc,SAAAC,GAAC,OAAI,EAAKD,aAAaC,IACrCC,UAAW,SAAAD,GAAC,OAAI,EAAKC,UAAUD,KAJpB,E,sEAWf,OACI,kBAAC,IAAD,CACI2iD,QAASrjD,KAAKQ,GAAGC,aACjB6iD,YAAatjD,KAAKQ,GAAGC,cAErB,kBAAC,IAAD,CACIV,SAAUC,KAAKujD,sB,uCAMD,IAAfC,EAAc,uDAAJ,GACjBzjD,EAAWC,KAAKC,MAAMF,SAG1B,MAFuB,kBAAbA,IACNA,EAAW,kBAAC,IAAD,eAAMA,SAAUA,GAAcyjD,KACtCzjD,I,mCAKEW,GACNA,EAAEgG,mBAELhG,EAAEoF,iBACF9F,KAAKyjD,SAAS/iD,M,gCAIRA,GACN,IAAGA,EAAEiG,qBAEL,OAAOjG,EAAEkG,KACL,IAAK,IACL,IAAK,QACD5G,KAAKyjD,SAAS/iD,GACd,MAEJ,QACIS,QAAQ0F,KAAK,kBAAmBnG,EAAEkG,Q,+BAOrClG,GACL,MAAM,IAAIc,MAAM,qB,mCAKL,OAAOxB,KAAKY,QAAQC,U,8CAG5Bb,KAAK4C,cACJ5C,KAAK4C,aAAa2B,oB,GAvEiBrE,IAAMC,WAAhCuB,EAEVC,YAAcC,K,+ECLnBo5C,E,uLAIE,MAA+B,kBAAjBh7C,KAAKoH,KAAK,GAAkBpH,KAAKoH,KAAK,GAAGqG,OAAO,QAAKyS,I,mCAG1DmgC,GACTrgD,KAAKoH,KAAK,GAAV,WAAmBi5C,K,8BA2BnB,OAAO,IAAIrF,EAAiBh7C,KAAKoH,KAAK+F,W,kCAvBtC,OAAOnN,KAAKoH,KAAK,I,aAGLmH,GACZvO,KAAKoH,KAAK,GAAKmH,I,oCAIf,OAAOvO,KAAKoH,KAAK,SAAM8Y,G,aAGTzR,GAEd,GADAA,EAAczI,WAAWyI,GACrBiQ,OAAOtR,MAAMqB,GACb,MAAM,IAAIjN,MAAM,oBACpBxB,KAAKoH,KAAK,GAAKqH,I,6CA3BQN,GAuChB6sC,a,iHCxCMnyC,E,uJAIakrB,G,0FAAS2vB,E,+BAAa,G,kBACzC7+C,OAAO6M,OAAOqiB,EAAS2vB,I,mLAGH3vB,G,0FACpBlvB,OAAO8+C,QAAQ5vB,I,kNCRxB2oB,E,gLA2BE,OAAO,IAAIA,EAAgB18C,KAAKoH,KAAK+F,W,oCAvBrC,MAA+B,qBAAjBnN,KAAKoH,KAAK,GAAqBpH,KAAKoH,KAAK,QAAK8Y,G,aAG9CzR,GAEd,GADAA,EAAczI,WAAWyI,GACrBiQ,OAAOtR,MAAMqB,GACb,MAAM,IAAIjN,MAAM,oBACpBxB,KAAKoH,KAAK,GAAKqH,I,+BAIf,MAA+B,qBAAjBzO,KAAKoH,KAAK,GAAqBpH,KAAKoH,KAAK,QAAK8Y,G,aAGnDkgC,GAET,GADAA,EAAcp6C,WAAWo6C,GACrB1hC,OAAOtR,MAAMgzC,GACb,MAAM,IAAI5+C,MAAM,oBACpBxB,KAAKoH,KAAK,GAAKg5C,M,SAtBOjyC,GA+BfuuC,a,2FC9BT5B,E,yLAGE,MAA+B,kBAAjB96C,KAAKoH,KAAK,GAAkBpH,KAAKoH,KAAK,GAAGqG,OAAO,QAAKyS,I,qCAGxD0jC,GACX5jD,KAAKoH,KAAK,GAAV,WAAmBw8C,K,kCAInB,OAAO5jD,KAAKoH,KAAK+F,MAAM,K,gDAgBDnG,EAAMszC,GAC5B,IAAMf,EAAUv5C,KAAK6jD,iBAAiBrvC,cACtC,OAAO+kC,GACH,IAAK,UACL,IAAK,IACD,IAAMuK,EAAaxJ,EAAWO,QACxBlH,EAAiB2G,EAAWpzC,YAC9B68C,EAAkB/jD,KAAKgkD,sBAAsBh9C,GACjDszC,EAAWO,QAAUkJ,EAGwB,oBAAnCA,EAAgBE,iBACtB3J,EAAWpzC,YAAc68C,EAAgBE,eAAetQ,IAGnB,oBAA/BoQ,EAAgBG,YACtBH,EAAgBG,WAAWJ,GAE/B,MAWJ,QACI,OAAO3iD,QAAQwC,MAAM,gCAAkC41C,M,4CAK7CvyC,GAClB,IAAM4R,EAAS5Y,KAAKmkD,YAOpB,MALwB,kBAAdvrC,EAAO,GACH7R,IAAcW,aAAakR,EAAO,GAAIA,EAAO,IAE7C5R,EAAK43C,0BAA0BhmC,EAAO,M,8BAOpD,OAAO,IAAIkiC,EAAmB96C,KAAKoH,KAAK+F,W,8EA3EfgB,KA+ElB2sC,a,6TChFTsJ,E,oLAGE,OAAOpkD,KAAKoH,KAAK,I,aAGLmH,GACZvO,KAAKoH,KAAK,GAAKmH,I,oCAIf,OAAO,M,aAGOE,GACd,MAAM,IAAIjN,MAAM,kD,SAfM2M,GAoBfi2C,a,i5CClBA,MAAO,iC,mCAElB,IAAMnP,EAAU5lC,EAAQ,MAA+B,GACvD,OAAO4lC,EAAQnC,QAAQtoC,KAAI,SAAA8rC,GAOzB,MANqB,kBAAXA,IACRA,EAAS,CAAC94B,IAAK84B,EAAQpwC,KAAK,WAC1BowC,EAAOt1C,QACTs1C,EAAOt1C,MAAQs1C,EAAO94B,IAAI1Q,MAAM,KAAKgJ,OACpCm/B,EAAQoP,UACT/N,EAAO94B,IAAMy3B,EAAQoP,QAAU/N,EAAO94B,KACjC,CAAC,uBAAwB84B,U,GAXTjC,W,qLCCd,MAAO,gC,qCAElB,MAAO,CACL,IAAIiQ,O,GAJmBjQ,W,qLCCf,MAAO,0B,GADQA,W,qLCEd,MAAO,yB,qCAElB,MAAO,CACH,IAAIkQ,K,qCAKR,MAAO,CACL,+C,GAVuBlQ,W,iOCGd,MAAO,uB,qCAElB,MAAO,CACL,IAAImQ,EACJ,IAAIC,EACJ,IAAIH,K,qCAKN,MAAO,CACL,kD,GAZuBjQ,Y,oICHRqQ,E,YACjB,WAAYzkD,GAAQ,IAAD,8BACf,4CAAMA,KACDmC,MAAQ,CACT4E,KAAM,MAEV,EAAK29C,QAAUzkD,IAAMsC,YACrB,EAAKhC,GAAK,CACNokD,UAAW,SAAAx9C,GAAI,OAAI,EAAKw9C,UAAUx9C,KAPvB,E,gIAeGy9C,EAAWC,GAC7B,OAAO,I,kCAGC7kB,GAIR,GAHmB,kBAATA,IACNA,EAAOrvB,KAAKC,UAAUovB,KAEtBp7B,OAAOkgD,mBACP,OAAO5jD,QAAQC,KAAK,2EAA6EyD,OAAOkgD,oBAE5GlgD,OAAOkgD,mBAAmBlY,YAAY5M,K,+BAGhC,IAAD,OAiBL,OAfGp7B,SAAWA,OAAOmgD,eACjBngD,OAAOmgD,aAAe,CAClBC,YAAa51C,EAAQ,KAIzB6C,SAASgzC,iBAAiB,WAAW,SAAClwC,GAClC7T,QAAQmU,IAAI,wBAAyBN,EAAM5N,MAC3C,EAAKylC,YAAY,QAAU73B,EAAM5N,SAElC,GAEHpH,KAAK6sC,YAAY,CAAC,UAGf,kBAACsY,EAAA,EAAD,U,GA/CqCjlD,IAAMC,WCqF3CilD,E,YAhFX,WAAYnlD,GAAQ,IAAD,8BACf,4CAAMA,KASVqF,WAAa,WACT,EAAKzB,SAAS,CAAEwhD,UAAW,EAAKjjD,MAAMijD,WAClC,EAAKjjD,MAAMijD,UACX,EAAKC,UAAUC,aAAa,OAbjB,EAgBnBC,WAAa,WACT,EAAKC,eAfL,EAAKrjD,MAAQ,GAFE,E,kKAmCf,OAAO,kBAAC,EAAD,U,GApCGlC,IAAMC,WCKJynC,QACW,cAA7B/iC,OAAOqP,SAASo3B,UAEe,UAA7BzmC,OAAOqP,SAASo3B,UAEhBzmC,OAAOqP,SAASo3B,SAAS/wB,MACvB,2DCZNmrC,IAASC,OAAO,kBAAC,EAAD,MAASzzC,SAAS0zC,eAAe,SD6H3C,kBAAmBlnB,WACrBA,UAAUmnB,cAAcC,MAAMzf,MAAK,SAAA0f,GACjCA,EAAaC,kB","file":"static/js/main.9160cf98.chunk.js","sourcesContent":["import React from 'react';\n\n/** Div **/\nexport default class ASUIDiv extends React.Component {\n\n    render() {\n        let children = this.props.children;\n        if(typeof children === \"function\")\n            children = children(this);\n        return <div {...this.props}>{children}</div>;\n    }\n}\n\n","import React from 'react';\nimport PropTypes from \"prop-types\";\n\nimport \"./assets/ASUIIcon.css\";\n\n/** Icon **/\nclass ASUIIcon extends React.Component {\n\n    /** Property validation **/\n    static propTypes = {\n        source: PropTypes.any.isRequired,\n    };\n\n    constructor(props = {}) {\n        super(props, {});\n    }\n\n    render() {\n        let className = \"asui-icon\";\n        if(this.props.source) {\n            className += ' ' + this.props.source;\n        }\n        return <div className={className}/>;\n    }\n\n}\n\nexport default ASUIIcon;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport ASUIMenuContext from \"../menu/ASUIMenuContext\";\nimport ASUIClickableBase from \"./ASUIClickableBase.native\";\n\nexport default class ASUIButton extends ASUIClickableBase {\n    /** Context **/\n    static contextType = ASUIMenuContext;\n\n    /** Default Properties **/\n    static defaultProps = {\n    };\n\n    /** Property validation **/\n    static propTypes = {\n        onAction: PropTypes.func.isRequired,\n        disabled: PropTypes.bool,\n    };\n\n\n    constructor(props) {\n        super(props);\n        this.cb = {\n            onMouseInput: e => this.onMouseInput(e),\n            onKeyDown: e => this.onKeyDown(e),\n        };\n    }\n\n    getOverlay() { return this.context.overlay; }\n\n\n    render() {\n        let className = 'asui-menu-item';\n        if(this.props.className)\n            className += ' ' + this.props.className;\n        if(this.props.disabled)\n            className += ' disabled';\n        if(this.props.selected)\n            className += ' selected';\n\n        return (\n            <div\n                title={this.props.title}\n                className={className}\n                onClick={this.cb.onMouseInput}\n                onKeyDown={this.cb.onKeyDown}\n                tabIndex={0}\n            >\n                {this.props.children}\n            </div>\n        );\n    }\n\n\n    /** Actions **/\n\n    doAction(e) {\n        if(this.props.disabled) {\n            console.warn(this.constructor.name + \" is disabled.\", this);\n            return;\n        }\n\n        if(!this.props.onAction)\n            throw new Error(\"Button does not contain props 'onAction'\");\n        const result = this.props.onAction(e, this);\n        if (result !== false)\n            this.closeAllDropDownMenus();\n    }\n\n\n}\n\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport ASUIMenuContext from \"../ASUIMenuContext\";\n\nclass ASUIDropDownContainer extends React.Component {\n    static contextType = ASUIMenuContext;\n\n    // creating default props\n    static defaultProps = {\n        // arrow:          true,\n        vertical:       false,\n        // openOnHover:    null,\n        // disabled:       false,\n    };\n\n    // validating prop types\n    static propTypes = {\n        // closeCallback: PropTypes.func.isRequired,\n        vertical: PropTypes.bool,\n        disabled: PropTypes.bool,\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n            stick: false,\n        };\n        this.divRef = React.createRef();\n    }\n\n    getOverlay() { return this.context.overlay; }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n//         console.log('componentDidUpdate', this.state);\n        if(this.getOverlay()) {\n            if (this.state.open)\n                this.getOverlay().addCloseMenuCallback(this, this.closeMenu.bind(this));\n            else\n                this.getOverlay().removeCloseMenuCallback(this);\n        }\n        this.updateScreenPosition();\n    }\n\n    componentWillUnmount() {\n        if(this.getOverlay())\n            this.getOverlay().removeCloseMenuCallback(this);\n    }\n\n    render() {\n        if (!this.state.open)\n            return null;\n\n        let className = 'asui-menu-dropdown';\n        if (this.props.vertical)\n            className += ' vertical';\n        if (this.state.stick)\n            className += ' stick';\n        if(this.props.disabled)\n            return 'Disabled';\n\n        let options = this.state.options;\n\n        return <ASUIMenuContext.Provider\n            value={{overlay:this.getOverlay(), parentDropDown:this}}>\n            <div\n                className={className}\n                children={options}\n                ref={this.divRef}\n                />\n        </ASUIMenuContext.Provider>\n\n    }\n\n    hoverMenu() {\n        if(this.state.open === true || !this.getOverlay() || !this.getOverlay().isHoverEnabled())\n            return;\n        this.openMenu();\n    }\n\n    toggleMenu() {\n\n        if (!this.state.open)\n            this.openMenu();\n        else if (!this.state.stick)\n            this.stickMenu();\n        else\n            this.closeMenu();\n    }\n\n    async openMenu() {\n        if (this.props.disabled)\n            return console.error(\"Menu is disabled\");\n        if (this.state.open)\n            throw new Error(\"Menu was already open\");\n\n        // Try open menu handler\n        if(this.getOverlay()) {\n            const res = this.getOverlay().openMenu(this.props.options);\n            if (res !== false) {\n//                 console.info(\"Sub-menu options were sent to menu handler: \", this.getOverlay().openMenu);\n                return;\n            }\n        }\n\n        let options = this.props.options;\n        if (typeof options === \"function\")\n            options = options(this);\n        if(options instanceof Promise)\n            options = await options;\n        if (!options)\n            console.warn(\"Empty options returned by \", this);\n\n        this.setState({\n            open: true,\n            options\n        });\n\n        setTimeout(() => {\n            this.getOverlay().closeMenus(this.getAncestorMenus());\n        }, 100);\n    }\n\n    stickMenu() {\n        if (!this.state.open)\n            throw new Error(\"Unable to stick. Menu was not yet open\");\n\n        this.getAncestorMenus().forEach(menu => {\n            menu.setState({\n                stick: true,\n            });\n        })\n    }\n\n    closeMenu(stayOpenOnStick = false) {\n        if (this.state.stick && stayOpenOnStick === true) {\n            // console.warn(\"Ignoring close due to stick\", this);\n            return;\n        }\n        this.setState({\n            open: false,\n            stick: false,\n            options: null\n        })\n    }\n\n    getAncestorMenus() {\n        let menus = [];\n        let parent = this;\n        while (parent) {\n            menus.push(parent);\n            parent = parent.context.parentDropDown;\n        }\n        return menus;\n    }\n\n\n    closeAllDropDownMenus() {\n        if(this.getOverlay())\n            this.getOverlay().closeAllMenus();\n    }\n\n    updateScreenPosition() {\n        if(!this.state.open || !this.divRef.current)\n            return;\n        const div = this.divRef.current;\n        const rect = div.getBoundingClientRect();\n        if(rect.right > window.innerWidth)\n            div.classList.add('overflow-right');\n        if(rect.bottom > window.innerHeight)\n            div.classList.add('overflow-bottom');\n        // console.log(rect.right, window.innerWidth, rect.bottom, window.innerHeight)\n    }\n}\n\n// class DropDownContextWrapper extends React.Component {\n//     static contextType = DropDownContext;\n//\n//     render() {\n//         return <DropDownContext.Provider value={this}>\n//             <DropDownContainer\n//                 parentDropDown={this.context}\n//                 {...this.props}\n//                 />\n//         </DropDownContext.Provider>;\n//     }\n// }\n\nexport default ASUIDropDownContainer;\n\n// function reactMapRecursive(children, fn) {\n//     return React.Children.map(children, child => {\n//         if (!React.isValidElement(child)) {\n//             return child;\n//         }\n//\n//         if (child.props.children) {\n//             child = React.cloneElement(child, {\n//                 children: reactMapRecursive(child.props.children, fn)\n//             });\n//         }\n//\n//         return fn(child);\n//     });\n// }\n","import \"./assets/ASUIButton.css\"\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport ASUIDropDownContainer from \"../menu/dropdown/ASUIDropDownContainer.native\";\nimport ASUIClickableBase from \"./ASUIClickableBase.native\";\n\nexport default class ASUIButtonDropDown extends ASUIClickableBase {\n    // Default Properties\n    static defaultProps = {\n        arrow:          true,\n        vertical:       true,\n    };\n\n    // Property validation\n    static propTypes = {\n        options: PropTypes.any.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n        this.dropdown = React.createRef();\n    }\n\n\n    renderChildren(props = {}) {\n        let arrow = this.props.arrow === true ? (this.props.vertical ? '▼' : '►') : this.props.arrow;\n        return [\n            super.renderChildren(props),\n            arrow ? <div className=\"arrow\">{arrow}</div> : null,\n            <ASUIDropDownContainer\n                ref={this.dropdown}\n                disabled={this.props.disabled}\n                options={this.props.options}\n                vertical={this.props.vertical}\n            />\n        ];\n    }\n\n\n    toggleMenu()    { return this.dropdown.current.toggleMenu(); }\n    hoverMenu()     { return this.dropdown.current.hoverMenu(); }\n\n    doAction(e) {\n        this.toggleMenu();\n    }\n}\n","import React from \"react\";\nimport \"./assets/ASUIForm.css\"\nimport PropTypes from \"prop-types\";\n\nclass ASUIForm extends React.Component {\n    /** Default Properties **/\n    static defaultProps = {\n    };\n\n    /** Property validation **/\n    static propTypes = {\n        className: PropTypes.string,\n        header: PropTypes.any,\n    };\n\n    render() {\n        let className = 'asui-form';\n        if(this.props.className)\n            className += ' ' + this.props.className;\n\n        let children = this.props.children;\n        if(typeof children === \"function\")\n            children = children(this);\n\n        return (\n            <div className={className}>\n                {this.props.header ? <div className=\"header\">{this.props.header}</div> : null}\n                <div className=\"container\">\n                    {children}\n                </div>\n            </div>\n        )\n    }\n}\n\n/** Export this script **/\nexport default ASUIForm;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./assets/ASUIPanel.css\"\n\nclass ASUIPanel extends React.Component {\n    /** Default Properties **/\n    static defaultProps = {\n    };\n\n    /** Property validation **/\n    static propTypes = {\n        className: PropTypes.string,\n        header: PropTypes.any,\n    };\n\n    render() {\n        let className = 'asui-panel';\n        if(this.props.className)\n            className += ' ' + this.props.className;\n\n        let children = this.props.children;\n        if(typeof children === \"function\")\n            children = children(this);\n\n        return (\n            <div\n                {...this.props}\n                className={className}\n                >\n                {this.props.header ? <div className=\"header\">{this.props.header}</div> : null}\n                {children}\n            </div>\n        )\n    }\n}\n/** Export this script **/\nexport default ASUIPanel;\n","import React from \"react\";\nimport \"./assets/ASUIInputRange.scss\";\nimport PropTypes from \"prop-types\";\n\nclass ASUIInputRange extends React.Component {\n    /** Default Properties **/\n    static defaultProps = {\n    };\n\n    /** Property validation **/\n    static propTypes = {\n        onChange: PropTypes.func.isRequired,\n    };\n\n\n\n    constructor(props = {}) {\n        super(props);\n        this.cb = {\n            onChange: e => this.onChange(e),\n            onClick: e => this.onClick(e),\n        };\n    }\n\n    onClick(e) {\n        e.preventDefault();\n        const newValue = parseFloat(e.target.value);\n        this.props.onChange(e, newValue)\n        // e.preventDefault();\n    }\n\n    onChange(e) {\n        e.preventDefault();\n        const newValue = parseFloat(e.target.value);\n        this.props.onChange(e, newValue)\n        // this.setState({value: newValue});\n    }\n\n    render() {\n        let className = \"asui-input-range\";\n        if(this.props.className)\n            className += ' ' + this.props.className;\n        return (\n            <input\n                className={className}\n                type=\"range\"\n                value={this.props.value}\n                onChange={this.cb.onChange}\n                onClick={this.cb.onClick}\n                min={this.props.min}\n                max={this.props.max}\n                step={this.props.step}\n                name={this.props.name}\n                title={this.props.title}\n                />\n        )\n    }\n\n}\n\n\n/** Export this script **/\nexport default ASUIInputRange;\n","\nimport ASUIDiv from \"./div/ASUIDiv\";\nimport ASUIIcon from \"./icon/ASUIIcon\";\nimport {\n    ASUIButton,\n    ASUIButtonDropDown\n} from \"./button/\";\n\nimport {\n    ASUIMenuAction,\n    ASUIMenuDropDown,\n    ASUIMenuBreak,\n    ASUIMenuOverlayContainer\n} from \"./menu/\";\n\nimport ASUIForm from \"./form/ASUIForm\";\nimport ASUIPanel from \"./form/ASUIPanel\";\n\nimport ASUIInputRange from \"./input-range/ASUIInputRange\";\n\nexport {\n    ASUIDiv,\n    ASUIIcon,\n    ASUIForm,\n    ASUIPanel,\n\n    ASUIButton,\n    ASUIButtonDropDown,\n\n    ASUIMenuAction,\n    ASUIMenuBreak,\n    ASUIMenuDropDown,\n    ASUIMenuOverlayContainer,\n\n    ASUIInputRange,\n}\n","import ASUIClickableBase from \"../button/ASUIClickableBase.native\";\n\nimport './assets/ASUIMenu.css';\n\nclass ASUIMenuAction extends ASUIClickableBase {\n    getClassName() { return 'asui-menu-item'; }\n}\n\nexport default ASUIMenuAction;\n\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport ASUIMenuContext from \"../ASUIMenuContext\";\n\nimport \"./ASUIDropDownContainer.css\";\n\nclass ASUIDropDownContainer extends React.Component {\n    static contextType = ASUIMenuContext;\n\n    // creating default props\n    static defaultProps = {\n        // arrow:          true,\n        vertical:       false,\n        // openOnHover:    null,\n        // disabled:       false,\n    };\n\n    // validating prop types\n    static propTypes = {\n        // closeCallback: PropTypes.func.isRequired,\n        vertical: PropTypes.bool,\n        disabled: PropTypes.bool,\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n            stick: false,\n        };\n        this.divRef = React.createRef();\n    }\n\n    getOverlay() { return this.context.overlay; }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n//         console.log('componentDidUpdate', this.state);\n        if(this.getOverlay()) {\n            if (this.state.open)\n                this.getOverlay().addCloseMenuCallback(this, this.closeMenu.bind(this));\n            else\n                this.getOverlay().removeCloseMenuCallback(this);\n        }\n        this.updateScreenPosition();\n    }\n\n    componentWillUnmount() {\n        if(this.getOverlay())\n            this.getOverlay().removeCloseMenuCallback(this);\n    }\n\n    render() {\n        if (!this.state.open)\n            return null;\n\n        let className = 'asui-menu-dropdown';\n        if (this.props.vertical)\n            className += ' vertical';\n        if (this.state.stick)\n            className += ' stick';\n        if(this.props.disabled)\n            return 'Disabled';\n\n        let options = this.props.options;\n        if (typeof options === \"function\")\n            options = options(this);\n        if (!options)\n            console.warn(\"Empty options returned by \", this);\n\n        return <ASUIMenuContext.Provider\n            value={{overlay:this.getOverlay(), parentDropDown:this}}>\n            <div\n                className={className}\n                children={options}\n                ref={this.divRef}\n                />\n        </ASUIMenuContext.Provider>\n\n    }\n\n    hoverMenu() {\n        if(this.state.open === true || !this.getOverlay() || !this.getOverlay().isHoverEnabled())\n            return;\n        this.openMenu();\n    }\n\n    toggleMenu() {\n\n        if (!this.state.open)\n            this.openMenu();\n        else if (!this.state.stick)\n            this.stickMenu();\n        else\n            this.closeMenu();\n    }\n\n    openMenu() {\n        if (this.props.disabled)\n            return console.error(\"Menu is disabled\");\n        if (this.state.open)\n            throw new Error(\"Menu was already open\");\n\n        // Try open menu handler\n        if(this.getOverlay()) {\n            const res = this.getOverlay().openMenu(this.props.options);\n            if (res !== false) {\n//                 console.info(\"Sub-menu options were sent to menu handler: \", this.getOverlay().openMenu);\n                return;\n            }\n        }\n\n        this.setState({\n            open: true,\n        });\n\n        setTimeout(() => {\n            this.getOverlay().closeMenus(this.getAncestorMenus());\n        }, 100);\n    }\n\n    stickMenu() {\n        if (!this.state.open)\n            throw new Error(\"Unable to stick. Menu was not yet open\");\n\n        this.getAncestorMenus().forEach(menu => {\n            menu.setState({\n                stick: true,\n            });\n        })\n    }\n\n    closeMenu(stayOpenOnStick = false) {\n        if (this.state.stick && stayOpenOnStick === true) {\n            // console.warn(\"Ignoring close due to stick\", this);\n            return;\n        }\n        this.setState({\n            open: false,\n            stick: false,\n            options: null\n        })\n    }\n\n    getAncestorMenus() {\n        let menus = [];\n        let parent = this;\n        while (parent) {\n            menus.push(parent);\n            parent = parent.context.parentDropDown;\n        }\n        return menus;\n    }\n\n\n    closeAllDropDownMenus() {\n        if(this.getOverlay())\n            this.getOverlay().closeAllMenus();\n    }\n\n    updateScreenPosition() {\n        if(!this.state.open || !this.divRef.current)\n            return;\n        const div = this.divRef.current;\n        const rect = div.getBoundingClientRect();\n        if(rect.right > window.innerWidth)\n            div.classList.add('overflow-right');\n        if(rect.bottom > window.innerHeight)\n            div.classList.add('overflow-bottom');\n        // console.log(rect.right, window.innerWidth, rect.bottom, window.innerHeight)\n    }\n}\n\n// class DropDownContextWrapper extends React.Component {\n//     static contextType = DropDownContext;\n//\n//     render() {\n//         return <DropDownContext.Provider value={this}>\n//             <DropDownContainer\n//                 parentDropDown={this.context}\n//                 {...this.props}\n//                 />\n//         </DropDownContext.Provider>;\n//     }\n// }\n\nexport default ASUIDropDownContainer;\n\n// function reactMapRecursive(children, fn) {\n//     return React.Children.map(children, child => {\n//         if (!React.isValidElement(child)) {\n//             return child;\n//         }\n//\n//         if (child.props.children) {\n//             child = React.cloneElement(child, {\n//                 children: reactMapRecursive(child.props.children, fn)\n//             });\n//         }\n//\n//         return fn(child);\n//     });\n// }\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport \"../assets/ASUIMenu.css\";\nimport ASUIDropDownContainer from \"./ASUIDropDownContainer\";\n\nexport default class ASUIMenuDropDown extends React.Component {\n    // Default Properties\n    static defaultProps = {\n        arrow:          true,\n        vertical:       false,\n    };\n\n    // Property validation\n    static propTypes = {\n        options: PropTypes.any.isRequired,\n    };\n\n\n    constructor(props) {\n        super(props);\n\n        this.cb = {\n            onKeyDown: (e) => this.onKeyDown(e),\n            onMouseInput: e => this.onMouseInput(e),\n        };\n        this.dropdown = React.createRef();\n    }\n\n\n    getClassName() { return 'asui-menu-item'; }\n\n    render() {\n        let className = this.getClassName(); // 'asui-menu-item';\n        if(this.props.className)\n            className += ' ' + this.props.className;\n        if(this.props.disabled)\n            className += ' disabled';\n        if(this.props.selected)\n            className += ' selected';\n\n        let arrow = this.props.arrow === true ? (this.props.vertical ? '▼' : '►') : this.props.arrow;\n        return (\n            <div\n                title={this.props.title}\n                className={className}\n                onMouseEnter={this.cb.onMouseInput}\n                onClick={this.cb.onMouseInput}\n                onKeyDown={this.cb.onKeyDown}\n                tabIndex={0}\n                >\n                {this.props.children}\n                {arrow ? <div className=\"arrow\">{arrow}</div> : null}\n                <ASUIDropDownContainer\n                    ref={this.dropdown}\n                    disabled={this.props.disabled}\n                    options={this.props.options}\n                    vertical={this.props.vertical}\n                    />\n            </div>\n        )\n    }\n\n    toggleMenu()    { return this.dropdown.current.toggleMenu(); }\n    hoverMenu()     { return this.dropdown.current.hoverMenu(); }\n\n    onMouseInput(e) {\n        if(e.defaultPrevented)\n            return;\n        e.preventDefault();\n        switch(e.type) {\n            case 'click':\n                // Try onClick handler first to avoid causing a state change within a render\n                if(this.props.onClick)\n                    if(this.props.onClick(e) === false)\n                        return;\n                this.toggleMenu();\n                break;\n\n            case 'mouseenter':\n            case 'mouseover':\n                this.hoverMenu();\n                break;\n\n            default:\n                throw new Error(\"Unknown Mouse event: \" + e.type);\n        }\n    }\n\n\n\n    onKeyDown(e) {\n        if(e.isDefaultPrevented())\n            return;\n        switch(e.key) {\n            case ' ':\n            case 'Enter':\n                this.toggleMenu();\n                break;\n\n            default:\n                console.info(\"Unhandled key: \", e.key);\n                break;\n        }\n    }\n    onMouseEnter(e) {\n        this.toggleMenu();\n    }\n\n}\n","import React from \"react\";\n\nimport './assets/ASUIMenu.css';\n\nclass ASUIMenuBreak extends React.Component {\n    render() {\n        return (\n            <hr className=\"asui-menu-break\"/>\n        );\n    }\n}\n\nexport default ASUIMenuBreak;\n","import React from \"react\";\nimport ASUIMenuContext from \"../ASUIMenuContext\";\n\nexport default class ASUIMenuOverlayContainerBase extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n            openOverlay: false\n        };\n        this.cb = {\n            closeAllMenus: () => this.closeAllMenus(),\n        };\n        this.openMenus =  [];\n        this.updateOverlayTimeout = null;\n    }\n    // componentDidMount() {\n    //     MenuDropDown.addGlobalSubMenuHandler(this.openMenuHandler)\n    // }\n    //\n    // componentWillUnmount() {\n    //     MenuDropDown.removeGlobalSubMenuHandler(this.openMenuHandler)\n    // }\n\n    renderContent() {\n        throw new Error(\"Not implemented\");\n    }\n\n\n    render() {\n        return <ASUIMenuContext.Provider\n            value={{overlay:this, parentDropDown:null}}>\n            {this.renderContent()}\n        </ASUIMenuContext.Provider>;\n    }\n\n\n    // getActiveMenuCount() {\n    //     return this.openMenus.length;\n    // }\n\n    updateOverlay() {\n        const openOverlay = this.state.open || this.openMenus.length > 0;\n//             console.log('updateOverlay', openOverlay);\n        if(this.state.openOverlay !== openOverlay)\n            this.setState({openOverlay})\n    }\n\n    isHoverEnabled() {\n        return !this.props.isActive && (this.state.openOverlay || this.openMenus.length > 0);\n    }\n\n    addCloseMenuCallback(menuItem, closeMenuCallback) {\n        const i = this.openMenus.findIndex(openMenu => openMenu[0] === menuItem);\n        if(i === -1)\n            this.openMenus.push([menuItem, closeMenuCallback]);\n        // console.log('this.openMenus', this.openMenus);\n        this.updateOverlay();\n    }\n\n    removeCloseMenuCallback(menuItem) {\n        const i = this.openMenus.findIndex(openMenu => openMenu[0] === menuItem);\n        if(i !== -1)\n            this.openMenus.splice(i, 1);\n        // this.updateOverlay();\n    }\n\n\n    closeMenus(butThese=[], stayOpenOnStick=true) {\n        // console.log('closeMenus', butThese, stayOpenOnStick);\n        // this.overlayContext.openMenuItems = [];\n        this.openMenus.forEach(openMenu => {\n            const [menuItem, closeMenuCallback] = openMenu;\n            if(butThese.indexOf(menuItem) !== -1)\n                return;\n            closeMenuCallback(stayOpenOnStick);\n        });\n        // this.updateOverlay();\n    }\n\n\n    closeAllMenus(e) {\n        this.closeMenus(e, []);\n        this.setState({\n            open: false,\n            openOverlay: false,\n            options: null\n        });\n    }\n\n    async openMenu(options) {\n        if(!this.props.isActive)\n            return false;\n\n        if(typeof options === \"function\")\n            options = options(this);\n        if(options instanceof Promise)\n            options = await options;\n\n        this.setState({\n            open: true,\n            openOverlay: true,\n            options\n        });\n        return true;\n    }\n\n    // openOverlay() {\n    //     this.setState({\n    //         openOverlay: true,\n    //     });\n    //     return true;\n    // }\n    //\n    // closeOverlay() {\n    //     this.setState({\n    //         openOverlay: false,\n    //     });\n    //     return true;\n    // }\n}\n","import ASUIMenuAction from \"./ASUIMenuAction\";\nimport ASUIMenuDropDown from \"./dropdown/ASUIMenuDropDown\";\nimport ASUIDropDownContainer from \"./dropdown/ASUIDropDownContainer\";\nimport ASUIMenuBreak from \"./ASUIMenuBreak\";\nimport ASUIMenuOverlayContainer from \"./overlay/ASUIMenuOverlayContainer\";\n\nexport {\n    ASUIMenuAction,\n    ASUIMenuBreak,\n    ASUIMenuDropDown,\n    ASUIDropDownContainer,\n    ASUIMenuOverlayContainer\n}\n","import React from \"react\";\n\nclass ProgramLoader {\n    constructor(song) {\n        this.song = song;\n        // this.audioContext = audioContext;\n        // this.destinations = new WeakMap();\n    }\n\n\n    loadInstanceFromDestination(programID, destination) {\n        return this.loadInstanceFromID(programID);\n        // let programs = this.destinations.get(destination);\n        // if(!programs) {\n        //     programs = {};\n        //     this.destinations.set(destination, programs);\n        // }\n        // if(typeof programs[programID] === \"undefined\")\n        //     programs[programID] = this.programLoadInstance(programID);\n\n        // return programs[programID];\n    }\n\n    getData(programID) {\n        if (!this.song.data.programs[programID])\n            throw new Error(\"Invalid program ID: \" + programID);\n        return this.song.data.programs[programID];\n    }\n\n\n    getClassName(programID) {\n        const [className] = this.getData(programID);\n        return className;\n    }\n    getConfig(programID) {\n        const [, config] = this.getData(programID);\n        return config;\n    }\n    getClass(programID) {\n        const className = this.getClassName(programID);\n        const {classProgram} = ProgramLoader.getProgramClassInfo(className);\n        return classProgram;\n    }\n\n    loadInstanceFromID(programID) {\n        const [className, config] = this.getData(programID);\n        return ProgramLoader.loadInstance(className, config);\n    }\n\n\n    programLoadRenderer(programID) {\n        const [className, config] = this.getData(programID);\n        const {classRenderer: Renderer} = ProgramLoader.getProgramClassInfo(className);\n        return <Renderer\n            programID={programID}\n            config={config}\n        />;\n    }\n\n\n    /** Actions **/\n\n    stopProgramPlayback(programID) {\n        const classes = ProgramLoader.registeredProgramClasses;\n        const {classProgram} = classes[programID];\n        if(!classProgram.stopPlayback) {\n            // console.warn(classProgram.name + \" has no static stopPlayback method\");\n        } else {\n            classProgram.stopPlayback();\n        }\n    }\n\n    stopAllPlayback() {\n        const classes = ProgramLoader.registeredProgramClasses;\n        for(let i=0; i<classes.length; i++) {\n            this.stopProgramPlayback(i);\n        }\n    }\n\n    unloadAllPrograms() {\n        const classes = ProgramLoader.registeredProgramClasses;\n        for(let i=0; i<classes.length; i++) {\n            const {classProgram} = classes[i];\n            if(!classProgram.unloadAll) {\n                // TODO: use instance, not static\n                // console.warn(classProgram.name + \" has no static unloadAll method\");\n                continue;\n            }\n            classProgram.unloadAll();\n        }\n\n    }\n\n    /** Menu **/\n\n\n\n    /** Static **/\n\n    static loadInstance(className, config={}) {\n        const {classProgram} = this.getProgramClassInfo(className);\n        return new classProgram(config);\n    }\n\n    static getProgramClassInfo(className) {\n        const classes = ProgramLoader.registeredProgramClasses;\n        for(let i=0; i<classes.length; i++) {\n            const classInfo = classes[i];\n            if(classInfo.className === className)\n                return classInfo;\n        }\n        throw new Error(`Program class ${className} was not found`);\n    }\n\n\n\n    static addProgramClass(className, classProgram, classRenderer=null, title=null) {\n        // const className = classProgram.name;\n        const classes = ProgramLoader.registeredProgramClasses;\n        title = title || classProgram.name;\n        classes.push({classProgram, classRenderer, className, title})\n    }\n\n    static getRegisteredPrograms() { return ProgramLoader.registeredProgramClasses; }\n        // const classes = ProgramLoader.registeredProgramClasses;\n        // const results = [];\n        // for(let i=0; i<classes.length; i++) {\n        //     const classInfo = classes[i];\n        //     const {classObject, name, config} = classInfo;\n        //     const result = callback(classObject, name, config);\n        //     if(result !== null) results.push(result);\n        //     if(result === false) break;\n        // }\n        // return results;\n    // }\n    static registeredProgramClasses = []\n}\n\nexport default ProgramLoader;\n\n","import {ASUIMenuAction, ASUIMenuBreak, ASUIMenuDropDown} from \"../../components/menu\";\nimport {ASUIInputRange} from \"../../components\";\nimport ProgramLoader from \"../program/ProgramLoader\";\nimport React from \"react\";\nimport PromptManager from \"../prompt/PromptManager\";\n\nclass Values {\n\n    /** Menus **/\n\n    // TODO: move copy to SongValues\n    static renderMenuSelectCommand(onSelectValue, keyboardOctave=null) {\n        return (<>\n            <ASUIMenuDropDown options={() => this.renderMenuSelectCommandByFrequency(onSelectValue, keyboardOctave)}           >By Frequency</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuSelectCommandByOctave(onSelectValue, keyboardOctave)}              >By Octave</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown disabled options={() => this.renderMenuSelectCommandByNamed(onSelectValue)}               >By Alias</ASUIMenuDropDown>\n            <ASUIMenuDropDown disabled options={() => this.renderMenuSelectCommandByTrack(onSelectValue)}               >By Group</ASUIMenuDropDown>\n            <ASUIMenuAction onAction={async e => onSelectValue(await PromptManager.openPromptDialog(\"Insert custom command\"))}      >Custom Command</ASUIMenuAction>\n        </>);\n\n    }\n\n\n    // TODO: move copy to SongValues\n    static renderMenuSelectCommandByNamed(onSelectValue) {\n        return this.values.getAllNamedFrequencies((noteName, frequency, programID) =>\n            <ASUIMenuAction\n                key={noteName}\n                onAction={e => onSelectValue(noteName)}\n                children={noteName}\n            />\n        );\n    }\n\n    // TODO: move copy to SongValues\n    static renderMenuSelectCommandByTrack(onSelectValue, onTrackAdd=null) {\n        return (<>\n            {this.getAllSongGroups((trackName) =>\n                trackName === this.trackName ? null :\n                    <ASUIMenuAction\n                        key={trackName}\n                        disabled={trackName === this.state.selectedTrack}\n                        onAction={e => onSelectValue('@' + trackName)}\n                    >{trackName}</ASUIMenuAction>\n            )}\n            <ASUIMenuAction onAction={onTrackAdd} hasBreak  >Create New Track</ASUIMenuAction>\n        </>);\n    }\n\n\n    // renderMenuSelectCommandByCurrentOctave(onSelectValue, octave=null) {\n    //     octave = octave !== null ? octave : this.state.keyboardOctave;\n    //     return Values.getNoteFrequencies((noteName) =>\n    //         <MenuAction key={noteName} onAction={e => onSelectValue(`${noteName}${octave}`)}     >{noteName}{octave}</MenuAction>\n    //     );\n    // }\n\n\n    static renderMenuSelectCommandByFrequency(onSelectValue, keyboardOctave=null) {\n        return this.getNoteFrequencies((noteName) =>\n            <ASUIMenuDropDown key={noteName} options={() => this.renderMenuSelectCommandByFrequencyOctave(onSelectValue, noteName, keyboardOctave)}>\n                {noteName}\n            </ASUIMenuDropDown>\n        );\n    }\n\n    // TODO: move into lower menu?\n    static renderMenuSelectCommandByFrequencyOctave(onSelectValue, noteName, keyboardOctave=null) {\n        return (<>\n            {keyboardOctave !== null ? <ASUIMenuAction onAction={() => onSelectValue(noteName+''+keyboardOctave)}>{noteName+''+keyboardOctave} (Current)</ASUIMenuAction> : null}\n            {this.getNoteOctaves((octave) =>\n                <ASUIMenuAction key={octave} onAction={() => onSelectValue(noteName+''+octave)}>\n                    {noteName+''+octave}\n                </ASUIMenuAction>\n            )}\n        </>)\n    }\n\n    static renderMenuSelectCommandByOctave(onSelectValue, keyboardOctave=null) {\n        return (<>\n            {keyboardOctave !== null ? <ASUIMenuDropDown key={keyboardOctave} options={() => this.renderMenuSelectCommandByOctaveFrequency(onSelectValue, keyboardOctave)}>\n                {keyboardOctave} (Current)\n            </ASUIMenuDropDown> : null}\n            {this.getNoteOctaves((octave) =>\n                <ASUIMenuDropDown key={octave} options={() => this.renderMenuSelectCommandByOctaveFrequency(onSelectValue, octave)}>\n                    {octave}\n                </ASUIMenuDropDown>\n            )}\n        </>)\n    }\n\n    static renderMenuSelectCommandByOctaveFrequency(onSelectValue, octave) {\n        return this.getNoteFrequencies((noteName) =>\n            <ASUIMenuAction key={noteName} onAction={() => onSelectValue(noteName+''+octave)}     >{noteName+''+octave}</ASUIMenuAction>\n        );\n    }\n\n\n    static renderMenuSelectDuration(onSelectValue, currentDuration, timeDivision) {\n        return (<>\n            <ASUIMenuDropDown disabled options={() => renderMenuSelect('recent')}    >Recent</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown options={() => renderMenuSelect('fraction')}  >Fraction</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => renderMenuSelect('triplet')}   >Triplet</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => renderMenuSelect('dotted')}    >Dotted</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown disabled options={() => renderMenuSelect('custom')}    >Custom</ASUIMenuDropDown>\n        </>);\n\n        function renderMenuSelect(key) {\n            let results = [];\n            switch(key) {\n                case 'fraction':\n                    for (let i = 64; i > 1; i /= 2)\n                        results.push(\n                            <ASUIMenuAction key={`${i}a`} onAction={() => onSelectValue(1 / i * timeDivision, `1/${i}B`)}  >{`1/${i}B`}</ASUIMenuAction>\n                        );\n                    for (let i = 1; i <= 16; i++)\n                        results.push(\n                            <ASUIMenuAction key={`${i}b`} onAction={() => onSelectValue(i * timeDivision, i + 'B')}  >{i + 'B'}</ASUIMenuAction>\n                        );\n                    break;\n\n                case 'triplet':\n                    for (let i = 64; i > 1; i /= 2)\n                        results.push(\n                            <ASUIMenuAction key={`${i}a`} onAction={() => onSelectValue(1 / (i / 1.5) * timeDivision, `1/${i}T`)}  >{`1/${i}T`}</ASUIMenuAction>\n                        );\n                    for (let i = 1; i <= 16; i++)\n                        results.push(\n                            <ASUIMenuAction key={`${i}b`} onAction={() => onSelectValue((i / 1.5) * timeDivision, i + 'T')}  >{i + 'T'}</ASUIMenuAction>\n                        );\n                    break;\n\n                case 'dotted':\n                    for (let i = 64; i > 1; i /= 2)\n                        results.push(\n                            <ASUIMenuAction key={`${i}a`} onAction={() => onSelectValue(1 / (i * 1.5) * timeDivision, `1/${i}D`)}  >{`1/${i}D`}</ASUIMenuAction>\n                        );\n                    for (let i = 1; i <= 16; i++)\n                        results.push(\n                            <ASUIMenuAction key={`${i}b`} onAction={() => onSelectValue((i * 1.5) * timeDivision, i + 'D')}  >{i + 'D'}</ASUIMenuAction>\n                        );\n                    break;\n\n                default:\n                    throw new Error(\"Unknown key\");\n            }\n            return results;\n        }\n    }\n\n    static renderMenuSelectVelocity(onSelectValue, currentVelocity=null) {\n        const customAction = async () => {\n            const velocity = await PromptManager.openPromptDialog(\"Enter custom velocity (1-127)\", 127);\n            onSelectValue(velocity);\n        };\n        return (<>\n            <ASUIMenuAction onAction={()=>{}} disabled>Set Velocity</ASUIMenuAction>\n            <ASUIInputRange\n                min={0}\n                max={127}\n                value={currentVelocity}\n                onChange={(e, mixerValue) => onSelectValue(mixerValue)}\n            />\n            <ASUIMenuBreak/>\n            {this.getNoteVelocities((velocity) =>\n                <ASUIMenuAction key={velocity} onAction={() => onSelectValue(velocity)}  >{velocity}</ASUIMenuAction>)}\n            <ASUIMenuAction onAction={customAction} hasBreak >Custom</ASUIMenuAction>\n        </>);\n    }\n\n    /** @deprecated moved to Library **/\n    static renderMenuSelectAvailableProgram(onSelectValue, menuTitle=null) {\n        return (<>\n            {menuTitle ? <><ASUIMenuAction disabled onAction={() => {}}>{menuTitle}</ASUIMenuAction><ASUIMenuBreak/></> : null}\n            {ProgramLoader.getRegisteredPrograms().map((config, i) =>\n                <ASUIMenuAction key={i} onAction={() => onSelectValue(config.className)}       >{config.title}</ASUIMenuAction>\n            )}\n        </>);\n    }\n\n\n    /** UUID **/\n    static generateUUID() {\n        var d = new Date().getTime();\n        if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\n            d += performance.now(); //use high-precision timer if available\n        }\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            var r = (d + Math.random() * 16) % 16 | 0;\n            d = Math.floor(d / 16);\n            // eslint-disable-next-line no-mixed-operators\n            return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n        });\n    }\n\n    /** Values **/\n\n    static getNoteFrequencies(callback = (freq) => freq) {\n        const results = [];\n        const noteList = this.noteList();\n        for (let j = 0; j < noteList.length; j++) {\n            const noteFrequency = noteList[j];\n            const result = callback(noteFrequency);\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n    static getNoteOctaves(callback = (octave) => octave) {\n        const results = [];\n        for (let i = 1; i <= 8; i++) {\n            const result = callback(i);\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n\n    static getOctaveNoteFrequencies(callback = (freq) => freq) {\n        const results = [];\n        const noteFrequencies = this.noteList();\n        for (let i = 1; i <= 8; i++) {\n            for (let j = 0; j < noteFrequencies.length; j++) {\n                const noteFrequency = noteFrequencies[j] + i;\n                const result = callback(noteFrequency);\n                if(!addResult(results, result)) return results;\n            }\n        }\n        return results;\n    }\n\n\n    static getNoteVelocities(callback = (velocity) => velocity) {\n        const results = [];\n        for (let vi = 100; vi >= 0; vi -= 10) {\n            const result = callback(vi);\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n\n\n    static getBeatsPerMeasure(callback = (beatsPerMeasure, beatsPerMeasureString) => [beatsPerMeasure, beatsPerMeasureString]) {\n        const results = [];\n        for (let beatPerMeasure = 1; beatPerMeasure <= 12; beatPerMeasure++) {\n            const result = callback(beatPerMeasure, beatPerMeasure + ` beat${beatPerMeasure > 1 ? 's' : ''} per measure`);\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n    static getBeatsPerMinute(callback = (beatsPerMinute, beatsPerMinuteString) => [beatsPerMinute, beatsPerMinuteString]) {\n        const results = [];\n        for (let beatPerMinute = 40; beatPerMinute <= 300; beatPerMinute += 10) {\n            const result = callback(beatPerMinute, beatPerMinute + ` beat${beatPerMinute > 1 ? 's' : ''} per minute`);\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n    static getTrackerSegmentLengthInRows(callback = (lengthInTicks, lengthString) => [lengthInTicks, lengthString]) {\n        const results = [];\n        [4, 5, 6, 7, 8, 10, 12, 16, 24, 32, 48, 64, 96, 128]\n            .forEach(i => {\n                const result = callback(i, i + ' Rows');\n                if(!addResult(results, result)) return results;\n            });\n        return results;\n    }\n\n    static formatVelocity(velocity) {\n        if (typeof velocity !== 'number')\n            return 'N/A'; // throw new Error(\"Invalid Program\");\n        return velocity === 100 ? \"Max\" : velocity + '';\n    }\n\n\n\n    static formatProgramID(programID) {\n        if (typeof programID !== 'number')\n            return 'N/A'; // throw new Error(\"Invalid Program\");\n        return programID < 10 ? \"0\" + programID : \"\" + programID;\n    }\n\n    static formatCommand(commandString) {\n        return commandString;\n    }\n\n    static formatPlaybackPosition(seconds) {\n        let m = Math.floor(seconds / 60);\n        seconds = seconds % 60;\n        let ms = Math.round((seconds - Math.floor(seconds)) * 1000);\n        seconds = Math.floor(seconds);\n\n        m = (m + '').padStart(2, '0');\n        seconds = (seconds + '').padStart(2, '0');\n        ms = (ms + '').padStart(3, '0'); // TODO: ticks?\n        return `${m}:${seconds}:${ms}`;\n    }\n\n    static parsePlaybackPosition(formattedSeconds) {\n        const parts = formattedSeconds.toString().split(':');\n        return (parseInt(parts[0], 10) * 60)\n            + (parseInt(parts[1], 10))\n            + (parseInt(parts[2], 10) / 1000);\n    }\n\n    static parseFrequencyString(note) {\n        if (typeof note !== \"string\")\n            throw new Error(\"Frequency is not a string\");\n        if (!note)\n            throw new Error(\"Frequency is null\");\n\n        const noteQuarterToneList = this.noteQuarterToneList();\n        const noteScale = note.slice(0, -1);\n        const octave = parseInt(note.slice(-1));\n        if(isNaN(octave))\n            throw new Error(\"Invalid octave value: \" + note);\n        if(typeof noteQuarterToneList[noteScale] === \"undefined\")\n            throw new Error(\"Unrecognized Note: \" + noteScale);\n        let keyNumber = noteQuarterToneList[noteScale];\n\n        if (keyNumber < 6)\n            keyNumber = keyNumber + 24 + ((octave - 1) * 24) + 2;\n        else\n            keyNumber = keyNumber + ((octave - 1) * 24) + 2;\n\n        return 440 * Math.pow(2, (keyNumber - 98) / 24);\n    }\n\n\n    /** Duration **/\n    static parseDurationAsTicks(durationString, timeDivision) {\n        if(!timeDivision)\n            throw new Error(\"Invalid timeDivision\");\n        if (typeof durationString !== 'string')\n            return durationString;\n        const units = durationString.substr(durationString.length - 1);\n        let fraction = durationString.substr(0, durationString.length - 1);\n        if(fraction.indexOf('/') !== -1) {\n            const fractionSplit = fraction.split('/');\n            fraction = parseInt(fractionSplit[0], 10) / parseInt(fractionSplit[1], 10);\n        }\n        switch (units) {\n            case 't':\n                return parseInt(fraction);\n            case 'B':\n                return timeDivision * parseFloat(fraction);\n            case 'D':\n                return timeDivision * 1.5 * parseFloat(fraction);\n            case 'T':\n                return timeDivision / 1.5 * parseFloat(fraction);\n            default:\n                throw new Error(\"Invalid Duration: \" + durationString);\n        }\n    }\n\n    static formatDuration(input, timeDivision) {\n        let stringValue;\n        this.getNoteDurations((duration, durationString) => {\n            if (input === duration || input === durationString) {\n                stringValue = durationString;\n                return false;\n            }\n        }, timeDivision);\n\n        if (stringValue)\n            return stringValue;\n        const beatDivisor = input / timeDivision;\n        if(beatDivisor === Math.round(beatDivisor))\n            return beatDivisor + 'B';\n\n        input = parseFloat(input).toFixed(2);\n        return input.replace('.00', 't');\n    }\n\n\n    static getNoteDurations(callback = (duration, durationString) => [duration, durationString], timeDivision) {\n        const results = [];\n        for (let i = 64; i > 1; i /= 2) {\n            let result = callback(1 / i * timeDivision, `1/${i}B`);            // Full Beats\n            if(!addResult(results, result)) return results;\n        }\n        for (let i = 64; i > 1; i /= 2) {\n            let result = callback((1 / i) / 1.5 * timeDivision, `1/${i}T`); // Triplet\n            if(!addResult(results, result)) return results;\n        }\n        for (let i = 64; i > 1; i /= 2) {\n            let result = callback(1 / i * 1.5 * timeDivision, `1/${i}D`);      // Dotted\n            if(!addResult(results, result)) return results;\n        }\n\n        for (let i = 1; i <= 16; i++) {\n            let result = callback(i * timeDivision, `${i}B`);            // Full Beats\n            if(!addResult(results, result)) return results;\n        }\n\n        for (let i = 1; i <= 16; i++) {\n            let result = callback(i / 1.5 * timeDivision, `${i}T`); // Triplet\n            if(!addResult(results, result)) return results;\n        }\n\n        for (let i = 1; i <= 16; i++) {\n            let result = callback(i * 1.5 * timeDivision, `${i}D`);      // Dotted\n            if(!addResult(results, result)) return results;\n        }\n        return results;\n    }\n\n    // get noteFrequencies() {\n    //     return this.renderer.noteFrequencies; // ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    // }\n\n\n    /** Frequency **/\n    // const noteCommands = ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#'];\n    // Uses quarter tones\n    static noteList() {\n        return [\n            'A',\n            'A#',\n            'Bb',\n            'B',\n            'C',\n            'C#',\n            'Db',\n            'D',\n            'D#',\n            'Eb',\n            'E',\n            'E#',\n            'F',\n            'F#',\n            'Gb',\n            'G',\n            'G#',\n            'Ab',\n        ]\n    }\n\n    static noteQuarterToneList() {\n        return {\n            'A': 0,\n            'Aq': 1,\n            'A#': 2,\n            'A#q': 3,\n            'Bb': 2,\n            'Bbq': 3,\n            'B': 4,\n            'Bq': 5,\n            'C': 6,\n            'Cq': 7,\n            'C#': 8,\n            'C#q': 9,\n            'Db': 8,\n            'Dbq': 9,\n            'D': 10,\n            'Dq': 11,\n            'D#': 12,\n            'D#q': 13,\n            'Eb': 12,\n            'Ebq': 13,\n            'E': 14,\n            'Eq': 15,\n            'E#': 16,\n            'E#q': 17,\n            'F': 16,\n            'Fq': 17,\n            'F#': 18,\n            'F#q': 19,\n            'Gb': 18,\n            'Gbq': 19,\n            'G': 20,\n            'Gq': 21,\n            'G#': 22,\n            'G#q': 23,\n            'Ab': 22,\n            'Abq': 23,\n        }\n    }\n}\n\nfunction addResult (results, result) {\n    if (result !== null && typeof result !== \"undefined\")\n        results.push(result);\n    return result === false ? result : true;\n}\n\n\n\nexport default Values;\n\n\n","import Values from \"../../common/values/Values\";\n\nclass Instruction {\n    constructor(instructionData = [0]) {\n        this.data = instructionData;\n    }\n\n    get command() {\n        return this.data[1];\n    }\n\n    set command(newCommand) {\n        this.data[1] = newCommand;\n    }\n\n\n    get deltaDurationTicks() {\n        return this.data[0];\n    }\n\n    set deltaDurationTicks(newDeltaDuration) {\n        this.data[0] = newDeltaDuration;\n    }\n\n    getDurationString(timeDivision) {\n        const durationTicks = this.durationTicks;\n        if(durationTicks === null)\n            return 'N/A';\n        return Values.formatDuration(durationTicks, timeDivision);\n    }\n    set durationTicks(newDuration)  { throw new Error(\"TODO: Implement for \" + this.constructor.name);}\n    get durationTicks()             { throw new Error(\"TODO: Implement for \" + this.constructor.name);}\n    get clone()          { throw new Error(\"TODO: Implement for \" + this.constructor.name);}\n\n    /** @deprecated **/\n    set velocity(velocity)  { throw new Error(\"TODO: Implement for \" + this.constructor.name);}\n    /** @deprecated **/\n    get velocity()          { throw new Error(\"TODO: Implement for \" + this.constructor.name);}\n\n\n\n    /** Static **/\n\n    static processInstructionTracks(trackList) {\n        Object.keys(trackList).forEach((trackName, i) =>\n            this.processInstructionTrack(trackList[trackName]));\n    }\n    static processInstructionTrack(instructionList) {\n        if(!Array.isArray(instructionList))\n            throw new Error(\"Invalid ASCTrack instruction array\");\n        for(let i=0; i<instructionList.length; i++) {\n            const instruction = this.parseInstruction(instructionList[i]);\n            instructionList[i] = instruction.data;\n        }\n    }\n\n    static parseInstruction(instructionData) {\n        if (instructionData instanceof Instruction)\n            return instructionData;\n        if(typeof instructionData === \"number\")\n            instructionData = [instructionData];\n        if(typeof instructionData === \"string\")\n            instructionData = [0, instructionData];\n        if(!Array.isArray(instructionData))\n            throw new Error(\"Invalid instruction data\");\n        if(typeof instructionData[0] === \"string\")\n            instructionData.unshift(0);\n        return this.getInstruction(instructionData);\n    }\n\n    static getInstruction(instructionData) {\n        if(!instructionData)\n            throw new Error(\"Invalid Instruction data\");\n        const commandString = instructionData[1];\n        if(typeof commandString === \"string\") {\n            switch(commandString[0]) {\n                case '@':\n                    return new (require(\"./TrackInstruction\").default)(instructionData);\n                case '!':\n                    return new (require(\"./CommandInstruction\").default)(instructionData);\n                default:\n                    return new (require(\"./NoteInstruction\").default)(instructionData);\n            }\n\n        } else if(typeof commandString === \"number\") {\n            return new (require(\"./MIDIInstruction\").default)(instructionData);\n        }\n        throw new Error(\"Unknown Instruction\");\n        // if(this.isMIDIInstruction(instructionData))\n    }\n\n\n    // static isTrackInstruction(instructionData) {\n    //     return typeof instructionData[1] === \"string\" && instructionData[1][0] === '@';\n    // }\n    //\n    // static isMIDIInstruction(instructionData) {\n    //     return typeof instructionData[1] === \"number\";\n    // }\n\n\n}\n\n\nexport default Instruction;\n\n\n\n","import React from \"react\";\n\nconst unimplemented = function() { throw new Error(\"MenuContext Object is unimplemented\")};\nconst ASUIMenuContext = React.createContext({\n    openMenu: (options) =>                      unimplemented,\n    closeMenus: (butThese=[]) =>            unimplemented,\n    closeAllMenus: () =>                        unimplemented,\n    isHoverEnabled: () =>                       unimplemented,\n    removeDropDownMenu: (openMenuItem) =>       unimplemented,\n    addDropDownMenu: (openMenuItem) =>          unimplemented,\n});\n\nexport default ASUIMenuContext;\n","import Values from \"../../common/values/Values\";\n\nclass SongValues {\n    constructor(song) {\n        this.song = song;\n    }\n\n\n    getSongPrograms(callback = (id, name) => [id, name]) {\n        const song = this.song;\n        const results = [];\n        if (song && song.data.programs) {\n            const programList = song.data.programs;\n            for (let programID = 0; programID < programList.length; programID++) {\n                const [programClass, programInfo] = programList[programID]; //  || {title: \"No Program Loaded\"};\n                // const programs = this.renderer.getProgram(programID);\n                const result = callback(programID, programClass, programInfo);\n                if(!addResult(results, result)) return results;\n            }\n        }\n        return results;\n    }\n\n    getAllSongGroups(callback = (trackName) => trackName) {\n        const song = this.song;\n        const results = [];\n        const instructionList = song.data.tracks;\n        Object.keys(instructionList).forEach(function (key, i) {\n            const result = callback(key);\n            if(!addResult(results, result)) return results;\n        });\n        return results;\n    }\n\n\n    getAllNamedFrequencies(callback = (alias, aliasValue, programID) => [alias, aliasValue, programID]) {\n        return 'TODO';\n        // const song = this.song;\n        // const results = [];\n        // const programList = song.data.programs;\n        // for (let programID = 0; programID < programList.length; programID++) {\n        //     if (song.hasProgram(programID)) {\n        //         const instance = song.getProgram(programID);\n        //         if (instance.getFrequencyAliases) {\n        //             const aliases = instance.getFrequencyAliases();\n        //             for (const alias in aliases) {\n        //                 if (aliases.hasOwnProperty(alias)) {\n        //                     const aliasValue = aliases[alias];\n        //                     const result = callback(alias, aliasValue, programID);\n        //                     if(!addResult(results, result)) return results;\n        //                 }\n        //             }\n        //         }\n        //     }\n        // }\n        // return results;\n    }\n\n\n\n\n    formatSongDuration(input) {\n        return Values.formatDuration(input, this.song.data.timeDivision);\n    }\n\n\n    /** Duration **/\n\n    parseDurationAsTicks(durationString) {\n        return Values.parseDurationAsTicks(durationString, this.song.data.timeDivision);\n    }\n\n    formatDuration(input) {\n        return Values.formatDuration(input, this.song.data.timeDivision);\n    }\n\n\n    getNoteDurations(callback = (duration, durationString) => [duration, durationString]) {\n        return Values.getNoteDurations(callback, this.song.data.timeDivision);\n    }\n\n}\n\nfunction addResult (results, result) {\n    if (result !== null && typeof result !== \"undefined\")\n        results.push(result);\n    return result === false ? result : true;\n}\n\n\n\nexport default SongValues;\n","export default class LocalStorage {\n    static async setItem(key, value) {\n        return localStorage.setItem(key, value);\n    }\n\n    static async getItem(key) {\n        return localStorage.getItem(key);\n    }\n};\n","import LZString from 'lz-string';\nimport Values from \"../values/Values\";\n\nimport LocalStorage from \"./LocalStorage\";\n\nclass Storage {\n    /** Loading **/\n\n    async getRecentSongList() {\n        return this.decodeForStorage((await LocalStorage.getItem('song-recent-list')) || '[]');\n    }\n\n\n    /** Encoding / Decoding **/\n\n    encodeForStorage(json, replacer = null, space = null) {\n        let encodedString = JSON.stringify(json, replacer, space);\n//             console.log(`Compression: ${compressedString.length} / ${encodedString.length} = ${Math.round((compressedString.length / encodedString.length)*100)/100}`);\n        return LZString.compress(encodedString);\n    }\n\n    decodeForStorage(encodedString) {\n        if (!encodedString)\n            return null;\n        encodedString = LZString.decompress(encodedString) || encodedString;\n        return JSON.parse(encodedString);\n    }\n\n    /** Saving **/\n\n    async saveState(state, key='audio-source-state') {\n        await LocalStorage.setItem(key, JSON.stringify(state));\n    }\n\n    async loadState(key='audio-source-state') {\n        let state = await LocalStorage.getItem(key);\n        if (state)\n            state = JSON.parse(state);\n        return state;\n    }\n\n    async saveSongToMemory(songData, songHistory) {\n        // const song = this.data;\n        if (!songData.uuid)\n            songData.uuid = Values.generateUUID();\n        let songRecentUUIDs = [];\n        try {\n            songRecentUUIDs = this.decodeForStorage(await LocalStorage.getItem('song-recent-list') || '[]');\n        } catch (e) {\n            console.error(e);\n        }\n        songRecentUUIDs = songRecentUUIDs.filter((entry) => entry.uuid !== songData.uuid);\n        songRecentUUIDs.unshift({uuid: songData.uuid, title: songData.title});\n        await LocalStorage.setItem('song-recent-list', this.encodeForStorage(songRecentUUIDs));\n\n\n        await LocalStorage.setItem('song:' + songData.uuid, this.encodeForStorage(songData));\n        await LocalStorage.setItem('song-history:' + songData.uuid, this.encodeForStorage(songHistory)); // History stored separately due to memory limits\n        // this.querySelector('.song-menu').outerHTML = renderEditorMenuContent(this);\n        console.info(\"Song saved to memory: \" + songData.uuid, songData);\n    }\n\n    saveSongToFile(songData, prompt = true) {\n        // const song = this.data;\n        const instructionsKey = \"/** INSTRUCTIONS-\" + Values.generateUUID() + ' **/';\n        let jsonStringInstructions = JSON.stringify(songData.tracks);\n        let jsonString = JSON.stringify(Object.assign({}, songData, {\n            tracks: instructionsKey\n        }), null, \"\\t\");\n        jsonString = jsonString.replace('\"' + instructionsKey + '\"', jsonStringInstructions);\n        const dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(jsonString);\n        const downloadAnchorNode = document.createElement('a');\n        downloadAnchorNode.setAttribute(\"href\", dataStr);\n\n        let fileName = (songData.title || \"untitled\")\n                .replace(/\\s+/g, '_')\n            + '.json';\n        if (prompt)\n            fileName = window.prompt(\"Download as file?\", fileName);\n        if (!fileName)\n            return console.warn(\"Download canceled\");\n        downloadAnchorNode.setAttribute(\"download\", fileName);\n        document.body.appendChild(downloadAnchorNode); // required for firefox\n        downloadAnchorNode.click();\n        downloadAnchorNode.remove();\n    }\n\n    /** Loading **/\n\n    async loadSongFromMemory(songUUID) {\n        let songDataString = await LocalStorage.getItem('song:' + songUUID);\n        if (!songDataString)\n            throw new Error(\"Song Data not found for uuid: \" + songUUID);\n        let songData = this.decodeForStorage(songDataString);\n        if (!songData)\n            throw new Error(\"Invalid Song Data: \" + songDataString);\n        return songData;\n        // console.info(\"Song loaded from memory: \" + songUUID, songData, this.songHistory);\n    }\n\n    async loadSongHistoryFromMemory(songUUID) {\n        let songHistoryString = await LocalStorage.getItem('song-history:' + songUUID);\n        if (!songHistoryString)\n            return null;\n        return this.decodeForStorage(songHistoryString);\n        // this.render();\n        //this.gridSelect(null, 0);\n        // console.info(\"Song loaded from memory: \" + songUUID, songData, this.songHistory);\n    }\n\n\n    /** Batch Commands **/\n\n    async getBatchRecentCommands() {\n        let batchRecentCommands = await LocalStorage.getItem('batch-recent-commands');\n        if (!batchRecentCommands)\n            return [];\n        batchRecentCommands = JSON.parse(batchRecentCommands);\n        return batchRecentCommands;\n    }\n\n    async addBatchRecentCommands(batchCommand) {\n        let batchRecentCommands = this.getBatchRecentCommands();\n        if (batchRecentCommands.indexOf(batchCommand) === -1) {\n            batchRecentCommands.unshift(batchCommand);\n        }\n        await LocalStorage.setItem('batch-recent-commands', JSON.stringify(batchRecentCommands));\n    }\n\n    /** Batch Searches **/\n\n    async getBatchRecentSearches() {\n        let batchRecentSearches = await LocalStorage.getItem('batch-recent-searches');\n        if (!batchRecentSearches)\n            return [];\n        batchRecentSearches = JSON.parse(batchRecentSearches);\n        return batchRecentSearches;\n    }\n\n    async addBatchRecentSearches(batchCommand) {\n        let batchRecentSearches = this.getBatchRecentSearches();\n        if (batchRecentSearches.indexOf(batchCommand) === -1) {\n            batchRecentSearches.unshift(batchCommand);\n        }\n        await LocalStorage.setItem('batch-recent-searches', JSON.stringify(batchRecentSearches));\n    }\n\n\n    //\n    // historyQueue(songHistory) {\n    //     if(!Array.isArray(songHistory))\n    //         songHistory = [];\n    //     for(let i=0; i<songHistory.length; i++) {\n    //         const historyAction = songHistory[i];\n    //         this.status.history.currentStep++;\n    //         historyAction.step = this.status.history.currentStep;\n    //     }\n    //     //\n    //     // this.status.history.undoList.push(historyAction);\n    //     // this.status.history.undoPosition = this.status.history.undoList.length-1;\n    //\n    //     if(this.webSocket && songHistory.length > 0) {\n    //         console.info(\"Sending history actions: \", songHistory);\n    //         this.webSocket\n    //             .send(this.encodeForStorage({\n    //                 type: 'history:entry',\n    //                 songHistory: songHistory,\n    //                 // uuid: this.uuid\n    //             }))\n    //     }\n    // }\n    //\n    // historyUndo() {\n    //\n    // }\n    //\n    // historyRedo() {\n    //\n    // }\n    // clearHistoryActions() {\n    //     const actions = this.songHistory;\n    //     this.songHistory = [];\n    //     return actions;\n    // }\n\n\n}\n\n\nexport default Storage;\n","//\n// Player can be viewed as a state machine with\n// 3 states (playing, paused, stopped) and 5 transitions\n// (open, pause, unpause, seek, stop).\n// If the player has reached end of the song,\n// it is in the terminal \"stopped\" state and is\n// no longer playable:\n//                         ╭– (seek) –╮\n//                         ^          v\n//  ┌─ ─ ─ ─ ─┐         ┌─────────────────┐            ┌─────────┐\n//  │ stopped │–(open)–>│     playing     │––(stop)–––>│ stopped │\n//  └ ─ ─ ─ ─ ┘         └─────────────────┘            └─────────┘\n//                        | ┌────────┐ ^\n//                (pause) ╰>│ paused │–╯ (unpause)\n//                          └────────┘\n//\n// In the \"open\" transition, the audioNode is connected.\n// In the \"stop\" transition, it is disconnected.\n// \"stopped\" is synonymous with closed/empty.\n//\nexport default class Player {\n  constructor(audioCtx, destNode, chipCore, onPlayerStateUpdate) {\n    this._outerAudioProcess = this._outerAudioProcess.bind(this);\n\n    this.paused = true;\n    this.fileExtensions = [];\n    this.metadata = {};\n    this.audioCtx = audioCtx;\n    this.destinationNode = destNode;\n    this.onPlayerStateUpdate = onPlayerStateUpdate;\n    this.bufferSize = 2048;\n    this._innerAudioProcess = null;\n    this.audioNode = this.audioCtx.createScriptProcessor(this.bufferSize, 2, 2);\n    this.audioNode.onaudioprocess = this._outerAudioProcess;\n    this.debug = window.location.search.indexOf('debug=true') !== -1;\n    this.timeCount = 0;\n    this.renderTime = 0;\n    this.perfLoggingInterval = 100;\n  }\n\n  togglePause() {\n    this.paused = !this.paused;\n    return this.paused;\n  }\n\n  isPaused() {\n    return this.paused;\n  }\n\n  resume() {\n    this.paused = false;\n  }\n\n  canPlay(fileExtension) {\n    return this.fileExtensions.indexOf(fileExtension.toLowerCase()) !== -1;\n  }\n\n  loadData(data, filename) {\n    throw Error('Player.loadData() must be implemented.');\n  }\n\n  stop() {\n    throw Error('Player.stop() must be implemented.');\n  }\n\n  isPlaying() {\n    throw Error('Player.isPlaying() must be implemented.');\n  }\n\n  setTempo() {\n    console.warn('Player.setTempo() not implemented for this player.');\n  }\n\n  setVoices() {\n    console.warn('Player.setVoices() not implemented for this player.');\n  }\n\n  setFadeout(startMs) {\n    console.warn('Player.setFadeout() not implemented for this player.');\n  }\n\n  getVoiceName(index) {\n    console.warn('Player.getVoiceName() not implemented for this player.');\n  }\n\n  getNumVoices() {\n    return 0;\n  }\n\n  getNumSubtunes() {\n    return 1;\n  }\n\n  getSubtune() {\n    return 0;\n  }\n\n  getMetadata() {\n    return {\n      title: null,\n      author: null,\n    }\n  }\n\n  getParamDefs() {\n    return [];\n  }\n\n  connect() {\n    if (!this._innerAudioProcess) {\n      throw Error('Player.setAudioProcess has not been called.');\n    }\n    this.audioNode.connect(this.destinationNode);\n  }\n\n  suspend() {\n    this.stopped = true;\n    this.paused = true;\n  }\n\n  setOnPlayerStateUpdate(fn) {\n    this.onPlayerStateUpdate = fn;\n  }\n\n  setAudioProcess(fn) {\n    if (typeof fn !== 'function') {\n      throw Error('AudioProcess must be a function.');\n    }\n    this._innerAudioProcess = fn;\n  }\n\n  _outerAudioProcess(event) {\n    const start = performance.now();\n    this._innerAudioProcess(event);\n    const end = performance.now();\n\n    if (this.debug) {\n      this.renderTime += end - start;\n      this.timeCount++;\n      if (this.timeCount >= this.perfLoggingInterval) {\n        const cost = this.renderTime / this.timeCount;\n        const budget = 1000 * this.bufferSize / this.audioCtx.sampleRate;\n        console.log(\n          '[%s] %s ms to render %d frames (%s ms) (%s% utilization)',\n          this.constructor.name,\n          cost.toFixed(2),\n          this.bufferSize,\n          budget.toFixed(1),\n          (100 * cost / budget).toFixed(1),\n        );\n        this.renderTime = 0.0;\n        this.timeCount = 0;\n      }\n    }\n  }\n\n  muteAudioDuringCall(audioNode, fn) {\n    if (audioNode && audioNode.context.state === 'running' && this.paused === false) {\n      const audioprocess = audioNode.onaudioprocess;\n      // Workaround to eliminate stuttering:\n      // Temporarily swap the audio process callback, and do the\n      // expensive operation only after buffer is filled with silence\n      audioNode.onaudioprocess = function (e) {\n        for (let i = 0; i < e.outputBuffer.numberOfChannels; i++) {\n          e.outputBuffer.getChannelData(i).fill(0);\n        }\n        fn();\n        audioNode.onaudioprocess = audioprocess;\n      };\n    } else {\n      fn();\n    }\n  }\n\n  static metadataFromFilepath(filepath) {\n    // Guess metadata from path/filename for MIDI files.\n    // Assumes structure:  /Game MIDI/{game}/**/{title}\n    //             ...or:  /MIDI/{artist}/**/{title}\n    const parts = filepath.split('/');\n    const meta = {};\n    meta.title = parts.pop();\n    meta.system = parts.shift();\n    if (meta.system === 'Game MIDI') {\n      meta.game = parts.shift();\n    } else {\n      meta.artist = parts.shift();\n    }\n    return meta;\n  }\n}\n","import { CalcCascades, IirFilter } from 'fili';\n\nexport default class SubBass {\n  constructor(sampleRate) {\n    const iirCalculator = new CalcCascades();\n    const lowpass1Coeffs = iirCalculator.lowpass({\n      order: 5,\n      characteristic: 'butterworth',\n      Fs: sampleRate,\n      Fc: 200,\n      gain: 0,\n    });\n\n    const lowpass2Coeffs = iirCalculator.lowpass({\n      order: 3,\n      characteristic: 'butterworth',\n      Fs: sampleRate,\n      Fc: 120,\n      gain: 0,\n    });\n\n    const highpassCoeffs = iirCalculator.highpass({\n      order: 3,\n      characteristic: 'butterworth',\n      Fs: sampleRate,\n      Fc: 25,\n      gain: 0,\n    });\n\n    const lowpass1 = new IirFilter(lowpass1Coeffs);\n    const lowpass2 = new IirFilter(lowpass2Coeffs);\n    const highpass = new IirFilter(highpassCoeffs);\n    const numOctaves = 1;\n    const dcResponseTime = 0.16;\n    const envResponseTime = 0.016;\n\n    let sCurr = 0;\n    let sPrev = 0;\n    let cycleCounter = 0;\n    let dcAvg = 0;\n    let dcWeight = Math.exp(-1 / (sampleRate * dcResponseTime));\n    let envAvg = 0;\n    let envWeight = Math.exp(-1 / (sampleRate * envResponseTime));\n\n    function removeDcStep(sample) {\n      dcAvg = dcWeight * dcAvg + (1 - dcWeight) * sample;\n      return sample - dcAvg;\n    }\n\n    function envelopeStep(sample) {\n      sample = removeDcStep(sample);\n      envAvg = envWeight * envAvg + (1 - envWeight) * Math.abs(sample);\n      return envAvg * 1.414; // invert sine RMS\n    }\n\n    this.process = (sample) => {\n      const sBass = lowpass1.singleStep(sample);\n      const env = envelopeStep(sBass);\n\n      sPrev = sCurr;\n      sCurr = sBass;\n\n      // detect zero crossing (low to high)\n      if (sPrev < 0 && sCurr >= 0) {\n        cycleCounter = (cycleCounter + 1) % Math.pow(2, numOctaves);\n      }\n\n      let sOctaves = 0;\n      for (let i = 0; i < numOctaves; i++) {\n        const bit = cycleCounter & (1 << i);\n        sOctaves += bit ? 1 : -1;\n      }\n\n      const sSub = highpass.singleStep(lowpass2.singleStep(sOctaves));\n      return sSub * env;\n    }\n  }\n}","import Player from \"./Player.js\";\n// import App from \"../App\";\nimport SubBass from \"../effects/SubBass\";\nimport encoding from \"encoding-japanese\";\n\nlet emu = null;\nlet libgme = null;\nconst INT16_MAX = 65535;\nconst fileExtensions = [\n  'nsf',\n  'nsfe',\n  'spc',\n  'gym',\n  'vgm',\n  'vgz',\n  'ay',\n  'sgc',\n  'kss',\n];\n\nexport default class GMEPlayer extends Player {\n  constructor(audioCtx, destNode, chipCore, onPlayerStateUpdate) {\n    super(audioCtx, destNode, chipCore, onPlayerStateUpdate);\n    this.setParameter = this.setParameter.bind(this);\n    this.getParameter = this.getParameter.bind(this);\n    this.getParamDefs = this.getParamDefs.bind(this);\n\n    libgme = chipCore;\n    this.paused = false;\n    this.fileExtensions = fileExtensions;\n    this.subtune = 0;\n    this.tempo = 1.0;\n    this.params = { subbass: 1 };\n\n    this.buffer = libgme.allocate(this.bufferSize * 16, 'i16', libgme.ALLOC_NORMAL);\n    this.emuPtr = libgme.allocate(1, 'i32', libgme.ALLOC_NORMAL);\n\n    this.subBass = new SubBass(audioCtx.sampleRate);\n\n    this.setAudioProcess(this.gmeAudioProcess);\n  }\n\n  gmeAudioProcess(e) {\n    let i, channel;\n    const channels = [];\n    for (channel = 0; channel < e.outputBuffer.numberOfChannels; channel++) {\n      channels[channel] = e.outputBuffer.getChannelData(channel);\n    }\n\n    if (this.paused) {\n      for (channel = 0; channel < channels.length; channel++) {\n        channels[channel].fill(0);\n      }\n      return;\n    }\n\n    if (this.getPositionMs() >= this.getDurationMs() && this.fadingOut === false) {\n      console.log('Fading out at %d ms.', this.getPositionMs());\n      this.setFadeout(this.getPositionMs());\n      this.fadingOut = true;\n    }\n\n    if (libgme._gme_track_ended(emu) !== 1) {\n      libgme._gme_play(emu, this.bufferSize * 2, this.buffer);\n\n      for (channel = 0; channel < channels.length; channel++) {\n        for (i = 0; i < this.bufferSize; i++) {\n          channels[channel][i] = libgme.getValue(this.buffer +\n            // Interleaved channel format\n            i * 2 * 2 +             // frame offset   * bytes per sample * num channels +\n            channel * 2,            // channel offset * bytes per sample\n            'i16') / INT16_MAX;     // convert int16 to float\n        }\n      }\n\n      if (this.params.subbass > 0) {\n        for (i = 0; i < this.bufferSize; i++) {\n          const sub = this.subBass.process(channels[0][i]) * this.params.subbass;\n          channels[0][i] += sub;\n          channels[1][i] += sub;\n        }\n      }\n    } else {\n      this.subtune++;\n\n      if (this.subtune >= libgme._gme_track_count(emu) || this.playSubtune(this.subtune) !== 0) {\n        this.suspend();\n        console.debug(\n          'GMEPlayer.gmeAudioProcess(): _gme_track_ended == %s and subtune (%s) > _gme_track_count (%s).',\n          libgme._gme_track_ended(emu),\n          this.subtune,\n          libgme._gme_track_count(emu)\n        );\n        this.onPlayerStateUpdate(true);\n      }\n    }\n  }\n\n  playSubtune(subtune) {\n    this.fadingOut = false;\n    this.subtune = subtune;\n    this.metadata = this._parseMetadata(subtune);\n    console.debug('GMEPlayer.playSubtune(subtune=%s)', subtune);\n    this.onPlayerStateUpdate(false);\n    return libgme._gme_start_track(emu, subtune);\n  }\n\n  loadData(data, filepath) {\n    this.subtune = 0;\n    this.fadingOut = false;\n    this.filepathMeta = Player.metadataFromFilepath(filepath);\n    const formatNeedsBass = filepath.match(\n      /(\\.sgc$|\\.kss$|\\.nsfe?$|\\.ay$|Master System|Game Gear)/i\n    );\n    this.params.subbass = formatNeedsBass ? 1 : 0;\n\n    if (libgme.ccall(\n      \"gme_open_data\",\n      \"number\",\n      [\"array\", \"number\", \"number\", \"number\"],\n      [data, data.length, this.emuPtr, this.audioCtx.sampleRate]\n    ) !== 0) {\n      console.error(\"gme_open_data failed.\");\n      this.stop();\n      throw Error('Unable to load this file: ' + filepath);\n    }\n    emu = libgme.getValue(this.emuPtr, \"i32\");\n\n    this.connect();\n    this.resume();\n    if (this.playSubtune(this.subtune) !== 0) {\n      console.error(\"gme_start_track failed.\");\n      throw Error('Unable to play this subtune!');\n    }\n  }\n\n  _parseMetadata(subtune) {\n    const metadataPtr = libgme.allocate(1, \"i32\", libgme.ALLOC_NORMAL);\n    if (libgme._gme_track_info(emu, metadataPtr, subtune) !== 0)\n      console.error(\"could not load metadata\");\n    const ref = libgme.getValue(metadataPtr, \"*\");\n\n    let offset = 0;\n\n    const readInt32 = function () {\n      var value = libgme.getValue(ref + offset, \"i32\");\n      offset += 4;\n      return value;\n    };\n\n    const readString = function () {\n      const raw = [];\n      const ptr = libgme.getValue(ref + offset, 'i8*');\n      for (let i = 0; i < 255; i++) {\n        let char = libgme.getValue(ptr + i, 'i8');\n        if (char === 0) {\n          break;\n        }\n        raw.push(char & 0xFF);\n      }\n\n      offset += 4;\n      return encoding.convert(raw, {to: 'UNICODE', type: 'string'});\n    };\n\n    const meta = {};\n\n    meta.length = readInt32();\n    meta.intro_length = readInt32();\n    meta.loop_length = readInt32();\n    meta.play_length = readInt32();\n\n    offset += 4 * 12; // skip unused bytes\n\n    meta.system = readString();\n    meta.game = readString();\n    meta.title = readString() || meta.game || this.filepathMeta.title;\n    meta.artist = readString() || this.filepathMeta.artist;\n    meta.copyright = readString();\n    meta.comment = readString();\n\n    // meta.formatted = {\n    //   title: meta.game === meta.title ?\n    //     meta.title :\n    //     App.allOrNone(meta.game, ' - ') + meta.title,\n    //   subtitle: [meta.artist, meta.system].filter(x => x).join(' - ') +\n    //     App.allOrNone(' (', meta.copyright, ')'),\n    // };\n\n    return meta;\n  }\n\n  getVoiceName(index) {\n    if (emu) return libgme.UTF8ToString(libgme._gme_voice_name(emu, index));\n  }\n\n  getNumVoices() {\n    if (emu) return libgme._gme_voice_count(emu);\n  }\n\n  getNumSubtunes() {\n    if (emu) return libgme._gme_track_count(emu);\n  }\n\n  getSubtune() {\n    return this.subtune;\n  }\n\n  getPositionMs() {\n    if (emu) return libgme._gme_tell_scaled(emu);\n    return 0;\n  }\n\n  getDurationMs() {\n    if (emu) return this.metadata.play_length;\n    return 0;\n  }\n\n  getMetadata() {\n    return this.metadata;\n  }\n\n  getParameter(id) {\n    return this.params[id];\n  }\n\n  getParamDefs() {\n    return [\n      {\n        id: 'subbass',\n        label: 'Sub Bass',\n        type: 'number',\n        min: 0.0,\n        max: 2.0,\n        step: 0.01,\n        value: 1.0,\n      },\n    ];\n  }\n\n  setParameter(id, value) {\n    switch (id) {\n      case 'subbass':\n        this.params[id] = parseFloat(value);\n        break;\n      default:\n        console.warn('GMEPlayer has no parameter with id \"%s\".', id);\n    }\n  }\n\n  isPlaying() {\n    return !this.isPaused() && libgme._gme_track_ended(emu) !== 1;\n  }\n\n  setTempo(val) {\n    this.tempo = val;\n    if (emu) libgme._gme_set_tempo(emu, val);\n  }\n\n  setFadeout(startMs) {\n    if (emu) libgme._gme_set_fade(emu, startMs, 4000);\n  }\n\n  setVoices(voices) {\n    let mask = 0;\n    voices.forEach((isEnabled, i) => {\n      if (!isEnabled) {\n        mask += 1 << i;\n      }\n    });\n    if (emu) libgme._gme_mute_voices(emu, mask);\n  }\n\n  seekMs(positionMs) {\n    if (emu) {\n      this.muteAudioDuringCall(this.audioNode, () =>\n        libgme._gme_seek_scaled(emu, positionMs));\n    }\n  }\n\n  stop() {\n    this.suspend();\n    if (emu) libgme._gme_delete(emu);\n    emu = null;\n    console.debug('GMEPlayer.stop()');\n    this.onPlayerStateUpdate(true);\n  }\n}\n","/*eslint-disable*/\n\nvar CHIP_CORE = (function() {\n      var _scriptDir = '';\n\n      return (function(CHIP_CORE) {\n            CHIP_CORE = CHIP_CORE || {};\n\n            var Module = typeof CHIP_CORE !== \"undefined\" ? CHIP_CORE : {};\n            var moduleOverrides = {};\n            var key;\n            for (key in Module) {\n              if (Module.hasOwnProperty(key)) {\n                moduleOverrides[key] = Module[key]\n              }\n            }\n            var arguments_ = [];\n            var thisProgram = \"./this.program\";\n            var quit_ = function(status, toThrow) {\n              throw toThrow\n            };\n            var ENVIRONMENT_IS_WEB = true;\n            var ENVIRONMENT_IS_WORKER = false;\n            var scriptDirectory = \"\";\n            function locateFile(path) {\n              if (Module[\"locateFile\"]) {\n                return Module[\"locateFile\"](path, scriptDirectory)\n              }\n              return scriptDirectory + path\n            }\n            var read_, readAsync, readBinary, setWindowTitle;\n            if (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {\n              if (ENVIRONMENT_IS_WORKER) {\n                scriptDirectory = self.location.href\n              } else if (document.currentScript) {\n                scriptDirectory = document.currentScript.src\n              }\n              if (_scriptDir) {\n                scriptDirectory = _scriptDir\n              }\n              if (scriptDirectory.indexOf(\"blob:\") !== 0) {\n                scriptDirectory = scriptDirectory.substr(0, scriptDirectory.lastIndexOf(\"/\") + 1)\n              } else {\n                scriptDirectory = \"\"\n              }\n              {\n                read_ = function shell_read(url) {\n                  var xhr = new XMLHttpRequest;\n                  xhr.open(\"GET\", url, false);\n                  xhr.send(null);\n                  return xhr.responseText\n                }\n                ;\n                if (ENVIRONMENT_IS_WORKER) {\n                  readBinary = function readBinary(url) {\n                    var xhr = new XMLHttpRequest;\n                    xhr.open(\"GET\", url, false);\n                    xhr.responseType = \"arraybuffer\";\n                    xhr.send(null);\n                    return new Uint8Array(xhr.response)\n                  }\n                }\n                readAsync = function readAsync(url, onload, onerror) {\n                  var xhr = new XMLHttpRequest;\n                  xhr.open(\"GET\", url, true);\n                  xhr.responseType = \"arraybuffer\";\n                  xhr.onload = function xhr_onload() {\n                    if (xhr.status == 200 || xhr.status == 0 && xhr.response) {\n                      onload(xhr.response);\n                      return\n                    }\n                    onerror()\n                  }\n                  ;\n                  xhr.onerror = onerror;\n                  xhr.send(null)\n                }\n              }\n              setWindowTitle = function(title) {\n                document.title = title\n              }\n            } else {}\n            var out = Module[\"print\"] || console.log.bind(console);\n            var err = Module[\"printErr\"] || console.warn.bind(console);\n            for (key in moduleOverrides) {\n              if (moduleOverrides.hasOwnProperty(key)) {\n                Module[key] = moduleOverrides[key]\n              }\n            }\n            moduleOverrides = null;\n            if (Module[\"arguments\"])\n              arguments_ = Module[\"arguments\"];\n            if (Module[\"thisProgram\"])\n              thisProgram = Module[\"thisProgram\"];\n            if (Module[\"quit\"])\n              quit_ = Module[\"quit\"];\n            function dynamicAlloc(size) {\n              var ret = HEAP32[DYNAMICTOP_PTR >> 2];\n              var end = ret + size + 15 & -16;\n              if (end > _emscripten_get_heap_size()) {\n                abort()\n              }\n              HEAP32[DYNAMICTOP_PTR >> 2] = end;\n              return ret\n            }\n            function getNativeTypeSize(type) {\n              switch (type) {\n                case \"i1\":\n                case \"i8\":\n                  return 1;\n                case \"i16\":\n                  return 2;\n                case \"i32\":\n                  return 4;\n                case \"i64\":\n                  return 8;\n                case \"float\":\n                  return 4;\n                case \"double\":\n                  return 8;\n                default:\n                {\n                  if (type[type.length - 1] === \"*\") {\n                    return 4\n                  } else if (type[0] === \"i\") {\n                    var bits = Number(type.substr(1));\n                    assert(bits % 8 === 0, \"getNativeTypeSize invalid bits \" + bits + \", type \" + type);\n                    return bits / 8\n                  } else {\n                    return 0\n                  }\n                }\n              }\n            }\n            var wasmBinary;\n            if (Module[\"wasmBinary\"])\n              wasmBinary = Module[\"wasmBinary\"];\n            var noExitRuntime;\n            if (Module[\"noExitRuntime\"])\n              noExitRuntime = Module[\"noExitRuntime\"];\n            if (typeof WebAssembly !== \"object\") {\n              err(\"no native wasm support detected\")\n            }\n            function setValue(ptr, value, type, noSafe) {\n              type = type || \"i8\";\n              if (type.charAt(type.length - 1) === \"*\")\n                type = \"i32\";\n              switch (type) {\n                case \"i1\":\n                  HEAP8[ptr >> 0] = value;\n                  break;\n                case \"i8\":\n                  HEAP8[ptr >> 0] = value;\n                  break;\n                case \"i16\":\n                  HEAP16[ptr >> 1] = value;\n                  break;\n                case \"i32\":\n                  HEAP32[ptr >> 2] = value;\n                  break;\n                case \"i64\":\n                  tempI64 = [value >>> 0, (tempDouble = value,\n                      +Math_abs(tempDouble) >= 1 ? tempDouble > 0 ? (Math_min(+Math_floor(tempDouble / 4294967296), 4294967295) | 0) >>> 0 : ~~+Math_ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)],\n                      HEAP32[ptr >> 2] = tempI64[0],\n                      HEAP32[ptr + 4 >> 2] = tempI64[1];\n                  break;\n                case \"float\":\n                  HEAPF32[ptr >> 2] = value;\n                  break;\n                case \"double\":\n                  HEAPF64[ptr >> 3] = value;\n                  break;\n                default:\n                  abort(\"invalid type for setValue: \" + type)\n              }\n            }\n            function getValue(ptr, type, noSafe) {\n              type = type || \"i8\";\n              if (type.charAt(type.length - 1) === \"*\")\n                type = \"i32\";\n              switch (type) {\n                case \"i1\":\n                  return HEAP8[ptr >> 0];\n                case \"i8\":\n                  return HEAP8[ptr >> 0];\n                case \"i16\":\n                  return HEAP16[ptr >> 1];\n                case \"i32\":\n                  return HEAP32[ptr >> 2];\n                case \"i64\":\n                  return HEAP32[ptr >> 2];\n                case \"float\":\n                  return HEAPF32[ptr >> 2];\n                case \"double\":\n                  return HEAPF64[ptr >> 3];\n                default:\n                  abort(\"invalid type for getValue: \" + type)\n              }\n              return null\n            }\n            var wasmMemory;\n            var wasmTable = new WebAssembly.Table({\n              \"initial\": 915,\n              \"maximum\": 915 + 0,\n              \"element\": \"anyfunc\"\n            });\n            var ABORT = false;\n            var EXITSTATUS = 0;\n            function assert(condition, text) {\n              if (!condition) {\n                abort(\"Assertion failed: \" + text)\n              }\n            }\n            function getCFunc(ident) {\n              var func = Module[\"_\" + ident];\n              assert(func, \"Cannot call unknown function \" + ident + \", make sure it is exported\");\n              return func\n            }\n            function ccall(ident, returnType, argTypes, args, opts) {\n              var toC = {\n                \"string\": function(str) {\n                  var ret = 0;\n                  if (str !== null && str !== undefined && str !== 0) {\n                    var len = (str.length << 2) + 1;\n                    ret = stackAlloc(len);\n                    stringToUTF8(str, ret, len)\n                  }\n                  return ret\n                },\n                \"array\": function(arr) {\n                  var ret = stackAlloc(arr.length);\n                  writeArrayToMemory(arr, ret);\n                  return ret\n                }\n              };\n              function convertReturnValue(ret) {\n                if (returnType === \"string\")\n                  return UTF8ToString(ret);\n                if (returnType === \"boolean\")\n                  return Boolean(ret);\n                return ret\n              }\n              var func = getCFunc(ident);\n              var cArgs = [];\n              var stack = 0;\n              if (args) {\n                for (var i = 0; i < args.length; i++) {\n                  var converter = toC[argTypes[i]];\n                  if (converter) {\n                    if (stack === 0)\n                      stack = stackSave();\n                    cArgs[i] = converter(args[i])\n                  } else {\n                    cArgs[i] = args[i]\n                  }\n                }\n              }\n              var ret = func.apply(null, cArgs);\n              ret = convertReturnValue(ret);\n              if (stack !== 0)\n                stackRestore(stack);\n              return ret\n            }\n            var ALLOC_NORMAL = 0;\n            var ALLOC_NONE = 3;\n            function allocate(slab, types, allocator, ptr) {\n              var zeroinit, size;\n              if (typeof slab === \"number\") {\n                zeroinit = true;\n                size = slab\n              } else {\n                zeroinit = false;\n                size = slab.length\n              }\n              var singleType = typeof types === \"string\" ? types : null;\n              var ret;\n              if (allocator == ALLOC_NONE) {\n                ret = ptr\n              } else {\n                ret = [_malloc, stackAlloc, dynamicAlloc][allocator](Math.max(size, singleType ? 1 : types.length))\n              }\n              if (zeroinit) {\n                var stop;\n                ptr = ret;\n                assert((ret & 3) == 0);\n                stop = ret + (size & ~3);\n                for (; ptr < stop; ptr += 4) {\n                  HEAP32[ptr >> 2] = 0\n                }\n                stop = ret + size;\n                while (ptr < stop) {\n                  HEAP8[ptr++ >> 0] = 0\n                }\n                return ret\n              }\n              if (singleType === \"i8\") {\n                if (slab.subarray || slab.slice) {\n                  HEAPU8.set(slab, ret)\n                } else {\n                  HEAPU8.set(new Uint8Array(slab), ret)\n                }\n                return ret\n              }\n              var i = 0, type, typeSize, previousType;\n              while (i < size) {\n                var curr = slab[i];\n                type = singleType || types[i];\n                if (type === 0) {\n                  i++;\n                  continue\n                }\n                if (type == \"i64\")\n                  type = \"i32\";\n                setValue(ret + i, curr, type);\n                if (previousType !== type) {\n                  typeSize = getNativeTypeSize(type);\n                  previousType = type\n                }\n                i += typeSize\n              }\n              return ret\n            }\n            var UTF8Decoder = typeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf8\") : undefined;\n            function UTF8ArrayToString(u8Array, idx, maxBytesToRead) {\n              var endIdx = idx + maxBytesToRead;\n              var endPtr = idx;\n              while (u8Array[endPtr] && !(endPtr >= endIdx))\n                ++endPtr;\n              if (endPtr - idx > 16 && u8Array.subarray && UTF8Decoder) {\n                return UTF8Decoder.decode(u8Array.subarray(idx, endPtr))\n              } else {\n                var str = \"\";\n                while (idx < endPtr) {\n                  var u0 = u8Array[idx++];\n                  if (!(u0 & 128)) {\n                    str += String.fromCharCode(u0);\n                    continue\n                  }\n                  var u1 = u8Array[idx++] & 63;\n                  if ((u0 & 224) == 192) {\n                    str += String.fromCharCode((u0 & 31) << 6 | u1);\n                    continue\n                  }\n                  var u2 = u8Array[idx++] & 63;\n                  if ((u0 & 240) == 224) {\n                    u0 = (u0 & 15) << 12 | u1 << 6 | u2\n                  } else {\n                    u0 = (u0 & 7) << 18 | u1 << 12 | u2 << 6 | u8Array[idx++] & 63\n                  }\n                  if (u0 < 65536) {\n                    str += String.fromCharCode(u0)\n                  } else {\n                    var ch = u0 - 65536;\n                    str += String.fromCharCode(55296 | ch >> 10, 56320 | ch & 1023)\n                  }\n                }\n              }\n              return str\n            }\n            function UTF8ToString(ptr, maxBytesToRead) {\n              return ptr ? UTF8ArrayToString(HEAPU8, ptr, maxBytesToRead) : \"\"\n            }\n            function stringToUTF8Array(str, outU8Array, outIdx, maxBytesToWrite) {\n              if (!(maxBytesToWrite > 0))\n                return 0;\n              var startIdx = outIdx;\n              var endIdx = outIdx + maxBytesToWrite - 1;\n              for (var i = 0; i < str.length; ++i) {\n                var u = str.charCodeAt(i);\n                if (u >= 55296 && u <= 57343) {\n                  var u1 = str.charCodeAt(++i);\n                  u = 65536 + ((u & 1023) << 10) | u1 & 1023\n                }\n                if (u <= 127) {\n                  if (outIdx >= endIdx)\n                    break;\n                  outU8Array[outIdx++] = u\n                } else if (u <= 2047) {\n                  if (outIdx + 1 >= endIdx)\n                    break;\n                  outU8Array[outIdx++] = 192 | u >> 6;\n                  outU8Array[outIdx++] = 128 | u & 63\n                } else if (u <= 65535) {\n                  if (outIdx + 2 >= endIdx)\n                    break;\n                  outU8Array[outIdx++] = 224 | u >> 12;\n                  outU8Array[outIdx++] = 128 | u >> 6 & 63;\n                  outU8Array[outIdx++] = 128 | u & 63\n                } else {\n                  if (outIdx + 3 >= endIdx)\n                    break;\n                  outU8Array[outIdx++] = 240 | u >> 18;\n                  outU8Array[outIdx++] = 128 | u >> 12 & 63;\n                  outU8Array[outIdx++] = 128 | u >> 6 & 63;\n                  outU8Array[outIdx++] = 128 | u & 63\n                }\n              }\n              outU8Array[outIdx] = 0;\n              return outIdx - startIdx\n            }\n            function stringToUTF8(str, outPtr, maxBytesToWrite) {\n              return stringToUTF8Array(str, HEAPU8, outPtr, maxBytesToWrite)\n            }\n            function lengthBytesUTF8(str) {\n              var len = 0;\n              for (var i = 0; i < str.length; ++i) {\n                var u = str.charCodeAt(i);\n                if (u >= 55296 && u <= 57343)\n                  u = 65536 + ((u & 1023) << 10) | str.charCodeAt(++i) & 1023;\n                if (u <= 127)\n                  ++len;\n                else if (u <= 2047)\n                  len += 2;\n                else if (u <= 65535)\n                  len += 3;\n                else\n                  len += 4\n              }\n              return len\n            }\n            var UTF16Decoder = typeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf-16le\") : undefined;\n            function writeArrayToMemory(array, buffer) {\n              HEAP8.set(array, buffer)\n            }\n            function writeAsciiToMemory(str, buffer, dontAddNull) {\n              for (var i = 0; i < str.length; ++i) {\n                HEAP8[buffer++ >> 0] = str.charCodeAt(i)\n              }\n              if (!dontAddNull)\n                HEAP8[buffer >> 0] = 0\n            }\n            var WASM_PAGE_SIZE = 65536;\n            function alignUp(x, multiple) {\n              if (x % multiple > 0) {\n                x += multiple - x % multiple\n              }\n              return x\n            }\n            var buffer, HEAP8, HEAPU8, HEAP16, HEAPU16, HEAP32, HEAPU32, HEAPF32, HEAPF64;\n            function updateGlobalBufferAndViews(buf) {\n              buffer = buf;\n              Module[\"HEAP8\"] = HEAP8 = new Int8Array(buf);\n              Module[\"HEAP16\"] = HEAP16 = new Int16Array(buf);\n              Module[\"HEAP32\"] = HEAP32 = new Int32Array(buf);\n              Module[\"HEAPU8\"] = HEAPU8 = new Uint8Array(buf);\n              Module[\"HEAPU16\"] = HEAPU16 = new Uint16Array(buf);\n              Module[\"HEAPU32\"] = HEAPU32 = new Uint32Array(buf);\n              Module[\"HEAPF32\"] = HEAPF32 = new Float32Array(buf);\n              Module[\"HEAPF64\"] = HEAPF64 = new Float64Array(buf)\n            }\n            var DYNAMIC_BASE = 10925248\n                , DYNAMICTOP_PTR = 5682208;\n            var INITIAL_INITIAL_MEMORY = Module[\"INITIAL_MEMORY\"] || 16777216;\n            if (Module[\"wasmMemory\"]) {\n              wasmMemory = Module[\"wasmMemory\"]\n            } else {\n              wasmMemory = new WebAssembly.Memory({\n                \"initial\": INITIAL_INITIAL_MEMORY / WASM_PAGE_SIZE\n              })\n            }\n            if (wasmMemory) {\n              buffer = wasmMemory.buffer\n            }\n            INITIAL_INITIAL_MEMORY = buffer.byteLength;\n            updateGlobalBufferAndViews(buffer);\n            HEAP32[DYNAMICTOP_PTR >> 2] = DYNAMIC_BASE;\n            function callRuntimeCallbacks(callbacks) {\n              while (callbacks.length > 0) {\n                var callback = callbacks.shift();\n                if (typeof callback == \"function\") {\n                  callback();\n                  continue\n                }\n                var func = callback.func;\n                if (typeof func === \"number\") {\n                  if (callback.arg === undefined) {\n                    Module[\"dynCall_v\"](func)\n                  } else {\n                    Module[\"dynCall_vi\"](func, callback.arg)\n                  }\n                } else {\n                  func(callback.arg === undefined ? null : callback.arg)\n                }\n              }\n            }\n            var __ATPRERUN__ = [];\n            var __ATINIT__ = [];\n            var __ATMAIN__ = [];\n            var __ATPOSTRUN__ = [];\n            var runtimeInitialized = false;\n            function preRun() {\n              if (Module[\"preRun\"]) {\n                if (typeof Module[\"preRun\"] == \"function\")\n                  Module[\"preRun\"] = [Module[\"preRun\"]];\n                while (Module[\"preRun\"].length) {\n                  addOnPreRun(Module[\"preRun\"].shift())\n                }\n              }\n              callRuntimeCallbacks(__ATPRERUN__)\n            }\n            function initRuntime() {\n              runtimeInitialized = true;\n              if (!Module[\"noFSInit\"] && !FS.init.initialized)\n                FS.init();\n              TTY.init();\n              callRuntimeCallbacks(__ATINIT__)\n            }\n            function preMain() {\n              FS.ignorePermissions = false;\n              callRuntimeCallbacks(__ATMAIN__)\n            }\n            function postRun() {\n              if (Module[\"postRun\"]) {\n                if (typeof Module[\"postRun\"] == \"function\")\n                  Module[\"postRun\"] = [Module[\"postRun\"]];\n                while (Module[\"postRun\"].length) {\n                  addOnPostRun(Module[\"postRun\"].shift())\n                }\n              }\n              callRuntimeCallbacks(__ATPOSTRUN__)\n            }\n            function addOnPreRun(cb) {\n              __ATPRERUN__.unshift(cb)\n            }\n            function addOnPostRun(cb) {\n              __ATPOSTRUN__.unshift(cb)\n            }\n            var Math_abs = Math.abs;\n            var Math_ceil = Math.ceil;\n            var Math_floor = Math.floor;\n            var Math_min = Math.min;\n            var runDependencies = 0;\n            var runDependencyWatcher = null;\n            var dependenciesFulfilled = null;\n            function getUniqueRunDependency(id) {\n              return id\n            }\n            function addRunDependency(id) {\n              runDependencies++;\n              if (Module[\"monitorRunDependencies\"]) {\n                Module[\"monitorRunDependencies\"](runDependencies)\n              }\n            }\n            function removeRunDependency(id) {\n              runDependencies--;\n              if (Module[\"monitorRunDependencies\"]) {\n                Module[\"monitorRunDependencies\"](runDependencies)\n              }\n              if (runDependencies == 0) {\n                if (runDependencyWatcher !== null) {\n                  clearInterval(runDependencyWatcher);\n                  runDependencyWatcher = null\n                }\n                if (dependenciesFulfilled) {\n                  var callback = dependenciesFulfilled;\n                  dependenciesFulfilled = null;\n                  callback()\n                }\n              }\n            }\n            Module[\"preloadedImages\"] = {};\n            Module[\"preloadedAudios\"] = {};\n            function abort(what) {\n              if (Module[\"onAbort\"]) {\n                Module[\"onAbort\"](what)\n              }\n              what += \"\";\n              out(what);\n              err(what);\n              ABORT = true;\n              EXITSTATUS = 1;\n              what = \"abort(\" + what + \"). Build with -s ASSERTIONS=1 for more info.\";\n              throw new WebAssembly.RuntimeError(what)\n            }\n            var dataURIPrefix = \"data:application/octet-stream;base64,\";\n            function isDataURI(filename) {\n              return String.prototype.startsWith ? filename.startsWith(dataURIPrefix) : filename.indexOf(dataURIPrefix) === 0\n            }\n            var wasmBinaryFile = \"chip-core.wasm\";\n            if (!isDataURI(wasmBinaryFile)) {\n              wasmBinaryFile = locateFile(wasmBinaryFile)\n            }\n            function getBinary() {\n              try {\n                if (wasmBinary) {\n                  return new Uint8Array(wasmBinary)\n                }\n                if (readBinary) {\n                  return readBinary(wasmBinaryFile)\n                } else {\n                  throw \"both async and sync fetching of the wasm failed\"\n                }\n              } catch (err) {\n                abort(err)\n              }\n            }\n            function getBinaryPromise() {\n              if (!wasmBinary && (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) && typeof fetch === \"function\") {\n                return fetch(wasmBinaryFile, {\n                  credentials: \"same-origin\"\n                }).then(function(response) {\n                  if (!response[\"ok\"]) {\n                    throw \"failed to load wasm binary file at '\" + wasmBinaryFile + \"'\"\n                  }\n                  return response[\"arrayBuffer\"]()\n                }).catch(function() {\n                  return getBinary()\n                })\n              }\n              return new Promise(function(resolve, reject) {\n                    resolve(getBinary())\n                  }\n              )\n            }\n            function createWasm() {\n              var info = {\n                \"a\": asmLibraryArg\n              };\n              function receiveInstance(instance, module) {\n                var exports = instance.exports;\n                Module[\"asm\"] = exports;\n                removeRunDependency(\"wasm-instantiate\")\n              }\n              addRunDependency(\"wasm-instantiate\");\n              function receiveInstantiatedSource(output) {\n                receiveInstance(output[\"instance\"])\n              }\n              function instantiateArrayBuffer(receiver) {\n                return getBinaryPromise().then(function(binary) {\n                  return WebAssembly.instantiate(binary, info)\n                }).then(receiver, function(reason) {\n                  err(\"failed to asynchronously prepare wasm: \" + reason);\n                  abort(reason)\n                })\n              }\n              function instantiateAsync() {\n                if (!wasmBinary && typeof WebAssembly.instantiateStreaming === \"function\" && !isDataURI(wasmBinaryFile) && typeof fetch === \"function\") {\n                  fetch(wasmBinaryFile, {\n                    credentials: \"same-origin\"\n                  }).then(function(response) {\n                    var result = WebAssembly.instantiateStreaming(response, info);\n                    return result.then(receiveInstantiatedSource, function(reason) {\n                      err(\"wasm streaming compile failed: \" + reason);\n                      err(\"falling back to ArrayBuffer instantiation\");\n                      instantiateArrayBuffer(receiveInstantiatedSource)\n                    })\n                  })\n                } else {\n                  return instantiateArrayBuffer(receiveInstantiatedSource)\n                }\n              }\n              if (Module[\"instantiateWasm\"]) {\n                try {\n                  var exports = Module[\"instantiateWasm\"](info, receiveInstance);\n                  return exports\n                } catch (e) {\n                  err(\"Module.instantiateWasm callback failed with error: \" + e);\n                  return false\n                }\n              }\n              instantiateAsync();\n              return {}\n            }\n            var tempDouble;\n            var tempI64;\n            var ASM_CONSTS = {\n              161276: function($0) {\n                console.log(\"Error during V2M conversion.\", $0)\n              },\n              161441: function($0) {\n                console.log(\"Tiny MIDI Player loaded %d bytes.\", $0)\n              },\n              161499: function($0) {\n                console.log(\"First note appears at %d ms.\", $0)\n              }\n            };\n            function _emscripten_asm_const_iii(code, sigPtr, argbuf) {\n              var args = readAsmConstArgs(sigPtr, argbuf);\n              return ASM_CONSTS[code].apply(null, args)\n            }\n            __ATINIT__.push({\n              func: function() {\n                ___wasm_call_ctors()\n              }\n            });\n            function demangle(func) {\n              return func\n            }\n            function demangleAll(text) {\n              var regex = /\\b_Z[\\w\\d_]+/g;\n              return text.replace(regex, function(x) {\n                var y = demangle(x);\n                return x === y ? x : y + \" [\" + x + \"]\"\n              })\n            }\n            function jsStackTrace() {\n              var err = new Error;\n              if (!err.stack) {\n                try {\n                  throw new Error\n                } catch (e) {\n                  err = e\n                }\n                if (!err.stack) {\n                  return \"(no stack trace available)\"\n                }\n              }\n              return err.stack.toString()\n            }\n            function stackTrace() {\n              var js = jsStackTrace();\n              if (Module[\"extraStackTrace\"])\n                js += \"\\n\" + Module[\"extraStackTrace\"]();\n              return demangleAll(js)\n            }\n            function ___assert_fail(condition, filename, line, func) {\n              abort(\"Assertion failed: \" + UTF8ToString(condition) + \", at: \" + [filename ? UTF8ToString(filename) : \"unknown filename\", line, func ? UTF8ToString(func) : \"unknown function\"])\n            }\n            function ___cxa_allocate_exception(size) {\n              return _malloc(size)\n            }\n            var ___exception_infos = {};\n            var ___exception_last = 0;\n            function __ZSt18uncaught_exceptionv() {\n              return __ZSt18uncaught_exceptionv.uncaught_exceptions > 0\n            }\n            function ___cxa_throw(ptr, type, destructor) {\n              ___exception_infos[ptr] = {\n                ptr: ptr,\n                adjusted: [ptr],\n                type: type,\n                destructor: destructor,\n                refcount: 0,\n                caught: false,\n                rethrown: false\n              };\n              ___exception_last = ptr;\n              if (!(\"uncaught_exception\"in __ZSt18uncaught_exceptionv)) {\n                __ZSt18uncaught_exceptionv.uncaught_exceptions = 1\n              } else {\n                __ZSt18uncaught_exceptionv.uncaught_exceptions++\n              }\n              throw ptr\n            }\n            function ___setErrNo(value) {\n              if (Module[\"___errno_location\"])\n                HEAP32[Module[\"___errno_location\"]() >> 2] = value;\n              return value\n            }\n            function ___map_file(pathname, size) {\n              ___setErrNo(63);\n              return -1\n            }\n            var PATH = {\n              splitPath: function(filename) {\n                var splitPathRe = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\n                return splitPathRe.exec(filename).slice(1)\n              },\n              normalizeArray: function(parts, allowAboveRoot) {\n                var up = 0;\n                for (var i = parts.length - 1; i >= 0; i--) {\n                  var last = parts[i];\n                  if (last === \".\") {\n                    parts.splice(i, 1)\n                  } else if (last === \"..\") {\n                    parts.splice(i, 1);\n                    up++\n                  } else if (up) {\n                    parts.splice(i, 1);\n                    up--\n                  }\n                }\n                if (allowAboveRoot) {\n                  for (; up; up--) {\n                    parts.unshift(\"..\")\n                  }\n                }\n                return parts\n              },\n              normalize: function(path) {\n                var isAbsolute = path.charAt(0) === \"/\"\n                    , trailingSlash = path.substr(-1) === \"/\";\n                path = PATH.normalizeArray(path.split(\"/\").filter(function(p) {\n                  return !!p\n                }), !isAbsolute).join(\"/\");\n                if (!path && !isAbsolute) {\n                  path = \".\"\n                }\n                if (path && trailingSlash) {\n                  path += \"/\"\n                }\n                return (isAbsolute ? \"/\" : \"\") + path\n              },\n              dirname: function(path) {\n                var result = PATH.splitPath(path)\n                    , root = result[0]\n                    , dir = result[1];\n                if (!root && !dir) {\n                  return \".\"\n                }\n                if (dir) {\n                  dir = dir.substr(0, dir.length - 1)\n                }\n                return root + dir\n              },\n              basename: function(path) {\n                if (path === \"/\")\n                  return \"/\";\n                var lastSlash = path.lastIndexOf(\"/\");\n                if (lastSlash === -1)\n                  return path;\n                return path.substr(lastSlash + 1)\n              },\n              extname: function(path) {\n                return PATH.splitPath(path)[3]\n              },\n              join: function() {\n                var paths = Array.prototype.slice.call(arguments, 0);\n                return PATH.normalize(paths.join(\"/\"))\n              },\n              join2: function(l, r) {\n                return PATH.normalize(l + \"/\" + r)\n              }\n            };\n            var PATH_FS = {\n              resolve: function() {\n                var resolvedPath = \"\"\n                    , resolvedAbsolute = false;\n                for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n                  var path = i >= 0 ? arguments[i] : FS.cwd();\n                  if (typeof path !== \"string\") {\n                    throw new TypeError(\"Arguments to path.resolve must be strings\")\n                  } else if (!path) {\n                    return \"\"\n                  }\n                  resolvedPath = path + \"/\" + resolvedPath;\n                  resolvedAbsolute = path.charAt(0) === \"/\"\n                }\n                resolvedPath = PATH.normalizeArray(resolvedPath.split(\"/\").filter(function(p) {\n                  return !!p\n                }), !resolvedAbsolute).join(\"/\");\n                return (resolvedAbsolute ? \"/\" : \"\") + resolvedPath || \".\"\n              },\n              relative: function(from, to) {\n                from = PATH_FS.resolve(from).substr(1);\n                to = PATH_FS.resolve(to).substr(1);\n                function trim(arr) {\n                  var start = 0;\n                  for (; start < arr.length; start++) {\n                    if (arr[start] !== \"\")\n                      break\n                  }\n                  var end = arr.length - 1;\n                  for (; end >= 0; end--) {\n                    if (arr[end] !== \"\")\n                      break\n                  }\n                  if (start > end)\n                    return [];\n                  return arr.slice(start, end - start + 1)\n                }\n                var fromParts = trim(from.split(\"/\"));\n                var toParts = trim(to.split(\"/\"));\n                var length = Math.min(fromParts.length, toParts.length);\n                var samePartsLength = length;\n                for (var i = 0; i < length; i++) {\n                  if (fromParts[i] !== toParts[i]) {\n                    samePartsLength = i;\n                    break\n                  }\n                }\n                var outputParts = [];\n                for (var i = samePartsLength; i < fromParts.length; i++) {\n                  outputParts.push(\"..\")\n                }\n                outputParts = outputParts.concat(toParts.slice(samePartsLength));\n                return outputParts.join(\"/\")\n              }\n            };\n            var TTY = {\n              ttys: [],\n              init: function() {},\n              shutdown: function() {},\n              register: function(dev, ops) {\n                TTY.ttys[dev] = {\n                  input: [],\n                  output: [],\n                  ops: ops\n                };\n                FS.registerDevice(dev, TTY.stream_ops)\n              },\n              stream_ops: {\n                open: function(stream) {\n                  var tty = TTY.ttys[stream.node.rdev];\n                  if (!tty) {\n                    throw new FS.ErrnoError(43)\n                  }\n                  stream.tty = tty;\n                  stream.seekable = false\n                },\n                close: function(stream) {\n                  stream.tty.ops.flush(stream.tty)\n                },\n                flush: function(stream) {\n                  stream.tty.ops.flush(stream.tty)\n                },\n                read: function(stream, buffer, offset, length, pos) {\n                  if (!stream.tty || !stream.tty.ops.get_char) {\n                    throw new FS.ErrnoError(60)\n                  }\n                  var bytesRead = 0;\n                  for (var i = 0; i < length; i++) {\n                    var result;\n                    try {\n                      result = stream.tty.ops.get_char(stream.tty)\n                    } catch (e) {\n                      throw new FS.ErrnoError(29)\n                    }\n                    if (result === undefined && bytesRead === 0) {\n                      throw new FS.ErrnoError(6)\n                    }\n                    if (result === null || result === undefined)\n                      break;\n                    bytesRead++;\n                    buffer[offset + i] = result\n                  }\n                  if (bytesRead) {\n                    stream.node.timestamp = Date.now()\n                  }\n                  return bytesRead\n                },\n                write: function(stream, buffer, offset, length, pos) {\n                  if (!stream.tty || !stream.tty.ops.put_char) {\n                    throw new FS.ErrnoError(60)\n                  }\n                  try {\n                    for (var i = 0; i < length; i++) {\n                      stream.tty.ops.put_char(stream.tty, buffer[offset + i])\n                    }\n                  } catch (e) {\n                    throw new FS.ErrnoError(29)\n                  }\n                  if (length) {\n                    stream.node.timestamp = Date.now()\n                  }\n                  return i\n                }\n              },\n              default_tty_ops: {\n                get_char: function(tty) {\n                  if (!tty.input.length) {\n                    var result = null;\n                    if (typeof window != \"undefined\" && typeof window.prompt == \"function\") {\n                      result = window.prompt(\"Input: \");\n                      if (result !== null) {\n                        result += \"\\n\"\n                      }\n                    } else if (typeof readline == \"function\") {\n                      result = readline();\n                      if (result !== null) {\n                        result += \"\\n\"\n                      }\n                    }\n                    if (!result) {\n                      return null\n                    }\n                    tty.input = intArrayFromString(result, true)\n                  }\n                  return tty.input.shift()\n                },\n                put_char: function(tty, val) {\n                  if (val === null || val === 10) {\n                    out(UTF8ArrayToString(tty.output, 0));\n                    tty.output = []\n                  } else {\n                    if (val != 0)\n                      tty.output.push(val)\n                  }\n                },\n                flush: function(tty) {\n                  if (tty.output && tty.output.length > 0) {\n                    out(UTF8ArrayToString(tty.output, 0));\n                    tty.output = []\n                  }\n                }\n              },\n              default_tty1_ops: {\n                put_char: function(tty, val) {\n                  if (val === null || val === 10) {\n                    err(UTF8ArrayToString(tty.output, 0));\n                    tty.output = []\n                  } else {\n                    if (val != 0)\n                      tty.output.push(val)\n                  }\n                },\n                flush: function(tty) {\n                  if (tty.output && tty.output.length > 0) {\n                    err(UTF8ArrayToString(tty.output, 0));\n                    tty.output = []\n                  }\n                }\n              }\n            };\n            var MEMFS = {\n              ops_table: null,\n              mount: function(mount) {\n                return MEMFS.createNode(null, \"/\", 16384 | 511, 0)\n              },\n              createNode: function(parent, name, mode, dev) {\n                if (FS.isBlkdev(mode) || FS.isFIFO(mode)) {\n                  throw new FS.ErrnoError(63)\n                }\n                if (!MEMFS.ops_table) {\n                  MEMFS.ops_table = {\n                    dir: {\n                      node: {\n                        getattr: MEMFS.node_ops.getattr,\n                        setattr: MEMFS.node_ops.setattr,\n                        lookup: MEMFS.node_ops.lookup,\n                        mknod: MEMFS.node_ops.mknod,\n                        rename: MEMFS.node_ops.rename,\n                        unlink: MEMFS.node_ops.unlink,\n                        rmdir: MEMFS.node_ops.rmdir,\n                        readdir: MEMFS.node_ops.readdir,\n                        symlink: MEMFS.node_ops.symlink\n                      },\n                      stream: {\n                        llseek: MEMFS.stream_ops.llseek\n                      }\n                    },\n                    file: {\n                      node: {\n                        getattr: MEMFS.node_ops.getattr,\n                        setattr: MEMFS.node_ops.setattr\n                      },\n                      stream: {\n                        llseek: MEMFS.stream_ops.llseek,\n                        read: MEMFS.stream_ops.read,\n                        write: MEMFS.stream_ops.write,\n                        allocate: MEMFS.stream_ops.allocate,\n                        mmap: MEMFS.stream_ops.mmap,\n                        msync: MEMFS.stream_ops.msync\n                      }\n                    },\n                    link: {\n                      node: {\n                        getattr: MEMFS.node_ops.getattr,\n                        setattr: MEMFS.node_ops.setattr,\n                        readlink: MEMFS.node_ops.readlink\n                      },\n                      stream: {}\n                    },\n                    chrdev: {\n                      node: {\n                        getattr: MEMFS.node_ops.getattr,\n                        setattr: MEMFS.node_ops.setattr\n                      },\n                      stream: FS.chrdev_stream_ops\n                    }\n                  }\n                }\n                var node = FS.createNode(parent, name, mode, dev);\n                if (FS.isDir(node.mode)) {\n                  node.node_ops = MEMFS.ops_table.dir.node;\n                  node.stream_ops = MEMFS.ops_table.dir.stream;\n                  node.contents = {}\n                } else if (FS.isFile(node.mode)) {\n                  node.node_ops = MEMFS.ops_table.file.node;\n                  node.stream_ops = MEMFS.ops_table.file.stream;\n                  node.usedBytes = 0;\n                  node.contents = null\n                } else if (FS.isLink(node.mode)) {\n                  node.node_ops = MEMFS.ops_table.link.node;\n                  node.stream_ops = MEMFS.ops_table.link.stream\n                } else if (FS.isChrdev(node.mode)) {\n                  node.node_ops = MEMFS.ops_table.chrdev.node;\n                  node.stream_ops = MEMFS.ops_table.chrdev.stream\n                }\n                node.timestamp = Date.now();\n                if (parent) {\n                  parent.contents[name] = node\n                }\n                return node\n              },\n              getFileDataAsRegularArray: function(node) {\n                if (node.contents && node.contents.subarray) {\n                  var arr = [];\n                  for (var i = 0; i < node.usedBytes; ++i)\n                    arr.push(node.contents[i]);\n                  return arr\n                }\n                return node.contents\n              },\n              getFileDataAsTypedArray: function(node) {\n                if (!node.contents)\n                  return new Uint8Array(0);\n                if (node.contents.subarray)\n                  return node.contents.subarray(0, node.usedBytes);\n                return new Uint8Array(node.contents)\n              },\n              expandFileStorage: function(node, newCapacity) {\n                var prevCapacity = node.contents ? node.contents.length : 0;\n                if (prevCapacity >= newCapacity)\n                  return;\n                var CAPACITY_DOUBLING_MAX = 1024 * 1024;\n                newCapacity = Math.max(newCapacity, prevCapacity * (prevCapacity < CAPACITY_DOUBLING_MAX ? 2 : 1.125) | 0);\n                if (prevCapacity != 0)\n                  newCapacity = Math.max(newCapacity, 256);\n                var oldContents = node.contents;\n                node.contents = new Uint8Array(newCapacity);\n                if (node.usedBytes > 0)\n                  node.contents.set(oldContents.subarray(0, node.usedBytes), 0);\n                return\n              },\n              resizeFileStorage: function(node, newSize) {\n                if (node.usedBytes == newSize)\n                  return;\n                if (newSize == 0) {\n                  node.contents = null;\n                  node.usedBytes = 0;\n                  return\n                }\n                if (!node.contents || node.contents.subarray) {\n                  var oldContents = node.contents;\n                  node.contents = new Uint8Array(newSize);\n                  if (oldContents) {\n                    node.contents.set(oldContents.subarray(0, Math.min(newSize, node.usedBytes)))\n                  }\n                  node.usedBytes = newSize;\n                  return\n                }\n                if (!node.contents)\n                  node.contents = [];\n                if (node.contents.length > newSize)\n                  node.contents.length = newSize;\n                else\n                  while (node.contents.length < newSize)\n                    node.contents.push(0);\n                node.usedBytes = newSize\n              },\n              node_ops: {\n                getattr: function(node) {\n                  var attr = {};\n                  attr.dev = FS.isChrdev(node.mode) ? node.id : 1;\n                  attr.ino = node.id;\n                  attr.mode = node.mode;\n                  attr.nlink = 1;\n                  attr.uid = 0;\n                  attr.gid = 0;\n                  attr.rdev = node.rdev;\n                  if (FS.isDir(node.mode)) {\n                    attr.size = 4096\n                  } else if (FS.isFile(node.mode)) {\n                    attr.size = node.usedBytes\n                  } else if (FS.isLink(node.mode)) {\n                    attr.size = node.link.length\n                  } else {\n                    attr.size = 0\n                  }\n                  attr.atime = new Date(node.timestamp);\n                  attr.mtime = new Date(node.timestamp);\n                  attr.ctime = new Date(node.timestamp);\n                  attr.blksize = 4096;\n                  attr.blocks = Math.ceil(attr.size / attr.blksize);\n                  return attr\n                },\n                setattr: function(node, attr) {\n                  if (attr.mode !== undefined) {\n                    node.mode = attr.mode\n                  }\n                  if (attr.timestamp !== undefined) {\n                    node.timestamp = attr.timestamp\n                  }\n                  if (attr.size !== undefined) {\n                    MEMFS.resizeFileStorage(node, attr.size)\n                  }\n                },\n                lookup: function(parent, name) {\n                  throw FS.genericErrors[44]\n                },\n                mknod: function(parent, name, mode, dev) {\n                  return MEMFS.createNode(parent, name, mode, dev)\n                },\n                rename: function(old_node, new_dir, new_name) {\n                  if (FS.isDir(old_node.mode)) {\n                    var new_node;\n                    try {\n                      new_node = FS.lookupNode(new_dir, new_name)\n                    } catch (e) {}\n                    if (new_node) {\n                      for (var i in new_node.contents) {\n                        throw new FS.ErrnoError(55)\n                      }\n                    }\n                  }\n                  delete old_node.parent.contents[old_node.name];\n                  old_node.name = new_name;\n                  new_dir.contents[new_name] = old_node;\n                  old_node.parent = new_dir\n                },\n                unlink: function(parent, name) {\n                  delete parent.contents[name]\n                },\n                rmdir: function(parent, name) {\n                  var node = FS.lookupNode(parent, name);\n                  for (var i in node.contents) {\n                    throw new FS.ErrnoError(55)\n                  }\n                  delete parent.contents[name]\n                },\n                readdir: function(node) {\n                  var entries = [\".\", \"..\"];\n                  for (var key in node.contents) {\n                    if (!node.contents.hasOwnProperty(key)) {\n                      continue\n                    }\n                    entries.push(key)\n                  }\n                  return entries\n                },\n                symlink: function(parent, newname, oldpath) {\n                  var node = MEMFS.createNode(parent, newname, 511 | 40960, 0);\n                  node.link = oldpath;\n                  return node\n                },\n                readlink: function(node) {\n                  if (!FS.isLink(node.mode)) {\n                    throw new FS.ErrnoError(28)\n                  }\n                  return node.link\n                }\n              },\n              stream_ops: {\n                read: function(stream, buffer, offset, length, position) {\n                  var contents = stream.node.contents;\n                  if (position >= stream.node.usedBytes)\n                    return 0;\n                  var size = Math.min(stream.node.usedBytes - position, length);\n                  if (size > 8 && contents.subarray) {\n                    buffer.set(contents.subarray(position, position + size), offset)\n                  } else {\n                    for (var i = 0; i < size; i++)\n                      buffer[offset + i] = contents[position + i]\n                  }\n                  return size\n                },\n                write: function(stream, buffer, offset, length, position, canOwn) {\n                  if (buffer.buffer === HEAP8.buffer) {\n                    canOwn = false\n                  }\n                  if (!length)\n                    return 0;\n                  var node = stream.node;\n                  node.timestamp = Date.now();\n                  if (buffer.subarray && (!node.contents || node.contents.subarray)) {\n                    if (canOwn) {\n                      node.contents = buffer.subarray(offset, offset + length);\n                      node.usedBytes = length;\n                      return length\n                    } else if (node.usedBytes === 0 && position === 0) {\n                      node.contents = buffer.slice(offset, offset + length);\n                      node.usedBytes = length;\n                      return length\n                    } else if (position + length <= node.usedBytes) {\n                      node.contents.set(buffer.subarray(offset, offset + length), position);\n                      return length\n                    }\n                  }\n                  MEMFS.expandFileStorage(node, position + length);\n                  if (node.contents.subarray && buffer.subarray)\n                    node.contents.set(buffer.subarray(offset, offset + length), position);\n                  else {\n                    for (var i = 0; i < length; i++) {\n                      node.contents[position + i] = buffer[offset + i]\n                    }\n                  }\n                  node.usedBytes = Math.max(node.usedBytes, position + length);\n                  return length\n                },\n                llseek: function(stream, offset, whence) {\n                  var position = offset;\n                  if (whence === 1) {\n                    position += stream.position\n                  } else if (whence === 2) {\n                    if (FS.isFile(stream.node.mode)) {\n                      position += stream.node.usedBytes\n                    }\n                  }\n                  if (position < 0) {\n                    throw new FS.ErrnoError(28)\n                  }\n                  return position\n                },\n                allocate: function(stream, offset, length) {\n                  MEMFS.expandFileStorage(stream.node, offset + length);\n                  stream.node.usedBytes = Math.max(stream.node.usedBytes, offset + length)\n                },\n                mmap: function(stream, buffer, offset, length, position, prot, flags) {\n                  if (!FS.isFile(stream.node.mode)) {\n                    throw new FS.ErrnoError(43)\n                  }\n                  var ptr;\n                  var allocated;\n                  var contents = stream.node.contents;\n                  if (!(flags & 2) && contents.buffer === buffer.buffer) {\n                    allocated = false;\n                    ptr = contents.byteOffset\n                  } else {\n                    if (position > 0 || position + length < contents.length) {\n                      if (contents.subarray) {\n                        contents = contents.subarray(position, position + length)\n                      } else {\n                        contents = Array.prototype.slice.call(contents, position, position + length)\n                      }\n                    }\n                    allocated = true;\n                    var fromHeap = buffer.buffer == HEAP8.buffer;\n                    ptr = _malloc(length);\n                    if (!ptr) {\n                      throw new FS.ErrnoError(48)\n                    }\n                    (fromHeap ? HEAP8 : buffer).set(contents, ptr)\n                  }\n                  return {\n                    ptr: ptr,\n                    allocated: allocated\n                  }\n                },\n                msync: function(stream, buffer, offset, length, mmapFlags) {\n                  if (!FS.isFile(stream.node.mode)) {\n                    throw new FS.ErrnoError(43)\n                  }\n                  if (mmapFlags & 2) {\n                    return 0\n                  }\n                  var bytesWritten = MEMFS.stream_ops.write(stream, buffer, 0, length, offset, false);\n                  return 0\n                }\n              }\n            };\n            var FS = {\n              root: null,\n              mounts: [],\n              devices: {},\n              streams: [],\n              nextInode: 1,\n              nameTable: null,\n              currentPath: \"/\",\n              initialized: false,\n              ignorePermissions: true,\n              trackingDelegate: {},\n              tracking: {\n                openFlags: {\n                  READ: 1,\n                  WRITE: 2\n                }\n              },\n              ErrnoError: null,\n              genericErrors: {},\n              filesystems: null,\n              syncFSRequests: 0,\n              handleFSError: function(e) {\n                if (!(e instanceof FS.ErrnoError))\n                  throw e + \" : \" + stackTrace();\n                return ___setErrNo(e.errno)\n              },\n              lookupPath: function(path, opts) {\n                path = PATH_FS.resolve(FS.cwd(), path);\n                opts = opts || {};\n                if (!path)\n                  return {\n                    path: \"\",\n                    node: null\n                  };\n                var defaults = {\n                  follow_mount: true,\n                  recurse_count: 0\n                };\n                for (var key in defaults) {\n                  if (opts[key] === undefined) {\n                    opts[key] = defaults[key]\n                  }\n                }\n                if (opts.recurse_count > 8) {\n                  throw new FS.ErrnoError(32)\n                }\n                var parts = PATH.normalizeArray(path.split(\"/\").filter(function(p) {\n                  return !!p\n                }), false);\n                var current = FS.root;\n                var current_path = \"/\";\n                for (var i = 0; i < parts.length; i++) {\n                  var islast = i === parts.length - 1;\n                  if (islast && opts.parent) {\n                    break\n                  }\n                  current = FS.lookupNode(current, parts[i]);\n                  current_path = PATH.join2(current_path, parts[i]);\n                  if (FS.isMountpoint(current)) {\n                    if (!islast || islast && opts.follow_mount) {\n                      current = current.mounted.root\n                    }\n                  }\n                  if (!islast || opts.follow) {\n                    var count = 0;\n                    while (FS.isLink(current.mode)) {\n                      var link = FS.readlink(current_path);\n                      current_path = PATH_FS.resolve(PATH.dirname(current_path), link);\n                      var lookup = FS.lookupPath(current_path, {\n                        recurse_count: opts.recurse_count\n                      });\n                      current = lookup.node;\n                      if (count++ > 40) {\n                        throw new FS.ErrnoError(32)\n                      }\n                    }\n                  }\n                }\n                return {\n                  path: current_path,\n                  node: current\n                }\n              },\n              getPath: function(node) {\n                var path;\n                while (true) {\n                  if (FS.isRoot(node)) {\n                    var mount = node.mount.mountpoint;\n                    if (!path)\n                      return mount;\n                    return mount[mount.length - 1] !== \"/\" ? mount + \"/\" + path : mount + path\n                  }\n                  path = path ? node.name + \"/\" + path : node.name;\n                  node = node.parent\n                }\n              },\n              hashName: function(parentid, name) {\n                var hash = 0;\n                for (var i = 0; i < name.length; i++) {\n                  hash = (hash << 5) - hash + name.charCodeAt(i) | 0\n                }\n                return (parentid + hash >>> 0) % FS.nameTable.length\n              },\n              hashAddNode: function(node) {\n                var hash = FS.hashName(node.parent.id, node.name);\n                node.name_next = FS.nameTable[hash];\n                FS.nameTable[hash] = node\n              },\n              hashRemoveNode: function(node) {\n                var hash = FS.hashName(node.parent.id, node.name);\n                if (FS.nameTable[hash] === node) {\n                  FS.nameTable[hash] = node.name_next\n                } else {\n                  var current = FS.nameTable[hash];\n                  while (current) {\n                    if (current.name_next === node) {\n                      current.name_next = node.name_next;\n                      break\n                    }\n                    current = current.name_next\n                  }\n                }\n              },\n              lookupNode: function(parent, name) {\n                var errCode = FS.mayLookup(parent);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode,parent)\n                }\n                var hash = FS.hashName(parent.id, name);\n                for (var node = FS.nameTable[hash]; node; node = node.name_next) {\n                  var nodeName = node.name;\n                  if (node.parent.id === parent.id && nodeName === name) {\n                    return node\n                  }\n                }\n                return FS.lookup(parent, name)\n              },\n              createNode: function(parent, name, mode, rdev) {\n                var node = new FS.FSNode(parent,name,mode,rdev);\n                FS.hashAddNode(node);\n                return node\n              },\n              destroyNode: function(node) {\n                FS.hashRemoveNode(node)\n              },\n              isRoot: function(node) {\n                return node === node.parent\n              },\n              isMountpoint: function(node) {\n                return !!node.mounted\n              },\n              isFile: function(mode) {\n                return (mode & 61440) === 32768\n              },\n              isDir: function(mode) {\n                return (mode & 61440) === 16384\n              },\n              isLink: function(mode) {\n                return (mode & 61440) === 40960\n              },\n              isChrdev: function(mode) {\n                return (mode & 61440) === 8192\n              },\n              isBlkdev: function(mode) {\n                return (mode & 61440) === 24576\n              },\n              isFIFO: function(mode) {\n                return (mode & 61440) === 4096\n              },\n              isSocket: function(mode) {\n                return (mode & 49152) === 49152\n              },\n              flagModes: {\n                \"r\": 0,\n                \"rs\": 1052672,\n                \"r+\": 2,\n                \"w\": 577,\n                \"wx\": 705,\n                \"xw\": 705,\n                \"w+\": 578,\n                \"wx+\": 706,\n                \"xw+\": 706,\n                \"a\": 1089,\n                \"ax\": 1217,\n                \"xa\": 1217,\n                \"a+\": 1090,\n                \"ax+\": 1218,\n                \"xa+\": 1218\n              },\n              modeStringToFlags: function(str) {\n                var flags = FS.flagModes[str];\n                if (typeof flags === \"undefined\") {\n                  throw new Error(\"Unknown file open mode: \" + str)\n                }\n                return flags\n              },\n              flagsToPermissionString: function(flag) {\n                var perms = [\"r\", \"w\", \"rw\"][flag & 3];\n                if (flag & 512) {\n                  perms += \"w\"\n                }\n                return perms\n              },\n              nodePermissions: function(node, perms) {\n                if (FS.ignorePermissions) {\n                  return 0\n                }\n                if (perms.indexOf(\"r\") !== -1 && !(node.mode & 292)) {\n                  return 2\n                } else if (perms.indexOf(\"w\") !== -1 && !(node.mode & 146)) {\n                  return 2\n                } else if (perms.indexOf(\"x\") !== -1 && !(node.mode & 73)) {\n                  return 2\n                }\n                return 0\n              },\n              mayLookup: function(dir) {\n                var errCode = FS.nodePermissions(dir, \"x\");\n                if (errCode)\n                  return errCode;\n                if (!dir.node_ops.lookup)\n                  return 2;\n                return 0\n              },\n              mayCreate: function(dir, name) {\n                try {\n                  var node = FS.lookupNode(dir, name);\n                  return 20\n                } catch (e) {}\n                return FS.nodePermissions(dir, \"wx\")\n              },\n              mayDelete: function(dir, name, isdir) {\n                var node;\n                try {\n                  node = FS.lookupNode(dir, name)\n                } catch (e) {\n                  return e.errno\n                }\n                var errCode = FS.nodePermissions(dir, \"wx\");\n                if (errCode) {\n                  return errCode\n                }\n                if (isdir) {\n                  if (!FS.isDir(node.mode)) {\n                    return 54\n                  }\n                  if (FS.isRoot(node) || FS.getPath(node) === FS.cwd()) {\n                    return 10\n                  }\n                } else {\n                  if (FS.isDir(node.mode)) {\n                    return 31\n                  }\n                }\n                return 0\n              },\n              mayOpen: function(node, flags) {\n                if (!node) {\n                  return 44\n                }\n                if (FS.isLink(node.mode)) {\n                  return 32\n                } else if (FS.isDir(node.mode)) {\n                  if (FS.flagsToPermissionString(flags) !== \"r\" || flags & 512) {\n                    return 31\n                  }\n                }\n                return FS.nodePermissions(node, FS.flagsToPermissionString(flags))\n              },\n              MAX_OPEN_FDS: 4096,\n              nextfd: function(fd_start, fd_end) {\n                fd_start = fd_start || 0;\n                fd_end = fd_end || FS.MAX_OPEN_FDS;\n                for (var fd = fd_start; fd <= fd_end; fd++) {\n                  if (!FS.streams[fd]) {\n                    return fd\n                  }\n                }\n                throw new FS.ErrnoError(33)\n              },\n              getStream: function(fd) {\n                return FS.streams[fd]\n              },\n              createStream: function(stream, fd_start, fd_end) {\n                if (!FS.FSStream) {\n                  FS.FSStream = function() {}\n                  ;\n                  FS.FSStream.prototype = {\n                    object: {\n                      get: function() {\n                        return this.node\n                      },\n                      set: function(val) {\n                        this.node = val\n                      }\n                    },\n                    isRead: {\n                      get: function() {\n                        return (this.flags & 2097155) !== 1\n                      }\n                    },\n                    isWrite: {\n                      get: function() {\n                        return (this.flags & 2097155) !== 0\n                      }\n                    },\n                    isAppend: {\n                      get: function() {\n                        return this.flags & 1024\n                      }\n                    }\n                  }\n                }\n                var newStream = new FS.FSStream;\n                for (var p in stream) {\n                  newStream[p] = stream[p]\n                }\n                stream = newStream;\n                var fd = FS.nextfd(fd_start, fd_end);\n                stream.fd = fd;\n                FS.streams[fd] = stream;\n                return stream\n              },\n              closeStream: function(fd) {\n                FS.streams[fd] = null\n              },\n              chrdev_stream_ops: {\n                open: function(stream) {\n                  var device = FS.getDevice(stream.node.rdev);\n                  stream.stream_ops = device.stream_ops;\n                  if (stream.stream_ops.open) {\n                    stream.stream_ops.open(stream)\n                  }\n                },\n                llseek: function() {\n                  throw new FS.ErrnoError(70)\n                }\n              },\n              major: function(dev) {\n                return dev >> 8\n              },\n              minor: function(dev) {\n                return dev & 255\n              },\n              makedev: function(ma, mi) {\n                return ma << 8 | mi\n              },\n              registerDevice: function(dev, ops) {\n                FS.devices[dev] = {\n                  stream_ops: ops\n                }\n              },\n              getDevice: function(dev) {\n                return FS.devices[dev]\n              },\n              getMounts: function(mount) {\n                var mounts = [];\n                var check = [mount];\n                while (check.length) {\n                  var m = check.pop();\n                  mounts.push(m);\n                  check.push.apply(check, m.mounts)\n                }\n                return mounts\n              },\n              syncfs: function(populate, callback) {\n                if (typeof populate === \"function\") {\n                  callback = populate;\n                  populate = false\n                }\n                FS.syncFSRequests++;\n                if (FS.syncFSRequests > 1) {\n                  err(\"warning: \" + FS.syncFSRequests + \" FS.syncfs operations in flight at once, probably just doing extra work\")\n                }\n                var mounts = FS.getMounts(FS.root.mount);\n                var completed = 0;\n                function doCallback(errCode) {\n                  FS.syncFSRequests--;\n                  return callback(errCode)\n                }\n                function done(errCode) {\n                  if (errCode) {\n                    if (!done.errored) {\n                      done.errored = true;\n                      return doCallback(errCode)\n                    }\n                    return\n                  }\n                  if (++completed >= mounts.length) {\n                    doCallback(null)\n                  }\n                }\n                mounts.forEach(function(mount) {\n                  if (!mount.type.syncfs) {\n                    return done(null)\n                  }\n                  mount.type.syncfs(mount, populate, done)\n                })\n              },\n              mount: function(type, opts, mountpoint) {\n                var root = mountpoint === \"/\";\n                var pseudo = !mountpoint;\n                var node;\n                if (root && FS.root) {\n                  throw new FS.ErrnoError(10)\n                } else if (!root && !pseudo) {\n                  var lookup = FS.lookupPath(mountpoint, {\n                    follow_mount: false\n                  });\n                  mountpoint = lookup.path;\n                  node = lookup.node;\n                  if (FS.isMountpoint(node)) {\n                    throw new FS.ErrnoError(10)\n                  }\n                  if (!FS.isDir(node.mode)) {\n                    throw new FS.ErrnoError(54)\n                  }\n                }\n                var mount = {\n                  type: type,\n                  opts: opts,\n                  mountpoint: mountpoint,\n                  mounts: []\n                };\n                var mountRoot = type.mount(mount);\n                mountRoot.mount = mount;\n                mount.root = mountRoot;\n                if (root) {\n                  FS.root = mountRoot\n                } else if (node) {\n                  node.mounted = mount;\n                  if (node.mount) {\n                    node.mount.mounts.push(mount)\n                  }\n                }\n                return mountRoot\n              },\n              unmount: function(mountpoint) {\n                var lookup = FS.lookupPath(mountpoint, {\n                  follow_mount: false\n                });\n                if (!FS.isMountpoint(lookup.node)) {\n                  throw new FS.ErrnoError(28)\n                }\n                var node = lookup.node;\n                var mount = node.mounted;\n                var mounts = FS.getMounts(mount);\n                Object.keys(FS.nameTable).forEach(function(hash) {\n                  var current = FS.nameTable[hash];\n                  while (current) {\n                    var next = current.name_next;\n                    if (mounts.indexOf(current.mount) !== -1) {\n                      FS.destroyNode(current)\n                    }\n                    current = next\n                  }\n                });\n                node.mounted = null;\n                var idx = node.mount.mounts.indexOf(mount);\n                node.mount.mounts.splice(idx, 1)\n              },\n              lookup: function(parent, name) {\n                return parent.node_ops.lookup(parent, name)\n              },\n              mknod: function(path, mode, dev) {\n                var lookup = FS.lookupPath(path, {\n                  parent: true\n                });\n                var parent = lookup.node;\n                var name = PATH.basename(path);\n                if (!name || name === \".\" || name === \"..\") {\n                  throw new FS.ErrnoError(28)\n                }\n                var errCode = FS.mayCreate(parent, name);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                if (!parent.node_ops.mknod) {\n                  throw new FS.ErrnoError(63)\n                }\n                return parent.node_ops.mknod(parent, name, mode, dev)\n              },\n              create: function(path, mode) {\n                mode = mode !== undefined ? mode : 438;\n                mode &= 4095;\n                mode |= 32768;\n                return FS.mknod(path, mode, 0)\n              },\n              mkdir: function(path, mode) {\n                mode = mode !== undefined ? mode : 511;\n                mode &= 511 | 512;\n                mode |= 16384;\n                return FS.mknod(path, mode, 0)\n              },\n              mkdirTree: function(path, mode) {\n                var dirs = path.split(\"/\");\n                var d = \"\";\n                for (var i = 0; i < dirs.length; ++i) {\n                  if (!dirs[i])\n                    continue;\n                  d += \"/\" + dirs[i];\n                  try {\n                    FS.mkdir(d, mode)\n                  } catch (e) {\n                    if (e.errno != 20)\n                      throw e\n                  }\n                }\n              },\n              mkdev: function(path, mode, dev) {\n                if (typeof dev === \"undefined\") {\n                  dev = mode;\n                  mode = 438\n                }\n                mode |= 8192;\n                return FS.mknod(path, mode, dev)\n              },\n              symlink: function(oldpath, newpath) {\n                if (!PATH_FS.resolve(oldpath)) {\n                  throw new FS.ErrnoError(44)\n                }\n                var lookup = FS.lookupPath(newpath, {\n                  parent: true\n                });\n                var parent = lookup.node;\n                if (!parent) {\n                  throw new FS.ErrnoError(44)\n                }\n                var newname = PATH.basename(newpath);\n                var errCode = FS.mayCreate(parent, newname);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                if (!parent.node_ops.symlink) {\n                  throw new FS.ErrnoError(63)\n                }\n                return parent.node_ops.symlink(parent, newname, oldpath)\n              },\n              rename: function(old_path, new_path) {\n                var old_dirname = PATH.dirname(old_path);\n                var new_dirname = PATH.dirname(new_path);\n                var old_name = PATH.basename(old_path);\n                var new_name = PATH.basename(new_path);\n                var lookup, old_dir, new_dir;\n                try {\n                  lookup = FS.lookupPath(old_path, {\n                    parent: true\n                  });\n                  old_dir = lookup.node;\n                  lookup = FS.lookupPath(new_path, {\n                    parent: true\n                  });\n                  new_dir = lookup.node\n                } catch (e) {\n                  throw new FS.ErrnoError(10)\n                }\n                if (!old_dir || !new_dir)\n                  throw new FS.ErrnoError(44);\n                if (old_dir.mount !== new_dir.mount) {\n                  throw new FS.ErrnoError(75)\n                }\n                var old_node = FS.lookupNode(old_dir, old_name);\n                var relative = PATH_FS.relative(old_path, new_dirname);\n                if (relative.charAt(0) !== \".\") {\n                  throw new FS.ErrnoError(28)\n                }\n                relative = PATH_FS.relative(new_path, old_dirname);\n                if (relative.charAt(0) !== \".\") {\n                  throw new FS.ErrnoError(55)\n                }\n                var new_node;\n                try {\n                  new_node = FS.lookupNode(new_dir, new_name)\n                } catch (e) {}\n                if (old_node === new_node) {\n                  return\n                }\n                var isdir = FS.isDir(old_node.mode);\n                var errCode = FS.mayDelete(old_dir, old_name, isdir);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                errCode = new_node ? FS.mayDelete(new_dir, new_name, isdir) : FS.mayCreate(new_dir, new_name);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                if (!old_dir.node_ops.rename) {\n                  throw new FS.ErrnoError(63)\n                }\n                if (FS.isMountpoint(old_node) || new_node && FS.isMountpoint(new_node)) {\n                  throw new FS.ErrnoError(10)\n                }\n                if (new_dir !== old_dir) {\n                  errCode = FS.nodePermissions(old_dir, \"w\");\n                  if (errCode) {\n                    throw new FS.ErrnoError(errCode)\n                  }\n                }\n                try {\n                  if (FS.trackingDelegate[\"willMovePath\"]) {\n                    FS.trackingDelegate[\"willMovePath\"](old_path, new_path)\n                  }\n                } catch (e) {\n                  err(\"FS.trackingDelegate['willMovePath']('\" + old_path + \"', '\" + new_path + \"') threw an exception: \" + e.message)\n                }\n                FS.hashRemoveNode(old_node);\n                try {\n                  old_dir.node_ops.rename(old_node, new_dir, new_name)\n                } catch (e) {\n                  throw e\n                } finally {\n                  FS.hashAddNode(old_node)\n                }\n                try {\n                  if (FS.trackingDelegate[\"onMovePath\"])\n                    FS.trackingDelegate[\"onMovePath\"](old_path, new_path)\n                } catch (e) {\n                  err(\"FS.trackingDelegate['onMovePath']('\" + old_path + \"', '\" + new_path + \"') threw an exception: \" + e.message)\n                }\n              },\n              rmdir: function(path) {\n                var lookup = FS.lookupPath(path, {\n                  parent: true\n                });\n                var parent = lookup.node;\n                var name = PATH.basename(path);\n                var node = FS.lookupNode(parent, name);\n                var errCode = FS.mayDelete(parent, name, true);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                if (!parent.node_ops.rmdir) {\n                  throw new FS.ErrnoError(63)\n                }\n                if (FS.isMountpoint(node)) {\n                  throw new FS.ErrnoError(10)\n                }\n                try {\n                  if (FS.trackingDelegate[\"willDeletePath\"]) {\n                    FS.trackingDelegate[\"willDeletePath\"](path)\n                  }\n                } catch (e) {\n                  err(\"FS.trackingDelegate['willDeletePath']('\" + path + \"') threw an exception: \" + e.message)\n                }\n                parent.node_ops.rmdir(parent, name);\n                FS.destroyNode(node);\n                try {\n                  if (FS.trackingDelegate[\"onDeletePath\"])\n                    FS.trackingDelegate[\"onDeletePath\"](path)\n                } catch (e) {\n                  err(\"FS.trackingDelegate['onDeletePath']('\" + path + \"') threw an exception: \" + e.message)\n                }\n              },\n              readdir: function(path) {\n                var lookup = FS.lookupPath(path, {\n                  follow: true\n                });\n                var node = lookup.node;\n                if (!node.node_ops.readdir) {\n                  throw new FS.ErrnoError(54)\n                }\n                return node.node_ops.readdir(node)\n              },\n              unlink: function(path) {\n                var lookup = FS.lookupPath(path, {\n                  parent: true\n                });\n                var parent = lookup.node;\n                var name = PATH.basename(path);\n                var node = FS.lookupNode(parent, name);\n                var errCode = FS.mayDelete(parent, name, false);\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                if (!parent.node_ops.unlink) {\n                  throw new FS.ErrnoError(63)\n                }\n                if (FS.isMountpoint(node)) {\n                  throw new FS.ErrnoError(10)\n                }\n                try {\n                  if (FS.trackingDelegate[\"willDeletePath\"]) {\n                    FS.trackingDelegate[\"willDeletePath\"](path)\n                  }\n                } catch (e) {\n                  err(\"FS.trackingDelegate['willDeletePath']('\" + path + \"') threw an exception: \" + e.message)\n                }\n                parent.node_ops.unlink(parent, name);\n                FS.destroyNode(node);\n                try {\n                  if (FS.trackingDelegate[\"onDeletePath\"])\n                    FS.trackingDelegate[\"onDeletePath\"](path)\n                } catch (e) {\n                  err(\"FS.trackingDelegate['onDeletePath']('\" + path + \"') threw an exception: \" + e.message)\n                }\n              },\n              readlink: function(path) {\n                var lookup = FS.lookupPath(path);\n                var link = lookup.node;\n                if (!link) {\n                  throw new FS.ErrnoError(44)\n                }\n                if (!link.node_ops.readlink) {\n                  throw new FS.ErrnoError(28)\n                }\n                return PATH_FS.resolve(FS.getPath(link.parent), link.node_ops.readlink(link))\n              },\n              stat: function(path, dontFollow) {\n                var lookup = FS.lookupPath(path, {\n                  follow: !dontFollow\n                });\n                var node = lookup.node;\n                if (!node) {\n                  throw new FS.ErrnoError(44)\n                }\n                if (!node.node_ops.getattr) {\n                  throw new FS.ErrnoError(63)\n                }\n                return node.node_ops.getattr(node)\n              },\n              lstat: function(path) {\n                return FS.stat(path, true)\n              },\n              chmod: function(path, mode, dontFollow) {\n                var node;\n                if (typeof path === \"string\") {\n                  var lookup = FS.lookupPath(path, {\n                    follow: !dontFollow\n                  });\n                  node = lookup.node\n                } else {\n                  node = path\n                }\n                if (!node.node_ops.setattr) {\n                  throw new FS.ErrnoError(63)\n                }\n                node.node_ops.setattr(node, {\n                  mode: mode & 4095 | node.mode & ~4095,\n                  timestamp: Date.now()\n                })\n              },\n              lchmod: function(path, mode) {\n                FS.chmod(path, mode, true)\n              },\n              fchmod: function(fd, mode) {\n                var stream = FS.getStream(fd);\n                if (!stream) {\n                  throw new FS.ErrnoError(8)\n                }\n                FS.chmod(stream.node, mode)\n              },\n              chown: function(path, uid, gid, dontFollow) {\n                var node;\n                if (typeof path === \"string\") {\n                  var lookup = FS.lookupPath(path, {\n                    follow: !dontFollow\n                  });\n                  node = lookup.node\n                } else {\n                  node = path\n                }\n                if (!node.node_ops.setattr) {\n                  throw new FS.ErrnoError(63)\n                }\n                node.node_ops.setattr(node, {\n                  timestamp: Date.now()\n                })\n              },\n              lchown: function(path, uid, gid) {\n                FS.chown(path, uid, gid, true)\n              },\n              fchown: function(fd, uid, gid) {\n                var stream = FS.getStream(fd);\n                if (!stream) {\n                  throw new FS.ErrnoError(8)\n                }\n                FS.chown(stream.node, uid, gid)\n              },\n              truncate: function(path, len) {\n                if (len < 0) {\n                  throw new FS.ErrnoError(28)\n                }\n                var node;\n                if (typeof path === \"string\") {\n                  var lookup = FS.lookupPath(path, {\n                    follow: true\n                  });\n                  node = lookup.node\n                } else {\n                  node = path\n                }\n                if (!node.node_ops.setattr) {\n                  throw new FS.ErrnoError(63)\n                }\n                if (FS.isDir(node.mode)) {\n                  throw new FS.ErrnoError(31)\n                }\n                if (!FS.isFile(node.mode)) {\n                  throw new FS.ErrnoError(28)\n                }\n                var errCode = FS.nodePermissions(node, \"w\");\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                node.node_ops.setattr(node, {\n                  size: len,\n                  timestamp: Date.now()\n                })\n              },\n              ftruncate: function(fd, len) {\n                var stream = FS.getStream(fd);\n                if (!stream) {\n                  throw new FS.ErrnoError(8)\n                }\n                if ((stream.flags & 2097155) === 0) {\n                  throw new FS.ErrnoError(28)\n                }\n                FS.truncate(stream.node, len)\n              },\n              utime: function(path, atime, mtime) {\n                var lookup = FS.lookupPath(path, {\n                  follow: true\n                });\n                var node = lookup.node;\n                node.node_ops.setattr(node, {\n                  timestamp: Math.max(atime, mtime)\n                })\n              },\n              open: function(path, flags, mode, fd_start, fd_end) {\n                if (path === \"\") {\n                  throw new FS.ErrnoError(44)\n                }\n                flags = typeof flags === \"string\" ? FS.modeStringToFlags(flags) : flags;\n                mode = typeof mode === \"undefined\" ? 438 : mode;\n                if (flags & 64) {\n                  mode = mode & 4095 | 32768\n                } else {\n                  mode = 0\n                }\n                var node;\n                if (typeof path === \"object\") {\n                  node = path\n                } else {\n                  path = PATH.normalize(path);\n                  try {\n                    var lookup = FS.lookupPath(path, {\n                      follow: !(flags & 131072)\n                    });\n                    node = lookup.node\n                  } catch (e) {}\n                }\n                var created = false;\n                if (flags & 64) {\n                  if (node) {\n                    if (flags & 128) {\n                      throw new FS.ErrnoError(20)\n                    }\n                  } else {\n                    node = FS.mknod(path, mode, 0);\n                    created = true\n                  }\n                }\n                if (!node) {\n                  throw new FS.ErrnoError(44)\n                }\n                if (FS.isChrdev(node.mode)) {\n                  flags &= ~512\n                }\n                if (flags & 65536 && !FS.isDir(node.mode)) {\n                  throw new FS.ErrnoError(54)\n                }\n                if (!created) {\n                  var errCode = FS.mayOpen(node, flags);\n                  if (errCode) {\n                    throw new FS.ErrnoError(errCode)\n                  }\n                }\n                if (flags & 512) {\n                  FS.truncate(node, 0)\n                }\n                flags &= ~(128 | 512);\n                var stream = FS.createStream({\n                  node: node,\n                  path: FS.getPath(node),\n                  flags: flags,\n                  seekable: true,\n                  position: 0,\n                  stream_ops: node.stream_ops,\n                  ungotten: [],\n                  error: false\n                }, fd_start, fd_end);\n                if (stream.stream_ops.open) {\n                  stream.stream_ops.open(stream)\n                }\n                if (Module[\"logReadFiles\"] && !(flags & 1)) {\n                  if (!FS.readFiles)\n                    FS.readFiles = {};\n                  if (!(path in FS.readFiles)) {\n                    FS.readFiles[path] = 1;\n                    err(\"FS.trackingDelegate error on read file: \" + path)\n                  }\n                }\n                try {\n                  if (FS.trackingDelegate[\"onOpenFile\"]) {\n                    var trackingFlags = 0;\n                    if ((flags & 2097155) !== 1) {\n                      trackingFlags |= FS.tracking.openFlags.READ\n                    }\n                    if ((flags & 2097155) !== 0) {\n                      trackingFlags |= FS.tracking.openFlags.WRITE\n                    }\n                    FS.trackingDelegate[\"onOpenFile\"](path, trackingFlags)\n                  }\n                } catch (e) {\n                  err(\"FS.trackingDelegate['onOpenFile']('\" + path + \"', flags) threw an exception: \" + e.message)\n                }\n                return stream\n              },\n              close: function(stream) {\n                if (FS.isClosed(stream)) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (stream.getdents)\n                  stream.getdents = null;\n                try {\n                  if (stream.stream_ops.close) {\n                    stream.stream_ops.close(stream)\n                  }\n                } catch (e) {\n                  throw e\n                } finally {\n                  FS.closeStream(stream.fd)\n                }\n                stream.fd = null\n              },\n              isClosed: function(stream) {\n                return stream.fd === null\n              },\n              llseek: function(stream, offset, whence) {\n                if (FS.isClosed(stream)) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (!stream.seekable || !stream.stream_ops.llseek) {\n                  throw new FS.ErrnoError(70)\n                }\n                if (whence != 0 && whence != 1 && whence != 2) {\n                  throw new FS.ErrnoError(28)\n                }\n                stream.position = stream.stream_ops.llseek(stream, offset, whence);\n                stream.ungotten = [];\n                return stream.position\n              },\n              read: function(stream, buffer, offset, length, position) {\n                if (length < 0 || position < 0) {\n                  throw new FS.ErrnoError(28)\n                }\n                if (FS.isClosed(stream)) {\n                  throw new FS.ErrnoError(8)\n                }\n                if ((stream.flags & 2097155) === 1) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (FS.isDir(stream.node.mode)) {\n                  throw new FS.ErrnoError(31)\n                }\n                if (!stream.stream_ops.read) {\n                  throw new FS.ErrnoError(28)\n                }\n                var seeking = typeof position !== \"undefined\";\n                if (!seeking) {\n                  position = stream.position\n                } else if (!stream.seekable) {\n                  throw new FS.ErrnoError(70)\n                }\n                var bytesRead = stream.stream_ops.read(stream, buffer, offset, length, position);\n                if (!seeking)\n                  stream.position += bytesRead;\n                return bytesRead\n              },\n              write: function(stream, buffer, offset, length, position, canOwn) {\n                if (length < 0 || position < 0) {\n                  throw new FS.ErrnoError(28)\n                }\n                if (FS.isClosed(stream)) {\n                  throw new FS.ErrnoError(8)\n                }\n                if ((stream.flags & 2097155) === 0) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (FS.isDir(stream.node.mode)) {\n                  throw new FS.ErrnoError(31)\n                }\n                if (!stream.stream_ops.write) {\n                  throw new FS.ErrnoError(28)\n                }\n                if (stream.flags & 1024) {\n                  FS.llseek(stream, 0, 2)\n                }\n                var seeking = typeof position !== \"undefined\";\n                if (!seeking) {\n                  position = stream.position\n                } else if (!stream.seekable) {\n                  throw new FS.ErrnoError(70)\n                }\n                var bytesWritten = stream.stream_ops.write(stream, buffer, offset, length, position, canOwn);\n                if (!seeking)\n                  stream.position += bytesWritten;\n                try {\n                  if (stream.path && FS.trackingDelegate[\"onWriteToFile\"])\n                    FS.trackingDelegate[\"onWriteToFile\"](stream.path)\n                } catch (e) {\n                  err(\"FS.trackingDelegate['onWriteToFile']('\" + stream.path + \"') threw an exception: \" + e.message)\n                }\n                return bytesWritten\n              },\n              allocate: function(stream, offset, length) {\n                if (FS.isClosed(stream)) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (offset < 0 || length <= 0) {\n                  throw new FS.ErrnoError(28)\n                }\n                if ((stream.flags & 2097155) === 0) {\n                  throw new FS.ErrnoError(8)\n                }\n                if (!FS.isFile(stream.node.mode) && !FS.isDir(stream.node.mode)) {\n                  throw new FS.ErrnoError(43)\n                }\n                if (!stream.stream_ops.allocate) {\n                  throw new FS.ErrnoError(138)\n                }\n                stream.stream_ops.allocate(stream, offset, length)\n              },\n              mmap: function(stream, buffer, offset, length, position, prot, flags) {\n                if ((prot & 2) !== 0 && (flags & 2) === 0 && (stream.flags & 2097155) !== 2) {\n                  throw new FS.ErrnoError(2)\n                }\n                if ((stream.flags & 2097155) === 1) {\n                  throw new FS.ErrnoError(2)\n                }\n                if (!stream.stream_ops.mmap) {\n                  throw new FS.ErrnoError(43)\n                }\n                return stream.stream_ops.mmap(stream, buffer, offset, length, position, prot, flags)\n              },\n              msync: function(stream, buffer, offset, length, mmapFlags) {\n                if (!stream || !stream.stream_ops.msync) {\n                  return 0\n                }\n                return stream.stream_ops.msync(stream, buffer, offset, length, mmapFlags)\n              },\n              munmap: function(stream) {\n                return 0\n              },\n              ioctl: function(stream, cmd, arg) {\n                if (!stream.stream_ops.ioctl) {\n                  throw new FS.ErrnoError(59)\n                }\n                return stream.stream_ops.ioctl(stream, cmd, arg)\n              },\n              readFile: function(path, opts) {\n                opts = opts || {};\n                opts.flags = opts.flags || \"r\";\n                opts.encoding = opts.encoding || \"binary\";\n                if (opts.encoding !== \"utf8\" && opts.encoding !== \"binary\") {\n                  throw new Error('Invalid encoding type \"' + opts.encoding + '\"')\n                }\n                var ret;\n                var stream = FS.open(path, opts.flags);\n                var stat = FS.stat(path);\n                var length = stat.size;\n                var buf = new Uint8Array(length);\n                FS.read(stream, buf, 0, length, 0);\n                if (opts.encoding === \"utf8\") {\n                  ret = UTF8ArrayToString(buf, 0)\n                } else if (opts.encoding === \"binary\") {\n                  ret = buf\n                }\n                FS.close(stream);\n                return ret\n              },\n              writeFile: function(path, data, opts) {\n                opts = opts || {};\n                opts.flags = opts.flags || \"w\";\n                var stream = FS.open(path, opts.flags, opts.mode);\n                if (typeof data === \"string\") {\n                  var buf = new Uint8Array(lengthBytesUTF8(data) + 1);\n                  var actualNumBytes = stringToUTF8Array(data, buf, 0, buf.length);\n                  FS.write(stream, buf, 0, actualNumBytes, undefined, opts.canOwn)\n                } else if (ArrayBuffer.isView(data)) {\n                  FS.write(stream, data, 0, data.byteLength, undefined, opts.canOwn)\n                } else {\n                  throw new Error(\"Unsupported data type\")\n                }\n                FS.close(stream)\n              },\n              cwd: function() {\n                return FS.currentPath\n              },\n              chdir: function(path) {\n                var lookup = FS.lookupPath(path, {\n                  follow: true\n                });\n                if (lookup.node === null) {\n                  throw new FS.ErrnoError(44)\n                }\n                if (!FS.isDir(lookup.node.mode)) {\n                  throw new FS.ErrnoError(54)\n                }\n                var errCode = FS.nodePermissions(lookup.node, \"x\");\n                if (errCode) {\n                  throw new FS.ErrnoError(errCode)\n                }\n                FS.currentPath = lookup.path\n              },\n              createDefaultDirectories: function() {\n                FS.mkdir(\"/tmp\");\n                FS.mkdir(\"/home\");\n                FS.mkdir(\"/home/web_user\")\n              },\n              createDefaultDevices: function() {\n                FS.mkdir(\"/dev\");\n                FS.registerDevice(FS.makedev(1, 3), {\n                  read: function() {\n                    return 0\n                  },\n                  write: function(stream, buffer, offset, length, pos) {\n                    return length\n                  }\n                });\n                FS.mkdev(\"/dev/null\", FS.makedev(1, 3));\n                TTY.register(FS.makedev(5, 0), TTY.default_tty_ops);\n                TTY.register(FS.makedev(6, 0), TTY.default_tty1_ops);\n                FS.mkdev(\"/dev/tty\", FS.makedev(5, 0));\n                FS.mkdev(\"/dev/tty1\", FS.makedev(6, 0));\n                var random_device;\n                if (typeof crypto === \"object\" && typeof crypto[\"getRandomValues\"] === \"function\") {\n                  var randomBuffer = new Uint8Array(1);\n                  random_device = function() {\n                    crypto.getRandomValues(randomBuffer);\n                    return randomBuffer[0]\n                  }\n                } else {}\n                if (!random_device) {\n                  random_device = function() {\n                    abort(\"random_device\")\n                  }\n                }\n                FS.createDevice(\"/dev\", \"random\", random_device);\n                FS.createDevice(\"/dev\", \"urandom\", random_device);\n                FS.mkdir(\"/dev/shm\");\n                FS.mkdir(\"/dev/shm/tmp\")\n              },\n              createSpecialDirectories: function() {\n                FS.mkdir(\"/proc\");\n                FS.mkdir(\"/proc/self\");\n                FS.mkdir(\"/proc/self/fd\");\n                FS.mount({\n                  mount: function() {\n                    var node = FS.createNode(\"/proc/self\", \"fd\", 16384 | 511, 73);\n                    node.node_ops = {\n                      lookup: function(parent, name) {\n                        var fd = +name;\n                        var stream = FS.getStream(fd);\n                        if (!stream)\n                          throw new FS.ErrnoError(8);\n                        var ret = {\n                          parent: null,\n                          mount: {\n                            mountpoint: \"fake\"\n                          },\n                          node_ops: {\n                            readlink: function() {\n                              return stream.path\n                            }\n                          }\n                        };\n                        ret.parent = ret;\n                        return ret\n                      }\n                    };\n                    return node\n                  }\n                }, {}, \"/proc/self/fd\")\n              },\n              createStandardStreams: function() {\n                if (Module[\"stdin\"]) {\n                  FS.createDevice(\"/dev\", \"stdin\", Module[\"stdin\"])\n                } else {\n                  FS.symlink(\"/dev/tty\", \"/dev/stdin\")\n                }\n                if (Module[\"stdout\"]) {\n                  FS.createDevice(\"/dev\", \"stdout\", null, Module[\"stdout\"])\n                } else {\n                  FS.symlink(\"/dev/tty\", \"/dev/stdout\")\n                }\n                if (Module[\"stderr\"]) {\n                  FS.createDevice(\"/dev\", \"stderr\", null, Module[\"stderr\"])\n                } else {\n                  FS.symlink(\"/dev/tty1\", \"/dev/stderr\")\n                }\n                var stdin = FS.open(\"/dev/stdin\", \"r\");\n                var stdout = FS.open(\"/dev/stdout\", \"w\");\n                var stderr = FS.open(\"/dev/stderr\", \"w\")\n              },\n              ensureErrnoError: function() {\n                if (FS.ErrnoError)\n                  return;\n                FS.ErrnoError = function ErrnoError(errno, node) {\n                  this.node = node;\n                  this.setErrno = function(errno) {\n                    this.errno = errno\n                  }\n                  ;\n                  this.setErrno(errno);\n                  this.message = \"FS error\"\n                }\n                ;\n                FS.ErrnoError.prototype = new Error;\n                FS.ErrnoError.prototype.constructor = FS.ErrnoError;\n                [44].forEach(function(code) {\n                  FS.genericErrors[code] = new FS.ErrnoError(code);\n                  FS.genericErrors[code].stack = \"<generic error, no stack>\"\n                })\n              },\n              staticInit: function() {\n                FS.ensureErrnoError();\n                FS.nameTable = new Array(4096);\n                FS.mount(MEMFS, {}, \"/\");\n                FS.createDefaultDirectories();\n                FS.createDefaultDevices();\n                FS.createSpecialDirectories();\n                FS.filesystems = {\n                  \"MEMFS\": MEMFS\n                }\n              },\n              init: function(input, output, error) {\n                FS.init.initialized = true;\n                FS.ensureErrnoError();\n                Module[\"stdin\"] = input || Module[\"stdin\"];\n                Module[\"stdout\"] = output || Module[\"stdout\"];\n                Module[\"stderr\"] = error || Module[\"stderr\"];\n                FS.createStandardStreams()\n              },\n              quit: function() {\n                FS.init.initialized = false;\n                var fflush = Module[\"_fflush\"];\n                if (fflush)\n                  fflush(0);\n                for (var i = 0; i < FS.streams.length; i++) {\n                  var stream = FS.streams[i];\n                  if (!stream) {\n                    continue\n                  }\n                  FS.close(stream)\n                }\n              },\n              getMode: function(canRead, canWrite) {\n                var mode = 0;\n                if (canRead)\n                  mode |= 292 | 73;\n                if (canWrite)\n                  mode |= 146;\n                return mode\n              },\n              joinPath: function(parts, forceRelative) {\n                var path = PATH.join.apply(null, parts);\n                if (forceRelative && path[0] == \"/\")\n                  path = path.substr(1);\n                return path\n              },\n              absolutePath: function(relative, base) {\n                return PATH_FS.resolve(base, relative)\n              },\n              standardizePath: function(path) {\n                return PATH.normalize(path)\n              },\n              findObject: function(path, dontResolveLastLink) {\n                var ret = FS.analyzePath(path, dontResolveLastLink);\n                if (ret.exists) {\n                  return ret.object\n                } else {\n                  ___setErrNo(ret.error);\n                  return null\n                }\n              },\n              analyzePath: function(path, dontResolveLastLink) {\n                try {\n                  var lookup = FS.lookupPath(path, {\n                    follow: !dontResolveLastLink\n                  });\n                  path = lookup.path\n                } catch (e) {}\n                var ret = {\n                  isRoot: false,\n                  exists: false,\n                  error: 0,\n                  name: null,\n                  path: null,\n                  object: null,\n                  parentExists: false,\n                  parentPath: null,\n                  parentObject: null\n                };\n                try {\n                  var lookup = FS.lookupPath(path, {\n                    parent: true\n                  });\n                  ret.parentExists = true;\n                  ret.parentPath = lookup.path;\n                  ret.parentObject = lookup.node;\n                  ret.name = PATH.basename(path);\n                  lookup = FS.lookupPath(path, {\n                    follow: !dontResolveLastLink\n                  });\n                  ret.exists = true;\n                  ret.path = lookup.path;\n                  ret.object = lookup.node;\n                  ret.name = lookup.node.name;\n                  ret.isRoot = lookup.path === \"/\"\n                } catch (e) {\n                  ret.error = e.errno\n                }\n                return ret\n              },\n              createFolder: function(parent, name, canRead, canWrite) {\n                var path = PATH.join2(typeof parent === \"string\" ? parent : FS.getPath(parent), name);\n                var mode = FS.getMode(canRead, canWrite);\n                return FS.mkdir(path, mode)\n              },\n              createPath: function(parent, path, canRead, canWrite) {\n                parent = typeof parent === \"string\" ? parent : FS.getPath(parent);\n                var parts = path.split(\"/\").reverse();\n                while (parts.length) {\n                  var part = parts.pop();\n                  if (!part)\n                    continue;\n                  var current = PATH.join2(parent, part);\n                  try {\n                    FS.mkdir(current)\n                  } catch (e) {}\n                  parent = current\n                }\n                return current\n              },\n              createFile: function(parent, name, properties, canRead, canWrite) {\n                var path = PATH.join2(typeof parent === \"string\" ? parent : FS.getPath(parent), name);\n                var mode = FS.getMode(canRead, canWrite);\n                return FS.create(path, mode)\n              },\n              createDataFile: function(parent, name, data, canRead, canWrite, canOwn) {\n                var path = name ? PATH.join2(typeof parent === \"string\" ? parent : FS.getPath(parent), name) : parent;\n                var mode = FS.getMode(canRead, canWrite);\n                var node = FS.create(path, mode);\n                if (data) {\n                  if (typeof data === \"string\") {\n                    var arr = new Array(data.length);\n                    for (var i = 0, len = data.length; i < len; ++i)\n                      arr[i] = data.charCodeAt(i);\n                    data = arr\n                  }\n                  FS.chmod(node, mode | 146);\n                  var stream = FS.open(node, \"w\");\n                  FS.write(stream, data, 0, data.length, 0, canOwn);\n                  FS.close(stream);\n                  FS.chmod(node, mode)\n                }\n                return node\n              },\n              createDevice: function(parent, name, input, output) {\n                var path = PATH.join2(typeof parent === \"string\" ? parent : FS.getPath(parent), name);\n                var mode = FS.getMode(!!input, !!output);\n                if (!FS.createDevice.major)\n                  FS.createDevice.major = 64;\n                var dev = FS.makedev(FS.createDevice.major++, 0);\n                FS.registerDevice(dev, {\n                  open: function(stream) {\n                    stream.seekable = false\n                  },\n                  close: function(stream) {\n                    if (output && output.buffer && output.buffer.length) {\n                      output(10)\n                    }\n                  },\n                  read: function(stream, buffer, offset, length, pos) {\n                    var bytesRead = 0;\n                    for (var i = 0; i < length; i++) {\n                      var result;\n                      try {\n                        result = input()\n                      } catch (e) {\n                        throw new FS.ErrnoError(29)\n                      }\n                      if (result === undefined && bytesRead === 0) {\n                        throw new FS.ErrnoError(6)\n                      }\n                      if (result === null || result === undefined)\n                        break;\n                      bytesRead++;\n                      buffer[offset + i] = result\n                    }\n                    if (bytesRead) {\n                      stream.node.timestamp = Date.now()\n                    }\n                    return bytesRead\n                  },\n                  write: function(stream, buffer, offset, length, pos) {\n                    for (var i = 0; i < length; i++) {\n                      try {\n                        output(buffer[offset + i])\n                      } catch (e) {\n                        throw new FS.ErrnoError(29)\n                      }\n                    }\n                    if (length) {\n                      stream.node.timestamp = Date.now()\n                    }\n                    return i\n                  }\n                });\n                return FS.mkdev(path, mode, dev)\n              },\n              createLink: function(parent, name, target, canRead, canWrite) {\n                var path = PATH.join2(typeof parent === \"string\" ? parent : FS.getPath(parent), name);\n                return FS.symlink(target, path)\n              },\n              forceLoadFile: function(obj) {\n                if (obj.isDevice || obj.isFolder || obj.link || obj.contents)\n                  return true;\n                var success = true;\n                if (typeof XMLHttpRequest !== \"undefined\") {\n                  throw new Error(\"Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.\")\n                } else if (read_) {\n                  try {\n                    obj.contents = intArrayFromString(read_(obj.url), true);\n                    obj.usedBytes = obj.contents.length\n                  } catch (e) {\n                    success = false\n                  }\n                } else {\n                  throw new Error(\"Cannot load without read() or XMLHttpRequest.\")\n                }\n                if (!success)\n                  ___setErrNo(29);\n                return success\n              },\n              createLazyFile: function(parent, name, url, canRead, canWrite) {\n                function LazyUint8Array() {\n                  this.lengthKnown = false;\n                  this.chunks = []\n                }\n                LazyUint8Array.prototype.get = function LazyUint8Array_get(idx) {\n                  if (idx > this.length - 1 || idx < 0) {\n                    return undefined\n                  }\n                  var chunkOffset = idx % this.chunkSize;\n                  var chunkNum = idx / this.chunkSize | 0;\n                  return this.getter(chunkNum)[chunkOffset]\n                }\n                ;\n                LazyUint8Array.prototype.setDataGetter = function LazyUint8Array_setDataGetter(getter) {\n                  this.getter = getter\n                }\n                ;\n                LazyUint8Array.prototype.cacheLength = function LazyUint8Array_cacheLength() {\n                  var xhr = new XMLHttpRequest;\n                  xhr.open(\"HEAD\", url, false);\n                  xhr.send(null);\n                  if (!(xhr.status >= 200 && xhr.status < 300 || xhr.status === 304))\n                    throw new Error(\"Couldn't load \" + url + \". Status: \" + xhr.status);\n                  var datalength = Number(xhr.getResponseHeader(\"Content-length\"));\n                  var header;\n                  var hasByteServing = (header = xhr.getResponseHeader(\"Accept-Ranges\")) && header === \"bytes\";\n                  var usesGzip = (header = xhr.getResponseHeader(\"Content-Encoding\")) && header === \"gzip\";\n                  var chunkSize = 1024 * 1024;\n                  if (!hasByteServing)\n                    chunkSize = datalength;\n                  var doXHR = function(from, to) {\n                    if (from > to)\n                      throw new Error(\"invalid range (\" + from + \", \" + to + \") or no bytes requested!\");\n                    if (to > datalength - 1)\n                      throw new Error(\"only \" + datalength + \" bytes available! programmer error!\");\n                    var xhr = new XMLHttpRequest;\n                    xhr.open(\"GET\", url, false);\n                    if (datalength !== chunkSize)\n                      xhr.setRequestHeader(\"Range\", \"bytes=\" + from + \"-\" + to);\n                    if (typeof Uint8Array != \"undefined\")\n                      xhr.responseType = \"arraybuffer\";\n                    if (xhr.overrideMimeType) {\n                      xhr.overrideMimeType(\"text/plain; charset=x-user-defined\")\n                    }\n                    xhr.send(null);\n                    if (!(xhr.status >= 200 && xhr.status < 300 || xhr.status === 304))\n                      throw new Error(\"Couldn't load \" + url + \". Status: \" + xhr.status);\n                    if (xhr.response !== undefined) {\n                      return new Uint8Array(xhr.response || [])\n                    } else {\n                      return intArrayFromString(xhr.responseText || \"\", true)\n                    }\n                  };\n                  var lazyArray = this;\n                  lazyArray.setDataGetter(function(chunkNum) {\n                    var start = chunkNum * chunkSize;\n                    var end = (chunkNum + 1) * chunkSize - 1;\n                    end = Math.min(end, datalength - 1);\n                    if (typeof lazyArray.chunks[chunkNum] === \"undefined\") {\n                      lazyArray.chunks[chunkNum] = doXHR(start, end)\n                    }\n                    if (typeof lazyArray.chunks[chunkNum] === \"undefined\")\n                      throw new Error(\"doXHR failed!\");\n                    return lazyArray.chunks[chunkNum]\n                  });\n                  if (usesGzip || !datalength) {\n                    chunkSize = datalength = 1;\n                    datalength = this.getter(0).length;\n                    chunkSize = datalength;\n                    out(\"LazyFiles on gzip forces download of the whole file when length is accessed\")\n                  }\n                  this._length = datalength;\n                  this._chunkSize = chunkSize;\n                  this.lengthKnown = true\n                }\n                ;\n                if (typeof XMLHttpRequest !== \"undefined\") {\n                  if (!ENVIRONMENT_IS_WORKER)\n                    throw \"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc\";\n                  var lazyArray = new LazyUint8Array;\n                  Object.defineProperties(lazyArray, {\n                    length: {\n                      get: function() {\n                        if (!this.lengthKnown) {\n                          this.cacheLength()\n                        }\n                        return this._length\n                      }\n                    },\n                    chunkSize: {\n                      get: function() {\n                        if (!this.lengthKnown) {\n                          this.cacheLength()\n                        }\n                        return this._chunkSize\n                      }\n                    }\n                  });\n                  var properties = {\n                    isDevice: false,\n                    contents: lazyArray\n                  }\n                } else {\n                  var properties = {\n                    isDevice: false,\n                    url: url\n                  }\n                }\n                var node = FS.createFile(parent, name, properties, canRead, canWrite);\n                if (properties.contents) {\n                  node.contents = properties.contents\n                } else if (properties.url) {\n                  node.contents = null;\n                  node.url = properties.url\n                }\n                Object.defineProperties(node, {\n                  usedBytes: {\n                    get: function() {\n                      return this.contents.length\n                    }\n                  }\n                });\n                var stream_ops = {};\n                var keys = Object.keys(node.stream_ops);\n                keys.forEach(function(key) {\n                  var fn = node.stream_ops[key];\n                  stream_ops[key] = function forceLoadLazyFile() {\n                    if (!FS.forceLoadFile(node)) {\n                      throw new FS.ErrnoError(29)\n                    }\n                    return fn.apply(null, arguments)\n                  }\n                });\n                stream_ops.read = function stream_ops_read(stream, buffer, offset, length, position) {\n                  if (!FS.forceLoadFile(node)) {\n                    throw new FS.ErrnoError(29)\n                  }\n                  var contents = stream.node.contents;\n                  if (position >= contents.length)\n                    return 0;\n                  var size = Math.min(contents.length - position, length);\n                  if (contents.slice) {\n                    for (var i = 0; i < size; i++) {\n                      buffer[offset + i] = contents[position + i]\n                    }\n                  } else {\n                    for (var i = 0; i < size; i++) {\n                      buffer[offset + i] = contents.get(position + i)\n                    }\n                  }\n                  return size\n                }\n                ;\n                node.stream_ops = stream_ops;\n                return node\n              },\n              createPreloadedFile: function(parent, name, url, canRead, canWrite, onload, onerror, dontCreateFile, canOwn, preFinish) {\n                Browser.init();\n                var fullname = name ? PATH_FS.resolve(PATH.join2(parent, name)) : parent;\n                var dep = getUniqueRunDependency(\"cp \" + fullname);\n                function processData(byteArray) {\n                  function finish(byteArray) {\n                    if (preFinish)\n                      preFinish();\n                    if (!dontCreateFile) {\n                      FS.createDataFile(parent, name, byteArray, canRead, canWrite, canOwn)\n                    }\n                    if (onload)\n                      onload();\n                    removeRunDependency(dep)\n                  }\n                  var handled = false;\n                  Module[\"preloadPlugins\"].forEach(function(plugin) {\n                    if (handled)\n                      return;\n                    if (plugin[\"canHandle\"](fullname)) {\n                      plugin[\"handle\"](byteArray, fullname, finish, function() {\n                        if (onerror)\n                          onerror();\n                        removeRunDependency(dep)\n                      });\n                      handled = true\n                    }\n                  });\n                  if (!handled)\n                    finish(byteArray)\n                }\n                addRunDependency(dep);\n                if (typeof url == \"string\") {\n                  Browser.asyncLoad(url, function(byteArray) {\n                    processData(byteArray)\n                  }, onerror)\n                } else {\n                  processData(url)\n                }\n              },\n              indexedDB: function() {\n                return window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB\n              },\n              DB_NAME: function() {\n                return \"EM_FS_\" + window.location.pathname\n              },\n              DB_VERSION: 20,\n              DB_STORE_NAME: \"FILE_DATA\",\n              saveFilesToDB: function(paths, onload, onerror) {\n                onload = onload || function() {}\n                ;\n                onerror = onerror || function() {}\n                ;\n                var indexedDB = FS.indexedDB();\n                try {\n                  var openRequest = indexedDB.open(FS.DB_NAME(), FS.DB_VERSION)\n                } catch (e) {\n                  return onerror(e)\n                }\n                openRequest.onupgradeneeded = function openRequest_onupgradeneeded() {\n                  out(\"creating db\");\n                  var db = openRequest.result;\n                  db.createObjectStore(FS.DB_STORE_NAME)\n                }\n                ;\n                openRequest.onsuccess = function openRequest_onsuccess() {\n                  var db = openRequest.result;\n                  var transaction = db.transaction([FS.DB_STORE_NAME], \"readwrite\");\n                  var files = transaction.objectStore(FS.DB_STORE_NAME);\n                  var ok = 0\n                      , fail = 0\n                      , total = paths.length;\n                  function finish() {\n                    if (fail == 0)\n                      onload();\n                    else\n                      onerror()\n                  }\n                  paths.forEach(function(path) {\n                    var putRequest = files.put(FS.analyzePath(path).object.contents, path);\n                    putRequest.onsuccess = function putRequest_onsuccess() {\n                      ok++;\n                      if (ok + fail == total)\n                        finish()\n                    }\n                    ;\n                    putRequest.onerror = function putRequest_onerror() {\n                      fail++;\n                      if (ok + fail == total)\n                        finish()\n                    }\n                  });\n                  transaction.onerror = onerror\n                }\n                ;\n                openRequest.onerror = onerror\n              },\n              loadFilesFromDB: function(paths, onload, onerror) {\n                onload = onload || function() {}\n                ;\n                onerror = onerror || function() {}\n                ;\n                var indexedDB = FS.indexedDB();\n                try {\n                  var openRequest = indexedDB.open(FS.DB_NAME(), FS.DB_VERSION)\n                } catch (e) {\n                  return onerror(e)\n                }\n                openRequest.onupgradeneeded = onerror;\n                openRequest.onsuccess = function openRequest_onsuccess() {\n                  var db = openRequest.result;\n                  try {\n                    var transaction = db.transaction([FS.DB_STORE_NAME], \"readonly\")\n                  } catch (e) {\n                    onerror(e);\n                    return\n                  }\n                  var files = transaction.objectStore(FS.DB_STORE_NAME);\n                  var ok = 0\n                      , fail = 0\n                      , total = paths.length;\n                  function finish() {\n                    if (fail == 0)\n                      onload();\n                    else\n                      onerror()\n                  }\n                  paths.forEach(function(path) {\n                    var getRequest = files.get(path);\n                    getRequest.onsuccess = function getRequest_onsuccess() {\n                      if (FS.analyzePath(path).exists) {\n                        FS.unlink(path)\n                      }\n                      FS.createDataFile(PATH.dirname(path), PATH.basename(path), getRequest.result, true, true, true);\n                      ok++;\n                      if (ok + fail == total)\n                        finish()\n                    }\n                    ;\n                    getRequest.onerror = function getRequest_onerror() {\n                      fail++;\n                      if (ok + fail == total)\n                        finish()\n                    }\n                  });\n                  transaction.onerror = onerror\n                }\n                ;\n                openRequest.onerror = onerror\n              }\n            };\n            var SYSCALLS = {\n              mappings: {},\n              DEFAULT_POLLMASK: 5,\n              umask: 511,\n              calculateAt: function(dirfd, path) {\n                if (path[0] !== \"/\") {\n                  var dir;\n                  if (dirfd === -100) {\n                    dir = FS.cwd()\n                  } else {\n                    var dirstream = FS.getStream(dirfd);\n                    if (!dirstream)\n                      throw new FS.ErrnoError(8);\n                    dir = dirstream.path\n                  }\n                  path = PATH.join2(dir, path)\n                }\n                return path\n              },\n              doStat: function(func, path, buf) {\n                try {\n                  var stat = func(path)\n                } catch (e) {\n                  if (e && e.node && PATH.normalize(path) !== PATH.normalize(FS.getPath(e.node))) {\n                    return -54\n                  }\n                  throw e\n                }\n                HEAP32[buf >> 2] = stat.dev;\n                HEAP32[buf + 4 >> 2] = 0;\n                HEAP32[buf + 8 >> 2] = stat.ino;\n                HEAP32[buf + 12 >> 2] = stat.mode;\n                HEAP32[buf + 16 >> 2] = stat.nlink;\n                HEAP32[buf + 20 >> 2] = stat.uid;\n                HEAP32[buf + 24 >> 2] = stat.gid;\n                HEAP32[buf + 28 >> 2] = stat.rdev;\n                HEAP32[buf + 32 >> 2] = 0;\n                tempI64 = [stat.size >>> 0, (tempDouble = stat.size,\n                    +Math_abs(tempDouble) >= 1 ? tempDouble > 0 ? (Math_min(+Math_floor(tempDouble / 4294967296), 4294967295) | 0) >>> 0 : ~~+Math_ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)],\n                    HEAP32[buf + 40 >> 2] = tempI64[0],\n                    HEAP32[buf + 44 >> 2] = tempI64[1];\n                HEAP32[buf + 48 >> 2] = 4096;\n                HEAP32[buf + 52 >> 2] = stat.blocks;\n                HEAP32[buf + 56 >> 2] = stat.atime.getTime() / 1e3 | 0;\n                HEAP32[buf + 60 >> 2] = 0;\n                HEAP32[buf + 64 >> 2] = stat.mtime.getTime() / 1e3 | 0;\n                HEAP32[buf + 68 >> 2] = 0;\n                HEAP32[buf + 72 >> 2] = stat.ctime.getTime() / 1e3 | 0;\n                HEAP32[buf + 76 >> 2] = 0;\n                tempI64 = [stat.ino >>> 0, (tempDouble = stat.ino,\n                    +Math_abs(tempDouble) >= 1 ? tempDouble > 0 ? (Math_min(+Math_floor(tempDouble / 4294967296), 4294967295) | 0) >>> 0 : ~~+Math_ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)],\n                    HEAP32[buf + 80 >> 2] = tempI64[0],\n                    HEAP32[buf + 84 >> 2] = tempI64[1];\n                return 0\n              },\n              doMsync: function(addr, stream, len, flags, offset) {\n                var buffer = HEAPU8.slice(addr, addr + len);\n                FS.msync(stream, buffer, offset, len, flags)\n              },\n              doMkdir: function(path, mode) {\n                path = PATH.normalize(path);\n                if (path[path.length - 1] === \"/\")\n                  path = path.substr(0, path.length - 1);\n                FS.mkdir(path, mode, 0);\n                return 0\n              },\n              doMknod: function(path, mode, dev) {\n                switch (mode & 61440) {\n                  case 32768:\n                  case 8192:\n                  case 24576:\n                  case 4096:\n                  case 49152:\n                    break;\n                  default:\n                    return -28\n                }\n                FS.mknod(path, mode, dev);\n                return 0\n              },\n              doReadlink: function(path, buf, bufsize) {\n                if (bufsize <= 0)\n                  return -28;\n                var ret = FS.readlink(path);\n                var len = Math.min(bufsize, lengthBytesUTF8(ret));\n                var endChar = HEAP8[buf + len];\n                stringToUTF8(ret, buf, bufsize + 1);\n                HEAP8[buf + len] = endChar;\n                return len\n              },\n              doAccess: function(path, amode) {\n                if (amode & ~7) {\n                  return -28\n                }\n                var node;\n                var lookup = FS.lookupPath(path, {\n                  follow: true\n                });\n                node = lookup.node;\n                if (!node) {\n                  return -44\n                }\n                var perms = \"\";\n                if (amode & 4)\n                  perms += \"r\";\n                if (amode & 2)\n                  perms += \"w\";\n                if (amode & 1)\n                  perms += \"x\";\n                if (perms && FS.nodePermissions(node, perms)) {\n                  return -2\n                }\n                return 0\n              },\n              doDup: function(path, flags, suggestFD) {\n                var suggest = FS.getStream(suggestFD);\n                if (suggest)\n                  FS.close(suggest);\n                return FS.open(path, flags, 0, suggestFD, suggestFD).fd\n              },\n              doReadv: function(stream, iov, iovcnt, offset) {\n                var ret = 0;\n                for (var i = 0; i < iovcnt; i++) {\n                  var ptr = HEAP32[iov + i * 8 >> 2];\n                  var len = HEAP32[iov + (i * 8 + 4) >> 2];\n                  var curr = FS.read(stream, HEAP8, ptr, len, offset);\n                  if (curr < 0)\n                    return -1;\n                  ret += curr;\n                  if (curr < len)\n                    break\n                }\n                return ret\n              },\n              doWritev: function(stream, iov, iovcnt, offset) {\n                var ret = 0;\n                for (var i = 0; i < iovcnt; i++) {\n                  var ptr = HEAP32[iov + i * 8 >> 2];\n                  var len = HEAP32[iov + (i * 8 + 4) >> 2];\n                  var curr = FS.write(stream, HEAP8, ptr, len, offset);\n                  if (curr < 0)\n                    return -1;\n                  ret += curr\n                }\n                return ret\n              },\n              varargs: undefined,\n              get: function() {\n                SYSCALLS.varargs += 4;\n                var ret = HEAP32[SYSCALLS.varargs - 4 >> 2];\n                return ret\n              },\n              getStr: function(ptr) {\n                var ret = UTF8ToString(ptr);\n                return ret\n              },\n              getStreamFromFD: function(fd) {\n                var stream = FS.getStream(fd);\n                if (!stream)\n                  throw new FS.ErrnoError(8);\n                return stream\n              },\n              get64: function(low, high) {\n                return low\n              }\n            };\n            function ___syscall221(fd, cmd, varargs) {\n              SYSCALLS.varargs = varargs;\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                switch (cmd) {\n                  case 0:\n                  {\n                    var arg = SYSCALLS.get();\n                    if (arg < 0) {\n                      return -28\n                    }\n                    var newStream;\n                    newStream = FS.open(stream.path, stream.flags, 0, arg);\n                    return newStream.fd\n                  }\n                  case 1:\n                  case 2:\n                    return 0;\n                  case 3:\n                    return stream.flags;\n                  case 4:\n                  {\n                    var arg = SYSCALLS.get();\n                    stream.flags |= arg;\n                    return 0\n                  }\n                  case 12:\n                  {\n                    var arg = SYSCALLS.get();\n                    var offset = 0;\n                    HEAP16[arg + offset >> 1] = 2;\n                    return 0\n                  }\n                  case 13:\n                  case 14:\n                    return 0;\n                  case 16:\n                  case 8:\n                    return -28;\n                  case 9:\n                    ___setErrNo(28);\n                    return -1;\n                  default:\n                  {\n                    return -28\n                  }\n                }\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return -e.errno\n              }\n            }\n            function ___syscall5(path, flags, varargs) {\n              SYSCALLS.varargs = varargs;\n              try {\n                var pathname = SYSCALLS.getStr(path);\n                var mode = SYSCALLS.get();\n                var stream = FS.open(pathname, flags, mode);\n                return stream.fd\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return -e.errno\n              }\n            }\n            function ___syscall54(fd, op, varargs) {\n              SYSCALLS.varargs = varargs;\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                switch (op) {\n                  case 21509:\n                  case 21505:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    return 0\n                  }\n                  case 21510:\n                  case 21511:\n                  case 21512:\n                  case 21506:\n                  case 21507:\n                  case 21508:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    return 0\n                  }\n                  case 21519:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    var argp = SYSCALLS.get();\n                    HEAP32[argp >> 2] = 0;\n                    return 0\n                  }\n                  case 21520:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    return -28\n                  }\n                  case 21531:\n                  {\n                    var argp = SYSCALLS.get();\n                    return FS.ioctl(stream, op, argp)\n                  }\n                  case 21523:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    return 0\n                  }\n                  case 21524:\n                  {\n                    if (!stream.tty)\n                      return -59;\n                    return 0\n                  }\n                  default:\n                    abort(\"bad ioctl syscall \" + op)\n                }\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return -e.errno\n              }\n            }\n            function syscallMunmap(addr, len) {\n              if (addr === -1 || len === 0) {\n                return -28\n              }\n              var info = SYSCALLS.mappings[addr];\n              if (!info)\n                return 0;\n              if (len === info.len) {\n                var stream = FS.getStream(info.fd);\n                SYSCALLS.doMsync(addr, stream, len, info.flags, info.offset);\n                FS.munmap(stream);\n                SYSCALLS.mappings[addr] = null;\n                if (info.allocated) {\n                  _free(info.malloc)\n                }\n              }\n              return 0\n            }\n            function ___syscall91(addr, len) {\n              try {\n                return syscallMunmap(addr, len)\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return -e.errno\n              }\n            }\n            function _abort() {\n              abort()\n            }\n            var _abs = Math_abs;\n            function _emscripten_get_heap_size() {\n              return HEAPU8.length\n            }\n            function _emscripten_memcpy_big(dest, src, num) {\n              HEAPU8.copyWithin(dest, src, src + num)\n            }\n            function emscripten_realloc_buffer(size) {\n              try {\n                wasmMemory.grow(size - buffer.byteLength + 65535 >> 16);\n                updateGlobalBufferAndViews(wasmMemory.buffer);\n                return 1\n              } catch (e) {}\n            }\n            function _emscripten_resize_heap(requestedSize) {\n              var oldSize = _emscripten_get_heap_size();\n              var PAGE_MULTIPLE = 65536;\n              var maxHeapSize = 2147483648 - PAGE_MULTIPLE;\n              if (requestedSize > maxHeapSize) {\n                return false\n              }\n              var minHeapSize = 16777216;\n              for (var cutDown = 1; cutDown <= 4; cutDown *= 2) {\n                var overGrownHeapSize = oldSize * (1 + .2 / cutDown);\n                overGrownHeapSize = Math.min(overGrownHeapSize, requestedSize + 100663296);\n                var newSize = Math.min(maxHeapSize, alignUp(Math.max(minHeapSize, requestedSize, overGrownHeapSize), PAGE_MULTIPLE));\n                var replacement = emscripten_realloc_buffer(newSize);\n                if (replacement) {\n                  return true\n                }\n              }\n              return false\n            }\n            var ENV = {};\n            function __getExecutableName() {\n              return thisProgram || \"./this.program\"\n            }\n            function _emscripten_get_environ() {\n              if (!_emscripten_get_environ.strings) {\n                var env = {\n                  \"USER\": \"web_user\",\n                  \"LOGNAME\": \"web_user\",\n                  \"PATH\": \"/\",\n                  \"PWD\": \"/\",\n                  \"HOME\": \"/home/web_user\",\n                  \"LANG\": (typeof navigator === \"object\" && navigator.languages && navigator.languages[0] || \"C\").replace(\"-\", \"_\") + \".UTF-8\",\n                  \"_\": __getExecutableName()\n                };\n                for (var x in ENV) {\n                  env[x] = ENV[x]\n                }\n                var strings = [];\n                for (var x in env) {\n                  strings.push(x + \"=\" + env[x])\n                }\n                _emscripten_get_environ.strings = strings\n              }\n              return _emscripten_get_environ.strings\n            }\n            function _environ_get(__environ, environ_buf) {\n              var strings = _emscripten_get_environ();\n              var bufSize = 0;\n              strings.forEach(function(string, i) {\n                var ptr = environ_buf + bufSize;\n                HEAP32[__environ + i * 4 >> 2] = ptr;\n                writeAsciiToMemory(string, ptr);\n                bufSize += string.length + 1\n              });\n              return 0\n            }\n            function _environ_sizes_get(penviron_count, penviron_buf_size) {\n              var strings = _emscripten_get_environ();\n              HEAP32[penviron_count >> 2] = strings.length;\n              var bufSize = 0;\n              strings.forEach(function(string) {\n                bufSize += string.length + 1\n              });\n              HEAP32[penviron_buf_size >> 2] = bufSize;\n              return 0\n            }\n            function _fd_close(fd) {\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                FS.close(stream);\n                return 0\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return e.errno\n              }\n            }\n            function _fd_read(fd, iov, iovcnt, pnum) {\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                var num = SYSCALLS.doReadv(stream, iov, iovcnt);\n                HEAP32[pnum >> 2] = num;\n                return 0\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return e.errno\n              }\n            }\n            function _fd_seek(fd, offset_low, offset_high, whence, newOffset) {\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                var HIGH_OFFSET = 4294967296;\n                var offset = offset_high * HIGH_OFFSET + (offset_low >>> 0);\n                var DOUBLE_LIMIT = 9007199254740992;\n                if (offset <= -DOUBLE_LIMIT || offset >= DOUBLE_LIMIT) {\n                  return -61\n                }\n                FS.llseek(stream, offset, whence);\n                tempI64 = [stream.position >>> 0, (tempDouble = stream.position,\n                    +Math_abs(tempDouble) >= 1 ? tempDouble > 0 ? (Math_min(+Math_floor(tempDouble / 4294967296), 4294967295) | 0) >>> 0 : ~~+Math_ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)],\n                    HEAP32[newOffset >> 2] = tempI64[0],\n                    HEAP32[newOffset + 4 >> 2] = tempI64[1];\n                if (stream.getdents && offset === 0 && whence === 0)\n                  stream.getdents = null;\n                return 0\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return e.errno\n              }\n            }\n            function _fd_write(fd, iov, iovcnt, pnum) {\n              try {\n                var stream = SYSCALLS.getStreamFromFD(fd);\n                var num = SYSCALLS.doWritev(stream, iov, iovcnt);\n                HEAP32[pnum >> 2] = num;\n                return 0\n              } catch (e) {\n                if (typeof FS === \"undefined\" || !(e instanceof FS.ErrnoError))\n                  abort(e);\n                return e.errno\n              }\n            }\n            function _round(d) {\n              d = +d;\n              return d >= +0 ? +Math_floor(d + +.5) : +Math_ceil(d - +.5)\n            }\n            function _roundf(d) {\n              d = +d;\n              return d >= +0 ? +Math_floor(d + +.5) : +Math_ceil(d - +.5)\n            }\n            function __isLeapYear(year) {\n              return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\n            }\n            function __arraySum(array, index) {\n              var sum = 0;\n              for (var i = 0; i <= index; sum += array[i++]) {}\n              return sum\n            }\n            var __MONTH_DAYS_LEAP = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n            var __MONTH_DAYS_REGULAR = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n            function __addDays(date, days) {\n              var newDate = new Date(date.getTime());\n              while (days > 0) {\n                var leap = __isLeapYear(newDate.getFullYear());\n                var currentMonth = newDate.getMonth();\n                var daysInCurrentMonth = (leap ? __MONTH_DAYS_LEAP : __MONTH_DAYS_REGULAR)[currentMonth];\n                if (days > daysInCurrentMonth - newDate.getDate()) {\n                  days -= daysInCurrentMonth - newDate.getDate() + 1;\n                  newDate.setDate(1);\n                  if (currentMonth < 11) {\n                    newDate.setMonth(currentMonth + 1)\n                  } else {\n                    newDate.setMonth(0);\n                    newDate.setFullYear(newDate.getFullYear() + 1)\n                  }\n                } else {\n                  newDate.setDate(newDate.getDate() + days);\n                  return newDate\n                }\n              }\n              return newDate\n            }\n            function _strftime(s, maxsize, format, tm) {\n              var tm_zone = HEAP32[tm + 40 >> 2];\n              var date = {\n                tm_sec: HEAP32[tm >> 2],\n                tm_min: HEAP32[tm + 4 >> 2],\n                tm_hour: HEAP32[tm + 8 >> 2],\n                tm_mday: HEAP32[tm + 12 >> 2],\n                tm_mon: HEAP32[tm + 16 >> 2],\n                tm_year: HEAP32[tm + 20 >> 2],\n                tm_wday: HEAP32[tm + 24 >> 2],\n                tm_yday: HEAP32[tm + 28 >> 2],\n                tm_isdst: HEAP32[tm + 32 >> 2],\n                tm_gmtoff: HEAP32[tm + 36 >> 2],\n                tm_zone: tm_zone ? UTF8ToString(tm_zone) : \"\"\n              };\n              var pattern = UTF8ToString(format);\n              var EXPANSION_RULES_1 = {\n                \"%c\": \"%a %b %d %H:%M:%S %Y\",\n                \"%D\": \"%m/%d/%y\",\n                \"%F\": \"%Y-%m-%d\",\n                \"%h\": \"%b\",\n                \"%r\": \"%I:%M:%S %p\",\n                \"%R\": \"%H:%M\",\n                \"%T\": \"%H:%M:%S\",\n                \"%x\": \"%m/%d/%y\",\n                \"%X\": \"%H:%M:%S\",\n                \"%Ec\": \"%c\",\n                \"%EC\": \"%C\",\n                \"%Ex\": \"%m/%d/%y\",\n                \"%EX\": \"%H:%M:%S\",\n                \"%Ey\": \"%y\",\n                \"%EY\": \"%Y\",\n                \"%Od\": \"%d\",\n                \"%Oe\": \"%e\",\n                \"%OH\": \"%H\",\n                \"%OI\": \"%I\",\n                \"%Om\": \"%m\",\n                \"%OM\": \"%M\",\n                \"%OS\": \"%S\",\n                \"%Ou\": \"%u\",\n                \"%OU\": \"%U\",\n                \"%OV\": \"%V\",\n                \"%Ow\": \"%w\",\n                \"%OW\": \"%W\",\n                \"%Oy\": \"%y\"\n              };\n              for (var rule in EXPANSION_RULES_1) {\n                pattern = pattern.replace(new RegExp(rule,\"g\"), EXPANSION_RULES_1[rule])\n              }\n              var WEEKDAYS = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n              var MONTHS = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n              function leadingSomething(value, digits, character) {\n                var str = typeof value === \"number\" ? value.toString() : value || \"\";\n                while (str.length < digits) {\n                  str = character[0] + str\n                }\n                return str\n              }\n              function leadingNulls(value, digits) {\n                return leadingSomething(value, digits, \"0\")\n              }\n              function compareByDay(date1, date2) {\n                function sgn(value) {\n                  return value < 0 ? -1 : value > 0 ? 1 : 0\n                }\n                var compare;\n                if ((compare = sgn(date1.getFullYear() - date2.getFullYear())) === 0) {\n                  if ((compare = sgn(date1.getMonth() - date2.getMonth())) === 0) {\n                    compare = sgn(date1.getDate() - date2.getDate())\n                  }\n                }\n                return compare\n              }\n              function getFirstWeekStartDate(janFourth) {\n                switch (janFourth.getDay()) {\n                  case 0:\n                    return new Date(janFourth.getFullYear() - 1,11,29);\n                  case 1:\n                    return janFourth;\n                  case 2:\n                    return new Date(janFourth.getFullYear(),0,3);\n                  case 3:\n                    return new Date(janFourth.getFullYear(),0,2);\n                  case 4:\n                    return new Date(janFourth.getFullYear(),0,1);\n                  case 5:\n                    return new Date(janFourth.getFullYear() - 1,11,31);\n                  case 6:\n                    return new Date(janFourth.getFullYear() - 1,11,30)\n                }\n              }\n              function getWeekBasedYear(date) {\n                var thisDate = __addDays(new Date(date.tm_year + 1900,0,1), date.tm_yday);\n                var janFourthThisYear = new Date(thisDate.getFullYear(),0,4);\n                var janFourthNextYear = new Date(thisDate.getFullYear() + 1,0,4);\n                var firstWeekStartThisYear = getFirstWeekStartDate(janFourthThisYear);\n                var firstWeekStartNextYear = getFirstWeekStartDate(janFourthNextYear);\n                if (compareByDay(firstWeekStartThisYear, thisDate) <= 0) {\n                  if (compareByDay(firstWeekStartNextYear, thisDate) <= 0) {\n                    return thisDate.getFullYear() + 1\n                  } else {\n                    return thisDate.getFullYear()\n                  }\n                } else {\n                  return thisDate.getFullYear() - 1\n                }\n              }\n              var EXPANSION_RULES_2 = {\n                \"%a\": function(date) {\n                  return WEEKDAYS[date.tm_wday].substring(0, 3)\n                },\n                \"%A\": function(date) {\n                  return WEEKDAYS[date.tm_wday]\n                },\n                \"%b\": function(date) {\n                  return MONTHS[date.tm_mon].substring(0, 3)\n                },\n                \"%B\": function(date) {\n                  return MONTHS[date.tm_mon]\n                },\n                \"%C\": function(date) {\n                  var year = date.tm_year + 1900;\n                  return leadingNulls(year / 100 | 0, 2)\n                },\n                \"%d\": function(date) {\n                  return leadingNulls(date.tm_mday, 2)\n                },\n                \"%e\": function(date) {\n                  return leadingSomething(date.tm_mday, 2, \" \")\n                },\n                \"%g\": function(date) {\n                  return getWeekBasedYear(date).toString().substring(2)\n                },\n                \"%G\": function(date) {\n                  return getWeekBasedYear(date)\n                },\n                \"%H\": function(date) {\n                  return leadingNulls(date.tm_hour, 2)\n                },\n                \"%I\": function(date) {\n                  var twelveHour = date.tm_hour;\n                  if (twelveHour == 0)\n                    twelveHour = 12;\n                  else if (twelveHour > 12)\n                    twelveHour -= 12;\n                  return leadingNulls(twelveHour, 2)\n                },\n                \"%j\": function(date) {\n                  return leadingNulls(date.tm_mday + __arraySum(__isLeapYear(date.tm_year + 1900) ? __MONTH_DAYS_LEAP : __MONTH_DAYS_REGULAR, date.tm_mon - 1), 3)\n                },\n                \"%m\": function(date) {\n                  return leadingNulls(date.tm_mon + 1, 2)\n                },\n                \"%M\": function(date) {\n                  return leadingNulls(date.tm_min, 2)\n                },\n                \"%n\": function() {\n                  return \"\\n\"\n                },\n                \"%p\": function(date) {\n                  if (date.tm_hour >= 0 && date.tm_hour < 12) {\n                    return \"AM\"\n                  } else {\n                    return \"PM\"\n                  }\n                },\n                \"%S\": function(date) {\n                  return leadingNulls(date.tm_sec, 2)\n                },\n                \"%t\": function() {\n                  return \"\\t\"\n                },\n                \"%u\": function(date) {\n                  return date.tm_wday || 7\n                },\n                \"%U\": function(date) {\n                  var janFirst = new Date(date.tm_year + 1900,0,1);\n                  var firstSunday = janFirst.getDay() === 0 ? janFirst : __addDays(janFirst, 7 - janFirst.getDay());\n                  var endDate = new Date(date.tm_year + 1900,date.tm_mon,date.tm_mday);\n                  if (compareByDay(firstSunday, endDate) < 0) {\n                    var februaryFirstUntilEndMonth = __arraySum(__isLeapYear(endDate.getFullYear()) ? __MONTH_DAYS_LEAP : __MONTH_DAYS_REGULAR, endDate.getMonth() - 1) - 31;\n                    var firstSundayUntilEndJanuary = 31 - firstSunday.getDate();\n                    var days = firstSundayUntilEndJanuary + februaryFirstUntilEndMonth + endDate.getDate();\n                    return leadingNulls(Math.ceil(days / 7), 2)\n                  }\n                  return compareByDay(firstSunday, janFirst) === 0 ? \"01\" : \"00\"\n                },\n                \"%V\": function(date) {\n                  var janFourthThisYear = new Date(date.tm_year + 1900,0,4);\n                  var janFourthNextYear = new Date(date.tm_year + 1901,0,4);\n                  var firstWeekStartThisYear = getFirstWeekStartDate(janFourthThisYear);\n                  var firstWeekStartNextYear = getFirstWeekStartDate(janFourthNextYear);\n                  var endDate = __addDays(new Date(date.tm_year + 1900,0,1), date.tm_yday);\n                  if (compareByDay(endDate, firstWeekStartThisYear) < 0) {\n                    return \"53\"\n                  }\n                  if (compareByDay(firstWeekStartNextYear, endDate) <= 0) {\n                    return \"01\"\n                  }\n                  var daysDifference;\n                  if (firstWeekStartThisYear.getFullYear() < date.tm_year + 1900) {\n                    daysDifference = date.tm_yday + 32 - firstWeekStartThisYear.getDate()\n                  } else {\n                    daysDifference = date.tm_yday + 1 - firstWeekStartThisYear.getDate()\n                  }\n                  return leadingNulls(Math.ceil(daysDifference / 7), 2)\n                },\n                \"%w\": function(date) {\n                  return date.tm_wday\n                },\n                \"%W\": function(date) {\n                  var janFirst = new Date(date.tm_year,0,1);\n                  var firstMonday = janFirst.getDay() === 1 ? janFirst : __addDays(janFirst, janFirst.getDay() === 0 ? 1 : 7 - janFirst.getDay() + 1);\n                  var endDate = new Date(date.tm_year + 1900,date.tm_mon,date.tm_mday);\n                  if (compareByDay(firstMonday, endDate) < 0) {\n                    var februaryFirstUntilEndMonth = __arraySum(__isLeapYear(endDate.getFullYear()) ? __MONTH_DAYS_LEAP : __MONTH_DAYS_REGULAR, endDate.getMonth() - 1) - 31;\n                    var firstMondayUntilEndJanuary = 31 - firstMonday.getDate();\n                    var days = firstMondayUntilEndJanuary + februaryFirstUntilEndMonth + endDate.getDate();\n                    return leadingNulls(Math.ceil(days / 7), 2)\n                  }\n                  return compareByDay(firstMonday, janFirst) === 0 ? \"01\" : \"00\"\n                },\n                \"%y\": function(date) {\n                  return (date.tm_year + 1900).toString().substring(2)\n                },\n                \"%Y\": function(date) {\n                  return date.tm_year + 1900\n                },\n                \"%z\": function(date) {\n                  var off = date.tm_gmtoff;\n                  var ahead = off >= 0;\n                  off = Math.abs(off) / 60;\n                  off = off / 60 * 100 + off % 60;\n                  return (ahead ? \"+\" : \"-\") + String(\"0000\" + off).slice(-4)\n                },\n                \"%Z\": function(date) {\n                  return date.tm_zone\n                },\n                \"%%\": function() {\n                  return \"%\"\n                }\n              };\n              for (var rule in EXPANSION_RULES_2) {\n                if (pattern.indexOf(rule) >= 0) {\n                  pattern = pattern.replace(new RegExp(rule,\"g\"), EXPANSION_RULES_2[rule](date))\n                }\n              }\n              var bytes = intArrayFromString(pattern, false);\n              if (bytes.length > maxsize) {\n                return 0\n              }\n              writeArrayToMemory(bytes, s);\n              return bytes.length - 1\n            }\n            function _strftime_l(s, maxsize, format, tm) {\n              return _strftime(s, maxsize, format, tm)\n            }\n            function readAsmConstArgs(sigPtr, buf) {\n              if (!readAsmConstArgs.array) {\n                readAsmConstArgs.array = []\n              }\n              var args = readAsmConstArgs.array;\n              args.length = 0;\n              var ch;\n              while (ch = HEAPU8[sigPtr++]) {\n                if (ch === 100 || ch === 102) {\n                  buf = buf + 7 & ~7;\n                  args.push(HEAPF64[buf >> 3]);\n                  buf += 8\n                } else {\n                  buf = buf + 3 & ~3;\n                  args.push(HEAP32[buf >> 2]);\n                  buf += 4\n                }\n              }\n              return args\n            }\n            var FSNode = function(parent, name, mode, rdev) {\n              if (!parent) {\n                parent = this\n              }\n              this.parent = parent;\n              this.mount = parent.mount;\n              this.mounted = null;\n              this.id = FS.nextInode++;\n              this.name = name;\n              this.mode = mode;\n              this.node_ops = {};\n              this.stream_ops = {};\n              this.rdev = rdev\n            };\n            var readMode = 292 | 73;\n            var writeMode = 146;\n            Object.defineProperties(FSNode.prototype, {\n              read: {\n                get: function() {\n                  return (this.mode & readMode) === readMode\n                },\n                set: function(val) {\n                  val ? this.mode |= readMode : this.mode &= ~readMode\n                }\n              },\n              write: {\n                get: function() {\n                  return (this.mode & writeMode) === writeMode\n                },\n                set: function(val) {\n                  val ? this.mode |= writeMode : this.mode &= ~writeMode\n                }\n              },\n              isFolder: {\n                get: function() {\n                  return FS.isDir(this.mode)\n                }\n              },\n              isDevice: {\n                get: function() {\n                  return FS.isChrdev(this.mode)\n                }\n              }\n            });\n            FS.FSNode = FSNode;\n            FS.staticInit();\n            function intArrayFromString(stringy, dontAddNull, length) {\n              var len = length > 0 ? length : lengthBytesUTF8(stringy) + 1;\n              var u8array = new Array(len);\n              var numBytesWritten = stringToUTF8Array(stringy, u8array, 0, u8array.length);\n              if (dontAddNull)\n                u8array.length = numBytesWritten;\n              return u8array\n            }\n            var asmLibraryArg = {\n              \"a\": ___assert_fail,\n              \"e\": ___cxa_allocate_exception,\n              \"d\": ___cxa_throw,\n              \"t\": ___map_file,\n              \"f\": ___syscall221,\n              \"l\": ___syscall5,\n              \"k\": ___syscall54,\n              \"s\": ___syscall91,\n              \"i\": _abort,\n              \"m\": _abs,\n              \"c\": _emscripten_asm_const_iii,\n              \"p\": _emscripten_memcpy_big,\n              \"q\": _emscripten_resize_heap,\n              \"u\": _environ_get,\n              \"v\": _environ_sizes_get,\n              \"h\": _fd_close,\n              \"j\": _fd_read,\n              \"n\": _fd_seek,\n              \"g\": _fd_write,\n              \"memory\": wasmMemory,\n              \"b\": _round,\n              \"o\": _roundf,\n              \"r\": _strftime_l,\n              \"table\": wasmTable\n            };\n            var asm = createWasm();\n            Module[\"asm\"] = asm;\n            var ___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = function() {\n                  return (___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = Module[\"asm\"][\"w\"]).apply(null, arguments)\n                }\n            ;\n            var _free = Module[\"_free\"] = function() {\n                  return (_free = Module[\"_free\"] = Module[\"asm\"][\"x\"]).apply(null, arguments)\n                }\n            ;\n            var _malloc = Module[\"_malloc\"] = function() {\n                  return (_malloc = Module[\"_malloc\"] = Module[\"asm\"][\"y\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_open_data = Module[\"_gme_open_data\"] = function() {\n                  return (_gme_open_data = Module[\"_gme_open_data\"] = Module[\"asm\"][\"z\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_delete = Module[\"_gme_delete\"] = function() {\n                  return (_gme_delete = Module[\"_gme_delete\"] = Module[\"asm\"][\"A\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_track_count = Module[\"_gme_track_count\"] = function() {\n                  return (_gme_track_count = Module[\"_gme_track_count\"] = Module[\"asm\"][\"B\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_track_info = Module[\"_gme_track_info\"] = function() {\n                  return (_gme_track_info = Module[\"_gme_track_info\"] = Module[\"asm\"][\"C\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_start_track = Module[\"_gme_start_track\"] = function() {\n                  return (_gme_start_track = Module[\"_gme_start_track\"] = Module[\"asm\"][\"D\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_play = Module[\"_gme_play\"] = function() {\n                  return (_gme_play = Module[\"_gme_play\"] = Module[\"asm\"][\"E\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_set_fade = Module[\"_gme_set_fade\"] = function() {\n                  return (_gme_set_fade = Module[\"_gme_set_fade\"] = Module[\"asm\"][\"F\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_track_ended = Module[\"_gme_track_ended\"] = function() {\n                  return (_gme_track_ended = Module[\"_gme_track_ended\"] = Module[\"asm\"][\"G\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_tell_scaled = Module[\"_gme_tell_scaled\"] = function() {\n                  return (_gme_tell_scaled = Module[\"_gme_tell_scaled\"] = Module[\"asm\"][\"H\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_seek_scaled = Module[\"_gme_seek_scaled\"] = function() {\n                  return (_gme_seek_scaled = Module[\"_gme_seek_scaled\"] = Module[\"asm\"][\"I\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_voice_count = Module[\"_gme_voice_count\"] = function() {\n                  return (_gme_voice_count = Module[\"_gme_voice_count\"] = Module[\"asm\"][\"J\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_ignore_silence = Module[\"_gme_ignore_silence\"] = function() {\n                  return (_gme_ignore_silence = Module[\"_gme_ignore_silence\"] = Module[\"asm\"][\"K\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_set_tempo = Module[\"_gme_set_tempo\"] = function() {\n                  return (_gme_set_tempo = Module[\"_gme_set_tempo\"] = Module[\"asm\"][\"L\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_mute_voices = Module[\"_gme_mute_voices\"] = function() {\n                  return (_gme_mute_voices = Module[\"_gme_mute_voices\"] = Module[\"asm\"][\"M\"]).apply(null, arguments)\n                }\n            ;\n            var _gme_voice_name = Module[\"_gme_voice_name\"] = function() {\n                  return (_gme_voice_name = Module[\"_gme_voice_name\"] = Module[\"asm\"][\"N\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_init = Module[\"_adl_init\"] = function() {\n                  return (_adl_init = Module[\"_adl_init\"] = Module[\"asm\"][\"O\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_setNumChips = Module[\"_adl_setNumChips\"] = function() {\n                  return (_adl_setNumChips = Module[\"_adl_setNumChips\"] = Module[\"asm\"][\"P\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_getNumChips = Module[\"_adl_getNumChips\"] = function() {\n                  return (_adl_getNumChips = Module[\"_adl_getNumChips\"] = Module[\"asm\"][\"Q\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_setBank = Module[\"_adl_setBank\"] = function() {\n                  return (_adl_setBank = Module[\"_adl_setBank\"] = Module[\"asm\"][\"R\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_getBanksCount = Module[\"_adl_getBanksCount\"] = function() {\n                  return (_adl_getBanksCount = Module[\"_adl_getBanksCount\"] = Module[\"asm\"][\"S\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_getBankNames = Module[\"_adl_getBankNames\"] = function() {\n                  return (_adl_getBankNames = Module[\"_adl_getBankNames\"] = Module[\"asm\"][\"T\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_setSoftPanEnabled = Module[\"_adl_setSoftPanEnabled\"] = function() {\n                  return (_adl_setSoftPanEnabled = Module[\"_adl_setSoftPanEnabled\"] = Module[\"asm\"][\"U\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_generate = Module[\"_adl_generate\"] = function() {\n                  return (_adl_generate = Module[\"_adl_generate\"] = Module[\"asm\"][\"V\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_panic = Module[\"_adl_panic\"] = function() {\n                  return (_adl_panic = Module[\"_adl_panic\"] = Module[\"asm\"][\"W\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_resetState = Module[\"_adl_rt_resetState\"] = function() {\n                  return (_adl_rt_resetState = Module[\"_adl_rt_resetState\"] = Module[\"asm\"][\"X\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_noteOn = Module[\"_adl_rt_noteOn\"] = function() {\n                  return (_adl_rt_noteOn = Module[\"_adl_rt_noteOn\"] = Module[\"asm\"][\"Y\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_noteOff = Module[\"_adl_rt_noteOff\"] = function() {\n                  return (_adl_rt_noteOff = Module[\"_adl_rt_noteOff\"] = Module[\"asm\"][\"Z\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_channelAfterTouch = Module[\"_adl_rt_channelAfterTouch\"] = function() {\n                  return (_adl_rt_channelAfterTouch = Module[\"_adl_rt_channelAfterTouch\"] = Module[\"asm\"][\"_\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_controllerChange = Module[\"_adl_rt_controllerChange\"] = function() {\n                  return (_adl_rt_controllerChange = Module[\"_adl_rt_controllerChange\"] = Module[\"asm\"][\"$\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_patchChange = Module[\"_adl_rt_patchChange\"] = function() {\n                  return (_adl_rt_patchChange = Module[\"_adl_rt_patchChange\"] = Module[\"asm\"][\"aa\"]).apply(null, arguments)\n                }\n            ;\n            var _adl_rt_pitchBend = Module[\"_adl_rt_pitchBend\"] = function() {\n                  return (_adl_rt_pitchBend = Module[\"_adl_rt_pitchBend\"] = Module[\"asm\"][\"ba\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_open = Module[\"_v2m_open\"] = function() {\n                  return (_v2m_open = Module[\"_v2m_open\"] = Module[\"asm\"][\"ca\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_write_audio = Module[\"_v2m_write_audio\"] = function() {\n                  return (_v2m_write_audio = Module[\"_v2m_write_audio\"] = Module[\"asm\"][\"da\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_get_position_ms = Module[\"_v2m_get_position_ms\"] = function() {\n                  return (_v2m_get_position_ms = Module[\"_v2m_get_position_ms\"] = Module[\"asm\"][\"ea\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_get_duration_ms = Module[\"_v2m_get_duration_ms\"] = function() {\n                  return (_v2m_get_duration_ms = Module[\"_v2m_get_duration_ms\"] = Module[\"asm\"][\"fa\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_seek_ms = Module[\"_v2m_seek_ms\"] = function() {\n                  return (_v2m_seek_ms = Module[\"_v2m_seek_ms\"] = Module[\"asm\"][\"ga\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_set_speed = Module[\"_v2m_set_speed\"] = function() {\n                  return (_v2m_set_speed = Module[\"_v2m_set_speed\"] = Module[\"asm\"][\"ha\"]).apply(null, arguments)\n                }\n            ;\n            var _v2m_close = Module[\"_v2m_close\"] = function() {\n                  return (_v2m_close = Module[\"_v2m_close\"] = Module[\"asm\"][\"ia\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_start_player = Module[\"_xmp_start_player\"] = function() {\n                  return (_xmp_start_player = Module[\"_xmp_start_player\"] = Module[\"asm\"][\"ja\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_end_player = Module[\"_xmp_end_player\"] = function() {\n                  return (_xmp_end_player = Module[\"_xmp_end_player\"] = Module[\"asm\"][\"ka\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_play_buffer = Module[\"_xmp_play_buffer\"] = function() {\n                  return (_xmp_play_buffer = Module[\"_xmp_play_buffer\"] = Module[\"asm\"][\"la\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_get_frame_info = Module[\"_xmp_get_frame_info\"] = function() {\n                  return (_xmp_get_frame_info = Module[\"_xmp_get_frame_info\"] = Module[\"asm\"][\"ma\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_get_module_info = Module[\"_xmp_get_module_info\"] = function() {\n                  return (_xmp_get_module_info = Module[\"_xmp_get_module_info\"] = Module[\"asm\"][\"na\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_create_context = Module[\"_xmp_create_context\"] = function() {\n                  return (_xmp_create_context = Module[\"_xmp_create_context\"] = Module[\"asm\"][\"oa\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_stop_module = Module[\"_xmp_stop_module\"] = function() {\n                  return (_xmp_stop_module = Module[\"_xmp_stop_module\"] = Module[\"asm\"][\"pa\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_restart_module = Module[\"_xmp_restart_module\"] = function() {\n                  return (_xmp_restart_module = Module[\"_xmp_restart_module\"] = Module[\"asm\"][\"qa\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_seek_time = Module[\"_xmp_seek_time\"] = function() {\n                  return (_xmp_seek_time = Module[\"_xmp_seek_time\"] = Module[\"asm\"][\"ra\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_channel_mute = Module[\"_xmp_channel_mute\"] = function() {\n                  return (_xmp_channel_mute = Module[\"_xmp_channel_mute\"] = Module[\"asm\"][\"sa\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_get_player = Module[\"_xmp_get_player\"] = function() {\n                  return (_xmp_get_player = Module[\"_xmp_get_player\"] = Module[\"asm\"][\"ta\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_get_format_list = Module[\"_xmp_get_format_list\"] = function() {\n                  return (_xmp_get_format_list = Module[\"_xmp_get_format_list\"] = Module[\"asm\"][\"ua\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_inject_event = Module[\"_xmp_inject_event\"] = function() {\n                  return (_xmp_inject_event = Module[\"_xmp_inject_event\"] = Module[\"asm\"][\"va\"]).apply(null, arguments)\n                }\n            ;\n            var _xmp_load_module_from_memory = Module[\"_xmp_load_module_from_memory\"] = function() {\n                  return (_xmp_load_module_from_memory = Module[\"_xmp_load_module_from_memory\"] = Module[\"asm\"][\"wa\"]).apply(null, arguments)\n                }\n            ;\n            var _new_fluid_settings = Module[\"_new_fluid_settings\"] = function() {\n                  return (_new_fluid_settings = Module[\"_new_fluid_settings\"] = Module[\"asm\"][\"xa\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_settings_setstr = Module[\"_fluid_settings_setstr\"] = function() {\n                  return (_fluid_settings_setstr = Module[\"_fluid_settings_setstr\"] = Module[\"asm\"][\"ya\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_settings_setnum = Module[\"_fluid_settings_setnum\"] = function() {\n                  return (_fluid_settings_setnum = Module[\"_fluid_settings_setnum\"] = Module[\"asm\"][\"za\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_settings_setint = Module[\"_fluid_settings_setint\"] = function() {\n                  return (_fluid_settings_setint = Module[\"_fluid_settings_setint\"] = Module[\"asm\"][\"Aa\"]).apply(null, arguments)\n                }\n            ;\n            var _new_fluid_synth = Module[\"_new_fluid_synth\"] = function() {\n                  return (_new_fluid_synth = Module[\"_new_fluid_synth\"] = Module[\"asm\"][\"Ba\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_set_reverb = Module[\"_fluid_synth_set_reverb\"] = function() {\n                  return (_fluid_synth_set_reverb = Module[\"_fluid_synth_set_reverb\"] = Module[\"asm\"][\"Ca\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_noteon = Module[\"_fluid_synth_noteon\"] = function() {\n                  return (_fluid_synth_noteon = Module[\"_fluid_synth_noteon\"] = Module[\"asm\"][\"Da\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_noteoff = Module[\"_fluid_synth_noteoff\"] = function() {\n                  return (_fluid_synth_noteoff = Module[\"_fluid_synth_noteoff\"] = Module[\"asm\"][\"Ea\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_all_notes_off = Module[\"_fluid_synth_all_notes_off\"] = function() {\n                  return (_fluid_synth_all_notes_off = Module[\"_fluid_synth_all_notes_off\"] = Module[\"asm\"][\"Fa\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_all_sounds_off = Module[\"_fluid_synth_all_sounds_off\"] = function() {\n                  return (_fluid_synth_all_sounds_off = Module[\"_fluid_synth_all_sounds_off\"] = Module[\"asm\"][\"Ga\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_write_float = Module[\"_fluid_synth_write_float\"] = function() {\n                  return (_fluid_synth_write_float = Module[\"_fluid_synth_write_float\"] = Module[\"asm\"][\"Ha\"]).apply(null, arguments)\n                }\n            ;\n            var _fluid_synth_sfload = Module[\"_fluid_synth_sfload\"] = function() {\n                  return (_fluid_synth_sfload = Module[\"_fluid_synth_sfload\"] = Module[\"asm\"][\"Ia\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_note_on = Module[\"_tp_note_on\"] = function() {\n                  return (_tp_note_on = Module[\"_tp_note_on\"] = Module[\"asm\"][\"Ja\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_note_off = Module[\"_tp_note_off\"] = function() {\n                  return (_tp_note_off = Module[\"_tp_note_off\"] = Module[\"asm\"][\"Ka\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_program_change = Module[\"_tp_program_change\"] = function() {\n                  return (_tp_program_change = Module[\"_tp_program_change\"] = Module[\"asm\"][\"La\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_pitch_bend = Module[\"_tp_pitch_bend\"] = function() {\n                  return (_tp_pitch_bend = Module[\"_tp_pitch_bend\"] = Module[\"asm\"][\"Ma\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_control_change = Module[\"_tp_control_change\"] = function() {\n                  return (_tp_control_change = Module[\"_tp_control_change\"] = Module[\"asm\"][\"Na\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_channel_pressure = Module[\"_tp_channel_pressure\"] = function() {\n                  return (_tp_channel_pressure = Module[\"_tp_channel_pressure\"] = Module[\"asm\"][\"Oa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_render = Module[\"_tp_render\"] = function() {\n                  return (_tp_render = Module[\"_tp_render\"] = Module[\"asm\"][\"Pa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_panic = Module[\"_tp_panic\"] = function() {\n                  return (_tp_panic = Module[\"_tp_panic\"] = Module[\"asm\"][\"Qa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_panic_channel = Module[\"_tp_panic_channel\"] = function() {\n                  return (_tp_panic_channel = Module[\"_tp_panic_channel\"] = Module[\"asm\"][\"Ra\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_reset = Module[\"_tp_reset\"] = function() {\n                  return (_tp_reset = Module[\"_tp_reset\"] = Module[\"asm\"][\"Sa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_init = Module[\"_tp_init\"] = function() {\n                  return (_tp_init = Module[\"_tp_init\"] = Module[\"asm\"][\"Ta\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_write_audio = Module[\"_tp_write_audio\"] = function() {\n                  return (_tp_write_audio = Module[\"_tp_write_audio\"] = Module[\"asm\"][\"Ua\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_get_duration_ms = Module[\"_tp_get_duration_ms\"] = function() {\n                  return (_tp_get_duration_ms = Module[\"_tp_get_duration_ms\"] = Module[\"asm\"][\"Va\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_seek = Module[\"_tp_seek\"] = function() {\n                  return (_tp_seek = Module[\"_tp_seek\"] = Module[\"asm\"][\"Wa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_get_position_ms = Module[\"_tp_get_position_ms\"] = function() {\n                  return (_tp_get_position_ms = Module[\"_tp_get_position_ms\"] = Module[\"asm\"][\"Xa\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_set_speed = Module[\"_tp_set_speed\"] = function() {\n                  return (_tp_set_speed = Module[\"_tp_set_speed\"] = Module[\"asm\"][\"Ya\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_stop = Module[\"_tp_stop\"] = function() {\n                  return (_tp_stop = Module[\"_tp_stop\"] = Module[\"asm\"][\"Za\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_open = Module[\"_tp_open\"] = function() {\n                  return (_tp_open = Module[\"_tp_open\"] = Module[\"asm\"][\"_a\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_unload_soundfont = Module[\"_tp_unload_soundfont\"] = function() {\n                  return (_tp_unload_soundfont = Module[\"_tp_unload_soundfont\"] = Module[\"asm\"][\"$a\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_load_soundfont = Module[\"_tp_load_soundfont\"] = function() {\n                  return (_tp_load_soundfont = Module[\"_tp_load_soundfont\"] = Module[\"asm\"][\"ab\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_add_soundfont = Module[\"_tp_add_soundfont\"] = function() {\n                  return (_tp_add_soundfont = Module[\"_tp_add_soundfont\"] = Module[\"asm\"][\"bb\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_set_reverb = Module[\"_tp_set_reverb\"] = function() {\n                  return (_tp_set_reverb = Module[\"_tp_set_reverb\"] = Module[\"asm\"][\"cb\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_get_channel_in_use = Module[\"_tp_get_channel_in_use\"] = function() {\n                  return (_tp_get_channel_in_use = Module[\"_tp_get_channel_in_use\"] = Module[\"asm\"][\"db\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_get_channel_program = Module[\"_tp_get_channel_program\"] = function() {\n                  return (_tp_get_channel_program = Module[\"_tp_get_channel_program\"] = Module[\"asm\"][\"eb\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_set_channel_mute = Module[\"_tp_set_channel_mute\"] = function() {\n                  return (_tp_set_channel_mute = Module[\"_tp_set_channel_mute\"] = Module[\"asm\"][\"fb\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_set_bank = Module[\"_tp_set_bank\"] = function() {\n                  return (_tp_set_bank = Module[\"_tp_set_bank\"] = Module[\"asm\"][\"gb\"]).apply(null, arguments)\n                }\n            ;\n            var _tp_set_synth_engine = Module[\"_tp_set_synth_engine\"] = function() {\n                  return (_tp_set_synth_engine = Module[\"_tp_set_synth_engine\"] = Module[\"asm\"][\"hb\"]).apply(null, arguments)\n                }\n            ;\n            var _cqt_init = Module[\"_cqt_init\"] = function() {\n                  return (_cqt_init = Module[\"_cqt_init\"] = Module[\"asm\"][\"ib\"]).apply(null, arguments)\n                }\n            ;\n            var _cqt_calc = Module[\"_cqt_calc\"] = function() {\n                  return (_cqt_calc = Module[\"_cqt_calc\"] = Module[\"asm\"][\"jb\"]).apply(null, arguments)\n                }\n            ;\n            var _cqt_render_line = Module[\"_cqt_render_line\"] = function() {\n                  return (_cqt_render_line = Module[\"_cqt_render_line\"] = Module[\"asm\"][\"kb\"]).apply(null, arguments)\n                }\n            ;\n            var _cqt_bin_to_freq = Module[\"_cqt_bin_to_freq\"] = function() {\n                  return (_cqt_bin_to_freq = Module[\"_cqt_bin_to_freq\"] = Module[\"asm\"][\"lb\"]).apply(null, arguments)\n                }\n            ;\n            var ___errno_location = Module[\"___errno_location\"] = function() {\n                  return (___errno_location = Module[\"___errno_location\"] = Module[\"asm\"][\"mb\"]).apply(null, arguments)\n                }\n            ;\n            var stackSave = Module[\"stackSave\"] = function() {\n                  return (stackSave = Module[\"stackSave\"] = Module[\"asm\"][\"nb\"]).apply(null, arguments)\n                }\n            ;\n            var stackAlloc = Module[\"stackAlloc\"] = function() {\n                  return (stackAlloc = Module[\"stackAlloc\"] = Module[\"asm\"][\"ob\"]).apply(null, arguments)\n                }\n            ;\n            var stackRestore = Module[\"stackRestore\"] = function() {\n                  return (stackRestore = Module[\"stackRestore\"] = Module[\"asm\"][\"pb\"]).apply(null, arguments)\n                }\n            ;\n            var dynCall_vi = Module[\"dynCall_vi\"] = function() {\n                  return (dynCall_vi = Module[\"dynCall_vi\"] = Module[\"asm\"][\"qb\"]).apply(null, arguments)\n                }\n            ;\n            var dynCall_v = Module[\"dynCall_v\"] = function() {\n                  return (dynCall_v = Module[\"dynCall_v\"] = Module[\"asm\"][\"rb\"]).apply(null, arguments)\n                }\n            ;\n            Module[\"asm\"] = asm;\n            Module[\"ccall\"] = ccall;\n            Module[\"setValue\"] = setValue;\n            Module[\"getValue\"] = getValue;\n            Module[\"allocate\"] = allocate;\n            Module[\"UTF8ToString\"] = UTF8ToString;\n            Module[\"FS\"] = FS;\n            Module[\"ALLOC_NORMAL\"] = ALLOC_NORMAL;\n            var calledRun;\n            Module[\"then\"] = function(func) {\n              if (calledRun) {\n                func(Module)\n              } else {\n                var old = Module[\"onRuntimeInitialized\"];\n                Module[\"onRuntimeInitialized\"] = function() {\n                  if (old)\n                    old();\n                  func(Module)\n                }\n              }\n              return Module\n            }\n            ;\n            dependenciesFulfilled = function runCaller() {\n              if (!calledRun)\n                run();\n              if (!calledRun)\n                dependenciesFulfilled = runCaller\n            }\n            ;\n            function run(args) {\n              args = args || arguments_;\n              if (runDependencies > 0) {\n                return\n              }\n              preRun();\n              if (runDependencies > 0)\n                return;\n              function doRun() {\n                if (calledRun)\n                  return;\n                calledRun = true;\n                Module[\"calledRun\"] = true;\n                if (ABORT)\n                  return;\n                initRuntime();\n                preMain();\n                if (Module[\"onRuntimeInitialized\"])\n                  Module[\"onRuntimeInitialized\"]();\n                postRun()\n              }\n              if (Module[\"setStatus\"]) {\n                Module[\"setStatus\"](\"Running...\");\n                setTimeout(function() {\n                  setTimeout(function() {\n                    Module[\"setStatus\"](\"\")\n                  }, 1);\n                  doRun()\n                }, 1)\n              } else {\n                doRun()\n              }\n            }\n            Module[\"run\"] = run;\n            if (Module[\"preInit\"]) {\n              if (typeof Module[\"preInit\"] == \"function\")\n                Module[\"preInit\"] = [Module[\"preInit\"]];\n              while (Module[\"preInit\"].length > 0) {\n                Module[\"preInit\"].pop()()\n              }\n            }\n            noExitRuntime = true;\n            run();\n\n            return CHIP_CORE\n          }\n      );\n    }\n)();\nexport default CHIP_CORE;\n \n","import Player from \"./Player.js\";\n\nconst INT16_MAX = Math.pow(2, 16) - 1;\nconst XMP_PLAYER_STATE = 8;\nconst XMP_STATE_PLAYING = 2;\nconst fileExtensions = [\n  // libxmp-lite:\n  'it',  //  Impulse Tracker  1.00, 2.00, 2.14, 2.15\n  'mod', //  Sound/Noise/Protracker M.K., M!K!, M&K!, N.T., CD81\n  's3m', //  Scream Tracker 3 3.00, 3.01+\n  'xm',  //  Fast Tracker II  1.02, 1.03, 1.04\n];\n\nexport default class XMPPlayer extends Player {\n  constructor(audioCtx, destNode, chipCore, onPlayerStateUpdate = function() {}) {\n    super(audioCtx, destNode, chipCore, onPlayerStateUpdate);\n\n    this.lib = chipCore;\n    this.xmpCtx = chipCore._xmp_create_context();\n    this.xmp_frame_infoPtr = chipCore._malloc(2048);\n    this.fileExtensions = fileExtensions;\n    this.initialBPM = 125;\n    this.tempoScale = 1;\n    this._positionMs = 0;\n    this._durationMs = 1000;\n    this.buffer = chipCore.allocate(this.bufferSize * 16, 'i16', chipCore.ALLOC_NORMAL);\n\n    this.setAudioProcess(this.xmpAudioProcess);\n  }\n\n  xmpAudioProcess(e) {\n    let err;\n    let i, channel;\n    const infoPtr = this.xmp_frame_infoPtr;\n    const channels = [];\n    for (channel = 0; channel < e.outputBuffer.numberOfChannels; channel++) {\n      channels[channel] = e.outputBuffer.getChannelData(channel);\n    }\n\n    if (this.paused) {\n      for (channel = 0; channel < channels.length; channel++) {\n        channels[channel].fill(0);\n      }\n      return;\n    }\n\n    err = this.lib._xmp_play_buffer(this.xmpCtx, this.buffer, this.bufferSize * 4, 1);\n    if (err === -1) {\n      this.stop();\n    } else if (err !== 0) {\n      this.suspend();\n      console.error(\"xmp_play_buffer failed. error code: %d\", err);\n      throw Error('Unable to play this file!');\n    }\n\n    // Get current module BPM\n    // see http://xmp.sourceforge.net/libxmp.html#id25\n    this.lib._xmp_get_frame_info(this.xmpCtx, infoPtr);\n    const bpm = this.lib.getValue(infoPtr + 6 * 4, 'i32');\n    this._positionMs = this.lib.getValue(infoPtr + 7 * 4, 'i32'); // xmp_frame_info.time\n    this._maybeInjectTempo(bpm);\n\n    for (channel = 0; channel < channels.length; channel++) {\n      for (i = 0; i < this.bufferSize; i++) {\n        channels[channel][i] = this.lib.getValue(\n          this.buffer +           // Interleaved channel format\n          i * 2 * 2 +             // frame offset   * bytes per sample * num channels +\n          channel * 2,            // channel offset * bytes per sample\n          'i16'                   // the sample values are signed 16-bit integers\n        ) / INT16_MAX;            // convert int16 to float\n      }\n    }\n  }\n\n  _parseMetadata() {\n    const xmp = this.lib;\n    const meta = {};\n\n    // Match layout of xmp_module_info struct\n    // http://xmp.sourceforge.net/libxmp.html\n    // #void-xmp-get-module-info-xmp-context-c-struct-xmp-module-info-info\n    const xmp_module_infoPtr = xmp._malloc(2048);\n    xmp._xmp_get_module_info(this.xmpCtx, xmp_module_infoPtr);\n    const xmp_modulePtr = xmp.getValue(xmp_module_infoPtr + 20, '*');\n    meta.title = xmp.UTF8ToString(xmp_modulePtr, 256);\n    meta.system = xmp.UTF8ToString(xmp_modulePtr + 64, 256);\n    meta.comment = xmp.UTF8ToString(xmp.getValue(xmp_module_infoPtr + 24, '*'), 512);\n\n    const infoPtr = this.xmp_frame_infoPtr;\n    xmp._xmp_get_frame_info(this.xmpCtx, infoPtr);\n    this._durationMs = xmp.getValue(infoPtr + 8 * 4, 'i32');\n\n    // XMP-specific metadata\n    meta.patterns = xmp.getValue(xmp_modulePtr + 128 + 4 * 0, 'i32'); // patterns\n    meta.tracks = xmp.getValue(xmp_modulePtr + 128 + 4 * 1, 'i32'); // tracks\n    meta.numChannels = xmp.getValue(xmp_modulePtr + 128 + 4 * 2, 'i32'); // tracks per pattern\n    meta.numInstruments = xmp.getValue(xmp_modulePtr + 128 + 4 * 3, 'i32'); // instruments\n    meta.numSamples = xmp.getValue(xmp_modulePtr + 128 + 4 * 4, 'i32'); // samples\n    meta.initialSpeed = xmp.getValue(xmp_modulePtr + 128 + 4 * 5, 'i32'); // initial speed\n    meta.initialBPM = xmp.getValue(xmp_modulePtr + 128 + 4 * 6, 'i32'); // initial bpm\n    meta.moduleLength = xmp.getValue(xmp_modulePtr + 128 + 4 * 7, 'i32'); // module length\n    meta.restartPosition = xmp.getValue(xmp_modulePtr + 128 + 4 * 8, 'i32'); // restart position\n\n    // Filename fallback\n    if (!meta.title) meta.title = this.filepathMeta.title;\n\n    this.initialBPM = meta.initialBPM;\n\n    return meta;\n  }\n\n  loadData(data, filename) {\n    let err;\n    this.filepathMeta = Player.metadataFromFilepath(filename);\n\n    err = this.lib.ccall(\n      'xmp_load_module_from_memory', 'number',\n      ['number', 'array', 'number'],\n      [this.xmpCtx, data, data.length]\n    );\n    if (err !== 0) {\n      console.error(\"xmp_load_module_from_memory failed. error code: %d\", err);\n      throw Error('Unable to load this file!');\n    }\n\n    err = this.lib._xmp_start_player(this.xmpCtx, this.audioCtx.sampleRate, 0);\n    if (err !== 0) {\n      console.error('xmp_start_player failed. error code: %d', err);\n    }\n\n    this.metadata = this._parseMetadata(filename);\n\n    this.connect();\n    this.resume();\n    this.onPlayerStateUpdate(false);\n  }\n\n  setVoices(voices) {\n    voices.forEach((isEnabled, i) => {\n      this.lib._xmp_channel_mute(this.xmpCtx, i, isEnabled ? 0 : 1);\n    });\n  }\n\n  setTempo(val) {\n    if (!this.metadata.initialSpeed) {\n      console.error('Unable to set speed for this file format.');\n      return;\n    }\n    this.tempoScale = val;\n  }\n\n  _maybeInjectTempo(measuredBPM) {\n    const xmp = this.lib;\n    const minBPM = 20;\n    const maxBPM = 255;\n    const targetBPM = Math.floor(Math.max(Math.min(this.metadata.initialBPM * this.tempoScale, maxBPM), minBPM));\n\n    if (targetBPM === measuredBPM) return;\n\n    console.log('Injecting %d BPM into libxmp. (Initial: %d)', targetBPM, this.metadata.initialBPM);\n    const xmp_eventPtr = xmp._malloc(8);\n    for (let i = 0; i < 8; i++) xmp.setValue(xmp_eventPtr + i, 0, 'i8');\n    xmp.setValue(xmp_eventPtr + 3, 0x87, 'i8');\n    xmp.setValue(xmp_eventPtr + 4, targetBPM, 'i32');\n    xmp._xmp_inject_event(this.xmpCtx, 0, xmp_eventPtr);\n  }\n\n  getVoiceName(index) {\n    return `Ch ${index + 1}`;\n  }\n\n  getNumVoices() {\n    return this.metadata.numChannels;\n  }\n\n  getNumSubtunes() {\n    return 0;\n  }\n\n  getPositionMs() {\n    return this._positionMs;\n  }\n\n  getDurationMs() {\n    return this._durationMs;\n  }\n\n  getMetadata() {\n    return this.metadata;\n  }\n\n  isPlaying() {\n    const playingState = this.lib._xmp_get_player(this.xmpCtx, XMP_PLAYER_STATE);\n    return !this.isPaused() && playingState === XMP_STATE_PLAYING;\n  }\n\n  seekMs(seekMs) {\n    this.lib._xmp_seek_time(this.xmpCtx, seekMs);\n  }\n\n  stop() {\n    this.suspend();\n    this.lib._xmp_stop_module(this.xmpCtx);\n    console.debug('XMPPlayer.stop()');\n    this.onPlayerStateUpdate(true);\n  }\n}\n","import {ChipCore, GMEPlayer} from \"../../3rdparty/chip-player-js-lib\";\n// import queryString from \"querystring\";\n\n\nclass GMESongFile {\n    async init() { // TODO: lazy load\n\n        await new Promise((resolve, reject) => {\n            // Load the chip-core Emscripten runtime\n            try {\n                this.chipCore = new ChipCore({\n                    // Look for .wasm file in web root, not the same location as the app bundle (static/js).\n                    locateFile: (path, prefix) => {\n                        if (path.endsWith('.wasm') || path.endsWith('.wast'))\n                            return `${process.env.PUBLIC_URL}/${path}`;\n                        return prefix + path;\n                    },\n                    onRuntimeInitialized: (e) => {\n                        console.log('onRuntimeInitialized', e);\n                        resolve();\n                        // this.sequencer.setPlayers([\n                        //     new GMEPlayer(audioCtx, playerNode, chipCore),\n                        //     new XMPPlayer(audioCtx, playerNode, chipCore),\n                        //     new MIDIPlayer(audioCtx, playerNode, chipCore),\n                        //     new V2MPlayer(audioCtx, playerNode, chipCore),\n                        // ]);\n                        // this.setState({loading: false});\n\n                        // Experimental: Split Module Support\n                        //\n                        // chipCore.loadDynamicLibrary('./xmp.wasm', {\n                        //     loadAsync: true,\n                        //     global: true,\n                        //     nodelete: true,\n                        //   })\n                        //   .then(() => {\n                        //     return this.sequencer.setPlayers([new XMPPlayer(audioCtx, playerNode, chipCore)]);\n                        //   });\n\n                        // const urlParams = queryString.parse(window.location.search.substr(1));\n                        // if (urlParams.play) {\n                        //     // Allow a little time for initial page render before starting the song.\n                        //     // This is not absolutely necessary but helps prevent stuttering.\n                        //     setTimeout(() => {\n                        //         this.sequencer.playSonglist([urlParams.play]);\n                        //         if (urlParams.t) {\n                        //             setTimeout(() => {\n                        //                 if (this.sequencer.getPlayer()) {\n                        //                     this.sequencer.getPlayer().seekMs(parseInt(urlParams.t, 10));\n                        //                 }\n                        //             }, 100);\n                        //         }\n                        //     }, 500);\n                        // }\n                    },\n                });\n            } catch (e) {\n                // Browser doesn't file WASM (Safari in iOS Simulator)\n                throw e;\n            }\n        });\n\n        // this.sequencer = new Sequencer([], this.handleSequencerStateUpdate, this.handlePlayerError);\n    }\n\n    loadPlayerFromBuffer(audioContext, destinationNode, buffer, filepath) {\n        let uint8Array;\n        uint8Array = new Uint8Array(buffer);\n\n\n        const player = new GMEPlayer(audioContext, destinationNode, this.chipCore, e => this.onPlayerStateUpdate(e));\n        try {\n            player.loadData(uint8Array, filepath);\n        } catch (e) {\n            throw e;\n            // this.onPlayerError(e.message);\n            // return;\n        }\n        // this.onPlayerError(null);\n\n        const numVoices = player.getNumVoices();\n        player.setTempo(1.0); // this.tempo);\n        player.setVoices([...Array(numVoices)].fill(true));\n        player.stop();\n        return player;\n\n        // console.debug('Sequencer.playSong(...) song request completed');\n    }\n\n    onPlayerStateUpdate(e) {\n        console.log(e);\n    }\n\n\n\n    loadSongDataFromBuffer(buffer, filepath) {\n        var audioCtx = new AudioContext();\n        const player = this.loadPlayerFromBuffer(audioCtx, audioCtx.destination, buffer, filepath);\n        return this.loadSongDataFromPlayer(player, filepath);\n    }\n\n    loadSongDataFromPlayer(player, filepath) {\n        const metadata = player.metadata;\n        console.log('metadata', metadata);\n        // id666.length = 5;\n        const timeDivision = 96;\n        const beatsPerMinute = 120;\n        const lengthInTicks = (metadata.length * (beatsPerMinute / 60)) * timeDivision;\n\n        const songData = {\n            title: metadata.title,\n            // game: (id666.game ? id666.game + ': ' : ''),\n            game: metadata.game,\n            system: metadata.system,\n            artist: metadata.artist,\n            copyright: metadata.copyright,\n            version: 'auto',\n            created: new Date().getTime(),\n            timeDivision: timeDivision,\n            beatsPerMinute: beatsPerMinute,\n            // beatsPerMeasure: 4,\n            rootGroup: 'root',\n            programs: [\n                {\n                    \"className\": \"GMEPlayerSynthesizer\",\n                    fileURL: filepath\n                }\n            ],\n            instructions: {\n                'root': [\n                    ['C4', 0, lengthInTicks],\n                ]\n            }\n        };\n\n        return songData;\n    }\n\n    async loadSongDataFromURL(filepath, children={}) {\n        const response = await fetch(filepath);\n        const buffer = await response.arrayBuffer();\n        var audioCtx = new AudioContext();\n        const player = this.loadPlayerFromBuffer(audioCtx, audioCtx.destination, buffer, filepath);\n        const songData = this.loadSongDataFromPlayer(player, filepath);\n        return songData;\n    }\n\n\n}\n\n\nexport default GMESongFile;\n","class JSONSongFile {\n\n    async loadSongDataFromFileInput(file) {\n        const fileResult = await new Promise((resolve, reject) => {\n            let reader = new FileReader();                                      // prepare the file Reader\n            reader.readAsText(file);                 // read the binary data\n            reader.onload =  (e) => {\n                resolve(e.target.result);\n            };\n        });\n\n        // noinspection JSCheckFunctionSignatures\n        return JSON.parse(fileResult);\n    }\n\n\n    async loadSongDataFromURL(url, children={}) {\n        const response = await fetch(url);\n        const songData = await response.json();\n        return songData;\n    }\n\n}\n\n\nexport default JSONSongFile;\n","\nconst archiveBuffers = {};\nconst torrentCache = {};\nconst trackerURLS = [\n    \"udp://explodie.org:6969\",\n    \"udp://track.coppersurfer.tk:6969\",\n    \"udp://track.empire-js.us:1337\",\n    \"udp://track.leechers-paradise.org:6969\",\n    \"udp://track.opentrackr.org:1337\",\n    // \"wss://snesology.net/wss\",\n    \"wss://track.fastcast.nz\",\n    \"wss://track.openwebtorrent.com\",\n    \"wss://track.btorrent.xyz\",\n];\n\nclass FileService {\n    // constructor(song) {\n    //     this.song = song;\n    // }\n\n    log(message) {\n        console.info(message);\n        // if(this.song) {\n        //     this.song.dispatchEvent(new CustomEvent('log', {detail: message}))\n        // }\n    }\n\n    async loadBufferFromURL(url) {\n        // this.log(\"Loading buffer from url: \" + url);\n        if(url.toString().startsWith('torrent://')) {\n            console.time('getFileBufferFromTorrent');\n            const buffer = await this.getFileBufferFromTorrent(url);\n            console.timeEnd('getFileBufferFromTorrent');\n            return buffer;\n        }\n\n        const response = await fetch(url);\n        return await response.arrayBuffer();\n    }\n\n    getMagnetURL(torrentID) {\n        // &dn=snes\n        const magnetURL = `magnet:?xt=urn:btih:${torrentID}&dn=torrent&${trackerURLS.map(t => 'tr='+t).join('&')}`;\n        return magnetURL;\n    }\n\n    async getFileBufferFromTorrent(torrentURL) {\n        var match = torrentURL.match(/^(torrent?:)\\/\\/(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\\?[^#]*|)(#.*|)$/);\n        const parsedURL = match && {\n            hostname: match[3],\n            pathname: match[5],\n        };\n\n        const torrentID = parsedURL.hostname;\n        const filePath = parsedURL.pathname.substr(1);\n\n        const torrent = await this.getTorrent(torrentID);\n        for(let i=0; i<torrent.files.length; i++) {\n            const file = torrent.files[i];\n            if(filePath === file.path) {\n                return await getBuffer(file);\n            }\n            if(filePath.startsWith(file.path)) {\n                const archiveFilePath = filePath.substr(file.path.length);\n                let archiveBuffer;\n                if(typeof archiveBuffers[file.path] !== \"undefined\") {\n                    archiveBuffer = archiveBuffers[file.path];\n                } else {\n                    archiveBuffer = getBuffer(file);\n                    archiveBuffers[file.path] = archiveBuffer;\n                }\n                if(archiveBuffer instanceof Promise)\n                    archiveBuffer = await archiveBuffer;\n                return await this.getFileBufferFromArchive(archiveBuffer, archiveFilePath);\n            }\n        }\n        throw new Error(\"Archive file not found: \" + filePath);\n\n        async function getBuffer(file) {\n            return await new Promise((resolve, reject) => {\n                file.getBuffer(async function(err, buffer) {\n                    if(err) throw new Error(err);\n                    resolve(buffer);\n                });\n            })\n        }\n    }\n\n    async getFileBufferFromArchive(archiveBuffer, filePath) {\n        const files = await this.decompress7ZipArchive(archiveBuffer);\n        for(let i=0; i<files.length; i++) {\n            const file = files[i];\n            if(file.path === filePath) {\n                return file.data;\n            }\n        }\n        throw new Error(\"Archive file not found: \" + filePath);\n\n    }\n\n    async getTorrent(torrentID) {\n        var WebTorrent = await requireWebTorrent();\n\n        if(torrentCache[torrentID]) {\n            if(torrentCache[torrentID] instanceof Promise)\n                await torrentCache[torrentID];\n            return torrentCache[torrentID];\n        }\n\n        const magnetURL = this.getMagnetURL(torrentID);\n\n        var client = new WebTorrent();\n\n        torrentCache[torrentID] = new Promise((resolve, reject) => {\n            this.log(\"Connecting to cloud url: \" + magnetURL);\n            client.add(magnetURL, function (torrent) {\n                // Got torrent metadata!\n                resolve(torrent);\n            });\n        });\n        torrentCache[torrentID] = await torrentCache[torrentID];\n        const torrent = torrentCache[torrentID];\n        this.log(\"Connected to cloud: \" + torrent.infoHash);\n        return torrent;\n    }\n\n    async decompress7ZipArchive(archiveBuffer) {\n        const fda = [];\n        var totalMemory = 268435456;\n        var INTERRUPT = false;\n        var rootdata = \"/data\";\n        var fileName=  'archive.7z';\n        fda.push(new DataStorage(rootdata,true,null));\n        const filedata = new Uint8Array(archiveBuffer);\n        fda.push(new DataStorage(rootdata  + \"/\" + fileName,false,filedata));\n\n        const workerURL =  'assets/3rdparty/7zip/js/worker.7z.wrapper.js';\n\n        let worker7z = new Worker(workerURL);\n\n        return await new Promise((resolve, reject) => {\n            worker7z.onerror = console.error; // TODO: reuse webworker\n            worker7z.onmessage = function(event) {//1\n                if (INTERRUPT) {\n                    finfunc();\n                    return;\n                }\n                if (event.data.type === 1){\n                    // console.info(event.data.text);\n                } else if (event.data.type === 2){\n                    // console.info(event.data.text);\n                } else if (event.data.type === 3){\n                    resolve(event.data.results);\n                    worker7z.terminate();//this is very important!!! You have to release memory!\n                }\n            };\n            var fda0 = [fda[0],fda[1]];\n            var args = [\"x\",  fda0[1].path ,\"-o/result\"];\n            worker7z.postMessage({\n                id:1,\n                action:'doit',\n                arguments:args,\n                totalMemory: totalMemory,\n                FilesDataArray: fda0\n            });\n\n            function finfunc() {\n                worker7z.terminate();\n                worker7z = undefined;\n                INTERRUPT = false;\n                // clearDataWrapper();\n            }\n        });\n\n        function DataStorage(path,isdir,data) {\n            this.path = path;\n            this.isdir = isdir;\n            this.data = data;\n        }\n    }\n}\n\n\n\nasync function requireWebTorrent() {\n    const AudioSourceLoader = customElements.get('audio-source-loader');\n    const relativeScriptPath = 'node_modules/webtorrent/webtorrent.min.js';\n\n    let scriptElm = AudioSourceLoader.findScript(relativeScriptPath, false);\n    if(!scriptElm) {\n        window.exports = {};\n        window.module = {exports: window.exports};\n        // const scriptURL = findThisScript()[0].basePath + relativeScriptPath;\n        scriptElm = document.createElement('script');\n        // scriptElm.src = scriptURL;\n        scriptElm.promises = (scriptElm.promises || []).concat(new Promise(async (resolve, reject) => {\n            scriptElm.onload = e => {\n                scriptElm.exports = window.module.exports;\n                delete window.module; delete window.exports;\n                resolve();\n            };\n            document.head.appendChild(scriptElm);\n        }));\n    }\n    for (let i=0; i<scriptElm.promises.length; i++)\n        await scriptElm.promises[i];\n    return scriptElm.exports\n        || (() => { throw new Error(\"Script module has no exports: \" + relativeScriptPath); })()\n}\n\nexport default FileService;\n","const TARGET = Symbol('proxy_target');\nconst LISTENER = Symbol('proxy_listener');\n\nexport class ConfigListener {\n    constructor(song, path=[]) {\n        this.path = path;\n        this.song = song;\n        this.updateTimeout = null;\n        this.changeListeners = [];\n        // TODO: allow fast changes. trigger update slowly\n    }\n\n    addChangeListener(listener) {\n        this.changeListeners(listener);\n    }\n    removeChangeListener(listener) {\n        const i = this.changeListeners.indexOf(listener)\n        if(i !== -1)\n            this.changeListeners.splice(i);\n    }\n\n\n    get(obj, prop) {\n        switch(prop) { // TODO: support all common methods\n            case TARGET: return obj;\n            case LISTENER: return this;\n            case 'indexOf': return (v,b,e) => obj.indexOf(v,b,e);\n            case 'splice': return (number, deleteCount, ...newValues) => this.splice(obj, this.path.concat(number), number, deleteCount, ...newValues);\n            default:\n                const path = this.path.concat(prop);\n                if(typeof obj[prop] === 'object') {\n                    return new Proxy(obj[prop], new ConfigListener(this.song, path));\n                }\n                return obj[prop];\n        }\n    }\n\n    set(obj, prop, value) {\n        obj[prop] = value;\n        this.queueChange('set', this.path.concat(prop), value);\n        return true;\n    }\n\n    deleteProperty(obj, prop) {\n        if (prop in obj) {\n            delete obj[prop];\n            this.queueChange('delete', this.path.concat(prop));\n        }\n        return true;\n    }\n\n    queueChange(action, path) {\n        this.song.queueHistoryAction(action, path);\n        for(let i=0; i<this.changeListeners.length; i++) {\n            this.changeListeners[i](action, path);\n        }\n    }\n\n\n\n    splice(obj, path, number, deleteCount, ...newValues) {\n        if(!Array.isArray(obj))\n            throw new Error(`Splice may only be used in array objects for path: ${path.join('.')}`);\n\n        obj.splice(number, deleteCount, ...newValues);\n        this.queueChange('splice', path, number, deleteCount, ...newValues);\n    }\n\n    /** Static **/\n\n    static TARGET = TARGET;\n    static LISTENER = LISTENER;\n\n    static resolveProxiedObject(proxyObject) {\n        return proxyObject[TARGET] || proxyObject;\n    }\n\n    static addChangeListener(proxyObject, listener) {\n        const configListener = proxyObject[LISTENER];\n        configListener.addChangeListener(listener);\n    }\n}\n","import Instruction from \"./Instruction\";\n\nclass InstructionIterator {\n    constructor(instructionList, timeDivision, beatsPerMinute) {\n        this.instructions = instructionList;\n        this.beatsPerMinute = beatsPerMinute;\n        this.timeDivision = timeDivision;\n\n        this.currentIndex = -1; // TODO: rename to index?\n        this.positionTicks = 0;\n        this.endPositionTicks = 0;\n        this.positionSeconds = 0;\n        this.endPositionSeconds = 0;\n        this.lastInstructionPositionInTicks = 0;\n        this.lastInstructionPositionInSeconds = 0;\n        this.rowCount = 0;\n        this.cursorPosition = 0;\n\n        // this.nextQuantizationBreakInTicks = null;\n        // this.stats = stats || {};\n\n    }\n\n    hasReachedEnd() {\n        return this.currentIndex >= this.instructions.length - 1;\n    }\n\n    incrementPositionByInstruction(instruction, callback=null) {\n        const deltaDurationTicks = instruction.deltaDurationTicks;\n        this.positionTicks = this.lastInstructionPositionInTicks + deltaDurationTicks;\n        this.lastInstructionPositionInTicks = this.positionTicks;\n\n        const elapsedTime = (deltaDurationTicks / this.timeDivision) / (this.beatsPerMinute / 60);\n        this.positionSeconds = this.lastInstructionPositionInSeconds + elapsedTime;\n        this.lastInstructionPositionInSeconds = this.positionSeconds;\n\n        const durationTicks = instruction.durationTicks || 0;\n        if(durationTicks) {\n\n            const trackEndPositionInTicks = this.positionTicks + durationTicks;\n            if (trackEndPositionInTicks > this.endPositionTicks)\n                this.endPositionTicks = trackEndPositionInTicks;\n            const trackPlaybackEndTime = this.positionSeconds + (durationTicks / this.timeDivision) / (this.beatsPerMinute / 60);\n            if (trackPlaybackEndTime > this.endPositionSeconds)\n                this.endPositionSeconds = trackPlaybackEndTime;\n\n        }\n        if(callback)\n            callback(instruction);\n        this.cursorPosition++;\n\n        // TODO: calculate bpm changes\n    }\n\n    getInstruction(index) {\n        const instructionData = this.instructions[index];\n        return Instruction.getInstruction(instructionData);\n    }\n\n\n    currentInstruction() {\n        if (this.currentIndex === -1)\n            throw new Error(\"Iterator has not been started\");\n        return this.getInstruction(this.currentIndex);\n    }\n\n    nextInstruction(callback=null) {\n        if (this.hasReachedEnd())\n            return null;\n\n        this.currentIndex++;\n        let currentInstruction = this.currentInstruction(); // new SongInstruction(this.instructionList[this.trackIndex]);\n        this.incrementPositionByInstruction(currentInstruction, callback); // , currentInstruction.duration);\n        return currentInstruction;\n    }\n\n    nextInstructionRow(rowCallback=null, instructionCallback=null) {\n        if(this.hasReachedEnd())\n            return null;\n\n        const instructionList = [];\n        while(true) {\n            const instruction = this.nextInstruction(instructionCallback);\n            // Add instruction to the list\n            instructionList.push(instruction);\n\n            if(this.hasReachedEnd())\n                break;\n\n            // Check next instruction\n            const nextInstruction = this.getInstruction(this.currentIndex + 1);\n\n            // If the next instruction has a delta, then the current row ends\n            if (nextInstruction.deltaDurationTicks > 0) {\n                // Finish last row\n                break;\n            }\n\n            // Get next instruction\n            // instruction = this.nextInstruction(instructionCallback);\n        }\n\n        if(rowCallback)\n            rowCallback(instructionList);\n        this.rowCount++;\n        this.cursorPosition++;\n        return instructionList;\n    }\n\n\n    /** Seeking **/\n\n    seekToIndex(index, callback=null) {\n        if (!Number.isInteger(index))\n            throw new Error(\"Invalid seek index\");\n        while (!this.hasReachedEnd()) {\n            if (index <= this.currentIndex)\n                break;\n            if (!this.nextInstruction(callback))\n                break;\n        }\n    }\n\n    seekToEnd(callback=null) {\n        while (!this.hasReachedEnd())\n            this.nextInstruction(callback);\n    }\n\n    seekToPosition(positionSeconds, callback=null) {\n        while (!this.hasReachedEnd()) {\n            const nextInstruction = this.getInstruction(this.currentIndex + 1);\n            const elapsedTime = (nextInstruction.deltaDurationTicks / this.timeDivision) / (this.beatsPerMinute / 60);\n            if(this.positionSeconds + elapsedTime >= positionSeconds) {\n                break;\n            }\n            this.nextInstruction(callback);\n        }\n    }\n\n    seekToPositionTicks(positionTicks, callback=null) {\n        while (!this.hasReachedEnd() && this.positionTicks <= positionTicks) {\n            const nextInstruction = this.getInstruction(this.currentIndex + 1);\n            if(this.positionTicks + nextInstruction.deltaDurationTicks > positionTicks) {\n                break;\n            }\n            this.nextInstruction(callback);\n        }\n    }\n}\n\nexport default InstructionIterator;\n\n\n","import InstructionIterator from \"./InstructionIterator\";\n\n// TODO: make own class\nexport default class QuantizedInstructionIterator extends InstructionIterator {\n    constructor(instructionList, quantizationTicks, timeDivision, beatsPerMinute) {\n        super(instructionList, timeDivision, beatsPerMinute);\n        if(!quantizationTicks)\n            throw new Error(\"Invalid quantizationTicks\");\n        this.quantizationTicks = quantizationTicks;\n        // Initiate quantization breaks\n        this.nextQuantizationBreakInTicks = 0;\n    }\n\n    getNextInstructionPositionInTicks() {\n        if(this.hasReachedEnd())\n            return null;\n        let instruction = this.getInstruction(this.currentIndex + 1);\n        return instruction.deltaDurationTicks + this.lastInstructionPositionInTicks;\n    }\n\n    // getNextQuantizationBreaksInTicks() {\n    //     // Catch up the quantization breaks\n    //     const nextPositionTicks = this.getNextInstructionPositionInTicks();\n    //     while(this.nextQuantizationBreakInTicks <= this.positionTicks)\n    //         this.nextQuantizationBreakInTicks += this.quantizationTicks;\n    //\n    //     return this.nextQuantizationBreakInTicks;\n    // }\n\n    updateNextQuantizationBreakInTicks() {\n        let nextPositionTicks = this.getNextInstructionPositionInTicks();\n        if(nextPositionTicks < this.positionTicks)\n            nextPositionTicks = this.positionTicks;\n        while(this.nextQuantizationBreakInTicks <= nextPositionTicks)\n            this.nextQuantizationBreakInTicks += this.quantizationTicks;\n    }\n\n    getNextRowPositionTicks() {\n        const nextQuantizationBreakInTicks = this.nextQuantizationBreakInTicks;\n        // const nextQuantizationBreakInTicks = this.getNextQuantizationBreaksInTicks();\n        if(this.hasReachedEnd())\n            return nextQuantizationBreakInTicks;\n        // If there is a next instruction\n        let instruction = this.getInstruction(this.currentIndex + 1);\n        const nextPositionTicks = instruction.deltaDurationTicks + this.lastInstructionPositionInTicks;\n\n        if(nextPositionTicks < nextQuantizationBreakInTicks)\n            return nextPositionTicks;\n        return nextQuantizationBreakInTicks;\n    }\n\n\n    nextQuantizedInstructionRow(rowCallback=null, instructionCallback=null) {\n        // if(toPositionTicks !== null && this.positionTicks >= toPositionTicks)\n        //     return null; // Reached the end\n\n        const nextQuantizationBreakInTicks = this.nextQuantizationBreakInTicks;\n        const doRow = () => {\n            const elapsedTime = ((nextQuantizationBreakInTicks - this.positionTicks) / this.timeDivision) / (this.beatsPerMinute / 60);\n            this.positionSeconds += elapsedTime;\n            this.positionTicks = nextQuantizationBreakInTicks;\n            this.nextQuantizationBreakInTicks += this.quantizationTicks;\n            // this.updateNextQuantizationBreakInTicks();\n            // this.nextQuantizationBreakInTicks += this.quantizationTicks;\n            const row = [];\n            if(rowCallback)\n                rowCallback(row);\n\n            this.rowCount++;\n            this.cursorPosition++;\n            return row;\n        };\n\n        if(!this.hasReachedEnd()) {\n            // If there is a next instruction\n            const nextPositionTicks = this.getNextInstructionPositionInTicks();\n            if (\n                nextQuantizationBreakInTicks < nextPositionTicks) {\n                // Next break comes before next instruction\n\n                return doRow();\n            }\n\n            this.updateNextQuantizationBreakInTicks();\n            // Return the next row\n            return this.nextInstructionRow(rowCallback, instructionCallback);\n        }\n\n        // Render the next quantized row\n        return doRow();\n    }\n\n\n    // nextQuantizedInstructionRow(quantizationTicks, toPositionTicks, rowCallback=null, instructionCallback=null) {\n    //     // let nextQuantizationBreakInTicks = quantizationTicks;\n    //     const instructionList = [];\n    //     if(instructionCallback === null)\n    //         instructionCallback = function(instruction) { return instruction };\n    //\n    //     // Scan ahead to next instruction\n    //     let nextPositionTicks = this.positionTicks;\n    //     if(!this.hasReachedEnd()) {\n    //         let instruction = this.getInstruction(this.currentIndex + 1);\n    //         nextPositionTicks += instruction.deltaDurationTicks;\n    //     }\n    //\n    //     if(this.hasReachedEnd()) {\n    //\n    //     } else if(nextPositionTicks < this.nextQuantizationBreakInTicks) {\n    //         // If next position is after next quantized break, return a blank row\n    //         this.scrollPositionTicks = this.nextQuantizationBreakInTicks;\n    //         this.nextQuantizationBreakInTicks += this.quantizationTicks;\n    //\n    //     } else {\n    //         // Increment instruction position\n    //         this.nextInstruction();\n    //\n    //\n    //         while (!this.hasReachedEnd()) {\n    //             // Scan ahead to next instruction\n    //             let instruction = this.getInstruction(this.currentIndex + 1);\n    //\n    //             // If the next instruction has a delta, then the current row ends\n    //             if (!instruction || instruction.deltaDurationTicks > 0) {\n    //                 // Finish rendering last row\n    //                 break;\n    //\n    //                 // Move next quantized row up to current position\n    //                 // while (this.nextQuantizationBreakInTicks <= currentRowPositionTicks)\n    //                 //     this.nextQuantizationBreakInTicks += quantizationTicks;\n    //\n    //\n    //             }\n    //\n    //             // Increment instruction position\n    //             instruction = this.nextInstruction();\n    //\n    //             // Increment instruction cursor offset\n    //             this.cursorOffset++;\n    //             const ret = instructionCallback(instruction);\n    //             if (ret !== null)\n    //                 instructionList.push(ret);\n    //         }\n    //         this.scrollPositionTicks = this.positionTicks;\n    //     }\n    //     this.rowCount++;\n    //     this.cursorOffset++;\n    //     return instructionList;\n    //\n    //\n    // }\n\n    /** Seeking **/\n    // TODO: hack overrides subclass\n    seekToIndex(index, callback=null) {\n        if (!Number.isInteger(index))\n            throw new Error(\"Invalid seek index\");\n        while (true) {\n            if (index === this.currentIndex)\n                break;\n            this.nextInstruction(callback);\n            if (!this.nextQuantizedInstructionRow(null, callback))\n                break;\n        }\n    }\n\n    seekToEnd(callback=null) {\n        while (!this.hasReachedEnd())\n            this.nextQuantizedInstructionRow(null, callback);\n    }\n\n    seekToPosition(positionSeconds, callback=null) {\n        while (this.positionSeconds < positionSeconds) {\n            this.nextQuantizedInstructionRow(null, callback);\n        }\n    }\n\n    seekToPositionTicks(positionTicks, callback=null) {\n        while (this.positionTicks < positionTicks) {\n            this.nextQuantizedInstructionRow(null, callback);\n        }\n    }\n}\n\n\n\n","class AudioBufferInstrument {\n    constructor(config={}, audioContext=null) {\n        this.config = config;\n        this.audioContext = audioContext;\n        this.audioBuffer = null;\n        this.loadAudioBuffer();\n    }\n    async loadAudioBuffer() {\n        const response = await fetch(this.config.url);\n        const buffer = await response.arrayBuffer();\n        this.audioBuffer = this.audioContext.decodeAudioData(buffer);\n    }\n\n    /** Playback **/\n\n    playFrequency(destination, frequencyValue, startTime, duration, velocity, onended=null) {\n        // Velocity\n        let velocityGain = destination.context.createGain();\n        velocityGain.gain.value = parseFloat(velocity || 127) / 127;\n        velocityGain.connect(destination);\n        destination = velocityGain;\n\n        // Audio Buffer\n        const source = destination.context.createBufferSource();\n        source.buffer = this.audioBuffer;\n        if(typeof this.config.loop !== \"undefined\")\n            source.loop = !!this.config.loop;\n        const playbackRate = frequencyValue / (this.config.root ? this.getCommandFrequency(this.config.root) : 440);\n        source.playbackRate.value = playbackRate; //  Math.random()*2;\n        if(typeof this.config.detune !== \"undefined\")\n            source.detune.value = this.config.detune;\n\n\n        source.connect(destination);\n        source.start(startTime);\n        source.stop(startTime + duration);\n        if(onended)\n            source.onended = onended;\n\n        // TODO: envelop is an effect\n        // let adsr = this.config.adsr || [0, 0, 0, .1];\n        // let currentTime = destination.context.currentTime;\n        // startTime = startTime !== null ? startTime : currentTime;\n        // duration = duration !== null ? duration : 0;\n\n\n        // velocityGain.gain.linearRampToValueAtTime(velocityGain.gain.value, startTime + duration);\n        // velocityGain.gain.linearRampToValueAtTime(0, startTime + duration + adsr[3]);\n        return source;\n    }\n\n}\n\nexport default AudioBufferInstrument;\n\n","import React from 'react';\nimport {\n    // Button,\n    // InputSelect,\n    ASUIDiv,\n    ASUIButton,\n    ASUIMenuAction,\n    ASUIMenuBreak,\n    ASUIIcon, ASUIInputRange, ASUIMenuDropDown,\n} from \"../../../../components\";\n\nimport AudioBufferInstrumentRendererStyle from \"./AudioBufferInstrumentRendererStyle\";\n\n/** PolyphonyInstrumentRenderer **/\nclass AudioBufferInstrumentRenderer extends AudioBufferInstrumentRendererStyle {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false\n        }\n    }\n\n    getSong() { return this.props.song; }\n    getSampleID() { return this.props.sampleID; }\n    getInstrumentID() { return this.props.instrumentID; }\n    getSampleData() { return this.props.sampleData; }\n\n    render() {\n        const sample = this.getSampleData();\n        // console.log('voice', voice);\n        const sampleName = sample.url.replace(/\\.(wav|mp3)$/, '');\n\n        let className = 'audiobuffer-instrument-renderer';\n        if(this.state.open)\n            className += ' open';\n\n        return (\n            <ASUIDiv\n                className={className}\n                >\n                <ASUIButton\n                    title=\"Change Sample\"\n                    className=\"name\"\n                    onAction={e => this.toggleOpen(e)}>\n                    {sampleName || \"Unnamed\"}\n                </ASUIButton>\n                {!this.state.open ? null : (\n                    <>\n                        {typeof sample.mixer === 'undefined' ? null : (\n                            <ASUIDiv title=\"Edit Mixer\" className=\"mixer\">\n                                <ASUIButton onAction={e => this.openMenuChangeMixer(e)} vertical openOnHover={false}>\n                                    {sample.mixer+'%'}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                        {typeof sample.detune === 'undefined' ? null : (\n                            <ASUIDiv title={`Detune by ${sample.detune} cents`} className=\"detune\">\n                                <ASUIButton onAction={e => this.openMenuChangeDetune(e)} vertical openOnHover={false}>\n                                    {sample.detune+'c'}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                        {typeof sample.root === 'undefined' ? null : (\n                            <ASUIDiv title={`Key Root is ${sample.root}`} className=\"root\">\n                                <ASUIButton onAction={e => this.openMenuChangeKeyRoot(e)} vertical openOnHover={false}>\n                                    {sample.root}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                        {typeof sample.alias === 'undefined' ? null : (\n                            <ASUIDiv title={`Key Alias is ${sample.alias}`} className=\"alias\">\n                                <ASUIButton onAction={e => this.openMenuChangeKeyAlias(e)} vertical openOnHover={false}>\n                                    {sample.alias}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                        {typeof sample.range === 'undefined' ? null : (\n                            <ASUIDiv title={`Key Range is ${sample.range}`} className=\"range\">\n                                <ASUIButton onAction={e => this.openMenuChangeKeyRange(e)} vertical openOnHover={false}>\n                                    {sample.range}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                        {typeof sample.loop === 'undefined' ? null : (\n                            <ASUIDiv title=\"Toggle Loop\" className=\"loop\">\n                                <ASUIButton title=\"\" onAction={e => this.changeLoop(!sample.loop)} arrow={false} vertical openOnHover={false}>\n                                    {sample.loop?'∞':'⇥'}\n                                </ASUIButton>\n                            </ASUIDiv>\n                        )}\n                    </>)\n                }\n                <ASUIDiv title={`Edit Sample '${sampleName}'`} className=\"config\">\n                    <ASUIButton onAction={e => this.openMenuRoot(e)} vertical openOnHover={false}>\n                        <ASUIIcon source=\"config\"/>\n                    </ASUIButton>\n                </ASUIDiv>\n            </ASUIDiv>\n        );\n    }\n\n\n    openMenu(e, options) {\n        if(typeof this.props.openMenu === \"function\")\n            this.props.openMenu(e, options);\n        else\n            throw new Error(\"Invalid 'openMenu' props\");\n    }\n\n    openMenuRoot(e) {\n        this.openMenu(e, <>\n            <ASUIMenuAction onAction={()=>{}} disabled>Sample {this.props.sampleID}</ASUIMenuAction>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown key=\"mixer\" onAction={e => this.openMenuChangeMixer(e)}>Edit Mixer</ASUIMenuDropDown>\n            <ASUIMenuDropDown key=\"detune\" onAction={e => this.openMenuChangeDetune(e)}>Edit Detune</ASUIMenuDropDown>\n            <ASUIMenuDropDown key=\"root\" onAction={e => this.openMenuChangeKeyRoot(e)}>Edit Key Root</ASUIMenuDropDown>\n            <ASUIMenuDropDown key=\"alias\" onAction={e => this.openMenuChangeKeyAlias(e)}>Edit Key Alias</ASUIMenuDropDown>\n            <ASUIMenuDropDown key=\"range\" onAction={e => this.openMenuChangeKeyRange(e)}>Edit Key Range</ASUIMenuDropDown>\n            <ASUIMenuDropDown key=\"loop\" onAction={e => this.openMenuChangeLoop(e)}>Toggle Loop</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown key=\"change\" onAction={e => this.openMenuChangeSample(e)}>Change Sample</ASUIMenuDropDown>\n            <ASUIMenuAction key=\"remove\" onAction={e => this.renderMenu('voice-remove')}>Remove Sample</ASUIMenuAction>\n        </>);\n    }\n\n    openMenuChangeSample(e) {\n        const sample = this.getSampleData();\n        this.openMenu(e, <ASUIInputRange min={0} max={100} value={sample.mixer} />);\n    }\n\n    openMenuChangeMixer(e) {\n        const sample = this.getSampleData();\n        this.openMenu(e, <ASUIInputRange\n            min={0}\n            max={100}\n            value={typeof sample.mixer !== \"undefined\" ? sample.mixer : 100}\n            onChange={(e, mixerValue) => this.changeMixer(mixerValue)}\n        />);\n    }\n\n    openMenuChangeDetune(e) {\n        const sample = this.getSampleData();\n        this.openMenu(e, <ASUIInputRange\n            min={-1000}\n            max={1000}\n            value={typeof sample.detune !== \"undefined\" ? sample.detune : 100}\n            onChange={(e, detuneValue) => this.changeDetune(detuneValue)}\n        />);\n    }\n\n    // TODO: use generic menu/value library\n    openMenuChangeKeyRoot(e) {\n        const values = this.getSong().values;\n        this.openMenu(e, <>\n            <ASUIMenuAction onAction={null} disabled>Edit Key Root</ASUIMenuAction>\n            <ASUIMenuBreak />\n            {values.getNoteOctaves((octave) =>\n                <ASUIMenuDropDown onAction={e => this.openMenu(e,\n                    values.getNoteFrequencies((noteName) =>\n                        <ASUIMenuAction onAction={e => this.changeRoot(noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                    )\n                )}>{octave}</ASUIMenuDropDown>)}\n        </>);\n    }\n\n    openMenuChangeKeyAlias(e) {\n        const values = this.getSong().values;\n        this.openMenu(e, <>\n            <ASUIMenuAction onAction={null} disabled>Edit Key Root</ASUIMenuAction>\n            <ASUIMenuBreak />\n            {values.getNoteOctaves((octave) =>\n                <ASUIMenuDropDown onAction={e => this.openMenu(e,\n                    values.getNoteFrequencies((noteName) =>\n                        <ASUIMenuAction onAction={e => this.changeAlias(noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                    )\n                )}>{octave}</ASUIMenuDropDown>)}\n        </>);\n    }\n\n    openMenuChangeKeyRange(e) {\n        this.openMenu(e, );\n    }\n\n    openMenuChangeLoop(e) {\n        this.openMenu(e, );\n    }\n\n\n\n    renderMenu(menuKey=null) {\n        // const voice = this.getSampleData();\n        const values = this.getSong().values;\n        switch(menuKey) {\n            case 'voice-loop':\n            case 'voice-remove':\n            case null:\n                return ;\n\n            case 'voice-change':\n                return <>\n\n                </>;\n\n            case 'voice-mixer':\n                return <>\n\n                    <ASUIMenuBreak />\n                    <ASUIMenuAction onAction={null} disabled>Edit Mixer</ASUIMenuAction>\n                </>;\n\n            case 'voice-detune':\n                return <>\n\n                    <ASUIMenuBreak />\n                    <ASUIMenuAction onAction={null} disabled>Edit Detune</ASUIMenuAction>\n                </>;\n\n            case 'voice-root':\n                return <>\n                    <ASUIMenuAction onAction={null} disabled>Edit Key Root</ASUIMenuAction>\n                    <ASUIMenuBreak />\n                    {values.getNoteOctaves((octave) =>\n                    <ASUIMenuAction onAction={\n                        () => values.getNoteFrequencies((noteName) =>\n                            <ASUIMenuAction onAction={e => this.changeRoot(noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                        )\n                    }>{octave}</ASUIMenuAction>)}\n                </>;\n\n            case 'voice-alias':\n                return <>\n                    <ASUIMenuAction onAction={null} disabled>Edit Key Alias</ASUIMenuAction>\n                    <ASUIMenuBreak />\n                    {values.getNoteOctaves((octave) =>\n                    <ASUIMenuAction onAction={\n                        () => values.getNoteFrequencies((noteName) =>\n                            <ASUIMenuAction onAction={e => this.changeAlias(noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                        )\n                    }>{octave}</ASUIMenuAction>)}\n                </>;\n\n            case 'voice-range':\n                return <>\n                    <ASUIMenuAction onAction={null} disabled>Edit Key Range</ASUIMenuAction>\n                    <ASUIMenuBreak />\n                    <ASUIMenuAction onAction={e => this.renderMenu('voice-range-start')} >Set Range Start</ASUIMenuAction>\n                    <ASUIMenuAction onAction={e => this.renderMenu('voice-range-end')} >Set Range End</ASUIMenuAction>\n                </>;\n\n            case 'voice-range-start':\n                return (<>\n                    <ASUIMenuAction onAction={null} disabled>Range Start</ASUIMenuAction>\n                    <ASUIMenuBreak />\n                    {values.getNoteOctaves((octave) =>\n                        <ASUIMenuAction onAction={\n                            () => values.getNoteFrequencies((noteName) =>\n                                <ASUIMenuAction onAction={e => this.changeRange(noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                            )\n                        }>{octave}</ASUIMenuAction>)}\n                </>);\n\n            case 'voice-range-end':\n                return (<>\n                    <ASUIMenuAction onAction={null} disabled>Range End</ASUIMenuAction>\n                    <ASUIMenuBreak />\n                    {values.getNoteOctaves((octave) =>\n                        <ASUIMenuAction onAction={\n                            () => values.getNoteFrequencies((noteName) =>\n                                <ASUIMenuAction onAction={e => this.changeRange(null, noteName+octave)}    >{noteName+octave}</ASUIMenuAction>\n                            )\n                        }>{octave}</ASUIMenuAction>)}\n                </>);\n\n\n\n            default:\n                throw new Error(\"Unknown menu key: \" + menuKey);\n        }\n\n    }\n\n\n    toggleOpen(e) {\n        this.setState({open: !this.state.open})\n    }\n\n    changeMixer(newMixerValue) {\n        if(!Number.isInteger(newMixerValue))\n            throw new Error(\"Invalid mixer value type: \" + typeof newMixerValue);\n        this.config.samples[this.getSampleID()].mixer = newMixerValue;\n    }\n\n    changeDetune(newDetuneValue) {\n        if(!Number.isInteger(newDetuneValue))\n            throw new Error(\"Invalid detune value type: \" + typeof newDetuneValue);\n        this.config.samples[this.getSampleID()].detune = newDetuneValue;\n    }\n\n    changeRoot(newRootValue) {\n        this.config.samples[this.getSampleID()].root = newRootValue;\n    }\n\n    changeAlias(newAliasValue) {\n        this.config.samples[this.getSampleID()].alias = newAliasValue;\n    }\n\n    changeLoop(newLoopValue=null) {\n        if(newLoopValue === null)\n            newLoopValue = !this.getSampleData().loop;\n        this.config.samples[this.getSampleID()].loop = newLoopValue?1:0;\n    }\n\n}\n\nexport default AudioBufferInstrumentRenderer;\n","import React from 'react';\n\n\nimport \"./assets/AudioBufferInstrumentRenderer.css\";\n\n/** PolyphonyInstrumentRenderer **/\nclass AudioBufferInstrumentRendererStyle extends React.Component {\n\n}\n\nexport default AudioBufferInstrumentRendererStyle;\n","export default class PeriodicWaveLoader {\n    constructor(audioContext) {\n        this.audioContext = audioContext;\n    }\n\n    isPeriodicWaveAvailable(url) {\n        return !!PeriodicWaveLoader.waveURLCache[url];\n    }\n    getCachedPeriodicWaveFromURL(url) {\n        return PeriodicWaveLoader.waveURLCache[url];\n    }\n\n    async loadPeriodicWaveFromURL(url) {\n        if(PeriodicWaveLoader.waveURLCache[url])\n            return PeriodicWaveLoader.waveURLCache[url];\n\n        // TODO Use file service\n        const response = await fetch(url);\n        const waveData = await response.json();\n        if (!waveData.real)\n            throw new Error(\"Invalid 'real' data for createPeriodicWave\");\n        if (!waveData.imag)\n            throw new Error(\"Invalid 'imag' data for createPeriodicWave\");\n\n        return PeriodicWaveLoader.waveURLCache[url] = this.audioContext.createPeriodicWave(\n            new Float32Array(waveData.real),\n            new Float32Array(waveData.imag)\n        );\n\n        // throw new Error(\"Periodic wave was not found\");\n    }\n\n\n    /** Static **/\n\n    static waveURLCache = {};\n}\n","import PeriodicWaveLoader from \"../loader/PeriodicWaveLoader\";\n\n\nclass OscillatorInstrument {\n    constructor(config={}) {\n        // console.log('OscillatorInstrument', config);\n        this.config = config;\n    }\n\n    /** Effect **/\n\n    useDestination(oldDestination) {\n        return null; // Null is no effect processing\n    }\n\n    /** Playback **/\n\n    playFrequency(destination, frequency, startTime, duration, velocity, onended=null) {\n        const audioContext = destination.context;\n        const waveLoader = new PeriodicWaveLoader(audioContext);\n\n\n        // TODO: Detect config changes on the fly. Leave caching to browser. Destination cache?\n\n        // console.log('playFrequency', destination, frequency, startTime, duration, velocity)\n\n\n        //         // Filter voice playback\n        //         if (voiceConfig.alias) {\n        //             if(voiceConfig.alias !== commandFrequency)\n        //                 // if(voiceConfig.name !== namedFrequency)\n        //                 continue;\n        //         } else {\n        //             frequencyValue = this.getCommandFrequency(commandFrequency);\n        //         }\n        //\n        //         if (voiceConfig.keyLow && this.getCommandFrequency(voiceConfig.keyLow) > frequencyValue)\n        //             continue;\n        //         if (voiceConfig.keyHigh && this.getCommandFrequency(voiceConfig.keyHigh) < frequencyValue)\n        //             continue;\n\n        // Velocity\n//         console.log('velocity', velocity);\n        if(velocity !== null) {\n            let velocityGain = destination.context.createGain();\n            velocityGain.gain.value = parseFloat(velocity || 127) / 127;\n            velocityGain.connect(destination);\n            destination = velocityGain;\n        }\n\n        const osc = destination.context.createOscillator();   // instantiate an oscillator\n        osc.frequency.value = frequency;    // set Frequency (hz)\n        if (typeof this.config.detune !== \"undefined\")\n            osc.detune.value = this.config.detune;\n\n        switch(this.config.type) {\n            default:\n                osc.type = this.config.type;\n                break;\n\n            // case null:\n            case 'custom':\n                if(!this.config.url)\n                    throw new Error(\"Custom osc requires a url\");\n                if(waveLoader.isPeriodicWaveAvailable(this.config.url)) {\n                    osc.setPeriodicWave(waveLoader.getCachedPeriodicWaveFromURL(this.config.url))\n                } else {\n                    waveLoader.loadPeriodicWaveFromURL(this.config.url)\n                        .then(periodicWave => osc.setPeriodicWave(periodicWave));\n                }\n                break;\n        }\n\n        osc.connect(destination);\n        osc.start(startTime);\n        osc.stop(startTime + duration);\n\n        OscillatorInstrument.playingOSCs.push(osc);\n        osc.onended = function() {\n            const i = OscillatorInstrument.playingOSCs.indexOf(osc);\n            if(i !== -1)\n                OscillatorInstrument.playingOSCs.splice(i, 1);\n            onended && onended();\n        };\n\n    }\n\n\n\n    /** Static **/\n\n    static playingOSCs = [];\n\n    static stopPlayback() {\n        // Stop all active sources\n        //     console.log(\"this.playingOSCs\", this.playingOSCs);\n        for (let i = 0; i < this.playingOSCs.length; i++) {\n            try {\n                this.playingOSCs[i].stop();\n            } catch (e) {\n                console.warn(e);\n            }\n        }\n        this.playingOSCs = [];\n    }\n\n\n    static waveURLCache = {};\n\n    static unloadAll() {\n        this.waveURLCache = {}\n        // Unload all cached samples from this program type\n    }\n}\n\nexport default OscillatorInstrument;\n","import {ASUIMenuAction, ASUIMenuBreak, ASUIMenuDropDown} from \"../../components/menu\";\nimport React from \"react\";\nimport ProgramLoader from \"../../common/program/ProgramLoader\";\n\nclass Library {\n\n    getTitle() {\n        return this.constructor.name;\n    }\n\n    getLibraries() {\n        return [];\n    }\n\n\n    getPresets() {\n        return [];\n    }\n\n\n    /** Shortcuts **/\n\n\n    supportsProgram(programClassName) {\n        const presets = this.getPresets();\n        for(let i=0; i<presets.length; i++) {\n            const [className] = presets[i];\n            if(className === programClassName)\n                return true;\n        }\n        return false;\n    }\n\n    /** Menu **/\n\n\n    renderMenuProgramAll(onSelectPreset, programClass=null) {\n        return (<>\n            <ASUIMenuDropDown options={() => this.renderMenuProgramNew(onSelectPreset, programClass)}>New Program</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown options={() => this.renderMenuProgramAllPresets(onSelectPreset, programClass, true)}>Using Preset</ASUIMenuDropDown>\n        </>);\n    }\n\n    renderMenuProgramNew(onSelectPreset) {\n        return (<>\n            {ProgramLoader.getRegisteredPrograms().map((config, i) =>\n                <ASUIMenuAction key={i} onAction={e => onSelectPreset(config.className)}>{config.title || 'Untitled Preset #' + i}</ASUIMenuAction>\n            )}\n        </>);\n    }\n\n    renderMenuProgramAllPresets(onSelectPreset, programClass=null, includeRecent=true) {\n        return (<>\n            {includeRecent && false ? <ASUIMenuDropDown\n                disabled={true}\n                options={() => this.renderMenuProgramRecentPresets(onSelectPreset, programClass)}>\n                Recent Presets\n            </ASUIMenuDropDown> : null}\n            {includeRecent && Library.lastSelectedLibrary ? <ASUIMenuDropDown\n                disabled={Library.lastSelectedLibrary.getPresets().length === 0}\n                options={() => Library.lastSelectedLibrary.renderMenuProgramPresets(onSelectPreset, programClass)}>\n                Current Library\n            </ASUIMenuDropDown> : null }\n            <ASUIMenuDropDown\n                disabled={this.getPresets().length === 0}\n                options={() => this.renderMenuProgramPresets(onSelectPreset, programClass)}>\n                Presets\n            </ASUIMenuDropDown>\n            <ASUIMenuDropDown\n                disabled={this.getLibraries().length === 0}\n                options={() => this.renderMenuLibraryOptions(library =>\n                    library.renderMenuProgramAllPresets(onSelectPreset, programClass, false)\n                    , programClass)}>\n                Other Libraries\n            </ASUIMenuDropDown>\n        </>);\n    }\n\n\n    renderMenuProgramRecentPresets(onSelectPreset, programClass=null) {\n        // let recentLibrary = Library.lastSelectedLibrary; // TODO: move to state?\n        return (<>\n            <ASUIMenuAction onAction={()=>{}} disabled>{this.getTitle()}</ASUIMenuAction>\n            <ASUIMenuBreak />\n            {this.getPresets().map(([className, presetConfig], i) => {\n                return programClass === null || programClass === className\n                    ? <ASUIMenuAction key={i} onAction={e => onSelectPreset(className, presetConfig)}>{presetConfig.title || 'Untitled Preset #' + i}</ASUIMenuAction>\n                    : null;\n            })}\n        </>);\n    }\n\n\n    renderMenuProgramPresets(onSelectPreset, programClass=null) {\n        return (<>\n            <ASUIMenuAction onAction={()=>{}} disabled>{this.getTitle()}</ASUIMenuAction>\n            <ASUIMenuBreak />\n            {this.getPresets().map(([className, presetConfig], i) => {\n                return programClass === null || programClass === className\n                    ? <ASUIMenuAction key={i} onAction={e => onSelectPreset(className, presetConfig)}>{presetConfig.title || 'Untitled Preset #' + i}</ASUIMenuAction>\n                    : null;\n            })}\n        </>);\n    }\n\n    renderMenuLibraryOptions(onSelectLibraryOptions, programClass=null) {\n        return this.getLibraries().map((library, i) => {\n            // if (programClass !== null && !library.supportsProgram(programClass))\n            //     return null;\n            return (\n                <ASUIMenuDropDown key={i++}\n                                  options={() => {\n                                  Library.lastSelectedLibrary = library;\n                                  return onSelectLibraryOptions(library);\n                              }}>\n                    {library.getTitle()}\n                </ASUIMenuDropDown>\n            );\n        });\n    }\n\n    // renderMenuProgramLibraryPresets(onSelectPreset, programClass=null) {\n    //     return this.renderMenuLibraryOptions(programClass, library =>\n    //         library.renderSubMenuProgramPresets(onSelectPreset, programClass)\n    //     );\n    // }\n\n    // constructor(title=null) {\n    // this.title = title || this.constructor.name;\n    // this.baseURL = baseURL || document.location;\n    // ['libraries', 'samples', 'presets']\n    //     .forEach(key => {\n    //         if(!this.data[key])\n    //             this.data[key] = []\n    //     });\n    // if(!this.data.url)\n    //     this.data.url = document.location.toString();\n    // this.data.url = null;\n    // this.data.urlPrefix = '';\n    // this.name = \"Loading...\";\n    // this.libraries = [];\n    // this.programs = {};\n    // this.presets = [];\n    // this.samples = [];\n    // Object.assign(this, data);\n    // }\n\n    // load(data) {\n    //     Object.assign(this, data);\n    // }\n\n    // getPrograms() { return this.data.programs || []; }\n\n\n    // getPresetConfig(presetName, presetConfig={}) {\n    //     let presetData = this.getPresets().find(p => p.name = presetName)\n    //         || (()=>{ throw new Error(\"Could not find preset config for: \" + presetName);})();\n    //\n    //     const samples = presetData.samples || [];\n    //     for(let i=0; i<samples.length; i++) {\n    //         samples[i] = this.getSampleConfig(samples[i]);\n    //     }\n    //     presetConfig.presetName = presetName;\n    //     presetConfig.samples = samples;\n    //\n    //     return presetConfig;\n    // }\n\n    /** @var Library **/\n    static lastSelectedLibrary = null;\n\n    static historicLibraryCount() {\n        return Object.values(Library.cache).length;\n    };\n\n    static eachHistoricLibrary(callback) {\n        const results = [];\n        for (let cacheURL in Library.cache) {\n            if (Library.cache.hasOwnProperty(cacheURL)) {\n                let libraryConfig = Library.cache[cacheURL];\n                if (libraryConfig instanceof Promise)\n                    continue;\n                // libraryConfig = await libraryConfig;\n                libraryConfig.name = libraryConfig.name || libraryConfig.url.split('/').pop();\n                const result = callback(libraryConfig);\n                if (result === false)\n                    break;\n                if (result !== null)\n                    results.push(result);\n            }\n        }\n        return results;\n    }\n\n    static loadDefault() {\n        const defaultLibrary = require(\"../../default.library.js\").default;\n        return new defaultLibrary();\n    };\n\n    /**\n     * @param url\n     * @returns {Promise<Library>}\n     */\n    static async loadFromURL(url) {\n        if (!url)\n            throw new Error(\"Invalid url\");\n        const response = await fetch(url);\n        const libraryData = await response.json();\n        if (typeof libraryData.url === \"undefined\")\n            libraryData.url = url.toString();\n        console.log('library', libraryData);\n        return new Library(libraryData);\n    }\n\n    static async loadFromURL2(url) {\n        if (!url)\n            throw new Error(\"Invalid url\");\n        url = new URL((url.toString()).split('#')[0], document.location).toString();\n\n        let libraryData;\n        if (!Library.cache[url]) {\n            Library.cache[url] = new Promise((resolve, reject) => {\n                const xhr = new XMLHttpRequest();\n                xhr.open('GET', url.toString(), true);\n                xhr.responseType = 'json';\n                xhr.onload = () => {\n                    if (xhr.status !== 200)\n                        return reject(\"Sample library not found: \" + url);\n\n                    const libraryData = xhr.response;\n                    libraryData.url = url.toString();\n\n                    Object.keys(Library.cache).forEach(cacheURL => {\n                        if (Object.values(Library.cache) > 5)\n                            delete Library.cache[cacheURL];\n                    });\n                    Library.cache[url] = libraryData;\n\n                    console.info(\"Sample Library Loaded: \", url, Library.cache);\n                    resolve(libraryData);\n                };\n                xhr.send();\n            });\n        }\n        libraryData = Library.cache[url];\n        if (libraryData instanceof Promise)\n            libraryData = await libraryData;\n        return new Library(libraryData);\n    }\n\n}\n\n\n// /** @returns {Promise<Library>} */\n// Library.loadDefaultLibrary = async function() {\n//     return await Library.loadFromURL(Library.defaultLibraryURL);\n// };\nLibrary.cache = {};\nexport default Library;\n","import React from 'react';\n\nimport \"./assets/OscillatorInstrumentRenderer.css\";\nimport OscillatorInstrumentRendererBase from \"./OscillatorInstrumentRendererBase\";\nimport {ASUIIcon, ASUIMenuDropDown} from \"../../../../components\";\n\nclass OscillatorInstrumentRenderer extends OscillatorInstrumentRendererBase {\n\n    render() {\n        let className = \"instrument-renderer-oscillator-node\";\n        if(this.state.open)\n            className += ' open';\n        let title = this.getTitle();\n\n\n        return <div className={className}>\n            <div\n                className=\"title\"\n                title={`Oscillator: ${title}`}\n                onClick={this.cb.onClick}\n            >\n                {title}\n            </div>\n            {this.renderParameters()}\n            <ASUIMenuDropDown\n                arrow={false}\n                className=\"config\"\n                options={() => this.renderMenuRoot()}\n            >\n                <ASUIIcon source=\"config\"/>\n            </ASUIMenuDropDown>\n        </div>;\n    }\n}\nexport default OscillatorInstrumentRenderer;\n","import React from 'react';\nimport {\n    ASUIMenuAction,\n    ASUIMenuBreak,\n    ASUIInputRange,\n    ASUIMenuDropDown,\n} from \"../../../../components\";\nimport Library from \"../../../../song/library/Library\";\nimport Values from \"../../../../common/values/Values\";\n\n\nclass OscillatorInstrumentRendererBase extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false\n        };\n        this.cb = {\n            onClick: e => this.toggleOpen(),\n        };\n        this.library = Library.loadDefault();\n    }\n\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if(!this.props.config.type) {\n            console.warn(\"No default oscillator type was set. Setting to 'sawtooth'\");\n            this.props.config.type = 'sawtooth';\n        }\n    }\n\n    getTitle() {\n        return this.props.config.title\n            || this.props.config.type\n            || \"Unknown Osc\";\n    }\n\n\n    renderParameters() {\n        if(!this.state.open)\n            return [];\n        const config = this.props.config;\n        return (<>\n            <ASUIMenuDropDown title=\"Edit Mixer\"\n                              className=\"mixer\"\n                              options={() => this.renderMenuChangeMixer()}\n                              arrow={false}\n                              vertical>\n                {typeof config.mixer !== \"undefined\" ? config.mixer+'%' : '100%'}\n            </ASUIMenuDropDown>\n            <ASUIMenuDropDown title={`Detune by ${config.detune} cents`}\n                              className=\"detune\"\n                              options={() => this.renderMenuChangeDetune()}\n                              arrow={false}\n                              vertical>\n                {typeof config.detune !== \"undefined\" ? config.detune+'c' : '0c'}\n            </ASUIMenuDropDown>\n            {config.root ? <ASUIMenuDropDown title={`Key Root is ${config.root}`}\n                                             className=\"root\"\n                                             options={() => this.renderMenuChangeKeyRoot()}\n                                             arrow={false}\n                                             vertical>\n                {config.root ? config.root : \"-\"}\n            </ASUIMenuDropDown> : null}\n            {config.alias ? <ASUIMenuDropDown title={`Key Alias is ${config.alias}`}\n                                              className=\"alias\"\n                                              options={() => this.renderMenuChangeKeyAlias()}\n                                              arrow={false}\n                                              vertical>\n                {config.alias ? config.alias : \"-\"}\n            </ASUIMenuDropDown> : null}\n            {config.range ? <ASUIMenuDropDown title={`Key Range is ${config.range}`}\n                                              className=\"range\"\n                                              options={() => this.renderMenuChangeKeyRange()}\n                                              arrow={false}\n                                              vertical>\n                {config.range ? config.range : \"-\"}\n            </ASUIMenuDropDown> : null}\n            <ASUIMenuAction\n                    className=\"loop\"\n                    title=\"Toggle Loop\"\n                    onAction={e => this.changeLoop(!config.loop)}\n                    arrow={false}\n                    vertical>\n                    {config.loop?'∞':'1'}\n            </ASUIMenuAction>\n        </>);\n    }\n\n\n    /** Actions **/\n\n    toggleOpen() {\n        this.setState({open: !this.state.open});\n    }\n\n    changeMixer(newMixerValue) {\n        if(!Number.isInteger(newMixerValue))\n            throw new Error(\"Invalid mixer value type: \" + typeof newMixerValue);\n        this.props.config.mixer = newMixerValue;\n    }\n\n    changeDetune(newDetuneValue) {\n        if(!Number.isInteger(newDetuneValue))\n            throw new Error(\"Invalid detune value type: \" + typeof newDetuneValue);\n        this.props.config.detune = newDetuneValue;\n    }\n\n    changeRoot(newRootValue) {\n        this.props.config.root = newRootValue;\n    }\n\n    changeAlias(newAliasValue) {\n        this.props.config.alias = newAliasValue;\n    }\n\n\n    changeOscillator(newType) {\n        if(newType === 'custom') {\n        } else {\n            delete this.props.config.url;\n            delete this.props.config.real;\n            delete this.props.config.imag;\n            delete this.props.config.title;\n            this.props.config.type = newType;\n        }\n    }\n\n    changeLoop(newLoopValue=null) {\n        if(newLoopValue === null)\n            newLoopValue = !this.props.config.loop;\n        this.props.config.loop = newLoopValue?1:0;\n    }\n\n    loadPreset(preset) {\n        console.log(\"Loading preset: \", preset);\n        preset.type = 'custom';\n        Object.assign(this.props.config, preset);\n    }\n\n    /** Menus **/\n\n    renderMenuRoot() {\n        return (<>\n            <ASUIMenuAction onAction={()=>{}} disabled>Oscillator: {this.getTitle()}</ASUIMenuAction>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown options={() => this.renderMenuChangeOscillator()}>Change Oscillator</ASUIMenuDropDown>\n            <ASUIMenuBreak />\n            <ASUIMenuDropDown options={() => this.renderMenuChangeMixer()}>Edit Mixer</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeDetune()}>Edit Detune</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeKeyRoot()}>Edit Key Root</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeKeyAlias()}>Edit Key Alias</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeKeyRange()}>Edit Key Range</ASUIMenuDropDown>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeLoop()}>Toggle Loop</ASUIMenuDropDown>\n            <ASUIMenuAction disabled={!this.props.onRemove} onAction={(e) => this.props.onRemove(this.props.instrumentID)}>Remove Oscillator</ASUIMenuAction>\n        </>);\n    }\n\n    renderMenuChangeOscillator() {\n        return (<>\n            <ASUIMenuDropDown options={() => this.renderMenuChangeOscillatorStandard()}>Standard</ASUIMenuDropDown>\n            {/*<MenuDropDown options={() => this.renderMenuChangeOscillator('custom')}>Custom</MenuDropDown>*/}\n            <ASUIMenuBreak/>\n            {this.library.renderMenuProgramAllPresets(([className, presetConfig]) => {\n                this.loadPreset(className, presetConfig);\n            })}\n        </>);\n    }\n\n    renderMenuChangeOscillatorStandard() {\n        return (<>\n            <ASUIMenuAction onAction={e => this.changeOscillator('sine')}>Sine</ASUIMenuAction>\n            <ASUIMenuAction onAction={e => this.changeOscillator('square')}>Square</ASUIMenuAction>\n            <ASUIMenuAction onAction={e => this.changeOscillator('sawtooth')}>Sawtooth</ASUIMenuAction>\n            <ASUIMenuAction onAction={e => this.changeOscillator('triangle')}>Triangle</ASUIMenuAction>\n        </>);\n    }\n\n\n\n    renderMenuChangeMixer() {\n        const config = this.props.config;\n        return <ASUIInputRange\n            min={0}\n            max={100}\n            value={typeof config.mixer !== \"undefined\" ? config.mixer : 100}\n            onChange={(e, mixerValue) => this.changeMixer(mixerValue)}\n        />;\n    }\n\n    renderMenuChangeDetune() {\n        const config = this.props.config;\n        return ( <ASUIInputRange\n            min={-1000}\n            max={1000}\n            value={typeof config.detune !== \"undefined\" ? config.detune : 100}\n            onChange={(e, detuneValue) => this.changeDetune(detuneValue)}\n        />);\n    }\n\n    renderMenuChangeKeyRoot() {\n        return Values.renderMenuSelectCommand(noteNameOctave => {\n            this.changeRoot(noteNameOctave)\n        });\n    }\n\n    renderMenuChangeKeyAlias() {\n        return Values.renderMenuSelectCommand(noteNameOctave => {\n            this.changeAlias(noteNameOctave)\n        });\n    }\n\n\n    renderMenuChangeKeyRange() {\n        return (<>TODO</>);\n    }\n\n    renderMenuChangeLoop() {\n        return (<>TODO</>);\n    }\n}\n\nexport default OscillatorInstrumentRendererBase;\n","import ProgramLoader from \"../../../common/program/ProgramLoader\";\n// import Values from \"../../song/Values\";\n\nclass PolyphonyInstrument {\n    constructor(config={}) {\n        this.config = config;\n    }\n\n    /** Loading **/\n\n    loadVoice(voiceID) {\n        if(!this.config.voices[voiceID])\n            throw new Error(\"Voice config is missing: \" + voiceID);\n        const [voiceClassName, voiceConfig] = this.config.voices[voiceID];\n        let {classProgram:voiceClass} = ProgramLoader.getProgramClassInfo(voiceClassName);\n        return new voiceClass(voiceConfig);\n    }\n\n\n    /** Playback **/\n\n    playFrequency(destination, frequency, startTime, duration, velocity=null, onended=null) {\n        for (let i = 0; i < this.config.voices.length; i++) {\n            const voice = this.loadVoice(i);\n            voice.playFrequency(destination, frequency, startTime, duration, velocity, onended);\n        }\n    }\n\n    stopPlayback() {\n        // Stop all active sources\n//             console.log(\"activeSources!\", this.activeSources);\n        for (let i = 0; i < this.config.voices.length; i++) {\n            try {\n                const voice = this.loadVoice(i);\n                voice.stopPlayback(); // TODO: hacky?\n            } catch (e) {\n                console.warn(e);\n            }\n        }\n\n    }\n\n    /** Static **/\n\n    unloadAll() {\n        // Unload all cached samples from this program type\n    }\n\n\n\n}\n\n\nexport default PolyphonyInstrument;\n\n","import React from 'react';\n\nimport \"./PolyphonyInstrumentRenderer.css\";\nimport PolyphonyInstrumentRendererBase from \"./PolyphonyInstrumentRendererBase\";\nimport {ASUIButtonDropDown} from \"../../../../components\";\nimport {ProgramLoader} from \"../../../../common/program\";\n\n/** PolyphonyInstrumentRenderer **/\nexport default class PolyphonyInstrumentRenderer extends PolyphonyInstrumentRendererBase {\n\n    render() {\n        const voices = this.props.config.voices;\n//         console.log('voices', voices);\n        // Presets are handled by composer\n        return (\n            <div className=\"polyphony-instrument-renderer\">\n                <div className=\"voices\">\n                    {voices.map((voiceData, voiceID) => {\n                        const [className, config] = voiceData;\n                        const {classRenderer: Renderer} = ProgramLoader.getProgramClassInfo(className);\n                        return <Renderer\n                            onRemove={this.cb.onRemove}\n                            key={voiceID}\n                            instrumentID={voiceID}\n                            config={config}\n                        />\n                    })}\n                </div>\n                <ASUIButtonDropDown\n                    title=\"Add new voice\"\n                    className=\"add-voice\"\n                    arrow={false}\n                    options={() => this.renderMenuAddVoice()}>\n                    +\n                </ASUIButtonDropDown>\n            </div>\n        );\n\n    }\n\n}\n","import React from 'react';\n\nimport {\n    ASUIMenuAction, ASUIMenuBreak,\n} from \"../../../../components\";\n\nimport ProgramLoader from \"../../../../common/program/ProgramLoader\";\nimport Library from \"../../../../song/library/Library\";\nimport PromptManager from \"../../../../common/prompt/PromptManager\";\n\n/** PolyphonyInstrumentRenderer **/\nclass PolyphonyInstrumentRendererBase extends React.Component {\n    constructor(props) {\n        super(props);\n        this.cb = {\n            onRemove: (voiceID) => this.removeVoice(voiceID),\n            onAction: (e) => this.addVoice()\n        }\n    }\n\n    /** Actions **/\n\n    // TODO: Use Context Consumer/Provider for status/error callbacks\n    setStatus(message) { console.info(this.constructor.name, 'setStatus', message); }\n    setError(message) { console.error(this.constructor.name, 'setStatus', message); }\n\n    wrapVoiceWithNewInstrument(voiceID) {\n\n    }\n\n    async addVoice(instrumentClassName, promptUser=true) {\n        if (!instrumentClassName)\n            throw new Error(`Invalid voice instrument class`);\n        const {title} = ProgramLoader.getProgramClassInfo(instrumentClassName);\n        const instrumentConfig = {};\n        // instrumentConfig = InstrumentLoader.createInstrumentConfig(instrumentClassName, instrumentConfig);\n        // instrumentConfig.libraryURL = this.defaultLibraryURL;\n        // instrumentConfig.name = instrumentConfig.name || instrumentURL.split('/').pop();\n\n//         e.target.form.elements['instrumentURL'].value = '';\n        if (promptUser === false || await PromptManager.openConfirmDialog(`Add voice class '${title}' to Instrument?`)) {\n            const newVoiceID = this.props.config.voices.length;\n            this.props.config.voices[newVoiceID] = [instrumentClassName, instrumentConfig];\n            this.setStatus(`Instrument '${instrumentClassName}' added as voice ${newVoiceID}`);\n\n        } else {\n            this.setError(`New voice canceled: ${instrumentClassName}`);\n        }\n\n    }\n\n    renameVoice(voiceID, newTitle) {\n\n    }\n\n    removeVoice(voiceID) {\n        const voices = this.props.config.voices;\n        if(typeof voices[voiceID] === \"undefined\")\n            throw new Error(\"Voice ID not found: \" + voiceID);\n        voices.splice(voiceID, 1);\n    }\n\n    /** Menu **/\n\n    renderMenuAddVoice() {\n        const library = Library.loadDefault();\n        return (<>\n            <ASUIMenuAction disabled action={()=>{}}>Add new voice instrument</ASUIMenuAction>\n            <ASUIMenuBreak/>\n            {library.songLengthAllPresets(([className, presetConfig]) => {\n                this.addVoice(className, presetConfig);\n            })}\n        </>)\n        // return Values.renderMenuSelectAvailableInstrument((instrumentClass) => {\n        //     this.addVoice(instrumentClass);\n        // }, \"Add new program as voice\")\n    }\n}\n\nexport default PolyphonyInstrumentRendererBase;\n","import FileService from \"../../../song/file/FileService\";\nimport GMESongFile from \"../../../song/file/GMESongFile\";\n\nlet libGMESupport = null;\nclass GMEPlayerSynthesizer {\n    constructor(config={}) {\n        this.config = config;\n        if(libGMESupport === null) {\n            libGMESupport = new GMESongFile();\n            libGMESupport.init();\n        }\n    }\n\n    connect(destination) {\n\n    }\n\n    async loadBuffer() {\n        if(!this.fileBuffer) {\n            const src = this.config.fileURL;\n            const service = new FileService();\n            this.fileBuffer = service.loadBufferFromURL(src);\n            console.info(\"SPC ASPlayer loaded\");\n        }\n        if(this.fileBuffer instanceof Promise)\n            this.spcBuffer = await this.spcBuffer;\n        return this.fileBuffer;\n    }\n\n    async loadGMEPlayer(destination) {\n        const buffer = await this.loadBuffer();\n        return libGMESupport.loadPlayerFromBuffer(destination.context, destination, buffer, 'file', {\n            destination\n        });\n    }\n\n    /** Initializing Audio **/\n\n    async init(audioContext) {\n        this.audioContext = audioContext;\n        if (this.config.fileURL)\n            await this.loadBuffer();\n        console.info(\"SPC ASPlayer initialized\");\n    }\n\n    /** Playback **/\n\n\n    // Instruments return promises\n    async play(destination, namedFrequency, startTime, duration, velocity) {\n        const spcPlayer = await this.loadGMEPlayer(destination);\n        this.spcPlayers.push(spcPlayer);\n\n        let currentTime = destination.context.currentTime;\n        startTime = startTime !== null ? startTime : currentTime;\n        if(startTime > currentTime) {\n            const waitTime = startTime - currentTime;\n            await new Promise((resolve, reject) => setTimeout(resolve, waitTime * 1000));\n        }\n        // const commandFrequency = this.getFrequencyFromAlias(namedFrequency) || namedFrequency;\n        // const max = spcPlayer.getMaxPlaybackPosition();\n        if(startTime < currentTime) {\n            const seekPos = (currentTime - startTime) * 1000;\n            spcPlayer.seekPlaybackPosition(seekPos);\n        }\n        spcPlayer.play(destination);\n\n        if(duration) {\n            const waitTime = (startTime + duration) - destination.context.currentTime;\n            await new Promise((resolve, reject) => setTimeout(resolve, waitTime * 1000));\n            spcPlayer.pause();\n        }\n    }\n\n    stopPlayback() {\n        for(let i=0; i<this.spcPlayers.length; i++) {\n            // this.spcPlayers[i].stop();\n            this.spcPlayers[i].pause();\n        }\n        // this.spcPlayer.stop();\n\n    }\n\n    getFrequencyFromAlias(aliasName) {\n        return null;\n    }\n\n    getCommandFrequency(command) {\n        const keyNumber = this.getCommandKeyNumber(command);\n        return 440 * Math.pow(2, (keyNumber - 49) / 12);\n    }\n\n    getCommandKeyNumber(command) {\n        if (Number(command) === command && command % 1 !== 0)\n            return command;\n        if (!command)\n            return null;\n\n        const noteCommands = this.noteFrequencies; // ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#'];\n        let octave = command.length === 3 ? command.charAt(2) : command.charAt(1),\n            keyNumber = noteCommands.indexOf(command.slice(0, -1));\n        if (keyNumber < 3) keyNumber = keyNumber + 12 + ((octave - 1) * 12) + 1;\n        else keyNumber = keyNumber + ((octave - 1) * 12) + 1;\n        return keyNumber;\n    }\n\n\n    get noteFrequencies() {\n        return ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#'];\n    }\n\n    // get instrumentID() {\n    //     return this.getAttribute('data-id');\n    // }\n\n    // render(renderObject=null) {\n    //     if(renderObject instanceof HTMLElement && renderObject.matches('asui-div')) {\n    //         this.form = new GMEPlayerFormRenderer(renderObject, this);\n    //     } else {\n    //         throw new Error(\"Unknown renderer\");\n    //     }\n    // }\n\n\n}\n\n\n\n\n\n/**\n * Used for all Instrument UI. Instance not necessary for song playback\n */\n// class GMEPlayerRenderer {\n//\n//     /**\n//      *\n//      * @param {AudioSourceComposerForm} instrumentForm\n//      * @param programs\n//      */\n//     constructor(instrumentForm, programs) {\n//         this.form = instrumentForm;\n//         this.programs = programs;\n//         const root = instrumentForm.getRootNode() || document;\n//         this.appendCSS(root);\n//         this.render();\n//     }\n//\n//     // get DEFAULT_SAMPLE_LIBRARY_URL() {\n//     //     return getScriptDirectory('default.library.json');\n//     // }\n//\n//\n//\n// //     appendCSS(rootElm) {\n// //\n// //         // Append Instrument CSS\n// //         const PATH = 'programs/chip/spc-player-synthesizer.css';\n// //         const linkHRef = getScriptDirectory(PATH);\n// // //             console.log(rootElm);\n// //         let linkElms = rootElm.querySelectorAll('link');\n// //         for(let i=0; i<linkElms.length; i++) {\n// //             if(linkElms[i].href.endsWith(PATH))\n// //                 return;\n// //         }\n// //         const linkElm = document.createElement('link');\n// //         linkElm.setAttribute('href', linkHRef);\n// //         linkElm.setAttribute('rel', 'stylesheet');\n// //         rootElm.insertBefore(linkElm, rootElm.firstChild);\n// //     }\n//\n//     /** Modify Instrument **/\n//\n//     remove() {\n//         this.programs.song.instrumentRemove(this.programs.id);\n//         // document.dispatchEvent(new CustomEvent('programs:remove', this));\n//     }\n//\n//     instrumentRename(newInstrumentName) {\n//         return this.programs.song.instrumentRename(this.programs.id, newInstrumentName);\n//     }\n//\n//     render() {\n//         // const programs = this.programs;\n//         const instrumentID = typeof this.programs.id !== \"undefined\" ? this.programs.id : -1;\n//         const instrumentIDHTML = (instrumentID < 10 ? \"0\" : \"\") + (instrumentID);\n//         this.form.innerHTML = '';\n//         this.form.classList.add('spc-player-synthesizer-container');\n//\n//         // this.form.removeEventListener('focus', this.focusHandler);\n//         // this.form.addEventListener('focus', this.focusHandler, true);\n//\n//         const instrumentToggleButton = this.form.addButtonInput('programs-id',\n//             e => this.form.classList.toggle('selected'),\n//             instrumentIDHTML + ':'\n//         );\n//         instrumentToggleButton.classList.add('show-on-focus');\n//\n//         const instrumentNameInput = this.form.addTextInput('programs-name',\n//             (e, newInstrumentName) => this.instrumentRename(newInstrumentName),\n//             'Instrument Name',\n//             this.programs.config.name || '',\n//             'Unnamed'\n//         );\n//         instrumentNameInput.classList.add('show-on-focus');\n//\n//\n//         this.form.addButtonInput('programs-remove',\n//             (e) => this.remove(e, instrumentID),\n//             this.form.createIcon('delete'),\n//             'Remove Instrument');\n//\n//         let defaultPresetURL = '';\n//         if (this.programs.config.libraryURL && this.programs.config.preset)\n//             defaultPresetURL = new URL(this.programs.config.libraryURL + '#' + this.programs.config.preset, document.location) + '';\n//\n//         this.fieldChangePreset = this.form.addSelectInput('programs-preset',\n//             (e, presetURL) => this.setPreset(presetURL),\n//             (addOption, setOptgroup) => {\n//                 addOption('', 'Change Preset');\n//                 // setOptgroup(this.sampleLibrary.name || 'Unnamed Library');\n//                 // this.sampleLibrary.getPresets().map(presetConfig => addOption(presetConfig.url, presetConfig.name));\n//                 // setOptgroup('Libraries');\n//                 // this.sampleLibrary.getLibraries().map(libraryConfig => addOption(libraryConfig.url, libraryConfig.name));\n//                 // setOptgroup('Other Libraries');\n//                 // const Library = customElements.get('audio-source-library');\n//                 // Library.eachHistoricLibrary(addOption);\n//             },\n//             'Change Instrument',\n//             defaultPresetURL);\n//\n//\n//         this.form.addBreak();\n//     }\n// }\n\nexport default GMEPlayerSynthesizer;\n\n\n","// import FileService from \"../../song/file/FileService\";\nimport React from \"react\";\n// import GMESongFile from \"../../song/file/GMESongFile\";\n\n\nclass GMEPlayerSynthesizerRenderer extends React.Component {\n    constructor(props={}) {\n        console.log(props);\n        super(props);\n        this.config = props.config || {};\n        this.state = {};\n    }\n\n}\n\n\n\n\n\n/**\n * Used for all Instrument UI. Instance not necessary for song playback\n */\n// class GMEPlayerRenderer {\n//\n//     /**\n//      *\n//      * @param {AudioSourceComposerForm} instrumentForm\n//      * @param programs\n//      */\n//     constructor(instrumentForm, programs) {\n//         this.form = instrumentForm;\n//         this.programs = programs;\n//         const root = instrumentForm.getRootNode() || document;\n//         this.appendCSS(root);\n//         this.render();\n//     }\n//\n//     // get DEFAULT_SAMPLE_LIBRARY_URL() {\n//     //     return getScriptDirectory('default.library.json');\n//     // }\n//\n//\n//\n// //     appendCSS(rootElm) {\n// //\n// //         // Append Instrument CSS\n// //         const PATH = 'programs/chip/spc-player-synthesizer.css';\n// //         const linkHRef = getScriptDirectory(PATH);\n// // //             console.log(rootElm);\n// //         let linkElms = rootElm.querySelectorAll('link');\n// //         for(let i=0; i<linkElms.length; i++) {\n// //             if(linkElms[i].href.endsWith(PATH))\n// //                 return;\n// //         }\n// //         const linkElm = document.createElement('link');\n// //         linkElm.setAttribute('href', linkHRef);\n// //         linkElm.setAttribute('rel', 'stylesheet');\n// //         rootElm.insertBefore(linkElm, rootElm.firstChild);\n// //     }\n//\n//     /** Modify Instrument **/\n//\n//     remove() {\n//         this.programs.song.instrumentRemove(this.programs.id);\n//         // document.dispatchEvent(new CustomEvent('programs:remove', this));\n//     }\n//\n//     instrumentRename(newInstrumentName) {\n//         return this.programs.song.instrumentRename(this.programs.id, newInstrumentName);\n//     }\n//\n//     render() {\n//         // const programs = this.programs;\n//         const instrumentID = typeof this.programs.id !== \"undefined\" ? this.programs.id : -1;\n//         const instrumentIDHTML = (instrumentID < 10 ? \"0\" : \"\") + (instrumentID);\n//         this.form.innerHTML = '';\n//         this.form.classList.add('spc-player-synthesizer-container');\n//\n//         // this.form.removeEventListener('focus', this.focusHandler);\n//         // this.form.addEventListener('focus', this.focusHandler, true);\n//\n//         const instrumentToggleButton = this.form.addButtonInput('programs-id',\n//             e => this.form.classList.toggle('selected'),\n//             instrumentIDHTML + ':'\n//         );\n//         instrumentToggleButton.classList.add('show-on-focus');\n//\n//         const instrumentNameInput = this.form.addTextInput('programs-name',\n//             (e, newInstrumentName) => this.instrumentRename(newInstrumentName),\n//             'Instrument Name',\n//             this.programs.config.name || '',\n//             'Unnamed'\n//         );\n//         instrumentNameInput.classList.add('show-on-focus');\n//\n//\n//         this.form.addButtonInput('programs-remove',\n//             (e) => this.remove(e, instrumentID),\n//             this.form.createIcon('delete'),\n//             'Remove Instrument');\n//\n//         let defaultPresetURL = '';\n//         if (this.programs.config.libraryURL && this.programs.config.preset)\n//             defaultPresetURL = new URL(this.programs.config.libraryURL + '#' + this.programs.config.preset, document.location) + '';\n//\n//         this.fieldChangePreset = this.form.addSelectInput('programs-preset',\n//             (e, presetURL) => this.setPreset(presetURL),\n//             (addOption, setOptgroup) => {\n//                 addOption('', 'Change Preset');\n//                 // setOptgroup(this.sampleLibrary.name || 'Unnamed Library');\n//                 // this.sampleLibrary.getPresets().map(presetConfig => addOption(presetConfig.url, presetConfig.name));\n//                 // setOptgroup('Libraries');\n//                 // this.sampleLibrary.getLibraries().map(libraryConfig => addOption(libraryConfig.url, libraryConfig.name));\n//                 // setOptgroup('Other Libraries');\n//                 // const Library = customElements.get('audio-source-library');\n//                 // Library.eachHistoricLibrary(addOption);\n//             },\n//             'Change Instrument',\n//             defaultPresetURL);\n//\n//\n//         this.form.addBreak();\n//     }\n// }\n\nexport default GMEPlayerSynthesizerRenderer;\n","\nclass TestInstrument {\n    constructor(config={}, audioContext=null) {\n        this.config = {};\n        this.audioContext = audioContext;\n    }\n\n\n    /** Playback **/\n\n    playFrequency(destination, frequency, startTime, duration=null, velocity=null, onended=null) {\n        console.info('playFrequency(', frequency, startTime, duration, velocity, ')')\n    }\n\n\n}\n\nexport default TestInstrument;\n\n\n","import AudioBufferInstrument from \"./instrument/voice/AudioBufferInstrument\";\nimport AudioBufferInstrumentRenderer from \"./instrument/voice/render/AudioBufferInstrumentRenderer\";\nimport OscillatorInstrument from \"./instrument/voice/OscillatorInstrument\";\nimport OscillatorInstrumentRenderer from \"./instrument/voice/render/OscillatorInstrumentRenderer\";\nimport PolyphonyInstrument from \"./instrument/poly/PolyphonyInstrument\";\nimport PolyphonyInstrumentRenderer from \"./instrument/poly/render/PolyphonyInstrumentRenderer\";\nimport GMEPlayerSynthesizer from \"./player/gme/GMEPlayerSynthesizer\";\nimport GMEPlayerSynthesizerRenderer from \"./player/gme/GMEPlayerSynthesizerRenderer\";\nimport ProgramLoader from \"../common/program/ProgramLoader\";\nimport TestInstrument from \"./instrument/test/TestInstrument\";\n\nexport default {\n    AudioBufferInstrument,\n    AudioBufferInstrumentRenderer,\n    OscillatorInstrument,\n    OscillatorInstrumentRenderer,\n    PolyphonyInstrument,\n    PolyphonyInstrumentRenderer,\n    GMEPlayerSynthesizer,\n    GMEPlayerSynthesizerRenderer,\n    TestInstrument,\n    addAllPrograms: function() {\n        ProgramLoader.addProgramClass('AudioBufferInstrument', AudioBufferInstrument, AudioBufferInstrumentRenderer, 'AudioBuffer Instrument');\n        ProgramLoader.addProgramClass('OscillatorInstrument', OscillatorInstrument, OscillatorInstrumentRenderer, 'OscillatorNode Instrument');\n        ProgramLoader.addProgramClass('PolyphonyInstrument', PolyphonyInstrument, PolyphonyInstrumentRenderer, 'Audio Source Synthesizer');\n        ProgramLoader.addProgramClass('GMEPlayerSynthesizer', GMEPlayerSynthesizer, GMEPlayerSynthesizerRenderer, 'Game Music ASPlayer Synthesizer');\n        ProgramLoader.addProgramClass('TestInstrument', TestInstrument, null, 'Test Instrument');\n    }\n}\n\n\n","import TrackInstruction from \"../instruction/TrackInstruction\";\nimport CommandInstruction from \"../instruction/CommandInstruction\";\nimport {InstructionIterator} from \"../instruction\";\n\n\nexport default class TrackIterator {\n    constructor(tracks, startingTrackName, startingBeatsPerMinute, startingTimeDivision, onEvent=null) {\n        this.tracks = tracks;\n        if (!this.tracks[startingTrackName])\n            throw new Error(\"Invalid instruction track: \" + startingTrackName);\n\n        this.onEvent = onEvent || function() {};\n\n        // this.onEvent = onEvent;\n        this.positionSeconds = 0;\n        // this.seekLength = 10;\n        this.activeTracks = [];\n        // this.currentTrackID = -1;\n\n        this.startingBeatsPerMinute = startingBeatsPerMinute;\n        this.startingTimeDivision = startingTimeDivision;\n\n        const startingStats = {\n            // program: trackStats.program,            // Current program which all notes route through\n            // destination: trackStats.destination,    // Current destination sent to all playFrequency calls\n            startPosition: 0,\n            trackName: startingTrackName,\n            // beatsPerMinute: beatsPerMinute,\n            // startingTimeDivision: song.data.startingTimeDivision, // Time division is not passed to sub-groups\n        };\n        this.startTrackIteration(startingStats);\n    }\n\n    instructionGetIterator(trackName, timeDivision=null, beatsPerMinute=null) {\n        if(!this.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        const instructionList = this.tracks[trackName];\n\n        return new InstructionIterator(\n            instructionList,\n            timeDivision || this.startingTimeDivision,\n            beatsPerMinute || this.startingBeatsPerMinute,\n        );\n    }\n\n\n    startTrackIteration(trackStats) {\n        trackStats.iterator = this.instructionGetIterator(trackStats.trackName, trackStats.timeDivision, trackStats.beatsPerMinute);\n        this.activeTracks.push(trackStats);\n        return trackStats;\n    }\n\n    /** @deprecated **/\n    getPositionInSeconds() {\n        let totalPositionSeconds = 0;\n        for(let i=0; i<this.activeTracks.length; i++) {\n            const {iterator, startPosition} = this.activeTracks[i];\n            const positionSeconds = startPosition + iterator.positionSeconds;\n            if (positionSeconds > totalPositionSeconds)\n                totalPositionSeconds = positionSeconds;\n        }\n        return totalPositionSeconds;\n    }\n\n    getEndPositionInSeconds() {\n        let totalEndPositionSeconds = 0;\n        for(let i=0; i<this.activeTracks.length; i++) {\n            const {iterator, startPosition} = this.activeTracks[i];\n            const endPositionSeconds = startPosition + iterator.endPositionSeconds;\n            if (endPositionSeconds > totalEndPositionSeconds)\n                totalEndPositionSeconds = endPositionSeconds;\n        }\n        return totalEndPositionSeconds;\n    }\n\n    // incrementTrack() {\n    //     this.currentTrackID++;\n    //     if(this.currentTrackID >= this.activeTracks.length)\n    //         this.currentTrackID = 0;\n    //     return this.currentTrackID;\n    // }\n\n    hasReachedEnd() {\n        for(let i=0; i<this.activeTracks.length; i++) {\n            const {iterator} = this.activeTracks[i];\n            if(iterator.hasReachedEnd())\n                return true;\n        }\n        return false;\n    }\n\n\n    /**\n     * @param {TrackInstruction} instruction\n     * @param trackStats\n     */\n    processTrackInstruction(instruction, trackStats) {\n        // if (instruction.getTrackName() === iterator.trackName) { // TODO track stack\n\n        const subTrackStats = {\n            // program: trackStats.program,            // Current program which all notes route through\n            // destination: trackStats.destination,    // Current destination sent to all playFrequency calls\n            // parentStats: trackStats,\n            startPosition: trackStats.iterator.positionSeconds,\n            trackName: instruction.getTrackName(),\n            beatsPerMinute: trackStats.beatsPerMinute,\n            // timeDivision: trackStats.timeDivision, // Time division is not passed to sub-groups\n        };\n        if(typeof trackStats.program !== \"undefined\" && trackStats.program)\n            subTrackStats.program = trackStats.program;\n        if(typeof trackStats.destination !== \"undefined\" && trackStats.destination)\n            subTrackStats.destination = trackStats.destination;\n        // TODO: process track instruction parameters\n        this.startTrackIteration(subTrackStats);\n    }\n\n    /**\n     * @param {CommandInstruction} instruction\n     * @param trackStats\n     */\n    processCommandInstruction(instruction, trackStats) {\n\n    }\n\n    processInstruction(instruction, trackStats, callback=null) {\n        if(instruction instanceof CommandInstruction)\n            this.processCommandInstruction(instruction, trackStats);\n        else if(instruction instanceof TrackInstruction)\n            this.processTrackInstruction(instruction, trackStats);\n        callback && callback(instruction, trackStats);\n        // console.log(\"Note Playback: \", instruction, callback);\n    }\n\n\n    /** Seeking **/\n\n\n    seekToEnd(callback=null, seekLength=1) {\n        let seekPosition=0, finished = false;\n        while(!finished) {\n            seekPosition += seekLength; // Seek before\n            finished = this.seekToPosition(seekPosition, callback);\n        }\n        // return this;\n    }\n\n    seekToPosition(positionSeconds, callback=null) {\n        let finished = true;\n        for(let i=0; i<this.activeTracks.length; i++) {\n            const trackStats = this.activeTracks[i];\n            const {iterator, startPosition} = trackStats;\n            positionSeconds -= startPosition;\n            if(!iterator.hasReachedEnd()) {\n                iterator.seekToPosition(positionSeconds, (instruction) => {\n                    this.processInstruction(instruction, trackStats, callback);\n                });\n                if (!iterator.hasReachedEnd())\n                    finished = false;\n            }\n        }\n        return finished;\n    }\n\n    seekToStartingTrackIndex(index, callback=null) {\n        const trackStats = this.activeTracks[0];\n        const iterator = this.instructionGetIterator(trackStats.trackName, trackStats.timeDivision, trackStats.beatsPerMinute);\n        iterator.seekToIndex(index, callback);\n        const startPosition = iterator.positionSeconds;\n        this.seekToPosition(startPosition, callback);\n    }\n\n    // seekToPositionTicks(positionTicks, callback=null) {\n    //     while (this.positionTicks < positionTicks)\n    //         this.nextTrackInstruction(callback);\n    //     return this;\n    // }\n}\n","import TrackIterator from \"./TrackIterator\";\nimport {Instruction, NoteInstruction} from \"../instruction\";\n\n\nexport default class TrackPlayback extends TrackIterator {\n    constructor(song, startingTrackName = null, onEvent=null) {\n        super(song.data.tracks,\n            startingTrackName || song.getStartTrackName(),\n            song.data.beatsPerMinute,\n            song.data.timeDivision,\n            onEvent)\n\n        this.song = song;\n        this.seekLength = 10;\n        this.active = true;\n\n        this.endPromise = new Promise((resolve, reject) => {\n            this.endResolve = resolve;\n        });\n\n        this.playTrackInstructionCallback = this.playTrackInstruction.bind(this);\n\n    }\n\n    startTrackIteration(trackStats) {\n        super.startTrackIteration(trackStats)\n        if(!trackStats.playingIndices)\n            trackStats.playingIndices = [];\n        this.onEvent({\n            type: 'track:start',\n            playback: this,\n            trackStats\n        });\n    }\n\n    addInstructionFilter(filterCallback) {\n        const oldCallback = this.playTrackInstructionCallback;\n        this.playTrackInstructionCallback = function(instruction, trackStats) {\n            instruction = filterCallback(instruction, trackStats);\n            if(!instruction)\n                return;\n            if(!instruction instanceof Instruction)\n                throw new Error(\"Invalid Instruction\");\n            oldCallback(instruction, trackStats);\n        }\n    }\n\n    play(destination, startPosition=null) {\n        if (!destination || !destination.context)\n            throw new Error(\"Invalid destination\");\n        this.audioContext = destination.context;\n        this.destination = destination;\n\n        this.startTime = this.audioContext.currentTime; // this.audioContext.currentTime\n\n        this.seekInterval = setInterval(() => this.renderPlayback(), this.seekLength / 10);\n\n        if(startPosition !== null) {\n            this.seekToPosition(startPosition);\n            this.startTime -= startPosition;\n        }\n        this.renderPlayback();\n    }\n\n\n    playAtStartingTrackIndex(destination, index, callback=null) {\n        const trackStats = this.activeTracks[0];\n        const iterator = this.instructionGetIterator(trackStats.trackName, trackStats.timeDivision, trackStats.beatsPerMinute);\n        iterator.seekToIndex(index, callback);\n        const startPosition = iterator.positionSeconds;\n        this.play(destination, startPosition);\n        // console.log('playAtStartingTrackIndex', index, startPosition);\n        // this.seekToPosition(startPosition, callback);\n    }\n\n    getPlaybackPosition() {\n        return this.audioContext.currentTime - this.startTime;\n\n    }\n\n    // getPositionInSeconds() {\n    //     return this.startTime;\n    // }\n\n    async awaitPlaybackReachedEnd() {\n        return await this.endPromise;\n    }\n\n    renderPlayback() {\n        const currentPositionSeconds = this.getPlaybackPosition();\n\n        if(!this.active || this.hasReachedEnd()) {\n            clearInterval(this.seekInterval);\n            const endPositionSeconds = this.getEndPositionInSeconds();\n            const timeTillFinished = endPositionSeconds - currentPositionSeconds;\n            console.log(`Song is ending in ${timeTillFinished} seconds`);\n            if(timeTillFinished > 0)\n                setTimeout(() => this.stopPlayback(), timeTillFinished * 1000);\n            else\n                this.stopPlayback();\n        } else {\n            this.seekToPosition(currentPositionSeconds + this.seekLength, this.playTrackInstructionCallback);\n        }\n    }\n\n    stopPlayback() {\n        if(this.active) {\n            this.active = false;\n            this.endResolve();\n        }\n        // this.endPromise = true;\n    }\n\n    playTrackInstruction(instruction, trackStats) {\n        if(typeof trackStats.program === \"undefined\")\n            return console.error(\"ASCTrack has no program set: \", trackStats.trackName);\n        if(instruction instanceof NoteInstruction) {\n            const destination = trackStats.destination || this.destination;\n            const noteStartTime = this.startTime + trackStats.startPosition + trackStats.iterator.positionSeconds; // ASCTrack start time equals current track's start + playback times\n            if(noteStartTime > 0) {\n                const noteIndex = trackStats.iterator.currentIndex;\n                const playingIndices = trackStats.playingIndices;\n                const onEvent = this.onEvent;\n                this.song.playInstruction(destination, instruction, trackStats.program, noteStartTime,\n                    () => {\n                        if(playingIndices.indexOf(noteIndex) === -1) {\n                            playingIndices.push(noteIndex);\n                            // console.log('playingIndices.push', playingIndices);\n\n                            onEvent({\n                                type: 'instruction:play',\n                                playback: this,\n                                playingIndices,\n                                trackStats\n                            });\n                        }\n                    },\n                    () => {\n                        playingIndices.splice(playingIndices.indexOf(noteIndex), 1);\n                        // console.log('playingIndices.splice', playingIndices);\n                        onEvent({\n                            type: 'instruction:stop',\n                            playback: this,\n                            playingIndices,\n                            trackStats\n                        });\n\n\n                    });\n            }\n        }\n    }\n\n    /**\n     * @param {CommandInstruction} instruction\n     * @param trackStats\n     */\n    processCommandInstruction(instruction, trackStats) {\n        instruction.processCommandInstruction(this.song, trackStats);\n    }\n\n}\n","import ProgramLoader from \"../common/program/ProgramLoader\";\nimport SongValues from \"./values/SongValues\";\n\nimport Storage from \"../common/storage/Storage\";\nimport GMESongFile from \"./file/GMESongFile\";\nimport JSONSongFile from \"./file/JSONSongFile\";\nimport FileService from \"./file/FileService\";\nimport {ConfigListener} from \"./config/ConfigListener\";\nimport {Instruction, InstructionIterator, QuantizedInstructionIterator} from \"./instruction/\";\n\n\nimport ProgramList from \"../programs\";\nimport Values from \"../common/values/Values\";\nimport TrackIterator from \"./track/TrackIterator\";\nimport TrackPlayback from \"./track/TrackPlayback\";\n\n// TODO: can be handled cleaner\nProgramList.addAllPrograms();\n// const DEFAULT_PROGRAM_CLASS = 'PolyphonyProgram';\n\n\nclass Song {\n    constructor(songData={}) {\n\n        this.eventListeners = [];\n        this.programLoader = new ProgramLoader(this);\n\n        this.volume = null;\n        this.lastVolumeGain = null;\n        this.playback = null;\n\n        const data = {\n            title: Song.generateTitle(),\n            uuid: Values.generateUUID(),\n            version: '0.0.1',\n            created: new Date().getTime(),\n            timeDivision: 96 * 4,\n            beatsPerMinute: 120,\n            beatsPerMeasure: 4,\n            startTrack: 'root',\n            programs: [ // Also called 'programs' or 'patches'\n                ['PolyphonyInstrument', {\n                    voices: [\n                        ['OscillatorInstrument', {\n                            type: 'sawtooth'\n                        }],\n                        ['OscillatorInstrument', {\n                            type: 'sawtooth'\n                        }],\n                    ]}\n                ],\n                ['OscillatorInstrument',{type: 'square'}],\n            ],\n            tracks: {\n                root: [\n                    ['@track0', 288],\n                    ['@track1'],\n                ],\n                track0: [\n                    // ['!d', 'Effect'],\n                    ['!p', 0],\n                    [0, 'C4', 64],\n                    [64, 'D4', 64],\n                    [64, 'E4', 64],\n                    [64, 'F4', 64],\n                    [64, 'G4', 64],\n                    [64, 'A4', 64],\n                ],\n                track1: [\n                    ['!p', 1],\n                    [64, 'A3', 64],\n                    // [64, 'Aq3', 64],\n                    // [64, 'A#3', 64],\n                    [64, 'A#q3', 64],\n                    // [64, 'B3', 64],\n                    // [64, 'Bq3', 64],\n                    [64, 'C4', 64],\n                    // [64, 'Cq4', 64],\n                    // [64, 'C#4', 64],\n                    [64, 'C#q4', 64],\n                    // [64, 'D4', 64],\n                    // [64, 'Dq4', 64],\n                    [64, 'D#4', 64],\n                    // [64, 'D#q4', 64],\n                    // [64, 'E4', 64],\n                    [64, 'Eq4', 64],\n                    // [64, 'E#4', 64],\n                    // [64, 'E#q4', 64],\n                    [64, 'F#4', 64],\n                    // [64, 'F#q4', 64],\n                    // [64, 'G4', 64],\n                    [64, 'Gq4', 64],\n                    // [64, 'G#4', 64],\n                    // [64, 'G#q4', 64],\n                    [64, 'A4', 64],\n                    // [64, 'Aq4', 64],\n                    // [64, 'A#4', 64],\n                    [64, 'A#q4', 64],\n                    // [64, 'B4', 64],\n                    // [64, 'Bq4', 64],\n                    [64, 'C5', 64],\n                    // [64, 'Cq4', 64],\n                    // [64, 'C#4', 64],\n                    [64, 'C#q5', 64],\n                    // [64, 'D4', 64],\n                    // [64, 'Dq4', 64],\n                    [64, 'D#5', 64],\n                    // [64, 'D#q4', 64],\n                    // [64, 'E4', 64],\n                    [64, 'Eq5', 64],\n                    // [64, 'E#4', 64],\n                    // [64, 'E#q4', 64],\n                    [64, 'F#5', 64],\n                    // [64, 'F#q4', 64],\n                    // [64, 'G4', 64],\n                    [64, 'Gq5', 64],\n                    // [64, 'G#4', 64],\n                    // [64, 'G#q4', 64],\n                    [64, 'A5', 64],\n                ]\n            }\n        };\n\n        this.getProxiedData = function() { return data; };\n        this.data = new Proxy(data, new ConfigListener(this));\n        this.history = [];\n        this.values = new SongValues(this);\n\n        this.loadSongData(songData);\n        this.programLoadAll();\n\n        this.dispatchEventCallback = e => this.dispatchEvent(e);\n    }\n\n    /** @deprecated? **/\n    connect(destination) {\n        this.destination = destination;\n    }\n\n    /** Events and Listeners **/\n\n    dispatchEvent(e) {\n        for (let i = 0; i < this.eventListeners.length; i++) {\n            const [eventName, listenerCallback] = this.eventListeners[i];\n            if(e.name === eventName || eventName === '*') {\n                listenerCallback(e);\n            }\n        }\n    }\n\n    addEventListener(eventName, listenerCallback) {\n        this.eventListeners.push([eventName, listenerCallback]);\n    }\n\n    removeEventListener(eventName, listenerCallback) {\n        for (let i = 0; i < this.eventListeners.length; i++) {\n            const [eventName2, listenerCallback2] = this.eventListeners[i];\n            if(eventName === eventName2 && listenerCallback === listenerCallback2) {\n                this.eventListeners.splice(i, 1);\n                break;\n            }\n        }\n    }\n\n    unloadAll() {\n        this.programLoader.unloadAllPrograms();\n        this.eventListeners = [];\n    }\n\n\n    /** Song Data **/\n\n\n    loadSongData(songData) {\n        const data = this.getProxiedData();\n\n        if (this.playback)\n            this.stopPlayback();\n        Object.assign(data, songData);\n\n        // this.data = songData;\n        this.playbackPosition = 0;\n\n        // Process all instructions\n        if(!data.tracks)\n            throw new Error(\"No tracks found in song data\");\n        Instruction.processInstructionTracks(data.tracks);\n\n        // let loadingPrograms = 0;\n\n        // console.log(\"Song data loaded: \", songData);\n\n        this.dispatchEvent({\n            type: 'song:loaded',\n            song: this\n        });\n    }\n\n\n    loadSongHistory(songHistory) {\n        this.history = songHistory;\n    }\n\n\n    /** Instruction Tracks **/\n\n    getStartTrackName() {\n        return typeof this.data.startTrack === \"undefined\"\n            ? this.data.startTrack\n            : Object.keys(this.data.tracks)[0];\n    }\n\n    hasTrack(trackName) {\n        return typeof this.data.tracks[trackName] !== \"undefined\";\n    }\n\n\n    generateInstructionTrackName(trackName = 'track') {\n        const tracks = this.data.tracks;\n        for (let i = 0; i <= 999; i++) {\n            const currentTrackName = trackName + i;\n            if (!tracks.hasOwnProperty(currentTrackName))\n                return currentTrackName;\n        }\n        throw new Error(\"Failed to generate group name\");\n    }\n\n\n\n    /** Programs **/\n    // All programs are sent a 0 frequency play in order to pre-load samples.\n\n    hasProgram(programID) {\n        return !!this.data.programs[programID];\n    }\n\n    playProgram(destination, program, noteFrequency, noteStartTime, noteDuration=null, noteVelocity=null, onstart=null, onended=null) {\n        // if (!programID && programID !== 0)\n        //     throw new Error(\"Invalid program ID\");\n        // if (!programID && programID !== 0) {\n        //     console.warn(\"No programs set for instruction. Using programs 0\");\n        //     programID = 0;\n        //     // return;\n        // }\n        // let program = this.programLoader.loadInstanceFromID(programID);\n        // return await program.play(destination, noteFrequency, noteStartTime, noteDuration, noteVelocity);\n        if(onstart !== null) {\n            let currentTime = destination.context.currentTime;\n            setTimeout(onstart, (noteStartTime - currentTime) * 1000);\n        }\n        if(typeof noteFrequency === \"string\")\n            noteFrequency = Values.parseFrequencyString(noteFrequency);\n        return program.playFrequency(destination, noteFrequency, noteStartTime, noteDuration, noteVelocity, onended);\n    }\n\n    programGetData(programID)         { return this.programLoader.getData(programID); }\n    programGetClassName(programID)    { return this.programLoader.getClassName(programID); }\n    programGetClass(programID)        { return this.programLoader.getClass(programID); }\n    programGetConfig(programID)       { return this.programLoader.getConfig(programID); }\n\n\n    // programGetList() {\n    //     return this.data.programs;\n    // }\n    programEach(callback) {\n        return this.data.programs.map(function(entry, programID) {\n            const [className, config] = entry;\n            return callback(programID, className, config);\n        });\n    }\n\n\n    programLoadAll() {\n        const programList = this.data.programs;\n        for (let programID = 0; programID < programList.length; programID++) {\n            if (programList[programID]) {\n                this.programLoadInstanceFromID(programID);\n                // TODO wait for init?\n            }\n        }\n    }\n\n\n    programLoadInstanceFromID(programID) {\n        return this.programLoader.loadInstanceFromID(programID);\n        // this.dispatchEvent({\n        //     type: 'programs:instance',\n        //     program,\n        //     programID,\n        //     song: this\n        // });\n    }\n\n    programLoadRenderer(programID) {\n        return this.programLoader.programLoadRenderer(programID);\n    }\n\n\n    programAdd(config) {\n        if (typeof config !== 'object')\n            throw new Error(\"Invalid programs config object\");\n        if (!config.className)\n            throw new Error(\"Invalid Program Class\");\n\n        const programList = this.data.programs;\n        const programID = programList.length;\n\n        this.data.programs[programID] = config;\n        this.programLoadInstanceFromID(programID);\n        // this.dispatchEvent({\n        //     type: 'programs:added',\n        //     programID,\n        //     config,\n        //     song: this\n        // });\n        return programID;\n    }\n\n    programReplace(programID, programClassName, programConfig={}) {\n        // Preserve old programs name\n        // if (oldConfig && oldConfig.title && !programConfig.title)\n        //     programConfig.title = oldConfig.title;\n\n        const oldConfig = this.data.programs[programID];\n        this.data.programs[programID] = [programClassName, programConfig];\n        this.programLoadInstanceFromID(programID);\n\n        // this.dispatchEvent({\n        //     type: 'programs:modified',\n        //     programID,\n        //     oldConfig,\n        //     song: this\n        // });\n        return oldConfig;\n    }\n\n    programRename(programID, newTitle) {\n        const config = this.programGetConfig(programID);\n        config.title = newTitle;\n    }\n\n    programRemove(programID) {\n        const programList = this.data.programs;\n        if (!programList[programID])\n            return console.error(\"Invalid programs ID: \" + programID);\n        const isLastProgram = programID === programList.length - 1;\n\n        const oldConfig = programList[programID];\n        if(isLastProgram) {\n            delete programList[programID];\n        } else {\n            programList[programID] = null;\n        }\n        // this.programUnload(programID);\n\n        // this.dispatchEvent({\n        //     type: 'programs:removed',\n        //     programID,\n        //     song: this\n        // });\n        return oldConfig;\n    }\n\n\n\n\n    /** Instructions **/\n\n    instructionIndexOf(trackName, instruction) {\n        if (instruction instanceof Instruction)\n            instruction = instruction.data;\n\n        if(!this.data.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        let instructionList = this.data.tracks[trackName];\n\n        instruction = ConfigListener.resolveProxiedObject(instruction);\n        // instructionList = ConfigListener.resolveProxiedObject(instructionList);\n\n        const p = instructionList.indexOf(instruction);\n        if (p === -1)\n            throw new Error(\"Instruction not found in instruction list\");\n        return p;\n    }\n\n    instructionGetList(trackName) {\n        if(!this.data.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        return this.data.tracks[trackName];\n    }\n\n    instructionGetByIndex(trackName, index) {\n        if(!this.data.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        let instructionList = this.instructionGetList(trackName);\n        if(index < 0 || index > instructionList.length)\n            throw new Error(\"Index is out or range: \" + index);\n        if(!instructionList[index])\n            throw new Error(\"Invalid instruction index: \" + index);\n        return Instruction.getInstruction(instructionList[index]);\n    }\n\n\n    instructionGetIterator(trackName, timeDivision=null, beatsPerMinute=null) {\n        if(!this.data.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        const instructionList = this.data.tracks[trackName];\n\n        return new InstructionIterator(\n            instructionList,\n            timeDivision || this.data.timeDivision,\n            beatsPerMinute || this.data.beatsPerMinute,\n        );\n    }\n\n    instructionGetQuantizedIterator(trackName, quantizationTicks, timeDivision=null, beatsPerMinute=null) {\n        if(!this.data.tracks[trackName])\n            throw new Error(\"Invalid instruction track: \" + trackName);\n        const instructionList = this.data.tracks[trackName];\n\n        return new QuantizedInstructionIterator(\n            instructionList,\n            quantizationTicks,\n            timeDivision || this.data.timeDivision,\n            beatsPerMinute || this.data.beatsPerMinute,\n        );\n    }\n\n\n    /** Modify Instructions **/\n\n    /** TODO: fix insertion bugs **/\n    instructionInsertAtPosition(trackName, insertPositionInTicks, insertInstructionData) {\n        if (typeof insertPositionInTicks === 'string')\n            insertPositionInTicks = Values.parseDurationAsTicks(insertPositionInTicks, this.data.timeDivision);\n\n        if (!Number.isInteger(insertPositionInTicks))\n            throw new Error(\"Invalid integer: \" + typeof insertPositionInTicks);\n        if (!insertInstructionData)\n            throw new Error(\"Invalid insert instruction\");\n        const insertInstruction = Instruction.parseInstruction(insertInstructionData);\n        let instructionList = this.data.tracks[trackName];\n\n\n        const iterator = this.instructionGetIterator(trackName);\n\n        let instruction = iterator.nextInstruction();\n        while (instruction) {\n            // if(instruction.deltaDuration > 0) {\n            const currentPositionInTicks = iterator.positionTicks;\n            if (currentPositionInTicks > insertPositionInTicks) {\n                // Delta note appears after note to be inserted\n                const splitDuration = [\n                    insertPositionInTicks - (currentPositionInTicks - instruction.deltaDurationTicks),\n                    currentPositionInTicks - insertPositionInTicks\n                ];\n\n                const modifyIndex = iterator.currentIndex;\n                // Make following delta note smaller\n                this.instructionReplaceDeltaDuration(trackName, modifyIndex, splitDuration[1]);\n\n                // Insert new note before delta note.\n                insertInstruction.deltaDurationTicks = splitDuration[0];                     // Make new note equal the rest of the duration\n                this.instructionInsertAtIndex(trackName, modifyIndex, insertInstruction);\n\n                return modifyIndex; // this.splitPauseInstruction(trackName, i,insertPosition - groupPosition , insertInstruction);\n\n            } else if (currentPositionInTicks === insertPositionInTicks) {\n                // Delta note plays at the same time as new note, append after\n\n                let lastInsertIndex;\n                // Search for last insert position\n                for (lastInsertIndex = iterator.currentIndex + 1; lastInsertIndex < instructionList.length; lastInsertIndex++)\n                    if (new Instruction(instructionList[lastInsertIndex]).deltaDurationTicks > 0)\n                        break;\n\n                insertInstruction.deltaDurationTicks = 0; // TODO: is this correct?\n                this.instructionInsertAtIndex(trackName, lastInsertIndex, insertInstruction);\n                return lastInsertIndex;\n            }\n            // groupPosition += instruction.deltaDuration;\n            // lastDeltaInstructionIndex = i;\n            // }\n            // if (!instruction)\n            //     break;\n            instruction = iterator.nextInstruction();\n        }\n\n        if (iterator.positionTicks >= insertPositionInTicks)\n            throw new Error(\"Something went wrong\");\n        // Insert a new pause at the end of the song, lasting until the new note?\n        let lastPauseIndex = instructionList.length;\n        // this.instructionInsertAtIndex(trackName, lastPauseIndex, {\n        //     command: '!pause',\n        //     duration: insertPosition - groupPosition\n        // });\n        // Insert new note\n        insertInstruction.deltaDurationTicks = insertPositionInTicks - iterator.positionTicks;\n        this.instructionInsertAtIndex(trackName, lastPauseIndex, insertInstruction);\n        return lastPauseIndex;\n    }\n\n\n    instructionInsertAtIndex(trackName, insertIndex, insertInstructionData) {\n        if (!insertInstructionData)\n            throw new Error(\"Invalid insert instruction\");\n        let insertInstruction = Instruction.parseInstruction(insertInstructionData);\n        insertInstructionData = insertInstruction.data;\n        this.instructionGetList(trackName).splice(insertIndex, 0, insertInstructionData);\n        return insertIndex;\n    }\n\n\n    instructionDeleteAtIndex(trackName, deleteIndex) {\n        const deleteInstruction = this.instructionGetByIndex(trackName, deleteIndex);\n        if (deleteInstruction.deltaDurationTicks > 0) {\n            const nextInstruction = this.instructionGetByIndex(trackName, deleteIndex + 1, false);\n            if (nextInstruction) {\n                // this.getInstruction(trackName, deleteIndex+1).deltaDuration =\n                //     nextInstruction.deltaDuration + deleteInstruction.deltaDuration;\n                this.instructionReplaceDeltaDuration(trackName, deleteIndex + 1, nextInstruction.deltaDurationTicks + deleteInstruction.deltaDurationTicks)\n            }\n        }\n        this.instructionGetList(trackName).splice(deleteIndex, 1);\n        // return this.spliceDataByPath(['instructions', trackName, deleteIndex], 1);\n    }\n\n    instructionReplaceDeltaDuration(trackName, replaceIndex, newDelta) {\n        this.instructionGetByIndex(trackName, replaceIndex).deltaDurationTicks = newDelta;\n        // return this.instructionReplaceParam(trackName, replaceIndex, 0, newDelta);\n    }\n\n    instructionReplaceCommand(trackName, replaceIndex, newCommand) {\n        //: TODO: check for recursive group\n        this.instructionGetByIndex(trackName, replaceIndex).command = newCommand;\n    }\n\n    instructionReplaceProgram(trackName, replaceIndex, programID) {\n        this.instructionGetByIndex(trackName, replaceIndex).program = programID;\n    }\n\n    instructionReplaceDuration(trackName, replaceIndex, newDuration) {\n        if (typeof newDuration === 'string')\n            newDuration = Values.parseDurationAsTicks(newDuration, this.data.timeDivision);\n        this.instructionGetByIndex(trackName, replaceIndex).durationTicks = newDuration;\n    }\n\n    instructionReplaceVelocity(trackName, replaceIndex, newVelocity) {\n        if (!Number.isInteger(newVelocity))\n            throw new Error(\"Velocity must be an integer: \" + newVelocity);\n        if (newVelocity < 0)\n            throw new Error(\"Velocity must be a positive integer: \" + newVelocity);\n        this.instructionGetByIndex(trackName, replaceIndex).velocity = newVelocity;\n    }\n\n\n    /** Song Tracks **/\n\n    trackAdd(newTrackName, instructionList) {\n        if (this.data.tracks.hasOwnProperty(newTrackName))\n            throw new Error(\"New group already exists: \" + newTrackName);\n        this.data.tracks[newTrackName] = instructionList || [];\n    }\n\n\n    trackRemove(removeTrackName) {\n        if (removeTrackName === 'root')\n            throw new Error(\"Cannot remove root instruction track, n00b\");\n        if (!this.data.tracks.hasOwnProperty(removeTrackName))\n            throw new Error(\"Existing group not found: \" + removeTrackName);\n\n        delete this.data.tracks[removeTrackName];\n    }\n\n\n    trackRename(oldTrackName, newTrackName) {\n        if (oldTrackName === 'root')\n            throw new Error(\"Cannot rename root instruction track, n00b\");\n        if (!this.data.tracks.hasOwnProperty(oldTrackName))\n            throw new Error(\"Existing group not found: \" + oldTrackName);\n        if (this.data.tracks.hasOwnProperty(newTrackName))\n            throw new Error(\"New group already exists: \" + newTrackName);\n\n        const removedGroupData = this.data.tracks[oldTrackName];\n        delete this.data.tracks[oldTrackName];\n        this.data.tracks[newTrackName] = removedGroupData;\n    }\n\n\n    // trackGetIterator(destination, onEvent=null) {\n    //     return new TrackIterator(destination, this, this.getStartTrackName(), onEvent);\n    // }\n\n    /** Playback Timing **/\n\n    getSongLengthInSeconds() {\n        const iterator = new TrackIterator(this.data.tracks, this.getStartTrackName(), this.data.beatsPerMinute, this.data.timeDivision);\n        iterator.seekToEnd();\n        // console.log('getSongLengthInSeconds()', iterator.getEndPositionInSeconds())\n        return iterator.getEndPositionInSeconds();\n    }\n\n    // getSongLengthTicks() {\n    //     return this.instructionGetIterator(this.getStartTrackName())\n    //         .seekToEnd()\n    //         .endPositionTicks;\n    // }\n\n    // getSongLength() {\n    //     return this.getGroupLength(this.getStartTrackName());\n    // }\n    //\n    // getGroupLength(trackName) {\n    //     const instructionIterator = this.getInstructionIterator(trackName);\n    //     while (instructionIterator.nextInstruction()) {}\n    //     return instructionIterator;\n    //     // return {\n    //     //     inSeconds: instructionIterator.endPositionSeconds,\n    //     //     inTicks: instructionIterator.endPositionTicks\n    //     // }\n    // }\n\n\n    getSongPositionFromTicks(songPositionInTicks) {\n        return this.getGroupPositionFromTicks(this.getStartTrackName(), songPositionInTicks);\n    }\n\n    // Refactor\n    getGroupPositionFromTicks(trackName, groupPositionInTicks) {\n        const iterator = this.instructionGetIterator(trackName);\n        while (true) {\n            if (iterator.positionTicks >= groupPositionInTicks || !iterator.nextInstruction())\n                break;\n        }\n\n\n        let currentPosition = iterator.positionSeconds;\n\n        if (groupPositionInTicks > iterator.positionTicks) {\n            const elapsedTicks = groupPositionInTicks - iterator.positionTicks;\n            currentPosition += Song.ticksToSeconds(elapsedTicks, iterator.beatsPerMinute, iterator.timeDivision);\n\n        } else if (groupPositionInTicks < iterator.positionTicks) {\n            const elapsedTicks = iterator.positionTicks - groupPositionInTicks;\n            currentPosition -= Song.ticksToSeconds(elapsedTicks, iterator.beatsPerMinute, iterator.timeDivision);\n        }\n\n        // console.info(\"getGroupPositionFromTicks\", groupPositionInTicks, currentPosition);\n        return currentPosition;\n    }\n\n\n    getSongPositionInTicks(positionInSeconds = null) {\n        if (positionInSeconds === null)\n            positionInSeconds = this.getSongPlaybackPosition();\n        return this.getGroupPositionInTicks(this.getStartTrackName(), positionInSeconds);\n    }\n\n\n    getGroupPositionInTicks(trackName, positionInSeconds) {\n        const iterator = this.instructionGetIterator(trackName);\n        while (true) {\n            if (iterator.positionSeconds >= positionInSeconds || !iterator.nextInstruction())\n                break;\n        }\n\n        let currentPositionInTicks = iterator.positionTicks;\n        if (positionInSeconds > iterator.positionSeconds) {\n            const elapsedTime = positionInSeconds - iterator.positionSeconds;\n            currentPositionInTicks += Song.secondsToTicks(elapsedTime, iterator.beatsPerMinute);\n\n        } else if (positionInSeconds < iterator.positionSeconds) {\n            const elapsedTime = iterator.positionSeconds - positionInSeconds;\n            currentPositionInTicks -= Song.secondsToTicks(elapsedTime, iterator.beatsPerMinute);\n        }\n\n        // console.info(\"getSongPositionInTicks\", positionInSeconds, currentPositionInTicks);\n        return currentPositionInTicks;\n    }\n\n    static ticksToSeconds(elapsedTicks, beatsPerMinute, timeDivision) {\n        return (elapsedTicks / timeDivision) * (60 / beatsPerMinute);\n    }\n\n    static secondsToTicks(elapsedTime, beatsPerMinute, timeDivision) {\n        return Math.round((elapsedTime * timeDivision) / (60 / beatsPerMinute));\n    }\n\n\n    /** Playback **/\n\n    setVolume(newVolume) {\n        this.volume = newVolume;\n        if(this.lastVolumeGain)\n            this.lastVolumeGain.gain.value = newVolume;\n    }\n\n    getVolumeGain(destination) {\n        if(!destination || !destination.context)\n            throw new Error(\"Invalid destination\");\n        // if (this.volume !== null) {\n        const context = destination.context;\n        let gain = context.createGain();\n        gain.gain.value = this.volume === null ? 1 : this.volume;\n        gain.connect(destination);\n        this.lastVolumeGain = gain;\n        return gain;\n        // }\n        // return destination;\n    }\n\n\n    getSongPlaybackPosition() {\n        if (this.playback)\n            return this.playback.audioContext.currentTime - this.playback.startTime;\n        return this.playbackPosition;\n    }\n\n\n    setPlaybackPositionInTicks(songPositionInTicks) {\n        if (!Number.isInteger(songPositionInTicks))\n            throw new Error(\"Invalid start position in ticks\");\n        // TODO: is start position beyond song's ending?\n\n        const playbackPosition = this.getSongPositionFromTicks(songPositionInTicks);\n        return this.setPlaybackPosition(playbackPosition);\n    }\n\n    setPlaybackPosition(songPosition) {// TODO: duplicate values? Does the song need to store position?\n        songPosition = parseFloat(songPosition);\n        if (Number.isNaN(songPosition))\n            throw new Error(\"Invalid start position\");\n\n        // this.playback.setPlaybackPosition(this.getAudioContext().currentTime - this.playbackPosition);\n        // let isPlaying = !!this.playback;\n        if (this.playback) {\n            this.stopPlayback();\n        }\n        this.playbackPosition = songPosition;\n\n        this.dispatchEvent({\n            type: 'song:seek',\n            position: this.playbackPosition,\n            // positionInTicks: this.getSongPositionInTicks(this.playbackPosition), // TODO: use iterator\n            song: this\n        });\n\n        console.log('setPlaybackPosition', songPosition);\n\n        // if (isPlaying) {\n        //     const oldDestination = this.playback.destination;\n        //     this.playback = new InstructionPlayback(oldDestination, this, this.getStartTrackName(), oldDestination.context.currentTime - this.playbackPosition);\n        //     // this.playback.awaitPlaybackReachedEnd()\n        //     //     .then((reachedEnding) => reachedEnding ? this.stopPlayback(true) : null);\n        // }\n        // const positionInTicks = this.getSongPositionInTicks(this.playbackPosition);\n//         console.log(\"Seek position: \", this.playbackPosition, positionInTicks);\n\n    }\n\n\n    async play(destination, startPosition=null) {\n        destination = this.getVolumeGain(destination);\n        // const audioContext = destination.context;\n        if (this.playback) {\n            this.stopPlayback();\n            this.setPlaybackPosition(0);\n            // throw new Error(\"Song is already playing\");\n        }\n\n        // await this.init(audioContext);\n        if(startPosition === null)\n            startPosition = this.playbackPosition;\n        console.log(\"Start playback:\", startPosition);\n        const playback = new TrackPlayback(this, this.getStartTrackName(), this.dispatchEventCallback);\n        this.playback = playback;\n        playback.play(destination, startPosition)\n\n        this.dispatchEvent({\n            type: 'song:play',\n            playback: this.playback,\n            // positionInTicks: this.getSongPositionInTicks(this.playbackPosition), // TODO: use iterator\n            song: this\n        });\n\n        await playback.awaitPlaybackReachedEnd();\n\n        this.dispatchEvent({\n            type: 'song:end',\n            playback: this.playback,\n            // positionInTicks: this.getSongPositionInTicks(this.playbackPosition), // TODO: use iterator\n            song: this\n        });\n        if(this.playback)\n            this.stopPlayback()\n\n        return playback;\n        // const reachedEnding = await this.playback.awaitPlaybackReachedEnd();\n        // if(reachedEnding)\n        //     this.stopPlayback(true);\n    }\n\n\n    stopProgramPlayback(programID) {\n        this.programLoader.stopProgramPlayback(programID);\n        // let programClass = this.programLoader.programGetClass(programID);\n        // if(typeof programClass.stopPlayback !== \"function\")\n        //     return console.error(programClass.name + \".stopPlayback is not a function\");\n        // programClass.stopPlayback();\n    }\n\n    stopPlayback() {\n        if (!this.playback)\n            return console.warn(\"Playback is already stopped\");\n        const playback = this.playback;\n        this.playback = null;\n        this.playbackPosition = playback.getPositionInSeconds();\n        playback.stopPlayback();\n        this.programLoader.stopAllPlayback(); // TODO: redundant?\n\n        // TODO: move to playback class\n        // for (let i = 0; i < this.playbackEndCallbacks.length; i++)\n        //     this.playbackEndCallbacks[i]();\n        // this.playbackEndCallbacks = [];\n        // for (let i = 0; i < this.waitCancels.length; i++)\n        //     this.waitCancels[i]();\n        // this.waitCancels = [];\n\n\n        console.log(\"End playback:\", this.playbackPosition);\n\n\n        this.dispatchEvent({\n            type: 'song:end',\n            playback: this.playback,\n            // positionInTicks: this.getSongPositionInTicks(this.playbackPosition), // TODO: use iterator\n            song: this\n        });\n    }\n\n    pause() {\n        if (this.isPaused)\n            throw new Error(\"Song is already paused\");\n        this.isPaused = true;\n    }\n\n    resume() {\n        if (!this.isPaused)\n            throw new Error(\"Song is not paused\");\n        this.isPaused = false;\n    }\n\n    isPlaying() {\n        return !!this.playback;\n    }\n\n\n    playSelectedInstructions(destination, trackName, selectedIndices) {\n        destination = this.getVolumeGain(destination);\n\n        // TrackIterator find playback position of first index start point\n        if(this.playback)\n            this.stopPlayback();\n        const playback = new TrackPlayback(this, trackName, this.dispatchEventCallback);\n        this.playback = playback;\n        playback.addInstructionFilter(function(instruction, trackStats) {\n            if(trackStats.trackName !== trackName)\n                return null;\n            const index = trackStats.iterator.currentIndex;\n            for(let i=0; i<selectedIndices.length; i++)\n                if(selectedIndices[i] === index) {\n                    // console.log(\"Playing instruction \", index, instruction);\n                    return instruction;\n                }\n            // console.log(\"Skipping instruction \", index, instruction);\n        })\n        // TrackPlayback with selective callback\n        if(selectedIndices.length > 0)\n            playback.playAtStartingTrackIndex(destination, selectedIndices[0])\n        // playback.play(destination);\n\n\n        // for(let i=0; i<selectedIndices.length; i++) {\n        //     const selectedIndex = selectedIndices[i];\n        //     const instruction = song.instructionGetByIndex(trackName, selectedIndex);\n        //     song.playInstruction(destination, instruction, trackState.programID);\n        // }\n\n    }\n\n    // playInstructionAtIndex(destination, trackName, instructionIndex, noteStartTime = null) {\n    //     const instruction = this.instructionGetByIndex(trackName, instructionIndex, false);\n    //     if (instruction)\n    //         this.playInstruction(instruction, noteStartTime);\n    //     else\n    //         console.warn(\"No instruction at index\");\n    // }\n\n    playInstruction(destination, instruction, program, noteStartTime = null, onstart=null, onended=null) {\n        destination = this.getVolumeGain(destination);\n\n        const audioContext = destination.context;\n        if (!instruction instanceof Instruction)\n            throw new Error(\"Invalid instruction\");\n\n        // if(this.playback)\n        //     this.stopPlayback();\n\n        // if (instruction instanceof ASCTrackInstruction) { // Handled in  TrackPlayback\n        //     return new TrackPlayback(destination, this, instruction.getTrackName(), noteStartTime);\n        // }\n\n\n        // const noteDuration = (instruction.duration || 1) * (60 / beatsPerMinute);\n\n        let noteDuration = null;\n        if(typeof instruction.durationTicks !== \"undefined\") {\n            let beatsPerMinute = this.data.beatsPerMinute; // getStartingBeatsPerMinute();\n            let timeDivision = this.data.timeDivision;\n            const noteDurationTicks = instruction.durationTicks; // (timeDivision);\n            noteDuration = (noteDurationTicks / timeDivision) / (beatsPerMinute / 60);\n        }\n\n        let currentTime = audioContext.currentTime;\n\n        if (!noteStartTime && noteStartTime !== 0)\n            noteStartTime = currentTime;\n\n\n        this.playProgram(destination, program, instruction.command, noteStartTime, noteDuration, instruction.velocity, onstart, onended);\n        // Wait for note to start\n        // if (noteStartTime > currentTime) {\n        //     await this.wait(noteStartTime - currentTime);\n        //     // await new Promise((resolve, reject) => setTimeout(resolve, (noteStartTime - currentTime) * 1000));\n        // }\n\n        // Dispatch note start event\n        // this.dispatchEvent({\n        //     type: 'note:start',\n        //     trackName,\n        //     instruction,\n        //     song: this\n        // });\n\n        // currentTime = audioContext.currentTime;\n        // if (noteStartTime + noteDuration > currentTime) {\n        //     await this.wait(noteStartTime + noteDuration - currentTime);\n        //     // await new Promise((resolve, reject) => setTimeout(resolve, (noteStartTime + noteDuration - currentTime) * 1000));\n        // }\n        // // TODO: check for song stop\n        // // Dispatch note end event\n        // this.dispatchEvent({\n        //     type: 'note:end',\n        //     trackName,\n        //     instruction,\n        //     song: this\n        // });\n    }\n\n\n\n    /** Song Modification History **/\n\n\n\n    queueHistoryAction(action, pathList, data = null, oldData = null) {\n        if(Array.isArray(pathList))\n            pathList = pathList.join('.');\n        const historyAction = [\n            action + ':' + pathList,\n        ];\n        if (data !== null || oldData !== null)\n            historyAction.push(data);\n        if (oldData !== null)\n            historyAction.push(oldData);\n        // this.history.push(historyAction);\n\n        // setTimeout(() => {\n\n        this.dispatchEvent({\n            type: 'song:modified',\n            historyAction,\n            song: this\n        });\n\n        return historyAction;\n    }\n\n\n\n    /** History **/\n\n    // applyHistoryActions(songHistory) {\n    //     for (let i = 0; i < songHistory.length; i++) {\n    //         const historyAction = songHistory[i];\n    //         switch (historyAction.action) {\n    //             case 'reset':\n    //                 Object.assign(this.data, historyAction.data);\n    //                 break;\n    //             case 'insert':\n    //                 this.insertDataPath(historyAction.path, historyAction.data);\n    //                 break;\n    //             case 'delete':\n    //                 this.deleteDataPath(historyAction.path);\n    //                 break;\n    //             case 'replace':\n    //                 this.updateData(historyAction.path, historyAction.data);\n    //                 break;\n    //             default:\n    //                 throw new Error(\"Unknown history action: \" + historyAction.action);\n    //         }\n    //     }\n    //     this.history = [];\n    //     this.instructionProcessGroupData();\n    // }\n\n\n    /** Static Song Loading **/\n\n    /** @deprecated **/\n    static loadSongFromData(audioContext, songData) {\n        const song = new Song();\n        song.loadSongData(songData);\n        return song;\n    }\n\n    /** @deprecated **/\n    static loadSongFromMemory(audioContext, songUUID) {\n        const storage = new Storage();\n        const songData = storage.loadSongFromMemory(songUUID);\n        const songHistory = storage.loadSongHistoryFromMemory(songUUID);\n        const song = new Song(songData);\n        song.loadSongData(songData);\n        song.loadSongHistory(songHistory);\n        return song;\n    }\n\n    /** @deprecated **/\n    static loadSongFromFileInput(audioContext, file) {\n        const library = Song.getFileSupportModule(file.name);\n        if (typeof library.loadSongDataFromFileInput !== \"function\")\n            throw new Error(\"Invalid library.loadSongDataFromFileInput method\");\n\n        const buffer = Song.loadBufferFromFileInput(file);\n        const songData = library.loadSongDataFromBuffer(buffer, file.name);\n        const song = new Song();\n        song.loadSongData(songData);\n        return song;\n    }\n\n    /** @deprecated **/\n    static async loadSongFromURL(audioContext, src) {\n        const library = Song.getFileSupportModule(src);\n        if (typeof library.loadSongDataFromBuffer !== \"function\")\n            throw new Error(\"Invalid library.loadSongDataFromURL method: \" + src);\n\n        const fileService = new FileService();\n        const buffer = await fileService.loadBufferFromURL(src);\n        // const buffer = await response.arrayBuffer();\n        const songData = library.loadSongDataFromBuffer(buffer, src);\n        const song = new Song();\n        song.loadSongData(songData);\n        return song;\n    }\n\n    /** @deprecated **/\n    static async loadBufferFromFileInput(file) {\n        return await new Promise((resolve, reject) => {\n            let reader = new FileReader();                                      // prepare the file Reader\n            reader.readAsArrayBuffer(file);                 // read the binary data\n            reader.onload =  (e) => {\n                resolve(e.target.result);\n            };\n        });\n    }\n\n    /** Static Fle Support Module **/\n\n    static getFileSupportModule(filePath) {\n        // const AudioSourceLoader = customElements.get('audio-source-loader');\n        // const requireAsync = AudioSourceLoader.getRequireAsync(thisModule);\n        const fileExt = filePath.split('.').pop().toLowerCase();\n        let library;\n        switch (fileExt) {\n            // case 'mid':\n            // case 'midi':\n            //     const {MIDISupport} = require('../file/MIDIFile.js');\n            //     return new MIDISupport;\n            //\n            case 'json':\n                library = new JSONSongFile();\n                // await library.init();\n                return library;\n            //\n            case 'nsf':\n            case 'nsfe':\n            case 'spc':\n            case 'gym':\n            case 'vgm':\n            case 'vgz':\n            case 'ay':\n            case 'sgc':\n            case 'kss':\n                library = new GMESongFile();\n                library.init();\n                return library;\n            //\n            // case 'mp3':\n            //     const {MP3Support} = require('../file/MP3File.js');\n            //     return new MP3Support;\n\n            default:\n                throw new Error(\"Unknown file module for file type: \" + fileExt);\n        }\n    };\n\n\n\n\n    /** Generate Song Data **/\n\n    static generateTitle() {\n        return `Untitled (${new Date().toJSON().slice(0, 10).replace(/-/g, '/')})`;\n    }\n\n}\n\nSong.DEFAULT_VOLUME = 0.7;\n\n\n// Song.loadSongFromMIDIFile = async function (file, defaultProgramURL = null) {\n//     defaultProgramURL = defaultProgramURL || this.getDefaultProgramURL();\n//     const midiSupport = new MIDIImport();\n//     const songData = await midiSupport.loadSongFromMidiFile(file, defaultProgramURL);\n//     const song = new Song();\n//     await song.loadSongData(songData);\n//     return song;\n// };\n\n\n\n\nexport default Song;\n","class Keyboard {\n\n    getKeyboardLayout(layoutName=null) {\n        switch(layoutName) {\n            default:\n            case '2octave':\n                return {\n                    '@':'C#4',  '#':'D#4',  '%':'F#4', '^':'G#4',   '&':'A#4',  '*':'C#3',  ')':'D#3',\n                    'Q':'C4',   'W':'D4',   'E':'E4',   'R':'F4',   'T':'G4',   'Y':'A4',   'U':'B4',   'I':'C3',   'O':'D3',   'P':'E3',\n                    'S':'C#3',  'D':'D#3',  'G':'F#3',  'H':'G#3',  'J':'A#3',  'L':'C#4',  ':':'D#4',\n                    'Z':'C3',   'X':'D3',   'C':'E3',   'V':'F3',   'B':'G3',   'N':'A3',   'M':'B3', '<':'C4', '>':'D4', '?':'E4',\n\n                    '2':'C#2', '3':'D#2', '5':'F#2', '6':'G#2', '7':'A#2', '9':'C#3', '0':'D#3',\n                    'q':'C2', 'w':'D2', 'e':'E2', 'r':'F2', 't':'G2', 'y':'A2', 'u':'B2', 'i':'C3', 'o':'D3', 'p':'E3',\n                    's':'C#1', 'd':'D#1', 'g':'F#1', 'h':'G#1', 'j':'A#1', 'l':'C#2', ';':'D#2',\n                    'z':'C1', 'x':'D1', 'c':'E1', 'v':'F1', 'b':'G1', 'n':'A1', 'm':'B1', ',':'C2', '.':'D2', '/':'E2',\n                };\n\n            case '4octave':\n                return {\n                    // '1':'C4', '2':'C#4', '3':'D4', '4':'D#4', '5':'E4', '6':'F4', '7':'F#4', '8': 'G4', '9':'G#4', '0':'A4', \"-\":'A#4', \"=\":'B4', // TODO special commands?\n                    'Q':'C6', 'W':'C#6', 'E':'D6', 'R':'D#6', 'T':'E6', 'Y':'F6', 'U':'F#6', 'I': 'G6', 'O':'G#6', 'P':'A6', \"{\":'A#6', \"}\":'B6',\n                    'A':'C5', 'S':'C#5', 'D':'D5', 'F':'D#5', 'G':'E5', 'H':'F5', 'J':'F#5', 'K': 'G5', 'L':'G#5', ':':'A5', '\"': 'A#5',\n                    'Z':'C4', 'X':'C#4', 'C':'D4', 'V':'D#4', 'B':'E4', 'N':'F4', 'M':'F#4', '<': 'G4', '>':'G#4', '?':'A4',\n\n\n                    'q':'C3', 'w':'C#3', 'e':'D3', 'r':'D#3', 't':'E3', 'y':'F3', 'u':'F#3', 'i': 'G3', 'o':'G#3', 'p':'A3', \"[\":'A#3', \"]\":'B3',\n                    'a':'C2', 's':'C#2', 'd':'D2', 'f':'D#2', 'g':'E2', 'h':'F2', 'j':'F#2', 'k': 'G2', 'l':'G#2', ';':'A2', \"'\":'A#2',\n                    'z':'C1', 'x':'C#1', 'c':'D1', 'v':'D#1', 'b':'E1', 'n':'F1', 'm':'F#1', ',': 'G1', '.':'G#1', '/':'A1',\n                };\n        }\n    }\n\n    getKeyboardCommand(key, octave = 3, layoutName = null) {\n        if (!Number.isInteger(octave))\n            throw new Error(\"Octave value must be an integer\");\n        const keyboardLayout = this.getKeyboardLayout(layoutName);\n        if (typeof keyboardLayout[key] === 'undefined')\n            return null;\n        // const octave = parseInt(this.editor.track.fieldTrackerOctave.value) || 1;\n        let command = keyboardLayout[key];\n        for (let i = 6; i >= 1; i--)\n            command = command.replace(i, octave + i - 1);\n        return command;\n    }\n\n}\n\n\nexport default Keyboard;\n","\nimport Song from \"./Song\";\nimport Storage from \"../common/storage/Storage\";\nimport Keyboard from \"../common/keyboard/Keyboard\"\nimport {ProgramLoader} from \"../common/program\";\nimport {Instruction, NoteInstruction, TrackInstruction, InstructionIterator} from \"./instruction\";\nimport SongValues from \"./values/SongValues\";\nimport {TrackIterator, TrackPlayback} from \"./track\";\nimport Library from \"./library/Library\";\nexport {\n    Song,\n    Library,\n    ProgramLoader,\n\n    Instruction,\n    NoteInstruction,\n    TrackInstruction,\n    InstructionIterator,\n\n    TrackIterator,\n    TrackPlayback,\n\n    Storage,\n\n    Keyboard,\n\n    SongValues,\n}\n","import React from \"react\";\nimport {Text, TouchableHighlight, View} from \"react-native\";\n\nimport ASUIMenuContext from \"../menu/ASUIMenuContext\";\n\nexport default class ASUIClickableBase extends React.Component {\n    /** Context **/\n    static contextType = ASUIMenuContext;\n\n    constructor(props) {\n        super(props);\n        this.cb = {\n            onMouseInput: e => this.onMouseInput(e),\n            onKeyDown: e => this.onKeyDown(e),\n        };\n    }\n\n\n    render() {\n\n        return (\n            <TouchableHighlight\n                onPress={this.cb.onMouseInput}\n                onLongPress={this.cb.onMouseInput}\n            >\n                <View\n                    children={this.renderChildren()}\n                    />\n            </TouchableHighlight>\n        );\n    }\n\n    renderChildren(textProps={}) {\n        let children = this.props.children;\n        if(typeof children !== 'object')\n            children = <Text children={children} {...textProps}></Text>;\n        return children;\n    }\n\n    /** User Input **/\n\n    onMouseInput(e) {\n        if(e.defaultPrevented)\n            return;\n        e.preventDefault();\n        this.doAction(e);\n    }\n\n\n    onKeyDown(e) {\n        if(e.isDefaultPrevented())\n            return;\n        switch(e.key) {\n            case ' ':\n            case 'Enter':\n                this.doAction(e);\n                break;\n\n            default:\n                console.info(\"Unhandled key: \", e.key);\n                break;\n        }\n    }\n\n    /** Actions **/\n\n    doAction(e) {\n        throw new Error(\"Not implemented\");\n    }\n\n    /** Overlay Context **/\n\n    getOverlay() { return this.context.overlay; }\n\n    closeAllDropDownMenus() {\n        if(this.getOverlay())\n            this.getOverlay().closeAllMenus();\n    }\n\n}\n","import Instruction from \"./Instruction\";\n\nclass TrackInstruction extends Instruction {\n\n\n    getTrackName() {\n        return typeof this.data[1] === \"string\" ? this.data[1].substr(1) : undefined;\n    }\n\n    setTrackName(newTrackName) {\n        this.data[1] = `@${newTrackName}`;\n    }\n\n    get instruction() {\n        return this.data[2];\n    }\n\n    set instruction(newCommand) {\n        this.data[2] = newCommand;\n    }\n\n    get durationTicks() {\n        return this.data[3] || undefined;\n    }\n\n    set durationTicks(newDuration) {\n        newDuration = parseFloat(newDuration);\n        if (Number.isNaN(newDuration))\n            throw new Error(\"Invalid Duration\");\n        this.data[3] = newDuration;\n    }\n\n    get velocity() {\n        return undefined;\n    }\n\n    clone() {\n        return new TrackInstruction(this.data.slice())\n    }\n}\n\nexport default TrackInstruction;\n","\nexport default class PromptManager {\n\n    /** Prompt **/\n\n    static async openPromptDialog(message, defaultValue='') {\n        return window.prompt(message, defaultValue);\n    }\n\n    static async openConfirmDialog(message) {\n        return window.confirm(message);\n    }\n}\n","import Instruction from \"./Instruction\";\n\nclass NoteInstruction extends Instruction {\n\n\n    get durationTicks() {\n        return typeof this.data[2] !== \"undefined\" ? this.data[2] : undefined;\n    }\n\n    set durationTicks(newDuration) {\n        newDuration = parseFloat(newDuration);\n        if (Number.isNaN(newDuration))\n            throw new Error(\"Invalid Duration\");\n        this.data[2] = newDuration;\n    }\n\n    get velocity() {\n        return typeof this.data[3] !== \"undefined\" ? this.data[3] : undefined;\n    }\n\n    set velocity(newVelocity) {\n        newVelocity = parseFloat(newVelocity);\n        if (Number.isNaN(newVelocity))\n            throw new Error(\"Invalid Velocity\");\n        this.data[3] = newVelocity;\n    }\n\n\n    clone() {\n        return new NoteInstruction(this.data.slice());\n    }\n}\n\nexport default NoteInstruction;\n","import Instruction from \"./Instruction\";\nimport ProgramLoader from \"../../common/program/ProgramLoader\";\n\nclass CommandInstruction extends Instruction {\n\n    getCommandName() {\n        return typeof this.data[1] === \"string\" ? this.data[1].substr(1) : undefined;\n    }\n\n    setCommandName(newCommandName) {\n        this.data[1] = `!${newCommandName}`;\n    }\n\n    getParams() {\n        return this.data.slice(2);\n    }\n\n    get durationTicks() {\n        return undefined;\n    }\n\n    get velocity() {\n        return undefined;\n    }\n\n\n    /**\n     * @param {CommandInstruction} song\n     * @param trackStats\n     */\n    processCommandInstruction(song, trackStats) {\n        const command = this.getCommandName().toLowerCase();\n        switch(command) {\n            case 'program':      // Set Program (can be changed many times per track)\n            case 'p':\n                const oldProgram = trackStats.program;\n                const oldDestination = trackStats.destination;\n                let programInstance = this.loadProgramFromParams(song);\n                trackStats.program = programInstance;\n\n                // useDestination allows for audio processing (i.e. effects)\n                if(typeof programInstance.useDestination === 'function')\n                    trackStats.destination = programInstance.useDestination(oldDestination);\n\n                // useProgram allows for both note processing and audio processing effects\n                if(typeof programInstance.useProgram === 'function')\n                    programInstance.useProgram(oldProgram);\n\n                break;\n\n            // case 'destination':     // Append destination (does not handle note processing)\n            // case 'd':\n            //     // if(!trackStats.originalDestination)\n            //     //     trackStats.originalDestination = trackStats.destination;\n            //     trackStats.destination = instruction.loadDestinationFromParams(trackStats.destination, this.song);\n            //\n            //     // this.song.programLoadInstance()\n            //     break;\n\n            default:\n                return console.error(\"Unknown command instruction: \" + command);\n        }\n    }\n\n\n    loadProgramFromParams(song) {\n        const params = this.getParams();\n        let program;\n        if(typeof params[0] === \"string\") {\n            program = ProgramLoader.loadInstance(params[0], params[1]);\n        } else {\n            program = song.programLoadInstanceFromID(params[0]);\n        }\n        return program;\n    }\n\n\n    clone() {\n        return new CommandInstruction(this.data.slice());\n    }\n}\n\nexport default CommandInstruction;\n","import Instruction from \"./Instruction\";\n\nclass MIDIInstruction extends Instruction {\n\n    get instruction() {\n        return this.data[2];\n    }\n\n    set instruction(newCommand) {\n        this.data[2] = newCommand;\n    }\n\n    get durationTicks() {\n        return null;\n    }\n\n    set durationTicks(newDuration) {\n        throw new Error(\"Unable to set duration on MIDI instruction\");\n    }\n\n}\n\nexport default MIDIInstruction;\n","\r\nimport {Library} from \"../../song\";\r\n\r\nexport default class extends Library {\r\n  getTitle() { return \"Mohayonao Wave Library Index\"; }\r\n  getPresets() {\r\n    const library = require(\"./mohayonao.library.json\") || [];\r\n    return library.samples.map(preset => {\r\n      if(typeof preset !== \"object\")\r\n        preset = {url: preset, type:'custom'};\r\n      if(!preset.title)\r\n        preset.title = preset.url.split('/').pop();\r\n      if(library.baseURL)\r\n        preset.url = library.baseURL + preset.url;\r\n      return ['OscillatorInstrument', preset];\r\n    });\r\n  }\r\n}\r\n","import MohayonaoWaveLibrary from \"./wave/mohayonao.library.js\";\r\nimport {Library} from \"../song\";\r\n\r\nexport default class extends Library {\r\n  getTitle() { return \"Periodic Wave Library Index\"; }\r\n  getLibraries() {\r\n    return [\r\n      new MohayonaoWaveLibrary()\r\n    ];\r\n  }\r\n}\r\n","\nimport {Library} from \"../../../song\";\n\nexport default class extends Library {\n\tgetTitle() { return \"FreeWaveSamples.com\"; }\n}\n","import FWSLibrary from \"./gm/fws/fws.library.js\";\r\n\r\nimport {Library} from \"../song\";\r\n\r\nexport default class extends Library {\r\n  getTitle() { return \"Sample Library Index\"; }\r\n  getLibraries() {\r\n    return [\r\n        new FWSLibrary()\r\n    ];\r\n  }\r\n\r\n  getPlaylists() {\r\n    return [\r\n      \"assets/files/test.pl.json;Test Playlist\"\r\n    ]\r\n  }\r\n}\r\n","import WaveLibrary from \"./samples/wave.library.js\";\r\nimport SampleLibrary from \"./samples/sample.library\";\r\nimport MohayonaoWaveLibrary from \"./samples/wave/mohayonao.library.js\";\r\n\r\nimport {Library} from \"./song\";\r\n\r\nexport default class extends Library {\r\n  getTitle() { return \"Audio Source Index\"; }\r\n  getLibraries() {\r\n    return [\r\n      new SampleLibrary(),\r\n      new WaveLibrary(),\r\n      new MohayonaoWaveLibrary(),\r\n    ];\r\n  }\r\n\r\n  getPlaylists() {\r\n    return [\r\n      \"assets/files/test.pl.json;Test ASPPlaylist\"\r\n    ]\r\n  }\r\n}\r\n\r\n","import React from \"react\";\nimport {View} from \"react-native\";\n\nexport default class SongProxyWebViewClient extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            song: null\n        }\n        this.webView = React.createRef();\n        this.cb = {\n            onMessage: data => this.onMessage(data)\n        }\n    }\n\n    componentDidMount() {\n\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return false;\n    }\n\n    postMessage(args) {\n        if(typeof args !== \"string\")\n            args = JSON.stringify(args);\n\n        if(!window.ReactNativeWebView)\n            return console.warn('SongProxyWebViewClient.postMessage: window.ReactNativeWebView is ' + typeof window.ReactNativeWebView);\n\n        window.ReactNativeWebView.postMessage(args);\n    }\n\n    render() {\n\n        if(window && !window._AUDIOSOURCE) {\n            window._AUDIOSOURCE = {\n                SONGCLASSES: require('../')\n            }\n\n\n            document.addEventListener(\"message\", (event) => {\n                console.log(\"Received post message\", event.data);\n                this.postMessage('echo ' + event.data);\n\n            }, false);\n\n            this.postMessage(['load']);\n        }\n\n        return <View/>;\n    }\n\n    // sendSongCommand(...args) {\n    //     args.unshift('song');\n    //     const argString = JSON.stringify(args);\n    //     const webView = this.webView.current;\n    //     webView.postMessage(argString);\n    //     console.log('postMessage', argString);\n    // }\n    //\n    // onMessage(data) {\n    //     console.log(\"Message: \", data.nativeEvent.data);\n    // }\n}\n","import React from 'react';\nimport './App.css';\n\nimport SongProxyWebViewClient from \"./audio-source/song/proxy/SongProxyWebViewClient\";\n// import MenuOverlayContainer from \"./audio-source/components/menu/MenuOverlayContainer\";\n\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            // menuOpen: true,\n            // menuOptions: null\n        };\n\n        // setTimeout(e => this.toggleMenu(), 200);\n    }\n\n    toggleMenu = () => {\n        this.setState({ menuOpen: !this.state.menuOpen });\n        if(!this.state.menuOpen)\n            this.playerElm.switchToMenu(null);\n    };\n\n    updateMenu = () => {\n        this.forceUpdate();\n    };\n\n    componentDidMount() {\n    }\n\n    renderDrawerContent() {\n        // let content = <Text>Close</Text>;\n        // if(this.playerElm)\n        //     content = this.playerElm.renderMenu();\n        // return (\n        //     <TouchableOpacity onPress={this.toggleMenu}>\n        //         <View style={styles.menuContainer}>{content}</View>\n        //     </TouchableOpacity>\n        // );\n    }\n\n    render() {\n        return <SongProxyWebViewClient/>;\n        // return (\n        //     <BrowserRouter>\n        //         <Switch>\n        //             <Route path={['/blank', '/proxy']}>\n        //                 <SongProxyWebViewClient/>\n        //             </Route>\n        //             <Route path={['/player', '/p']}>\n        //                 {this.renderPlayer()}\n        //             </Route>\n        //             <Route path={['/composer', '/c']}>\n        //                 {this.renderPlayer()}\n        //             </Route>\n        //             <Route path=\"/\" >\n        //                 {this.renderComposer()}\n        //                 {this.renderPlayer()}\n        //             </Route>\n        //         </Switch>\n        //     </BrowserRouter>\n        // );\n    }\n\n    // renderPlayer() {\n    //     return (\n    //         <ASPlayer\n    //             src=\"files/test.pl.json\"\n    //             ref = {ref => this.playerElm = ref}\n    //             onToggleMenu={this.toggleMenu}\n    //             onUpdateMenu={this.updateMenu}\n    //         />\n    //     );\n    // }\n    //\n    // renderComposer() {\n    //     return (\n    //         <ASComposer\n    //             // src=\"files/demo.json\"\n    //             ref = {ref => this.composer = ref}\n    //             onToggleMenu={this.toggleMenu}\n    //             onRenderMenu={e => this.menu.onRenderMenu}\n    //         />\n    //     );\n    // }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that file SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}