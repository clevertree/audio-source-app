(this["webpackJsonpaudio-source-web"]=this["webpackJsonpaudio-source-web"]||[]).push([[0],[,,,,function(e,t,n){"use strict";var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=n(0),c=n.n(u),l=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this.props.children;return"function"===typeof e&&(e=e(this)),c.a.createElement("div",this.props,e)}}]),t}(c.a.Component),f=(n(104),function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).call(this,e,{}))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e="asui-icon";return this.props.source&&(e+=" "+this.props.source),c.a.createElement("div",{className:e})}}]),t}(c.a.Component)),d=n(41),h=n.n(d),p=n(18),m=n(26),v=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).cb={onMouseInput:function(e){return n.onMouseInput(e)},onKeyDown:function(e){return n.onKeyDown(e)}},n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getOverlay",value:function(){return this.context.overlay}},{key:"render",value:function(){var e="asui-menu-item";return this.props.className&&(e+=" "+this.props.className),this.props.disabled&&(e+=" disabled"),this.props.selected&&(e+=" selected"),c.a.createElement("div",{title:this.props.title,className:e,onClick:this.cb.onMouseInput,onKeyDown:this.cb.onKeyDown,tabIndex:0},this.props.children)}},{key:"doAction",value:function(e){if(this.props.disabled)console.warn(this.constructor.name+" is disabled.",this);else{if(!this.props.onAction)throw new Error("Button does not contain props 'onAction'");!1!==this.props.onAction(e,this)&&this.closeAllDropDownMenus()}}}]),t}(m.a);v.contextType=p.a,v.defaultProps={},v.propTypes={onAction:h.a.func.isRequired,disabled:h.a.bool};var g=n(55),y=(n(107),n(3)),k=n.n(y),w=n(8),b=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={open:!1,stick:!1},n.divRef=c.a.createRef(),n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getOverlay",value:function(){return this.context.overlay}},{key:"componentDidUpdate",value:function(e,t,n){this.getOverlay()&&(this.state.open?this.getOverlay().addCloseMenuCallback(this,this.closeMenu.bind(this)):this.getOverlay().removeCloseMenuCallback(this)),this.updateScreenPosition()}},{key:"componentWillUnmount",value:function(){this.getOverlay()&&this.getOverlay().removeCloseMenuCallback(this)}},{key:"render",value:function(){if(!this.state.open)return null;var e="asui-menu-dropdown";if(this.props.vertical&&(e+=" vertical"),this.state.stick&&(e+=" stick"),this.props.disabled)return"Disabled";var t=this.state.options;return c.a.createElement(p.a.Provider,{value:{overlay:this.getOverlay(),parentDropDown:this}},c.a.createElement("div",{className:e,children:t,ref:this.divRef}))}},{key:"hoverMenu",value:function(){!0!==this.state.open&&this.getOverlay()&&this.getOverlay().isHoverEnabled()&&this.openMenu()}},{key:"toggleMenu",value:function(){this.state.open?this.state.stick?this.closeMenu():this.stickMenu():this.openMenu()}},{key:"openMenu",value:function(){var e=Object(w.a)(k.a.mark((function e(){var t,n=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.disabled){e.next=2;break}return e.abrupt("return",console.error("Menu is disabled"));case 2:if(!this.state.open){e.next=4;break}throw new Error("Menu was already open");case 4:if(!this.getOverlay()){e.next=8;break}if(!1===this.getOverlay().openMenu(this.props.options)){e.next=8;break}return e.abrupt("return");case 8:if("function"===typeof(t=this.props.options)&&(t=t(this)),!(t instanceof Promise)){e.next=14;break}return e.next=13,t;case 13:t=e.sent;case 14:t||console.warn("Empty options returned by ",this),this.setState({open:!0,options:t}),setTimeout((function(){n.getOverlay().closeMenus(n.getAncestorMenus())}),100);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stickMenu",value:function(){if(!this.state.open)throw new Error("Unable to stick. Menu was not yet open");this.getAncestorMenus().forEach((function(e){e.setState({stick:!0})}))}},{key:"closeMenu",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.stick&&!0===e||this.setState({open:!1,stick:!1,options:null})}},{key:"getAncestorMenus",value:function(){for(var e=[],t=this;t;)e.push(t),t=t.context.parentDropDown;return e}},{key:"closeAllDropDownMenus",value:function(){this.getOverlay()&&this.getOverlay().closeAllMenus()}},{key:"updateScreenPosition",value:function(){if(this.state.open&&this.divRef.current){var e=this.divRef.current,t=e.getBoundingClientRect();t.right>window.innerWidth&&e.classList.add("overflow-right"),t.bottom>window.innerHeight&&e.classList.add("overflow-bottom")}}}]),t}(c.a.Component);b.contextType=p.a,b.defaultProps={vertical:!1};var _=b,E=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).dropdown=c.a.createRef(),n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"renderChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!0===this.props.arrow?this.props.vertical?"\u25bc":"\u25ba":this.props.arrow;return[Object(g.a)(Object(i.a)(t.prototype),"renderChildren",this).call(this,e),n?c.a.createElement("div",{className:"arrow"},n):null,c.a.createElement(_,{ref:this.dropdown,disabled:this.props.disabled,options:this.props.options,vertical:this.props.vertical})]}},{key:"toggleMenu",value:function(){return this.dropdown.current.toggleMenu()}},{key:"hoverMenu",value:function(){return this.dropdown.current.hoverMenu()}},{key:"doAction",value:function(e){this.toggleMenu()}}]),t}(m.a);E.defaultProps={arrow:!0,vertical:!0},E.propTypes={options:h.a.any.isRequired};var O=n(9),x=(n(108),function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e="asui-form";this.props.className&&(e+=" "+this.props.className);var t=this.props.children;return"function"===typeof t&&(t=t(this)),c.a.createElement("div",{className:e},this.props.header?c.a.createElement("div",{className:"header"},this.props.header):null,c.a.createElement("div",{className:"container"},t))}}]),t}(c.a.Component));x.defaultProps={};n(109);var P=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e="asui-panel";this.props.className&&(e+=" "+this.props.className);var t=this.props.children;return"function"===typeof t&&(t=t(this)),c.a.createElement("div",Object.assign({},this.props,{className:e}),this.props.header?c.a.createElement("div",{className:"header"},this.props.header):null,t)}}]),t}(c.a.Component);P.defaultProps={};n(110);var D=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,t),(e=Object(o.a)(this,Object(i.a)(t).call(this,n))).cb={onChange:function(t){return e.onChange(t)},onClick:function(t){return e.onClick(t)}},e}return Object(s.a)(t,e),Object(a.a)(t,[{key:"onClick",value:function(e){e.preventDefault();var t=parseFloat(e.target.value);this.props.onChange(e,t)}},{key:"onChange",value:function(e){e.preventDefault();var t=parseFloat(e.target.value);this.props.onChange(e,t)}},{key:"render",value:function(){var e="asui-input-range";return this.props.className&&(e+=" "+this.props.className),c.a.createElement("input",{className:e,type:"range",value:this.props.value,onChange:this.cb.onChange,onClick:this.cb.onClick,min:this.props.min,max:this.props.max,step:this.props.step,name:this.props.name,title:this.props.title})}}]),t}(c.a.Component);D.defaultProps={};var S=D;n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return E})),n.d(t,"f",(function(){return O.a})),n.d(t,"g",(function(){return O.b})),n.d(t,"h",(function(){return O.c})),n.d(t,"e",(function(){return S}))},,,,,function(e,t,n){"use strict";var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=n(26),c=(n(56),function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getClassName",value:function(){return"asui-menu-item"}}]),t}(u.a)),l=n(0),f=n.n(l),d=n(18),h=(n(102),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={open:!1,stick:!1},n.divRef=f.a.createRef(),n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getOverlay",value:function(){return this.context.overlay}},{key:"componentDidUpdate",value:function(e,t,n){this.getOverlay()&&(this.state.open?this.getOverlay().addCloseMenuCallback(this,this.closeMenu.bind(this)):this.getOverlay().removeCloseMenuCallback(this)),this.updateScreenPosition()}},{key:"componentWillUnmount",value:function(){this.getOverlay()&&this.getOverlay().removeCloseMenuCallback(this)}},{key:"render",value:function(){if(!this.state.open)return null;var e="asui-menu-dropdown";if(this.props.vertical&&(e+=" vertical"),this.state.stick&&(e+=" stick"),this.props.disabled)return"Disabled";var t=this.props.options;return"function"===typeof t&&(t=t(this)),t||console.warn("Empty options returned by ",this),f.a.createElement(d.a.Provider,{value:{overlay:this.getOverlay(),parentDropDown:this}},f.a.createElement("div",{className:e,children:t,ref:this.divRef}))}},{key:"hoverMenu",value:function(){!0!==this.state.open&&this.getOverlay()&&this.getOverlay().isHoverEnabled()&&this.openMenu()}},{key:"toggleMenu",value:function(){this.state.open?this.state.stick?this.closeMenu():this.stickMenu():this.openMenu()}},{key:"openMenu",value:function(){var e=this;if(this.props.disabled)return console.error("Menu is disabled");if(this.state.open)throw new Error("Menu was already open");if(this.getOverlay()&&!1!==this.getOverlay().openMenu(this.props.options))return;this.setState({open:!0}),setTimeout((function(){e.getOverlay().closeMenus(e.getAncestorMenus())}),100)}},{key:"stickMenu",value:function(){if(!this.state.open)throw new Error("Unable to stick. Menu was not yet open");this.getAncestorMenus().forEach((function(e){e.setState({stick:!0})}))}},{key:"closeMenu",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.stick&&!0===e||this.setState({open:!1,stick:!1,options:null})}},{key:"getAncestorMenus",value:function(){for(var e=[],t=this;t;)e.push(t),t=t.context.parentDropDown;return e}},{key:"closeAllDropDownMenus",value:function(){this.getOverlay()&&this.getOverlay().closeAllMenus()}},{key:"updateScreenPosition",value:function(){if(this.state.open&&this.divRef.current){var e=this.divRef.current,t=e.getBoundingClientRect();t.right>window.innerWidth&&e.classList.add("overflow-right"),t.bottom>window.innerHeight&&e.classList.add("overflow-bottom")}}}]),t}(f.a.Component));h.contextType=d.a,h.defaultProps={vertical:!1};var p=h,m=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).cb={onKeyDown:function(e){return n.onKeyDown(e)},onMouseInput:function(e){return n.onMouseInput(e)}},n.dropdown=f.a.createRef(),n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getClassName",value:function(){return"asui-menu-item"}},{key:"render",value:function(){var e=this.getClassName();this.props.className&&(e+=" "+this.props.className),this.props.disabled&&(e+=" disabled"),this.props.selected&&(e+=" selected");var t=!0===this.props.arrow?this.props.vertical?"\u25bc":"\u25ba":this.props.arrow;return f.a.createElement("div",{title:this.props.title,className:e,onMouseEnter:this.cb.onMouseInput,onClick:this.cb.onMouseInput,onKeyDown:this.cb.onKeyDown,tabIndex:0},this.props.children,t?f.a.createElement("div",{className:"arrow"},t):null,f.a.createElement(p,{ref:this.dropdown,disabled:this.props.disabled,options:this.props.options,vertical:this.props.vertical}))}},{key:"toggleMenu",value:function(){return this.dropdown.current.toggleMenu()}},{key:"hoverMenu",value:function(){return this.dropdown.current.hoverMenu()}},{key:"onMouseInput",value:function(e){if(!e.defaultPrevented)switch(e.preventDefault(),e.type){case"click":if(this.props.onClick&&!1===this.props.onClick(e))return;this.toggleMenu();break;case"mouseenter":case"mouseover":this.hoverMenu();break;default:throw new Error("Unknown Mouse event: "+e.type)}}},{key:"onKeyDown",value:function(e){if(!e.isDefaultPrevented())switch(e.key){case" ":case"Enter":this.toggleMenu();break;default:console.info("Unhandled key: ",e.key)}}},{key:"onMouseEnter",value:function(e){this.toggleMenu()}}]),t}(f.a.Component);m.defaultProps={arrow:!0,vertical:!1};var v=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return f.a.createElement("hr",{className:"asui-menu-break"})}}]),t}(f.a.Component),g=(n(103),n(3)),y=n.n(g),k=n(8),w=n(10);f.a.Component;n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return m}))},,function(e,t,n){"use strict";var r=n(10),a=n(1),o=n(2),i=n(0),s=n.n(i),u=function(){function e(t){Object(a.a)(this,e),this.song=t}return Object(o.a)(e,[{key:"loadInstanceFromDestination",value:function(e,t){return this.loadInstanceFromID(e)}},{key:"getData",value:function(e){if(!this.song.data.programs[e])throw new Error("Invalid program ID: "+e);return this.song.data.programs[e]}},{key:"getClassName",value:function(e){var t=this.getData(e);return Object(r.a)(t,1)[0]}},{key:"getConfig",value:function(e){var t=this.getData(e);return Object(r.a)(t,2)[1]}},{key:"getClass",value:function(t){var n=this.getClassName(t);return e.getProgramClassInfo(n).classProgram}},{key:"loadInstanceFromID",value:function(t){var n=this.getData(t),a=Object(r.a)(n,2),o=a[0],i=a[1];return e.loadInstance(o,i)}},{key:"programLoadRenderer",value:function(t){var n=this.getData(t),a=Object(r.a)(n,2),o=a[0],i=a[1],u=e.getProgramClassInfo(o).classRenderer;return s.a.createElement(u,{programID:t,config:i})}},{key:"stopProgramPlayback",value:function(t){var n=e.registeredProgramClasses[t].classProgram;n.stopPlayback&&n.stopPlayback()}},{key:"stopAllPlayback",value:function(){for(var t=e.registeredProgramClasses,n=0;n<t.length;n++)this.stopProgramPlayback(n)}},{key:"unloadAllPrograms",value:function(){for(var t=e.registeredProgramClasses,n=0;n<t.length;n++){var r=t[n].classProgram;r.unloadAll&&r.unloadAll()}}}],[{key:"loadInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getProgramClassInfo(e),r=n.classProgram;return new r(t)}},{key:"getProgramClassInfo",value:function(t){for(var n=e.registeredProgramClasses,r=0;r<n.length;r++){var a=n[r];if(a.className===t)return a}throw new Error("Program class ".concat(t," was not found"))}},{key:"addProgramClass",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.registeredProgramClasses;a=a||n.name,o.push({classProgram:n,classRenderer:r,className:t,title:a})}},{key:"getRegisteredPrograms",value:function(){return e.registeredProgramClasses}}]),e}();u.registeredProgramClasses=[],t.a=u},function(e,t,n){"use strict";var r=n(1),a=n(2),o=n(17),i=function(){function e(t,n,a){Object(r.a)(this,e),this.instructions=t,this.beatsPerMinute=a,this.timeDivision=n,this.currentIndex=-1,this.positionTicks=0,this.endPositionTicks=0,this.positionSeconds=0,this.endPositionSeconds=0,this.lastInstructionPositionInTicks=0,this.lastInstructionPositionInSeconds=0,this.rowCount=0,this.cursorPosition=0}return Object(a.a)(e,[{key:"hasReachedEnd",value:function(){return this.currentIndex>=this.instructions.length-1}},{key:"incrementPositionByInstruction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.deltaDurationTicks;this.positionTicks=this.lastInstructionPositionInTicks+n,this.lastInstructionPositionInTicks=this.positionTicks;var r=n/this.timeDivision/(this.beatsPerMinute/60);this.positionSeconds=this.lastInstructionPositionInSeconds+r,this.lastInstructionPositionInSeconds=this.positionSeconds;var a=e.durationTicks||0;if(a){var o=this.positionTicks+a;o>this.endPositionTicks&&(this.endPositionTicks=o);var i=this.positionSeconds+a/this.timeDivision/(this.beatsPerMinute/60);i>this.endPositionSeconds&&(this.endPositionSeconds=i)}t&&t(e),this.cursorPosition++}},{key:"getInstruction",value:function(e){var t=this.instructions[e];return o.a.getInstruction(t)}},{key:"currentInstruction",value:function(){if(-1===this.currentIndex)throw new Error("Iterator has not been started");return this.getInstruction(this.currentIndex)}},{key:"nextInstruction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.hasReachedEnd())return null;this.currentIndex++;var t=this.currentInstruction();return this.incrementPositionByInstruction(t,e),t}},{key:"nextInstructionRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.hasReachedEnd())return null;for(var n=[];;){var r=this.nextInstruction(t);if(n.push(r),this.hasReachedEnd())break;var a=this.getInstruction(this.currentIndex+1);if(a.deltaDurationTicks>0)break}return e&&e(n),this.rowCount++,this.cursorPosition++,n}},{key:"seekToIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Number.isInteger(e))throw new Error("Invalid seek index");for(;!this.hasReachedEnd()&&!(e<=this.currentIndex)&&this.nextInstruction(t););}},{key:"seekToEnd",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!this.hasReachedEnd();)this.nextInstruction(e)}},{key:"seekToPosition",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!this.hasReachedEnd();){var n=this.getInstruction(this.currentIndex+1),r=n.deltaDurationTicks/this.timeDivision/(this.beatsPerMinute/60);if(this.positionSeconds+r>=e)break;this.nextInstruction(t)}}},{key:"seekToPositionTicks",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!this.hasReachedEnd()&&this.positionTicks<=e;){var n=this.getInstruction(this.currentIndex+1);if(this.positionTicks+n.deltaDurationTicks>e)break;this.nextInstruction(t)}}}]),e}(),s=n(6),u=n(5),c=n(7),l=function(e){function t(e,n,a,o){var i;if(Object(r.a)(this,t),i=Object(s.a)(this,Object(u.a)(t).call(this,e,a,o)),!n)throw new Error("Invalid quantizationTicks");return i.quantizationTicks=n,i.nextQuantizationBreakInTicks=0,i}return Object(c.a)(t,e),Object(a.a)(t,[{key:"getNextInstructionPositionInTicks",value:function(){return this.hasReachedEnd()?null:this.getInstruction(this.currentIndex+1).deltaDurationTicks+this.lastInstructionPositionInTicks}},{key:"updateNextQuantizationBreakInTicks",value:function(){var e=this.getNextInstructionPositionInTicks();for(e<this.positionTicks&&(e=this.positionTicks);this.nextQuantizationBreakInTicks<=e;)this.nextQuantizationBreakInTicks+=this.quantizationTicks}},{key:"getNextRowPositionTicks",value:function(){var e=this.nextQuantizationBreakInTicks;if(this.hasReachedEnd())return e;var t=this.getInstruction(this.currentIndex+1).deltaDurationTicks+this.lastInstructionPositionInTicks;return t<e?t:e}},{key:"nextQuantizedInstructionRow",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.nextQuantizationBreakInTicks,a=function(){var n=(r-e.positionTicks)/e.timeDivision/(e.beatsPerMinute/60);e.positionSeconds+=n,e.positionTicks=r,e.nextQuantizationBreakInTicks+=e.quantizationTicks;var a=[];return t&&t(a),e.rowCount++,e.cursorPosition++,a};if(!this.hasReachedEnd()){var o=this.getNextInstructionPositionInTicks();return r<o?a():(this.updateNextQuantizationBreakInTicks(),this.nextInstructionRow(t,n))}return a()}},{key:"seekToIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Number.isInteger(e))throw new Error("Invalid seek index");for(;e!==this.currentIndex&&(this.nextInstruction(t),this.nextQuantizedInstructionRow(null,t)););}},{key:"seekToEnd",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!this.hasReachedEnd();)this.nextQuantizedInstructionRow(null,e)}},{key:"seekToPosition",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.positionSeconds<e;)this.nextQuantizedInstructionRow(null,t)}},{key:"seekToPositionTicks",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.positionTicks<e;)this.nextQuantizedInstructionRow(null,t)}}]),t}(i),f=(n(31),n(59));n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f.default}))},function(e,t,n){"use strict";var r=n(3),a=n.n(r),o=n(8),i=n(1),s=n(2),u=n(9),c=n(4),l=n(11),f=n(0),d=n.n(f),h=n(42),p=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"renderMenuSelectCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return d.a.createElement(d.a.Fragment,null,d.a.createElement(u.c,{options:function(){return t.renderMenuSelectCommandByFrequency(e,n)}},"By Frequency"),d.a.createElement(u.c,{options:function(){return t.renderMenuSelectCommandByOctave(e,n)}},"By Octave"),d.a.createElement(u.b,null),d.a.createElement(u.c,{disabled:!0,options:function(){return t.renderMenuSelectCommandByNamed(e)}},"By Alias"),d.a.createElement(u.c,{disabled:!0,options:function(){return t.renderMenuSelectCommandByTrack(e)}},"By Group"),d.a.createElement(u.a,{onAction:function(){var t=Object(o.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,h.a.openPromptDialog("Insert custom command");case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},"Custom Command"))}},{key:"renderMenuSelectCommandByNamed",value:function(e){return this.values.getAllNamedFrequencies((function(t,n,r){return d.a.createElement(u.a,{key:t,onAction:function(n){return e(t)},children:t})}))}},{key:"renderMenuSelectCommandByTrack",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return d.a.createElement(d.a.Fragment,null,this.getAllSongGroups((function(n){return n===t.trackName?null:d.a.createElement(u.a,{key:n,disabled:n===t.state.selectedTrack,onAction:function(t){return e("@"+n)}},n)})),d.a.createElement(u.a,{onAction:n,hasBreak:!0},"Create New Track"))}},{key:"renderMenuSelectCommandByFrequency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getNoteFrequencies((function(r){return d.a.createElement(u.c,{key:r,options:function(){return t.renderMenuSelectCommandByFrequencyOctave(e,r,n)}},r)}))}},{key:"renderMenuSelectCommandByFrequencyOctave",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return d.a.createElement(d.a.Fragment,null,null!==n?d.a.createElement(u.a,{onAction:function(){return e(t+""+n)}},t+""+n," (Current)"):null,this.getNoteOctaves((function(n){return d.a.createElement(u.a,{key:n,onAction:function(){return e(t+""+n)}},t+""+n)})))}},{key:"renderMenuSelectCommandByOctave",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return d.a.createElement(d.a.Fragment,null,null!==n?d.a.createElement(u.c,{key:n,options:function(){return t.renderMenuSelectCommandByOctaveFrequency(e,n)}},n," (Current)"):null,this.getNoteOctaves((function(n){return d.a.createElement(u.c,{key:n,options:function(){return t.renderMenuSelectCommandByOctaveFrequency(e,n)}},n)})))}},{key:"renderMenuSelectCommandByOctaveFrequency",value:function(e,t){return this.getNoteFrequencies((function(n){return d.a.createElement(u.a,{key:n,onAction:function(){return e(n+""+t)}},n+""+t)}))}},{key:"renderMenuSelectDuration",value:function(e,t,n){return d.a.createElement(d.a.Fragment,null,d.a.createElement(u.c,{disabled:!0,options:function(){return r("recent")}},"Recent"),d.a.createElement(u.b,null),d.a.createElement(u.c,{options:function(){return r("fraction")}},"Fraction"),d.a.createElement(u.c,{options:function(){return r("triplet")}},"Triplet"),d.a.createElement(u.c,{options:function(){return r("dotted")}},"Dotted"),d.a.createElement(u.b,null),d.a.createElement(u.c,{disabled:!0,options:function(){return r("custom")}},"Custom"));function r(t){var r=[];switch(t){case"fraction":for(var a=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"a"),onAction:function(){return e(1/t*n,"1/".concat(t,"B"))}},"1/".concat(t,"B")))},o=64;o>1;o/=2)a(o);for(var i=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"b"),onAction:function(){return e(t*n,t+"B")}},t+"B"))},s=1;s<=16;s++)i(s);break;case"triplet":for(var c=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"a"),onAction:function(){return e(1/(t/1.5)*n,"1/".concat(t,"T"))}},"1/".concat(t,"T")))},l=64;l>1;l/=2)c(l);for(var f=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"b"),onAction:function(){return e(t/1.5*n,t+"T")}},t+"T"))},h=1;h<=16;h++)f(h);break;case"dotted":for(var p=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"a"),onAction:function(){return e(1/(1.5*t)*n,"1/".concat(t,"D"))}},"1/".concat(t,"D")))},m=64;m>1;m/=2)p(m);for(var v=function(t){r.push(d.a.createElement(u.a,{key:"".concat(t,"b"),onAction:function(){return e(1.5*t*n,t+"D")}},t+"D"))},g=1;g<=16;g++)v(g);break;default:throw new Error("Unknown key")}return r}}},{key:"renderMenuSelectVelocity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=function(){var t=Object(o.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.openPromptDialog("Enter custom velocity (1-127)",127);case 2:n=t.sent,e(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return d.a.createElement(d.a.Fragment,null,d.a.createElement(u.a,{onAction:function(){},disabled:!0},"Set Velocity"),d.a.createElement(c.e,{min:0,max:127,value:t,onChange:function(t,n){return e(n)}}),d.a.createElement(u.b,null),this.getNoteVelocities((function(t){return d.a.createElement(u.a,{key:t,onAction:function(){return e(t)}},t)})),d.a.createElement(u.a,{onAction:n,hasBreak:!0},"Custom"))}},{key:"renderMenuSelectAvailableProgram",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return d.a.createElement(d.a.Fragment,null,t?d.a.createElement(d.a.Fragment,null,d.a.createElement(u.a,{disabled:!0,onAction:function(){}},t),d.a.createElement(u.b,null)):null,l.a.getRegisteredPrograms().map((function(t,n){return d.a.createElement(u.a,{key:n,onAction:function(){return e(t.className)}},t.title)})))}},{key:"generateUUID",value:function(){var e=(new Date).getTime();return"undefined"!==typeof performance&&"function"===typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},{key:"getNoteFrequencies",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=[],n=this.noteList(),r=0;r<n.length;r++){var a=n[r],o=e(a);if(!m(t,o))return t}return t}},{key:"getNoteOctaves",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=[],n=1;n<=8;n++){var r=e(n);if(!m(t,r))return t}return t}},{key:"getOctaveNoteFrequencies",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=[],n=this.noteList(),r=1;r<=8;r++)for(var a=0;a<n.length;a++){var o=n[a]+r,i=e(o);if(!m(t,i))return t}return t}},{key:"getNoteVelocities",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=[],n=100;n>=0;n-=10){var r=e(n);if(!m(t,r))return t}return t}},{key:"getBeatsPerMeasure",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]},t=[],n=1;n<=12;n++){var r=e(n,n+" beat".concat(n>1?"s":""," per measure"));if(!m(t,r))return t}return t}},{key:"getBeatsPerMinute",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]},t=[],n=40;n<=300;n+=10){var r=e(n,n+" beat".concat(n>1?"s":""," per minute"));if(!m(t,r))return t}return t}},{key:"getTrackerSegmentLengthInRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]},t=[];return[4,5,6,7,8,10,12,16,24,32,48,64,96,128].forEach((function(n){var r=e(n,n+" Rows");if(!m(t,r))return t})),t}},{key:"formatVelocity",value:function(e){return"number"!==typeof e?"N/A":100===e?"Max":e+""}},{key:"formatProgramID",value:function(e){return"number"!==typeof e?"N/A":e<10?"0"+e:""+e}},{key:"formatCommand",value:function(e){return e}},{key:"formatPlaybackPosition",value:function(e){var t=Math.floor(e/60);e%=60;var n=Math.round(1e3*(e-Math.floor(e)));return e=Math.floor(e),t=(t+"").padStart(2,"0"),e=(e+"").padStart(2,"0"),n=(n+"").padStart(3,"0"),"".concat(t,":").concat(e,":").concat(n)}},{key:"parsePlaybackPosition",value:function(e){var t=e.toString().split(":");return 60*parseInt(t[0],10)+parseInt(t[1],10)+parseInt(t[2],10)/1e3}},{key:"parseFrequencyString",value:function(e){if("string"!==typeof e)throw new Error("Frequency is not a string");if(!e)throw new Error("Frequency is null");var t=this.noteQuarterToneList(),n=e.slice(0,-1),r=parseInt(e.slice(-1));if(isNaN(r))throw new Error("Invalid octave value: "+e);if("undefined"===typeof t[n])throw new Error("Unrecognized Note: "+n);var a=t[n];return a=a<6?a+24+24*(r-1)+2:a+24*(r-1)+2,440*Math.pow(2,(a-98)/24)}},{key:"parseDurationAsTicks",value:function(e,t){if(!t)throw new Error("Invalid timeDivision");if("string"!==typeof e)return e;var n=e.substr(e.length-1),r=e.substr(0,e.length-1);if(-1!==r.indexOf("/")){var a=r.split("/");r=parseInt(a[0],10)/parseInt(a[1],10)}switch(n){case"t":return parseInt(r);case"B":return t*parseFloat(r);case"D":return 1.5*t*parseFloat(r);case"T":return t/1.5*parseFloat(r);default:throw new Error("Invalid Duration: "+e)}}},{key:"formatDuration",value:function(e,t){var n;if(this.getNoteDurations((function(t,r){if(e===t||e===r)return n=r,!1}),t),n)return n;var r=e/t;return r===Math.round(r)?r+"B":(e=parseFloat(e).toFixed(2)).replace(".00","t")}},{key:"getNoteDurations",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]},t=arguments.length>1?arguments[1]:void 0,n=[],r=64;r>1;r/=2){var a=e(1/r*t,"1/".concat(r,"B"));if(!m(n,a))return n}for(var o=64;o>1;o/=2){var i=e(1/o/1.5*t,"1/".concat(o,"T"));if(!m(n,i))return n}for(var s=64;s>1;s/=2){var u=e(1/s*1.5*t,"1/".concat(s,"D"));if(!m(n,u))return n}for(var c=1;c<=16;c++){var l=e(c*t,"".concat(c,"B"));if(!m(n,l))return n}for(var f=1;f<=16;f++){var d=e(f/1.5*t,"".concat(f,"T"));if(!m(n,d))return n}for(var h=1;h<=16;h++){var p=e(1.5*h*t,"".concat(h,"D"));if(!m(n,p))return n}return n}},{key:"noteList",value:function(){return["A","A#","Bb","B","C","C#","Db","D","D#","Eb","E","E#","F","F#","Gb","G","G#","Ab"]}},{key:"noteQuarterToneList",value:function(){return{A:0,Aq:1,"A#":2,"A#q":3,Bb:2,Bbq:3,B:4,Bq:5,C:6,Cq:7,"C#":8,"C#q":9,Db:8,Dbq:9,D:10,Dq:11,"D#":12,"D#q":13,Eb:12,Ebq:13,E:14,Eq:15,"E#":16,"E#q":17,F:16,Fq:17,"F#":18,"F#q":19,Gb:18,Gbq:19,G:20,Gq:21,"G#":22,"G#q":23,Ab:22,Abq:23}}}]),e}();function m(e,t){return null!==t&&"undefined"!==typeof t&&e.push(t),!1!==t||t}t.a=p},,,,function(e,t,n){"use strict";var r=n(1),a=n(2),o=n(13),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0];Object(r.a)(this,e),this.data=t}return Object(a.a)(e,[{key:"getDurationString",value:function(e){var t=this.durationTicks;return null===t?"N/A":o.a.formatDuration(t,e)}},{key:"command",get:function(){return this.data[1]},set:function(e){this.data[1]=e}},{key:"deltaDurationTicks",get:function(){return this.data[0]},set:function(e){this.data[0]=e}},{key:"durationTicks",set:function(e){throw new Error("TODO: Implement for "+this.constructor.name)},get:function(){throw new Error("TODO: Implement for "+this.constructor.name)}},{key:"clone",get:function(){throw new Error("TODO: Implement for "+this.constructor.name)}},{key:"velocity",set:function(e){throw new Error("TODO: Implement for "+this.constructor.name)},get:function(){throw new Error("TODO: Implement for "+this.constructor.name)}}],[{key:"processInstructionTracks",value:function(e){var t=this;Object.keys(e).forEach((function(n,r){return t.processInstructionTrack(e[n])}))}},{key:"processInstructionTrack",value:function(e){if(!Array.isArray(e))throw new Error("Invalid ASCTrack instruction array");for(var t=0;t<e.length;t++){var n=this.parseInstruction(e[t]);e[t]=n.data}}},{key:"parseInstruction",value:function(t){if(t instanceof e)return t;if("number"===typeof t&&(t=[t]),"string"===typeof t&&(t=[0,t]),!Array.isArray(t))throw new Error("Invalid instruction data");return"string"===typeof t[0]&&t.unshift(0),this.getInstruction(t)}},{key:"getInstruction",value:function(e){if(!e)throw new Error("Invalid Instruction data");var t=e[1];if("string"===typeof t)switch(t[0]){case"@":return new(n(31).default)(e);case"!":return new(n(60).default)(e);default:return new(n(59).default)(e)}else if("number"===typeof t)return new(n(117).default)(e);throw new Error("Unknown Instruction")}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(0),a=function(){throw new Error("MenuContext Object is unimplemented")},o=n.n(r).a.createContext({openMenu:function(e){return a},closeMenus:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a},closeAllMenus:function(){return a},isHoverEnabled:function(){return a},removeDropDownMenu:function(e){return a},addDropDownMenu:function(e){return a}});t.a=o},,,,,,function(e,t,n){"use strict";var r=n(3),a=n.n(r),o=n(8),i=n(10),s=n(1),u=n(2),c=n(9),l=n(0),f=n.n(l),d=n(11),h=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,[{key:"getTitle",value:function(){return this.constructor.name}},{key:"getLibraries",value:function(){return[]}},{key:"getPresets",value:function(){return[]}},{key:"supportsProgram",value:function(e){for(var t=this.getPresets(),n=0;n<t.length;n++){if(Object(i.a)(t[n],1)[0]===e)return!0}return!1}},{key:"renderMenuProgramAll",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return f.a.createElement(f.a.Fragment,null,f.a.createElement(c.c,{options:function(){return t.renderMenuProgramNew(e,n)}},"New Program"),f.a.createElement(c.b,null),f.a.createElement(c.c,{options:function(){return t.renderMenuProgramAllPresets(e,n,!0)}},"Using Preset"))}},{key:"renderMenuProgramNew",value:function(e){return f.a.createElement(f.a.Fragment,null,d.a.getRegisteredPrograms().map((function(t,n){return f.a.createElement(c.a,{key:n,onAction:function(n){return e(t.className)}},t.title||"Untitled Preset #"+n)})))}},{key:"renderMenuProgramAllPresets",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return f.a.createElement(f.a.Fragment,null,null,a&&e.lastSelectedLibrary?f.a.createElement(c.c,{disabled:0===e.lastSelectedLibrary.getPresets().length,options:function(){return e.lastSelectedLibrary.renderMenuProgramPresets(t,r)}},"Current Library"):null,f.a.createElement(c.c,{disabled:0===this.getPresets().length,options:function(){return n.renderMenuProgramPresets(t,r)}},"Presets"),f.a.createElement(c.c,{disabled:0===this.getLibraries().length,options:function(){return n.renderMenuLibraryOptions((function(e){return e.renderMenuProgramAllPresets(t,r,!1)}),r)}},"Other Libraries"))}},{key:"renderMenuProgramRecentPresets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return f.a.createElement(f.a.Fragment,null,f.a.createElement(c.a,{onAction:function(){},disabled:!0},this.getTitle()),f.a.createElement(c.b,null),this.getPresets().map((function(n,r){var a=Object(i.a)(n,2),o=a[0],s=a[1];return null===t||t===o?f.a.createElement(c.a,{key:r,onAction:function(t){return e(o,s)}},s.title||"Untitled Preset #"+r):null})))}},{key:"renderMenuProgramPresets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return f.a.createElement(f.a.Fragment,null,f.a.createElement(c.a,{onAction:function(){},disabled:!0},this.getTitle()),f.a.createElement(c.b,null),this.getPresets().map((function(n,r){var a=Object(i.a)(n,2),o=a[0],s=a[1];return null===t||t===o?f.a.createElement(c.a,{key:r,onAction:function(t){return e(o,s)}},s.title||"Untitled Preset #"+r):null})))}},{key:"renderMenuLibraryOptions",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getLibraries().map((function(n,r){return f.a.createElement(c.c,{key:r++,options:function(){return e.lastSelectedLibrary=n,t(n)}},n.getTitle())}))}}],[{key:"historicLibraryCount",value:function(){return Object.values(e.cache).length}},{key:"eachHistoricLibrary",value:function(t){var n=[];for(var r in e.cache)if(e.cache.hasOwnProperty(r)){var a=e.cache[r];if(a instanceof Promise)continue;a.name=a.name||a.url.split("/").pop();var o=t(a);if(!1===o)break;null!==o&&n.push(o)}return n}},{key:"loadDefault",value:function(){return new(0,n(122).default)}},{key:"loadFromURL",value:function(){var t=Object(o.a)(a.a.mark((function t(n){var r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw new Error("Invalid url");case 2:return t.next=4,fetch(n);case 4:return r=t.sent,t.next=7,r.json();case 7:return"undefined"===typeof(o=t.sent).url&&(o.url=n.toString()),console.log("library",o),t.abrupt("return",new e(o));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"loadFromURL2",value:function(){var t=Object(o.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw new Error("Invalid url");case 2:if(n=new URL(n.toString().split("#")[0],document.location).toString(),e.cache[n]||(e.cache[n]=new Promise((function(t,r){var a=new XMLHttpRequest;a.open("GET",n.toString(),!0),a.responseType="json",a.onload=function(){if(200!==a.status)return r("Sample library not found: "+n);var o=a.response;o.url=n.toString(),Object.keys(e.cache).forEach((function(t){Object.values(e.cache)>5&&delete e.cache[t]})),e.cache[n]=o,console.info("Sample Library Loaded: ",n,e.cache),t(o)},a.send()}))),!((r=e.cache[n])instanceof Promise)){t.next=9;break}return t.next=8,r;case 8:r=t.sent;case 9:return t.abrupt("return",new e(r));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();h.lastSelectedLibrary=null,h.cache={},t.a=h},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),a=n(2),o=n(31),i=n(60),s=n(12),u=function(){function e(t,n,a,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(Object(r.a)(this,e),this.tracks=t,!this.tracks[n])throw new Error("Invalid instruction track: "+n);this.onEvent=i||function(){},this.positionSeconds=0,this.activeTracks=[],this.startingBeatsPerMinute=a,this.startingTimeDivision=o;var s={startPosition:0,trackName:n};this.startTrackIteration(s)}return Object(a.a)(e,[{key:"instructionGetIterator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.tracks[e])throw new Error("Invalid instruction track: "+e);var r=this.tracks[e];return new s.b(r,t||this.startingTimeDivision,n||this.startingBeatsPerMinute)}},{key:"startTrackIteration",value:function(e){return e.iterator=this.instructionGetIterator(e.trackName,e.timeDivision,e.beatsPerMinute),this.activeTracks.push(e),e}},{key:"getPositionInSeconds",value:function(){for(var e=0,t=0;t<this.activeTracks.length;t++){var n=this.activeTracks[t],r=n.iterator,a=n.startPosition+r.positionSeconds;a>e&&(e=a)}return e}},{key:"getEndPositionInSeconds",value:function(){for(var e=0,t=0;t<this.activeTracks.length;t++){var n=this.activeTracks[t],r=n.iterator,a=n.startPosition+r.endPositionSeconds;a>e&&(e=a)}return e}},{key:"hasReachedEnd",value:function(){for(var e=0;e<this.activeTracks.length;e++){if(this.activeTracks[e].iterator.hasReachedEnd())return!0}return!1}},{key:"processTrackInstruction",value:function(e,t){var n={startPosition:t.iterator.positionSeconds,trackName:e.getTrackName(),beatsPerMinute:t.beatsPerMinute};"undefined"!==typeof t.program&&t.program&&(n.program=t.program),"undefined"!==typeof t.destination&&t.destination&&(n.destination=t.destination),this.startTrackIteration(n)}},{key:"processCommandInstruction",value:function(e,t){}},{key:"processInstruction",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e instanceof i.default?this.processCommandInstruction(e,t):e instanceof o.default&&this.processTrackInstruction(e,t),n&&n(e,t)}},{key:"seekToEnd",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=!1;!r;)n+=t,r=this.seekToPosition(n,e)}},{key:"seekToPosition",value:function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!0,a=function(a){var o=t.activeTracks[a],i=o.iterator,s=o.startPosition;e-=s,i.hasReachedEnd()||(i.seekToPosition(e,(function(e){t.processInstruction(e,o,n)})),i.hasReachedEnd()||(r=!1))},o=0;o<this.activeTracks.length;o++)a(o);return r}},{key:"seekToStartingTrackIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.activeTracks[0],r=this.instructionGetIterator(n.trackName,n.timeDivision,n.beatsPerMinute);r.seekToIndex(e,t);var a=r.positionSeconds;this.seekToPosition(a,t)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=n(0),c=n.n(u),l=n(125),f=n(36),d=n(124),h=n(18),p=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).cb={onMouseInput:function(e){return n.onMouseInput(e)},onKeyDown:function(e){return n.onKeyDown(e)}},n}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return c.a.createElement(l.a,{onPress:this.cb.onMouseInput,onLongPress:this.cb.onMouseInput},c.a.createElement(f.a,{children:this.renderChildren()}))}},{key:"renderChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props.children;return"object"!==typeof t&&(t=c.a.createElement(d.a,Object.assign({children:t},e))),t}},{key:"onMouseInput",value:function(e){e.defaultPrevented||(e.preventDefault(),this.doAction(e))}},{key:"onKeyDown",value:function(e){if(!e.isDefaultPrevented())switch(e.key){case" ":case"Enter":this.doAction(e);break;default:console.info("Unhandled key: ",e.key)}}},{key:"doAction",value:function(e){throw new Error("Not implemented")}},{key:"getOverlay",value:function(){return this.context.overlay}},{key:"closeAllDropDownMenus",value:function(){this.getOverlay()&&this.getOverlay().closeAllMenus()}}]),t}(c.a.Component);p.contextType=h.a},,,,,function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTrackName",value:function(){return"string"===typeof this.data[1]?this.data[1].substr(1):void 0}},{key:"setTrackName",value:function(e){this.data[1]="@".concat(e)}},{key:"clone",value:function(){return new t(this.data.slice())}},{key:"instruction",get:function(){return this.data[2]},set:function(e){this.data[2]=e}},{key:"durationTicks",get:function(){return this.data[3]||void 0},set:function(e){if(e=parseFloat(e),Number.isNaN(e))throw new Error("Invalid Duration");this.data[3]=e}},{key:"velocity",get:function(){}}]),t}(n(17).a);t.default=u},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(3),a=n.n(r),o=n(8),i=n(1),s=n(2),u=n(6),c=n(20),l=n(5),f=n(55),d=n(7),h=n(25),p=n(12),m=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e.data.tracks,r||e.getStartTrackName(),e.data.beatsPerMinute,e.data.timeDivision,a))).song=e,n.seekLength=10,n.active=!0,n.endPromise=new Promise((function(e,t){n.endResolve=e})),n.playTrackInstructionCallback=n.playTrackInstruction.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"startTrackIteration",value:function(e){Object(f.a)(Object(l.a)(t.prototype),"startTrackIteration",this).call(this,e),e.playingIndices||(e.playingIndices=[]),this.onEvent({type:"track:start",playback:this,trackStats:e})}},{key:"addInstructionFilter",value:function(e){var t=this.playTrackInstructionCallback;this.playTrackInstructionCallback=function(n,r){if(n=e(n,r)){if(!n instanceof p.a)throw new Error("Invalid Instruction");t(n,r)}}}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||!e.context)throw new Error("Invalid destination");this.audioContext=e.context,this.destination=e,this.startTime=this.audioContext.currentTime,this.seekInterval=setInterval((function(){return t.renderPlayback()}),this.seekLength/10),null!==n&&(this.seekToPosition(n),this.startTime-=n),this.renderPlayback()}},{key:"playAtStartingTrackIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.activeTracks[0],a=this.instructionGetIterator(r.trackName,r.timeDivision,r.beatsPerMinute);a.seekToIndex(t,n);var o=a.positionSeconds;this.play(e,o)}},{key:"getPlaybackPosition",value:function(){return this.audioContext.currentTime-this.startTime}},{key:"awaitPlaybackReachedEnd",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.endPromise;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderPlayback",value:function(){var e=this,t=this.getPlaybackPosition();if(!this.active||this.hasReachedEnd()){clearInterval(this.seekInterval);var n=this.getEndPositionInSeconds()-t;console.log("Song is ending in ".concat(n," seconds")),n>0?setTimeout((function(){return e.stopPlayback()}),1e3*n):this.stopPlayback()}else this.seekToPosition(t+this.seekLength,this.playTrackInstructionCallback)}},{key:"stopPlayback",value:function(){this.active&&(this.active=!1,this.endResolve())}},{key:"playTrackInstruction",value:function(e,t){var n=this;if("undefined"===typeof t.program)return console.error("ASCTrack has no program set: ",t.trackName);if(e instanceof p.c){var r=t.destination||this.destination,a=this.startTime+t.startPosition+t.iterator.positionSeconds;if(a>0){var o=t.iterator.currentIndex,i=t.playingIndices,s=this.onEvent;this.song.playInstruction(r,e,t.program,a,(function(){-1===i.indexOf(o)&&(i.push(o),s({type:"instruction:play",playback:n,playingIndices:i,trackStats:t}))}),(function(){i.splice(i.indexOf(o),1),s({type:"instruction:stop",playback:n,playingIndices:i,trackStats:t})}))}}}},{key:"processCommandInstruction",value:function(e,t){e.processCommandInstruction(this.song,t)}}]),t}(h.a)},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3),a=n.n(r),o=n(8),i=n(1),s=n(2),u=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"openPromptDialog",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"",e.abrupt("return",window.prompt(t,n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"openConfirmDialog",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.confirm(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},,,,function(e,t,n){"use strict";var r=n(10),a=n(1),o=n(2),i=n(13),s=function(){function e(t){Object(a.a)(this,e),this.song=t}return Object(o.a)(e,[{key:"getSongPrograms",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]},t=this.song,n=[];if(t&&t.data.programs)for(var a=t.data.programs,o=0;o<a.length;o++){var i=Object(r.a)(a[o],2),s=i[0],c=i[1],l=e(o,s,c);if(!u(n,l))return n}return n}},{key:"getAllSongGroups",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=this.song,n=[],r=t.data.tracks;return Object.keys(r).forEach((function(t,r){var a=e(t);if(!u(n,a))return n})),n}},{key:"getAllNamedFrequencies",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"TODO"}},{key:"formatSongDuration",value:function(e){return i.a.formatDuration(e,this.song.data.timeDivision)}},{key:"parseDurationAsTicks",value:function(e){return i.a.parseDurationAsTicks(e,this.song.data.timeDivision)}},{key:"formatDuration",value:function(e){return i.a.formatDuration(e,this.song.data.timeDivision)}},{key:"getNoteDurations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return[e,t]};return i.a.getNoteDurations(e,this.song.data.timeDivision)}}]),e}();function u(e,t){return null!==t&&"undefined"!==typeof t&&e.push(t),!1!==t||t}t.a=s},,function(e,t,n){"use strict";var r=n(11);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";var r=n(3),a=n.n(r),o=n(8),i=n(10),s=n(1),u=n(2),c=n(11),l=n(46),f=n(50),d=n(83),h=n(6),p=n(5),m=n(20),v=n(7),g=function(){function e(t,n,r,a){Object(s.a)(this,e),this._outerAudioProcess=this._outerAudioProcess.bind(this),this.paused=!0,this.fileExtensions=[],this.metadata={},this.audioCtx=t,this.destinationNode=n,this.onPlayerStateUpdate=a,this.bufferSize=2048,this._innerAudioProcess=null,this.audioNode=this.audioCtx.createScriptProcessor(this.bufferSize,2,2),this.audioNode.onaudioprocess=this._outerAudioProcess,this.debug=-1!==window.location.search.indexOf("debug=true"),this.timeCount=0,this.renderTime=0,this.perfLoggingInterval=100}return Object(u.a)(e,[{key:"togglePause",value:function(){return this.paused=!this.paused,this.paused}},{key:"isPaused",value:function(){return this.paused}},{key:"resume",value:function(){this.paused=!1}},{key:"canPlay",value:function(e){return-1!==this.fileExtensions.indexOf(e.toLowerCase())}},{key:"loadData",value:function(e,t){throw Error("Player.loadData() must be implemented.")}},{key:"stop",value:function(){throw Error("Player.stop() must be implemented.")}},{key:"isPlaying",value:function(){throw Error("Player.isPlaying() must be implemented.")}},{key:"setTempo",value:function(){console.warn("Player.setTempo() not implemented for this player.")}},{key:"setVoices",value:function(){console.warn("Player.setVoices() not implemented for this player.")}},{key:"setFadeout",value:function(e){console.warn("Player.setFadeout() not implemented for this player.")}},{key:"getVoiceName",value:function(e){console.warn("Player.getVoiceName() not implemented for this player.")}},{key:"getNumVoices",value:function(){return 0}},{key:"getNumSubtunes",value:function(){return 1}},{key:"getSubtune",value:function(){return 0}},{key:"getMetadata",value:function(){return{title:null,author:null}}},{key:"getParamDefs",value:function(){return[]}},{key:"connect",value:function(){if(!this._innerAudioProcess)throw Error("Player.setAudioProcess has not been called.");this.audioNode.connect(this.destinationNode)}},{key:"suspend",value:function(){this.stopped=!0,this.paused=!0}},{key:"setOnPlayerStateUpdate",value:function(e){this.onPlayerStateUpdate=e}},{key:"setAudioProcess",value:function(e){if("function"!==typeof e)throw Error("AudioProcess must be a function.");this._innerAudioProcess=e}},{key:"_outerAudioProcess",value:function(e){var t=performance.now();this._innerAudioProcess(e);var n=performance.now();if(this.debug&&(this.renderTime+=n-t,this.timeCount++,this.timeCount>=this.perfLoggingInterval)){var r=this.renderTime/this.timeCount,a=1e3*this.bufferSize/this.audioCtx.sampleRate;console.log("[%s] %s ms to render %d frames (%s ms) (%s% utilization)",this.constructor.name,r.toFixed(2),this.bufferSize,a.toFixed(1),(100*r/a).toFixed(1)),this.renderTime=0,this.timeCount=0}}},{key:"muteAudioDuringCall",value:function(e,t){if(e&&"running"===e.context.state&&!1===this.paused){var n=e.onaudioprocess;e.onaudioprocess=function(r){for(var a=0;a<r.outputBuffer.numberOfChannels;a++)r.outputBuffer.getChannelData(a).fill(0);t(),e.onaudioprocess=n}}else t()}}],[{key:"metadataFromFilepath",value:function(e){var t=e.split("/"),n={};return n.title=t.pop(),n.system=t.shift(),"Game MIDI"===n.system?n.game=t.shift():n.artist=t.shift(),n}}]),e}(),y=n(44),k=function e(t){Object(s.a)(this,e);var n=new y.CalcCascades,r=n.lowpass({order:5,characteristic:"butterworth",Fs:t,Fc:200,gain:0}),a=n.lowpass({order:3,characteristic:"butterworth",Fs:t,Fc:120,gain:0}),o=n.highpass({order:3,characteristic:"butterworth",Fs:t,Fc:25,gain:0}),i=new y.IirFilter(r),u=new y.IirFilter(a),c=new y.IirFilter(o),l=0,f=0,d=0,h=0,p=Math.exp(-1/(.16*t)),m=0,v=Math.exp(-1/(.016*t));function g(e){return e=function(e){return e-(h=p*h+(1-p)*e)}(e),1.414*(m=v*m+(1-v)*Math.abs(e))}this.process=function(e){var t=i.singleStep(e),n=g(t);f=l,l=t,f<0&&l>=0&&(d=(d+1)%Math.pow(2,1));for(var r=0,a=0;a<1;a++){r+=d&1<<a?1:-1}return c.singleStep(u.singleStep(r))*n}},w=n(82),b=n.n(w),_=null,E=null,O=["nsf","nsfe","spc","gym","vgm","vgz","ay","sgc","kss"],x=function(e){function t(e,n,r,a){var o;return Object(s.a)(this,t),(o=Object(h.a)(this,Object(p.a)(t).call(this,e,n,r,a))).setParameter=o.setParameter.bind(Object(m.a)(o)),o.getParameter=o.getParameter.bind(Object(m.a)(o)),o.getParamDefs=o.getParamDefs.bind(Object(m.a)(o)),E=r,o.paused=!1,o.fileExtensions=O,o.subtune=0,o.tempo=1,o.params={subbass:1},o.buffer=E.allocate(16*o.bufferSize,"i16",E.ALLOC_NORMAL),o.emuPtr=E.allocate(1,"i32",E.ALLOC_NORMAL),o.subBass=new k(e.sampleRate),o.setAudioProcess(o.gmeAudioProcess),o}return Object(v.a)(t,e),Object(u.a)(t,[{key:"gmeAudioProcess",value:function(e){var t,n,r=[];for(n=0;n<e.outputBuffer.numberOfChannels;n++)r[n]=e.outputBuffer.getChannelData(n);if(this.paused)for(n=0;n<r.length;n++)r[n].fill(0);else if(this.getPositionMs()>=this.getDurationMs()&&!1===this.fadingOut&&(console.log("Fading out at %d ms.",this.getPositionMs()),this.setFadeout(this.getPositionMs()),this.fadingOut=!0),1!==E._gme_track_ended(_)){for(E._gme_play(_,2*this.bufferSize,this.buffer),n=0;n<r.length;n++)for(t=0;t<this.bufferSize;t++)r[n][t]=E.getValue(this.buffer+2*t*2+2*n,"i16")/65535;if(this.params.subbass>0)for(t=0;t<this.bufferSize;t++){var a=this.subBass.process(r[0][t])*this.params.subbass;r[0][t]+=a,r[1][t]+=a}}else this.subtune++,(this.subtune>=E._gme_track_count(_)||0!==this.playSubtune(this.subtune))&&(this.suspend(),console.debug("GMEPlayer.gmeAudioProcess(): _gme_track_ended == %s and subtune (%s) > _gme_track_count (%s).",E._gme_track_ended(_),this.subtune,E._gme_track_count(_)),this.onPlayerStateUpdate(!0))}},{key:"playSubtune",value:function(e){return this.fadingOut=!1,this.subtune=e,this.metadata=this._parseMetadata(e),console.debug("GMEPlayer.playSubtune(subtune=%s)",e),this.onPlayerStateUpdate(!1),E._gme_start_track(_,e)}},{key:"loadData",value:function(e,t){this.subtune=0,this.fadingOut=!1,this.filepathMeta=g.metadataFromFilepath(t);var n=t.match(/(\.sgc$|\.kss$|\.nsfe?$|\.ay$|Master System|Game Gear)/i);if(this.params.subbass=n?1:0,0!==E.ccall("gme_open_data","number",["array","number","number","number"],[e,e.length,this.emuPtr,this.audioCtx.sampleRate]))throw console.error("gme_open_data failed."),this.stop(),Error("Unable to load this file: "+t);if(_=E.getValue(this.emuPtr,"i32"),this.connect(),this.resume(),0!==this.playSubtune(this.subtune))throw console.error("gme_start_track failed."),Error("Unable to play this subtune!")}},{key:"_parseMetadata",value:function(e){var t=E.allocate(1,"i32",E.ALLOC_NORMAL);0!==E._gme_track_info(_,t,e)&&console.error("could not load metadata");var n=E.getValue(t,"*"),r=0,a=function(){var e=E.getValue(n+r,"i32");return r+=4,e},o=function(){for(var e=[],t=E.getValue(n+r,"i8*"),a=0;a<255;a++){var o=E.getValue(t+a,"i8");if(0===o)break;e.push(255&o)}return r+=4,b.a.convert(e,{to:"UNICODE",type:"string"})},i={};return i.length=a(),i.intro_length=a(),i.loop_length=a(),i.play_length=a(),r+=48,i.system=o(),i.game=o(),i.title=o()||i.game||this.filepathMeta.title,i.artist=o()||this.filepathMeta.artist,i.copyright=o(),i.comment=o(),i}},{key:"getVoiceName",value:function(e){if(_)return E.UTF8ToString(E._gme_voice_name(_,e))}},{key:"getNumVoices",value:function(){if(_)return E._gme_voice_count(_)}},{key:"getNumSubtunes",value:function(){if(_)return E._gme_track_count(_)}},{key:"getSubtune",value:function(){return this.subtune}},{key:"getPositionMs",value:function(){return _?E._gme_tell_scaled(_):0}},{key:"getDurationMs",value:function(){return _?this.metadata.play_length:0}},{key:"getMetadata",value:function(){return this.metadata}},{key:"getParameter",value:function(e){return this.params[e]}},{key:"getParamDefs",value:function(){return[{id:"subbass",label:"Sub Bass",type:"number",min:0,max:2,step:.01,value:1}]}},{key:"setParameter",value:function(e,t){switch(e){case"subbass":this.params[e]=parseFloat(t);break;default:console.warn('GMEPlayer has no parameter with id "%s".',e)}}},{key:"isPlaying",value:function(){return!this.isPaused()&&1!==E._gme_track_ended(_)}},{key:"setTempo",value:function(e){this.tempo=e,_&&E._gme_set_tempo(_,e)}},{key:"setFadeout",value:function(e){_&&E._gme_set_fade(_,e,4e3)}},{key:"setVoices",value:function(e){var t=0;e.forEach((function(e,n){e||(t+=1<<n)})),_&&E._gme_mute_voices(_,t)}},{key:"seekMs",value:function(e){_&&this.muteAudioDuringCall(this.audioNode,(function(){return E._gme_seek_scaled(_,e)}))}},{key:"stop",value:function(){this.suspend(),_&&E._gme_delete(_),_=null,console.debug("GMEPlayer.stop()"),this.onPlayerStateUpdate(!0)}}]),t}(g),P=(Math.pow(2,16),function(e){var t,n="undefined"!==typeof(e=e||{})?e:{},r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);var a,o,i=[],s="./this.program",u="";document.currentScript&&(u=document.currentScript.src),u=0!==u.indexOf("blob:")?u.substr(0,u.lastIndexOf("/")+1):"",a=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText};var c,l,f=n.print||console.log.bind(console),d=n.printErr||console.warn.bind(console);for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);function h(e){var t=E[F>>2],n=t+e+15&-16;return n>me()&&Q(),E[F>>2]=n,t}function p(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return 4;if("i"===e[0]){var t=Number(e.substr(1));return y(t%8===0,"getNativeTypeSize invalid bits "+t+", type "+e),t/8}return 0}}function m(e,t,n,r){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":w[e>>0]=t;break;case"i16":_[e>>1]=t;break;case"i32":E[e>>2]=t;break;case"i64":ee=[t>>>0,(Z=t,+U(Z)>=1?Z>0?(0|V(+G(Z/4294967296),4294967295))>>>0:~~+q((Z-+(~~Z>>>0))/4294967296)>>>0:0)],E[e>>2]=ee[0],E[e+4>>2]=ee[1];break;case"float":O[e>>2]=t;break;case"double":x[e>>3]=t;break;default:Q("invalid type for setValue: "+n)}}r=null,n.arguments&&(i=n.arguments),n.thisProgram&&(s=n.thisProgram),n.quit&&n.quit,n.wasmBinary&&(c=n.wasmBinary),n.noExitRuntime&&n.noExitRuntime,"object"!==typeof WebAssembly&&d("no native wasm support detected");var v=new WebAssembly.Table({initial:915,maximum:915,element:"anyfunc"}),g=!1;function y(e,t){e||Q("Assertion failed: "+t)}var k,w,b,_,E,O,x,P="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function D(e,t,n){for(var r=t+n,a=t;e[a]&&!(a>=r);)++a;if(a-t>16&&e.subarray&&P)return P.decode(e.subarray(t,a));for(var o="";t<a;){var i=e[t++];if(128&i){var s=63&e[t++];if(192!=(224&i)){var u=63&e[t++];if((i=224==(240&i)?(15&i)<<12|s<<6|u:(7&i)<<18|s<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(i);else{var c=i-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&i)<<6|s)}else o+=String.fromCharCode(i)}return o}function S(e,t){return e?D(b,e,t):""}function j(e,t,n,r){if(!(r>0))return 0;for(var a=n,o=n+r-1,i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),s<=127){if(n>=o)break;t[n++]=s}else if(s<=2047){if(n+1>=o)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=o)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=o)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-a}function I(e,t,n){return j(e,b,t,n)}function M(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}function A(e,t){w.set(e,t)}function C(e){k=e,n.HEAP8=w=new Int8Array(e),n.HEAP16=_=new Int16Array(e),n.HEAP32=E=new Int32Array(e),n.HEAPU8=b=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=O=new Float32Array(e),n.HEAPF64=x=new Float64Array(e)}"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var F=5682208,T=n.INITIAL_MEMORY||16777216;function N(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"===typeof r?void 0===t.arg?n.dynCall_v(r):n.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}(l=n.wasmMemory?n.wasmMemory:new WebAssembly.Memory({initial:T/65536}))&&(k=l.buffer),T=k.byteLength,C(k),E[F>>2]=10925248;var R=[],B=[],L=[],z=[],U=Math.abs,q=Math.ceil,G=Math.floor,V=Math.min,W=0,H=null,K=null;function Y(e){W++,n.monitorRunDependencies&&n.monitorRunDependencies(W)}function J(e){if(W--,n.monitorRunDependencies&&n.monitorRunDependencies(W),0==W&&(null!==H&&(clearInterval(H),H=null),K)){var t=K;K=null,t()}}function Q(e){throw n.onAbort&&n.onAbort(e),f(e+=""),d(e),g=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function X(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={};var $,Z,ee,te="chip-core.wasm";function ne(){try{if(c)return new Uint8Array(c);if(o)return o(te);throw"both async and sync fetching of the wasm failed"}catch(d){Q(d)}}X(te)||($=te,te=n.locateFile?n.locateFile($,u):u+$);var re={161276:function(e){console.log("Error during V2M conversion.",e)},161441:function(e){console.log("Tiny MIDI Player loaded %d bytes.",e)},161499:function(e){console.log("First note appears at %d ms.",e)}};function ae(){var e=function(){var e=new Error;if(!e.stack){try{throw new Error}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}();return n.extraStackTrace&&(e+="\n"+n.extraStackTrace()),e.replace(/\b_Z[\w\d_]+/g,(function(e){return e===e?e:e+" ["+e+"]"}))}B.push({func:function(){Ie()}});var oe={};function ie(){return ie.uncaught_exceptions>0}function se(e){return n.___errno_location&&(E[n.___errno_location()>>2]=e),e}var ue={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var n=0,r=e.length-1;r>=0;r--){var a=e[r];"."===a?e.splice(r,1):".."===a?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),n="/"===e.substr(-1);return(e=ue.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=ue.splitPath(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return ue.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return ue.normalize(e.join("/"))},join2:function(e,t){return ue.normalize(e+"/"+t)}},ce={resolve:function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:de.cwd();if("string"!==typeof r)throw new TypeError("Arguments to path.resolve must be strings");if(!r)return"";e=r+"/"+e,t="/"===r.charAt(0)}return(t?"/":"")+(e=ue.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=ce.resolve(e).substr(1),t=ce.resolve(t).substr(1);for(var r=n(e.split("/")),a=n(t.split("/")),o=Math.min(r.length,a.length),i=o,s=0;s<o;s++)if(r[s]!==a[s]){i=s;break}var u=[];for(s=i;s<r.length;s++)u.push("..");return(u=u.concat(a.slice(i))).join("/")}},le={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){le.ttys[e]={input:[],output:[],ops:t},de.registerDevice(e,le.stream_ops)},stream_ops:{open:function(e){var t=le.ttys[e.node.rdev];if(!t)throw new de.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,n,r,a){if(!e.tty||!e.tty.ops.get_char)throw new de.ErrnoError(60);for(var o=0,i=0;i<r;i++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(u){throw new de.ErrnoError(29)}if(void 0===s&&0===o)throw new de.ErrnoError(6);if(null===s||void 0===s)break;o++,t[n+i]=s}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,n,r,a){if(!e.tty||!e.tty.ops.put_char)throw new de.ErrnoError(60);try{for(var o=0;o<r;o++)e.tty.ops.put_char(e.tty,t[n+o])}catch(i){throw new de.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=Pe(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(f(D(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(f(D(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(d(D(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(d(D(e.output,0)),e.output=[])}}},fe={ops_table:null,mount:function(e){return fe.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if(de.isBlkdev(n)||de.isFIFO(n))throw new de.ErrnoError(63);fe.ops_table||(fe.ops_table={dir:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr,lookup:fe.node_ops.lookup,mknod:fe.node_ops.mknod,rename:fe.node_ops.rename,unlink:fe.node_ops.unlink,rmdir:fe.node_ops.rmdir,readdir:fe.node_ops.readdir,symlink:fe.node_ops.symlink},stream:{llseek:fe.stream_ops.llseek}},file:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr},stream:{llseek:fe.stream_ops.llseek,read:fe.stream_ops.read,write:fe.stream_ops.write,allocate:fe.stream_ops.allocate,mmap:fe.stream_ops.mmap,msync:fe.stream_ops.msync}},link:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr,readlink:fe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr},stream:de.chrdev_stream_ops}});var a=de.createNode(e,t,n,r);return de.isDir(a.mode)?(a.node_ops=fe.ops_table.dir.node,a.stream_ops=fe.ops_table.dir.stream,a.contents={}):de.isFile(a.mode)?(a.node_ops=fe.ops_table.file.node,a.stream_ops=fe.ops_table.file.stream,a.usedBytes=0,a.contents=null):de.isLink(a.mode)?(a.node_ops=fe.ops_table.link.node,a.stream_ops=fe.ops_table.link.stream):de.isChrdev(a.mode)&&(a.node_ops=fe.ops_table.chrdev.node,a.stream_ops=fe.ops_table.chrdev.stream),a.timestamp=Date.now(),e&&(e.contents[t]=a),a},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],n=0;n<e.usedBytes;++n)t.push(e.contents[n]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){t=Math.max(t,n*(n<1048576?2:1.125)|0),0!=n&&(t=Math.max(t,256));var r=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(r.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var n=e.contents;return e.contents=new Uint8Array(t),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=de.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,de.isDir(e.mode)?t.size=4096:de.isFile(e.mode)?t.size=e.usedBytes:de.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&fe.resizeFileStorage(e,t.size)},lookup:function(e,t){throw de.genericErrors[44]},mknod:function(e,t,n,r){return fe.createNode(e,t,n,r)},rename:function(e,t,n){if(de.isDir(e.mode)){var r;try{r=de.lookupNode(t,n)}catch(o){}if(r)for(var a in r.contents)throw new de.ErrnoError(55)}delete e.parent.contents[e.name],e.name=n,t.contents[n]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var n=de.lookupNode(e,t);for(var r in n.contents)throw new de.ErrnoError(55);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var n in e.contents)e.contents.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){var r=fe.createNode(e,t,41471,0);return r.link=n,r},readlink:function(e){if(!de.isLink(e.mode))throw new de.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,n,r,a){var o=e.node.contents;if(a>=e.node.usedBytes)return 0;var i=Math.min(e.node.usedBytes-a,r);if(i>8&&o.subarray)t.set(o.subarray(a,a+i),n);else for(var s=0;s<i;s++)t[n+s]=o[a+s];return i},write:function(e,t,n,r,a,o){if(t.buffer===w.buffer&&(o=!1),!r)return 0;var i=e.node;if(i.timestamp=Date.now(),t.subarray&&(!i.contents||i.contents.subarray)){if(o)return i.contents=t.subarray(n,n+r),i.usedBytes=r,r;if(0===i.usedBytes&&0===a)return i.contents=t.slice(n,n+r),i.usedBytes=r,r;if(a+r<=i.usedBytes)return i.contents.set(t.subarray(n,n+r),a),r}if(fe.expandFileStorage(i,a+r),i.contents.subarray&&t.subarray)i.contents.set(t.subarray(n,n+r),a);else for(var s=0;s<r;s++)i.contents[a+s]=t[n+s];return i.usedBytes=Math.max(i.usedBytes,a+r),r},llseek:function(e,t,n){var r=t;if(1===n?r+=e.position:2===n&&de.isFile(e.node.mode)&&(r+=e.node.usedBytes),r<0)throw new de.ErrnoError(28);return r},allocate:function(e,t,n){fe.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap:function(e,t,n,r,a,o,i){if(!de.isFile(e.node.mode))throw new de.ErrnoError(43);var s,u,c=e.node.contents;if(2&i||c.buffer!==t.buffer){(a>0||a+r<c.length)&&(c=c.subarray?c.subarray(a,a+r):Array.prototype.slice.call(c,a,a+r)),u=!0;var l=t.buffer==w.buffer;if(!(s=Ae(r)))throw new de.ErrnoError(48);(l?w:t).set(c,s)}else u=!1,s=c.byteOffset;return{ptr:s,allocated:u}},msync:function(e,t,n,r,a){if(!de.isFile(e.node.mode))throw new de.ErrnoError(43);return 2&a?0:(fe.stream_ops.write(e,t,0,r,n,!1),0)}}},de={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof de.ErrnoError))throw e+" : "+ae();return se(e.errno)},lookupPath:function(e,t){if(t=t||{},!(e=ce.resolve(de.cwd(),e)))return{path:"",node:null};var n={follow_mount:!0,recurse_count:0};for(var r in n)void 0===t[r]&&(t[r]=n[r]);if(t.recurse_count>8)throw new de.ErrnoError(32);for(var a=ue.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),o=de.root,i="/",s=0;s<a.length;s++){var u=s===a.length-1;if(u&&t.parent)break;if(o=de.lookupNode(o,a[s]),i=ue.join2(i,a[s]),de.isMountpoint(o)&&(!u||u&&t.follow_mount)&&(o=o.mounted.root),!u||t.follow)for(var c=0;de.isLink(o.mode);){var l=de.readlink(i);if(i=ce.resolve(ue.dirname(i),l),o=de.lookupPath(i,{recurse_count:t.recurse_count}).node,c++>40)throw new de.ErrnoError(32)}}return{path:i,node:o}},getPath:function(e){for(var t;;){if(de.isRoot(e)){var n=e.mount.mountpoint;return t?"/"!==n[n.length-1]?n+"/"+t:n+t:n}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%de.nameTable.length},hashAddNode:function(e){var t=de.hashName(e.parent.id,e.name);e.name_next=de.nameTable[t],de.nameTable[t]=e},hashRemoveNode:function(e){var t=de.hashName(e.parent.id,e.name);if(de.nameTable[t]===e)de.nameTable[t]=e.name_next;else for(var n=de.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode:function(e,t){var n=de.mayLookup(e);if(n)throw new de.ErrnoError(n,e);for(var r=de.hashName(e.id,t),a=de.nameTable[r];a;a=a.name_next){var o=a.name;if(a.parent.id===e.id&&o===t)return a}return de.lookup(e,t)},createNode:function(e,t,n,r){var a=new de.FSNode(e,t,n,r);return de.hashAddNode(a),a},destroyNode:function(e){de.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768===(61440&e)},isDir:function(e){return 16384===(61440&e)},isLink:function(e){return 40960===(61440&e)},isChrdev:function(e){return 8192===(61440&e)},isBlkdev:function(e){return 24576===(61440&e)},isFIFO:function(e){return 4096===(61440&e)},isSocket:function(e){return 49152===(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=de.flagModes[e];if("undefined"===typeof t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return de.ignorePermissions?0:(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var t=de.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{return de.lookupNode(e,t),20}catch(n){}return de.nodePermissions(e,"wx")},mayDelete:function(e,t,n){var r;try{r=de.lookupNode(e,t)}catch(o){return o.errno}var a=de.nodePermissions(e,"wx");if(a)return a;if(n){if(!de.isDir(r.mode))return 54;if(de.isRoot(r)||de.getPath(r)===de.cwd())return 10}else if(de.isDir(r.mode))return 31;return 0},mayOpen:function(e,t){return e?de.isLink(e.mode)?32:de.isDir(e.mode)&&("r"!==de.flagsToPermissionString(t)||512&t)?31:de.nodePermissions(e,de.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||de.MAX_OPEN_FDS;for(var n=e;n<=t;n++)if(!de.streams[n])return n;throw new de.ErrnoError(33)},getStream:function(e){return de.streams[e]},createStream:function(e,t,n){de.FSStream||(de.FSStream=function(){},de.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!==(2097155&this.flags)}},isWrite:{get:function(){return 0!==(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var r=new de.FSStream;for(var a in e)r[a]=e[a];e=r;var o=de.nextfd(t,n);return e.fd=o,de.streams[o]=e,e},closeStream:function(e){de.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=de.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new de.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){de.devices[e]={stream_ops:t}},getDevice:function(e){return de.devices[e]},getMounts:function(e){for(var t=[],n=[e];n.length;){var r=n.pop();t.push(r),n.push.apply(n,r.mounts)}return t},syncfs:function(e,t){"function"===typeof e&&(t=e,e=!1),de.syncFSRequests++,de.syncFSRequests>1&&d("warning: "+de.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=de.getMounts(de.root.mount),r=0;function a(e){return de.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,a(e));++r>=n.length&&a(null)}n.forEach((function(t){if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:function(e,t,n){var r,a="/"===n,o=!n;if(a&&de.root)throw new de.ErrnoError(10);if(!a&&!o){var i=de.lookupPath(n,{follow_mount:!1});if(n=i.path,r=i.node,de.isMountpoint(r))throw new de.ErrnoError(10);if(!de.isDir(r.mode))throw new de.ErrnoError(54)}var s={type:e,opts:t,mountpoint:n,mounts:[]},u=e.mount(s);return u.mount=s,s.root=u,a?de.root=u:r&&(r.mounted=s,r.mount&&r.mount.mounts.push(s)),u},unmount:function(e){var t=de.lookupPath(e,{follow_mount:!1});if(!de.isMountpoint(t.node))throw new de.ErrnoError(28);var n=t.node,r=n.mounted,a=de.getMounts(r);Object.keys(de.nameTable).forEach((function(e){for(var t=de.nameTable[e];t;){var n=t.name_next;-1!==a.indexOf(t.mount)&&de.destroyNode(t),t=n}})),n.mounted=null;var o=n.mount.mounts.indexOf(r);n.mount.mounts.splice(o,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,n){var r=de.lookupPath(e,{parent:!0}).node,a=ue.basename(e);if(!a||"."===a||".."===a)throw new de.ErrnoError(28);var o=de.mayCreate(r,a);if(o)throw new de.ErrnoError(o);if(!r.node_ops.mknod)throw new de.ErrnoError(63);return r.node_ops.mknod(r,a,t,n)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,de.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,de.mknod(e,t,0)},mkdirTree:function(e,t){for(var n=e.split("/"),r="",a=0;a<n.length;++a)if(n[a]){r+="/"+n[a];try{de.mkdir(r,t)}catch(o){if(20!=o.errno)throw o}}},mkdev:function(e,t,n){return"undefined"===typeof n&&(n=t,t=438),t|=8192,de.mknod(e,t,n)},symlink:function(e,t){if(!ce.resolve(e))throw new de.ErrnoError(44);var n=de.lookupPath(t,{parent:!0}).node;if(!n)throw new de.ErrnoError(44);var r=ue.basename(t),a=de.mayCreate(n,r);if(a)throw new de.ErrnoError(a);if(!n.node_ops.symlink)throw new de.ErrnoError(63);return n.node_ops.symlink(n,r,e)},rename:function(e,t){var n,r,a=ue.dirname(e),o=ue.dirname(t),i=ue.basename(e),s=ue.basename(t);try{n=de.lookupPath(e,{parent:!0}).node,r=de.lookupPath(t,{parent:!0}).node}catch(p){throw new de.ErrnoError(10)}if(!n||!r)throw new de.ErrnoError(44);if(n.mount!==r.mount)throw new de.ErrnoError(75);var u,c=de.lookupNode(n,i),l=ce.relative(e,o);if("."!==l.charAt(0))throw new de.ErrnoError(28);if("."!==(l=ce.relative(t,a)).charAt(0))throw new de.ErrnoError(55);try{u=de.lookupNode(r,s)}catch(p){}if(c!==u){var f=de.isDir(c.mode),h=de.mayDelete(n,i,f);if(h)throw new de.ErrnoError(h);if(h=u?de.mayDelete(r,s,f):de.mayCreate(r,s))throw new de.ErrnoError(h);if(!n.node_ops.rename)throw new de.ErrnoError(63);if(de.isMountpoint(c)||u&&de.isMountpoint(u))throw new de.ErrnoError(10);if(r!==n&&(h=de.nodePermissions(n,"w")))throw new de.ErrnoError(h);try{de.trackingDelegate.willMovePath&&de.trackingDelegate.willMovePath(e,t)}catch(p){d("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+p.message)}de.hashRemoveNode(c);try{n.node_ops.rename(c,r,s)}catch(p){throw p}finally{de.hashAddNode(c)}try{de.trackingDelegate.onMovePath&&de.trackingDelegate.onMovePath(e,t)}catch(p){d("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+p.message)}}},rmdir:function(e){var t=de.lookupPath(e,{parent:!0}).node,n=ue.basename(e),r=de.lookupNode(t,n),a=de.mayDelete(t,n,!0);if(a)throw new de.ErrnoError(a);if(!t.node_ops.rmdir)throw new de.ErrnoError(63);if(de.isMountpoint(r))throw new de.ErrnoError(10);try{de.trackingDelegate.willDeletePath&&de.trackingDelegate.willDeletePath(e)}catch(o){d("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.rmdir(t,n),de.destroyNode(r);try{de.trackingDelegate.onDeletePath&&de.trackingDelegate.onDeletePath(e)}catch(o){d("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readdir:function(e){var t=de.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new de.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=de.lookupPath(e,{parent:!0}).node,n=ue.basename(e),r=de.lookupNode(t,n),a=de.mayDelete(t,n,!1);if(a)throw new de.ErrnoError(a);if(!t.node_ops.unlink)throw new de.ErrnoError(63);if(de.isMountpoint(r))throw new de.ErrnoError(10);try{de.trackingDelegate.willDeletePath&&de.trackingDelegate.willDeletePath(e)}catch(o){d("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.unlink(t,n),de.destroyNode(r);try{de.trackingDelegate.onDeletePath&&de.trackingDelegate.onDeletePath(e)}catch(o){d("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readlink:function(e){var t=de.lookupPath(e).node;if(!t)throw new de.ErrnoError(44);if(!t.node_ops.readlink)throw new de.ErrnoError(28);return ce.resolve(de.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var n=de.lookupPath(e,{follow:!t}).node;if(!n)throw new de.ErrnoError(44);if(!n.node_ops.getattr)throw new de.ErrnoError(63);return n.node_ops.getattr(n)},lstat:function(e){return de.stat(e,!0)},chmod:function(e,t,n){var r;if(!(r="string"===typeof e?de.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new de.ErrnoError(63);r.node_ops.setattr(r,{mode:4095&t|-4096&r.mode,timestamp:Date.now()})},lchmod:function(e,t){de.chmod(e,t,!0)},fchmod:function(e,t){var n=de.getStream(e);if(!n)throw new de.ErrnoError(8);de.chmod(n.node,t)},chown:function(e,t,n,r){var a;if(!(a="string"===typeof e?de.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new de.ErrnoError(63);a.node_ops.setattr(a,{timestamp:Date.now()})},lchown:function(e,t,n){de.chown(e,t,n,!0)},fchown:function(e,t,n){var r=de.getStream(e);if(!r)throw new de.ErrnoError(8);de.chown(r.node,t,n)},truncate:function(e,t){if(t<0)throw new de.ErrnoError(28);var n;if(!(n="string"===typeof e?de.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new de.ErrnoError(63);if(de.isDir(n.mode))throw new de.ErrnoError(31);if(!de.isFile(n.mode))throw new de.ErrnoError(28);var r=de.nodePermissions(n,"w");if(r)throw new de.ErrnoError(r);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var n=de.getStream(e);if(!n)throw new de.ErrnoError(8);if(0===(2097155&n.flags))throw new de.ErrnoError(28);de.truncate(n.node,t)},utime:function(e,t,n){var r=de.lookupPath(e,{follow:!0}).node;r.node_ops.setattr(r,{timestamp:Math.max(t,n)})},open:function(e,t,r,a,o){if(""===e)throw new de.ErrnoError(44);var i;if(r="undefined"===typeof r?438:r,r=64&(t="string"===typeof t?de.modeStringToFlags(t):t)?4095&r|32768:0,"object"===typeof e)i=e;else{e=ue.normalize(e);try{i=de.lookupPath(e,{follow:!(131072&t)}).node}catch(f){}}var s=!1;if(64&t)if(i){if(128&t)throw new de.ErrnoError(20)}else i=de.mknod(e,r,0),s=!0;if(!i)throw new de.ErrnoError(44);if(de.isChrdev(i.mode)&&(t&=-513),65536&t&&!de.isDir(i.mode))throw new de.ErrnoError(54);if(!s){var u=de.mayOpen(i,t);if(u)throw new de.ErrnoError(u)}512&t&&de.truncate(i,0),t&=-641;var c=de.createStream({node:i,path:de.getPath(i),flags:t,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1},a,o);c.stream_ops.open&&c.stream_ops.open(c),!n.logReadFiles||1&t||(de.readFiles||(de.readFiles={}),e in de.readFiles||(de.readFiles[e]=1,d("FS.trackingDelegate error on read file: "+e)));try{if(de.trackingDelegate.onOpenFile){var l=0;1!==(2097155&t)&&(l|=de.tracking.openFlags.READ),0!==(2097155&t)&&(l|=de.tracking.openFlags.WRITE),de.trackingDelegate.onOpenFile(e,l)}}catch(f){d("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+f.message)}return c},close:function(e){if(de.isClosed(e))throw new de.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{de.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,n){if(de.isClosed(e))throw new de.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new de.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new de.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read:function(e,t,n,r,a){if(r<0||a<0)throw new de.ErrnoError(28);if(de.isClosed(e))throw new de.ErrnoError(8);if(1===(2097155&e.flags))throw new de.ErrnoError(8);if(de.isDir(e.node.mode))throw new de.ErrnoError(31);if(!e.stream_ops.read)throw new de.ErrnoError(28);var o="undefined"!==typeof a;if(o){if(!e.seekable)throw new de.ErrnoError(70)}else a=e.position;var i=e.stream_ops.read(e,t,n,r,a);return o||(e.position+=i),i},write:function(e,t,n,r,a,o){if(r<0||a<0)throw new de.ErrnoError(28);if(de.isClosed(e))throw new de.ErrnoError(8);if(0===(2097155&e.flags))throw new de.ErrnoError(8);if(de.isDir(e.node.mode))throw new de.ErrnoError(31);if(!e.stream_ops.write)throw new de.ErrnoError(28);1024&e.flags&&de.llseek(e,0,2);var i="undefined"!==typeof a;if(i){if(!e.seekable)throw new de.ErrnoError(70)}else a=e.position;var s=e.stream_ops.write(e,t,n,r,a,o);i||(e.position+=s);try{e.path&&de.trackingDelegate.onWriteToFile&&de.trackingDelegate.onWriteToFile(e.path)}catch(u){d("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+u.message)}return s},allocate:function(e,t,n){if(de.isClosed(e))throw new de.ErrnoError(8);if(t<0||n<=0)throw new de.ErrnoError(28);if(0===(2097155&e.flags))throw new de.ErrnoError(8);if(!de.isFile(e.node.mode)&&!de.isDir(e.node.mode))throw new de.ErrnoError(43);if(!e.stream_ops.allocate)throw new de.ErrnoError(138);e.stream_ops.allocate(e,t,n)},mmap:function(e,t,n,r,a,o,i){if(0!==(2&o)&&0===(2&i)&&2!==(2097155&e.flags))throw new de.ErrnoError(2);if(1===(2097155&e.flags))throw new de.ErrnoError(2);if(!e.stream_ops.mmap)throw new de.ErrnoError(43);return e.stream_ops.mmap(e,t,n,r,a,o,i)},msync:function(e,t,n,r,a){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,n,r,a):0},munmap:function(e){return 0},ioctl:function(e,t,n){if(!e.stream_ops.ioctl)throw new de.ErrnoError(59);return e.stream_ops.ioctl(e,t,n)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var n,r=de.open(e,t.flags),a=de.stat(e).size,o=new Uint8Array(a);return de.read(r,o,0,a,0),"utf8"===t.encoding?n=D(o,0):"binary"===t.encoding&&(n=o),de.close(r),n},writeFile:function(e,t,n){(n=n||{}).flags=n.flags||"w";var r=de.open(e,n.flags,n.mode);if("string"===typeof t){var a=new Uint8Array(M(t)+1),o=j(t,a,0,a.length);de.write(r,a,0,o,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");de.write(r,t,0,t.byteLength,void 0,n.canOwn)}de.close(r)},cwd:function(){return de.currentPath},chdir:function(e){var t=de.lookupPath(e,{follow:!0});if(null===t.node)throw new de.ErrnoError(44);if(!de.isDir(t.node.mode))throw new de.ErrnoError(54);var n=de.nodePermissions(t.node,"x");if(n)throw new de.ErrnoError(n);de.currentPath=t.path},createDefaultDirectories:function(){de.mkdir("/tmp"),de.mkdir("/home"),de.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(de.mkdir("/dev"),de.registerDevice(de.makedev(1,3),{read:function(){return 0},write:function(e,t,n,r,a){return r}}),de.mkdev("/dev/null",de.makedev(1,3)),le.register(de.makedev(5,0),le.default_tty_ops),le.register(de.makedev(6,0),le.default_tty1_ops),de.mkdev("/dev/tty",de.makedev(5,0)),de.mkdev("/dev/tty1",de.makedev(6,0)),"object"===typeof crypto&&"function"===typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}e||(e=function(){Q("random_device")}),de.createDevice("/dev","random",e),de.createDevice("/dev","urandom",e),de.mkdir("/dev/shm"),de.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){de.mkdir("/proc"),de.mkdir("/proc/self"),de.mkdir("/proc/self/fd"),de.mount({mount:function(){var e=de.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var n=+t,r=de.getStream(n);if(!r)throw new de.ErrnoError(8);var a={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return r.path}}};return a.parent=a,a}},e}},{},"/proc/self/fd")},createStandardStreams:function(){n.stdin?de.createDevice("/dev","stdin",n.stdin):de.symlink("/dev/tty","/dev/stdin"),n.stdout?de.createDevice("/dev","stdout",null,n.stdout):de.symlink("/dev/tty","/dev/stdout"),n.stderr?de.createDevice("/dev","stderr",null,n.stderr):de.symlink("/dev/tty1","/dev/stderr"),de.open("/dev/stdin","r"),de.open("/dev/stdout","w"),de.open("/dev/stderr","w")},ensureErrnoError:function(){de.ErrnoError||(de.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},de.ErrnoError.prototype=new Error,de.ErrnoError.prototype.constructor=de.ErrnoError,[44].forEach((function(e){de.genericErrors[e]=new de.ErrnoError(e),de.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){de.ensureErrnoError(),de.nameTable=new Array(4096),de.mount(fe,{},"/"),de.createDefaultDirectories(),de.createDefaultDevices(),de.createSpecialDirectories(),de.filesystems={MEMFS:fe}},init:function(e,t,r){de.init.initialized=!0,de.ensureErrnoError(),n.stdin=e||n.stdin,n.stdout=t||n.stdout,n.stderr=r||n.stderr,de.createStandardStreams()},quit:function(){de.init.initialized=!1;var e=n._fflush;e&&e(0);for(var t=0;t<de.streams.length;t++){var r=de.streams[t];r&&de.close(r)}},getMode:function(e,t){var n=0;return e&&(n|=365),t&&(n|=146),n},joinPath:function(e,t){var n=ue.join.apply(null,e);return t&&"/"==n[0]&&(n=n.substr(1)),n},absolutePath:function(e,t){return ce.resolve(t,e)},standardizePath:function(e){return ue.normalize(e)},findObject:function(e,t){var n=de.analyzePath(e,t);return n.exists?n.object:(se(n.error),null)},analyzePath:function(e,t){try{e=(r=de.lookupPath(e,{follow:!t})).path}catch(a){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var r=de.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=r.path,n.parentObject=r.node,n.name=ue.basename(e),r=de.lookupPath(e,{follow:!t}),n.exists=!0,n.path=r.path,n.object=r.node,n.name=r.node.name,n.isRoot="/"===r.path}catch(a){n.error=a.errno}return n},createFolder:function(e,t,n,r){var a=ue.join2("string"===typeof e?e:de.getPath(e),t),o=de.getMode(n,r);return de.mkdir(a,o)},createPath:function(e,t,n,r){e="string"===typeof e?e:de.getPath(e);for(var a=t.split("/").reverse();a.length;){var o=a.pop();if(o){var i=ue.join2(e,o);try{de.mkdir(i)}catch(s){}e=i}}return i},createFile:function(e,t,n,r,a){var o=ue.join2("string"===typeof e?e:de.getPath(e),t),i=de.getMode(r,a);return de.create(o,i)},createDataFile:function(e,t,n,r,a,o){var i=t?ue.join2("string"===typeof e?e:de.getPath(e),t):e,s=de.getMode(r,a),u=de.create(i,s);if(n){if("string"===typeof n){for(var c=new Array(n.length),l=0,f=n.length;l<f;++l)c[l]=n.charCodeAt(l);n=c}de.chmod(u,146|s);var d=de.open(u,"w");de.write(d,n,0,n.length,0,o),de.close(d),de.chmod(u,s)}return u},createDevice:function(e,t,n,r){var a=ue.join2("string"===typeof e?e:de.getPath(e),t),o=de.getMode(!!n,!!r);de.createDevice.major||(de.createDevice.major=64);var i=de.makedev(de.createDevice.major++,0);return de.registerDevice(i,{open:function(e){e.seekable=!1},close:function(e){r&&r.buffer&&r.buffer.length&&r(10)},read:function(e,t,r,a,o){for(var i=0,s=0;s<a;s++){var u;try{u=n()}catch(c){throw new de.ErrnoError(29)}if(void 0===u&&0===i)throw new de.ErrnoError(6);if(null===u||void 0===u)break;i++,t[r+s]=u}return i&&(e.node.timestamp=Date.now()),i},write:function(e,t,n,a,o){for(var i=0;i<a;i++)try{r(t[n+i])}catch(s){throw new de.ErrnoError(29)}return a&&(e.node.timestamp=Date.now()),i}}),de.mkdev(a,o,i)},createLink:function(e,t,n,r,a){var o=ue.join2("string"===typeof e?e:de.getPath(e),t);return de.symlink(n,o)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!==typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!a)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=Pe(a(e.url),!0),e.usedBytes=e.contents.length}catch(n){t=!1}return t||se(29),t},createLazyFile:function(e,t,n,r,a){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,n=e/this.chunkSize|0;return this.getter(n)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,r=Number(e.getResponseHeader("Content-length")),a=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,i=1048576;a||(i=r);var s=this;s.setDataGetter((function(e){var t=e*i,a=(e+1)*i-1;if(a=Math.min(a,r-1),"undefined"===typeof s.chunks[e]&&(s.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>r-1)throw new Error("only "+r+" bytes available! programmer error!");var a=new XMLHttpRequest;if(a.open("GET",n,!1),r!==i&&a.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(a.responseType="arraybuffer"),a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined"),a.send(null),!(a.status>=200&&a.status<300||304===a.status))throw new Error("Couldn't load "+n+". Status: "+a.status);return void 0!==a.response?new Uint8Array(a.response||[]):Pe(a.responseText||"",!0)}(t,a)),"undefined"===typeof s.chunks[e])throw new Error("doXHR failed!");return s.chunks[e]})),!o&&r||(i=r=1,r=this.getter(0).length,i=r,f("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=r,this._chunkSize=i,this.lengthKnown=!0},"undefined"!==typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var i={isDevice:!1,url:n},s=de.createFile(e,t,i,r,a);i.contents?s.contents=i.contents:i.url&&(s.contents=null,s.url=i.url),Object.defineProperties(s,{usedBytes:{get:function(){return this.contents.length}}});var u={};return Object.keys(s.stream_ops).forEach((function(e){var t=s.stream_ops[e];u[e]=function(){if(!de.forceLoadFile(s))throw new de.ErrnoError(29);return t.apply(null,arguments)}})),u.read=function(e,t,n,r,a){if(!de.forceLoadFile(s))throw new de.ErrnoError(29);var o=e.node.contents;if(a>=o.length)return 0;var i=Math.min(o.length-a,r);if(o.slice)for(var u=0;u<i;u++)t[n+u]=o[a+u];else for(u=0;u<i;u++)t[n+u]=o.get(a+u);return i},s.stream_ops=u,s},createPreloadedFile:function(e,t,r,a,o,i,s,u,c,l){Browser.init();var f=t?ce.resolve(ue.join2(e,t)):e;function d(r){function d(n){l&&l(),u||de.createDataFile(e,t,n,a,o,c),i&&i(),J()}var h=!1;n.preloadPlugins.forEach((function(e){h||e.canHandle(f)&&(e.handle(r,f,d,(function(){s&&s(),J()})),h=!0)})),h||d(r)}Y(),"string"==typeof r?Browser.asyncLoad(r,(function(e){d(e)}),s):d(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=de.indexedDB();try{var a=r.open(de.DB_NAME(),de.DB_VERSION)}catch(o){return n(o)}a.onupgradeneeded=function(){f("creating db"),a.result.createObjectStore(de.DB_STORE_NAME)},a.onsuccess=function(){var r=a.result.transaction([de.DB_STORE_NAME],"readwrite"),o=r.objectStore(de.DB_STORE_NAME),i=0,s=0,u=e.length;function c(){0==s?t():n()}e.forEach((function(e){var t=o.put(de.analyzePath(e).object.contents,e);t.onsuccess=function(){++i+s==u&&c()},t.onerror=function(){s++,i+s==u&&c()}})),r.onerror=n},a.onerror=n},loadFilesFromDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=de.indexedDB();try{var a=r.open(de.DB_NAME(),de.DB_VERSION)}catch(o){return n(o)}a.onupgradeneeded=n,a.onsuccess=function(){var r=a.result;try{var i=r.transaction([de.DB_STORE_NAME],"readonly")}catch(o){return void n(o)}var s=i.objectStore(de.DB_STORE_NAME),u=0,c=0,l=e.length;function f(){0==c?t():n()}e.forEach((function(e){var t=s.get(e);t.onsuccess=function(){de.analyzePath(e).exists&&de.unlink(e),de.createDataFile(ue.dirname(e),ue.basename(e),t.result,!0,!0,!0),++u+c==l&&f()},t.onerror=function(){c++,u+c==l&&f()}})),i.onerror=n},a.onerror=n}},he={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t){if("/"!==t[0]){var n;if(-100===e)n=de.cwd();else{var r=de.getStream(e);if(!r)throw new de.ErrnoError(8);n=r.path}t=ue.join2(n,t)}return t},doStat:function(e,t,n){try{var r=e(t)}catch(a){if(a&&a.node&&ue.normalize(t)!==ue.normalize(de.getPath(a.node)))return-54;throw a}return E[n>>2]=r.dev,E[n+4>>2]=0,E[n+8>>2]=r.ino,E[n+12>>2]=r.mode,E[n+16>>2]=r.nlink,E[n+20>>2]=r.uid,E[n+24>>2]=r.gid,E[n+28>>2]=r.rdev,E[n+32>>2]=0,ee=[r.size>>>0,(Z=r.size,+U(Z)>=1?Z>0?(0|V(+G(Z/4294967296),4294967295))>>>0:~~+q((Z-+(~~Z>>>0))/4294967296)>>>0:0)],E[n+40>>2]=ee[0],E[n+44>>2]=ee[1],E[n+48>>2]=4096,E[n+52>>2]=r.blocks,E[n+56>>2]=r.atime.getTime()/1e3|0,E[n+60>>2]=0,E[n+64>>2]=r.mtime.getTime()/1e3|0,E[n+68>>2]=0,E[n+72>>2]=r.ctime.getTime()/1e3|0,E[n+76>>2]=0,ee=[r.ino>>>0,(Z=r.ino,+U(Z)>=1?Z>0?(0|V(+G(Z/4294967296),4294967295))>>>0:~~+q((Z-+(~~Z>>>0))/4294967296)>>>0:0)],E[n+80>>2]=ee[0],E[n+84>>2]=ee[1],0},doMsync:function(e,t,n,r,a){var o=b.slice(e,e+n);de.msync(t,o,a,n,r)},doMkdir:function(e,t){return"/"===(e=ue.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),de.mkdir(e,t,0),0},doMknod:function(e,t,n){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return de.mknod(e,t,n),0},doReadlink:function(e,t,n){if(n<=0)return-28;var r=de.readlink(e),a=Math.min(n,M(r)),o=w[t+a];return I(r,t,n+1),w[t+a]=o,a},doAccess:function(e,t){if(-8&t)return-28;var n;if(!(n=de.lookupPath(e,{follow:!0}).node))return-44;var r="";return 4&t&&(r+="r"),2&t&&(r+="w"),1&t&&(r+="x"),r&&de.nodePermissions(n,r)?-2:0},doDup:function(e,t,n){var r=de.getStream(n);return r&&de.close(r),de.open(e,t,0,n,n).fd},doReadv:function(e,t,n,r){for(var a=0,o=0;o<n;o++){var i=E[t+8*o>>2],s=E[t+(8*o+4)>>2],u=de.read(e,w,i,s,r);if(u<0)return-1;if(a+=u,u<s)break}return a},doWritev:function(e,t,n,r){for(var a=0,o=0;o<n;o++){var i=E[t+8*o>>2],s=E[t+(8*o+4)>>2],u=de.write(e,w,i,s,r);if(u<0)return-1;a+=u}return a},varargs:void 0,get:function(){return he.varargs+=4,E[he.varargs-4>>2]},getStr:function(e){return S(e)},getStreamFromFD:function(e){var t=de.getStream(e);if(!t)throw new de.ErrnoError(8);return t},get64:function(e,t){return e}},pe=U;function me(){return b.length}function ve(e){try{return l.grow(e-k.byteLength+65535>>16),C(l.buffer),1}catch(t){}}var ge={};function ye(){if(!ye.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"};for(var t in ge)e[t]=ge[t];var n=[];for(var t in e)n.push(t+"="+e[t]);ye.strings=n}return ye.strings}function ke(e){return e%4===0&&(e%100!==0||e%400===0)}function we(e,t){for(var n=0,r=0;r<=t;n+=e[r++]);return n}var be=[31,29,31,30,31,30,31,31,30,31,30,31],_e=[31,28,31,30,31,30,31,31,30,31,30,31];function Ee(e,t){for(var n=new Date(e.getTime());t>0;){var r=ke(n.getFullYear()),a=n.getMonth(),o=(r?be:_e)[a];if(!(t>o-n.getDate()))return n.setDate(n.getDate()+t),n;t-=o-n.getDate()+1,n.setDate(1),a<11?n.setMonth(a+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}function Oe(e,t){Oe.array||(Oe.array=[]);var n,r=Oe.array;for(r.length=0;n=b[e++];)100===n||102===n?(t=t+7&-8,r.push(x[t>>3]),t+=8):(t=t+3&-4,r.push(E[t>>2]),t+=4);return r}var xe=function(e,t,n,r){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=de.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=r};function Pe(e,t,n){var r=n>0?n:M(e)+1,a=new Array(r),o=j(e,a,0,a.length);return t&&(a.length=o),a}Object.defineProperties(xe.prototype,{read:{get:function(){return 365===(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return de.isDir(this.mode)}},isDevice:{get:function(){return de.isChrdev(this.mode)}}}),de.FSNode=xe,de.staticInit();var De={a:function(e,t,n,r){Q("Assertion failed: "+S(e)+", at: "+[t?S(t):"unknown filename",n,r?S(r):"unknown function"])},e:function(e){return Ae(e)},d:function(e,t,n){throw oe[e]={ptr:e,adjusted:[e],type:t,destructor:n,refcount:0,caught:!1,rethrown:!1},"uncaught_exception"in ie?ie.uncaught_exceptions++:ie.uncaught_exceptions=1,e},t:function(e,t){return se(63),-1},f:function(e,t,n){he.varargs=n;try{var r=he.getStreamFromFD(e);switch(t){case 0:return(a=he.get())<0?-28:de.open(r.path,r.flags,0,a).fd;case 1:case 2:return 0;case 3:return r.flags;case 4:var a=he.get();return r.flags|=a,0;case 12:return a=he.get(),_[a+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return se(28),-1;default:return-28}}catch(o){return"undefined"!==typeof de&&o instanceof de.ErrnoError||Q(o),-o.errno}},l:function(e,t,n){he.varargs=n;try{var r=he.getStr(e),a=he.get();return de.open(r,t,a).fd}catch(o){return"undefined"!==typeof de&&o instanceof de.ErrnoError||Q(o),-o.errno}},k:function(e,t,n){he.varargs=n;try{var r=he.getStreamFromFD(e);switch(t){case 21509:case 21505:return r.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return r.tty?0:-59;case 21519:if(!r.tty)return-59;var a=he.get();return E[a>>2]=0,0;case 21520:return r.tty?-28:-59;case 21531:return a=he.get(),de.ioctl(r,t,a);case 21523:case 21524:return r.tty?0:-59;default:Q("bad ioctl syscall "+t)}}catch(o){return"undefined"!==typeof de&&o instanceof de.ErrnoError||Q(o),-o.errno}},s:function(e,t){try{return function(e,t){if(-1===e||0===t)return-28;var n=he.mappings[e];if(!n)return 0;if(t===n.len){var r=de.getStream(n.fd);he.doMsync(e,r,t,n.flags,n.offset),de.munmap(r),he.mappings[e]=null,n.allocated&&Me(n.malloc)}return 0}(e,t)}catch(n){return"undefined"!==typeof de&&n instanceof de.ErrnoError||Q(n),-n.errno}},i:function(){Q()},m:pe,c:function(e,t,n){var r=Oe(t,n);return re[e].apply(null,r)},p:function(e,t,n){b.copyWithin(e,t,t+n)},q:function(e){var t=me();if(e>2147418112)return!1;for(var n,r,a=1;a<=4;a*=2){var o=t*(1+.2/a);if(o=Math.min(o,e+100663296),ve(Math.min(2147418112,((n=Math.max(16777216,e,o))%(r=65536)>0&&(n+=r-n%r),n))))return!0}return!1},u:function(e,t){var n=ye(),r=0;return n.forEach((function(n,a){var o=t+r;E[e+4*a>>2]=o,function(e,t,n){for(var r=0;r<e.length;++r)w[t++>>0]=e.charCodeAt(r);n||(w[t>>0]=0)}(n,o),r+=n.length+1})),0},v:function(e,t){var n=ye();E[e>>2]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),E[t>>2]=r,0},h:function(e){try{var t=he.getStreamFromFD(e);return de.close(t),0}catch(n){return"undefined"!==typeof de&&n instanceof de.ErrnoError||Q(n),n.errno}},j:function(e,t,n,r){try{var a=he.getStreamFromFD(e),o=he.doReadv(a,t,n);return E[r>>2]=o,0}catch(i){return"undefined"!==typeof de&&i instanceof de.ErrnoError||Q(i),i.errno}},n:function(e,t,n,r,a){try{var o=he.getStreamFromFD(e),i=4294967296*n+(t>>>0);return i<=-9007199254740992||i>=9007199254740992?-61:(de.llseek(o,i,r),ee=[o.position>>>0,(Z=o.position,+U(Z)>=1?Z>0?(0|V(+G(Z/4294967296),4294967295))>>>0:~~+q((Z-+(~~Z>>>0))/4294967296)>>>0:0)],E[a>>2]=ee[0],E[a+4>>2]=ee[1],o.getdents&&0===i&&0===r&&(o.getdents=null),0)}catch(s){return"undefined"!==typeof de&&s instanceof de.ErrnoError||Q(s),s.errno}},g:function(e,t,n,r){try{var a=he.getStreamFromFD(e),o=he.doWritev(a,t,n);return E[r>>2]=o,0}catch(i){return"undefined"!==typeof de&&i instanceof de.ErrnoError||Q(i),i.errno}},memory:l,b:function(e){return(e=+e)>=0?+G(e+.5):+q(e-.5)},o:function(e){return(e=+e)>=0?+G(e+.5):+q(e-.5)},r:function(e,t,n,r){return function(e,t,n,r){var a=E[r+40>>2],o={tm_sec:E[r>>2],tm_min:E[r+4>>2],tm_hour:E[r+8>>2],tm_mday:E[r+12>>2],tm_mon:E[r+16>>2],tm_year:E[r+20>>2],tm_wday:E[r+24>>2],tm_yday:E[r+28>>2],tm_isdst:E[r+32>>2],tm_gmtoff:E[r+36>>2],tm_zone:a?S(a):""},i=S(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var u in s)i=i.replace(new RegExp(u,"g"),s[u]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["January","February","March","April","May","June","July","August","September","October","November","December"];function f(e,t,n){for(var r="number"===typeof e?e.toString():e||"";r.length<t;)r=n[0]+r;return r}function d(e,t){return f(e,t,"0")}function h(e,t){function n(e){return e<0?-1:e>0?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function p(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function m(e){var t=Ee(new Date(e.tm_year+1900,0,1),e.tm_yday),n=new Date(t.getFullYear(),0,4),r=new Date(t.getFullYear()+1,0,4),a=p(n),o=p(r);return h(a,t)<=0?h(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var v={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return l[e.tm_mon].substring(0,3)},"%B":function(e){return l[e.tm_mon]},"%C":function(e){return d((e.tm_year+1900)/100|0,2)},"%d":function(e){return d(e.tm_mday,2)},"%e":function(e){return f(e.tm_mday,2," ")},"%g":function(e){return m(e).toString().substring(2)},"%G":function(e){return m(e)},"%H":function(e){return d(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":function(e){return d(e.tm_mday+we(ke(e.tm_year+1900)?be:_e,e.tm_mon-1),3)},"%m":function(e){return d(e.tm_mon+1,2)},"%M":function(e){return d(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return d(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=new Date(e.tm_year+1900,0,1),n=0===t.getDay()?t:Ee(t,7-t.getDay()),r=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(h(n,r)<0){var a=we(ke(r.getFullYear())?be:_e,r.getMonth()-1)-31,o=31-n.getDate()+a+r.getDate();return d(Math.ceil(o/7),2)}return 0===h(n,t)?"01":"00"},"%V":function(e){var t,n=new Date(e.tm_year+1900,0,4),r=new Date(e.tm_year+1901,0,4),a=p(n),o=p(r),i=Ee(new Date(e.tm_year+1900,0,1),e.tm_yday);return h(i,a)<0?"53":h(o,i)<=0?"01":(t=a.getFullYear()<e.tm_year+1900?e.tm_yday+32-a.getDate():e.tm_yday+1-a.getDate(),d(Math.ceil(t/7),2))},"%w":function(e){return e.tm_wday},"%W":function(e){var t=new Date(e.tm_year,0,1),n=1===t.getDay()?t:Ee(t,0===t.getDay()?1:7-t.getDay()+1),r=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(h(n,r)<0){var a=we(ke(r.getFullYear())?be:_e,r.getMonth()-1)-31,o=31-n.getDate()+a+r.getDate();return d(Math.ceil(o/7),2)}return 0===h(n,t)?"01":"00"},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,n=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(n?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var u in v)i.indexOf(u)>=0&&(i=i.replace(new RegExp(u,"g"),v[u](o)));var g=Pe(i,!1);return g.length>t?0:(A(g,e),g.length-1)}(e,t,n,r)},table:v},Se=function(){var e={a:De};function t(e,t){var r=e.exports;n.asm=r,J()}function r(e){t(e.instance)}function a(t){return(c||"function"!==typeof fetch?new Promise((function(e,t){e(ne())})):fetch(te,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+te+"'";return e.arrayBuffer()})).catch((function(){return ne()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){d("failed to asynchronously prepare wasm: "+e),Q(e)}))}if(Y(),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(o){return d("Module.instantiateWasm callback failed with error: "+o),!1}return function(){if(c||"function"!==typeof WebAssembly.instantiateStreaming||X(te)||"function"!==typeof fetch)return a(r);fetch(te,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){d("wasm streaming compile failed: "+e),d("falling back to ArrayBuffer instantiation"),a(r)}))}))}(),{}}();n.asm=Se;var je,Ie=n.___wasm_call_ctors=function(){return(Ie=n.___wasm_call_ctors=n.asm.w).apply(null,arguments)},Me=n._free=function(){return(Me=n._free=n.asm.x).apply(null,arguments)},Ae=n._malloc=function(){return(Ae=n._malloc=n.asm.y).apply(null,arguments)},Ce=(n._gme_open_data=function(){return(n._gme_open_data=n.asm.z).apply(null,arguments)},n._gme_delete=function(){return(n._gme_delete=n.asm.A).apply(null,arguments)},n._gme_track_count=function(){return(n._gme_track_count=n.asm.B).apply(null,arguments)},n._gme_track_info=function(){return(n._gme_track_info=n.asm.C).apply(null,arguments)},n._gme_start_track=function(){return(n._gme_start_track=n.asm.D).apply(null,arguments)},n._gme_play=function(){return(n._gme_play=n.asm.E).apply(null,arguments)},n._gme_set_fade=function(){return(n._gme_set_fade=n.asm.F).apply(null,arguments)},n._gme_track_ended=function(){return(n._gme_track_ended=n.asm.G).apply(null,arguments)},n._gme_tell_scaled=function(){return(n._gme_tell_scaled=n.asm.H).apply(null,arguments)},n._gme_seek_scaled=function(){return(n._gme_seek_scaled=n.asm.I).apply(null,arguments)},n._gme_voice_count=function(){return(n._gme_voice_count=n.asm.J).apply(null,arguments)},n._gme_ignore_silence=function(){return(n._gme_ignore_silence=n.asm.K).apply(null,arguments)},n._gme_set_tempo=function(){return(n._gme_set_tempo=n.asm.L).apply(null,arguments)},n._gme_mute_voices=function(){return(n._gme_mute_voices=n.asm.M).apply(null,arguments)},n._gme_voice_name=function(){return(n._gme_voice_name=n.asm.N).apply(null,arguments)},n._adl_init=function(){return(n._adl_init=n.asm.O).apply(null,arguments)},n._adl_setNumChips=function(){return(n._adl_setNumChips=n.asm.P).apply(null,arguments)},n._adl_getNumChips=function(){return(n._adl_getNumChips=n.asm.Q).apply(null,arguments)},n._adl_setBank=function(){return(n._adl_setBank=n.asm.R).apply(null,arguments)},n._adl_getBanksCount=function(){return(n._adl_getBanksCount=n.asm.S).apply(null,arguments)},n._adl_getBankNames=function(){return(n._adl_getBankNames=n.asm.T).apply(null,arguments)},n._adl_setSoftPanEnabled=function(){return(n._adl_setSoftPanEnabled=n.asm.U).apply(null,arguments)},n._adl_generate=function(){return(n._adl_generate=n.asm.V).apply(null,arguments)},n._adl_panic=function(){return(n._adl_panic=n.asm.W).apply(null,arguments)},n._adl_rt_resetState=function(){return(n._adl_rt_resetState=n.asm.X).apply(null,arguments)},n._adl_rt_noteOn=function(){return(n._adl_rt_noteOn=n.asm.Y).apply(null,arguments)},n._adl_rt_noteOff=function(){return(n._adl_rt_noteOff=n.asm.Z).apply(null,arguments)},n._adl_rt_channelAfterTouch=function(){return(n._adl_rt_channelAfterTouch=n.asm._).apply(null,arguments)},n._adl_rt_controllerChange=function(){return(n._adl_rt_controllerChange=n.asm.$).apply(null,arguments)},n._adl_rt_patchChange=function(){return(n._adl_rt_patchChange=n.asm.aa).apply(null,arguments)},n._adl_rt_pitchBend=function(){return(n._adl_rt_pitchBend=n.asm.ba).apply(null,arguments)},n._v2m_open=function(){return(n._v2m_open=n.asm.ca).apply(null,arguments)},n._v2m_write_audio=function(){return(n._v2m_write_audio=n.asm.da).apply(null,arguments)},n._v2m_get_position_ms=function(){return(n._v2m_get_position_ms=n.asm.ea).apply(null,arguments)},n._v2m_get_duration_ms=function(){return(n._v2m_get_duration_ms=n.asm.fa).apply(null,arguments)},n._v2m_seek_ms=function(){return(n._v2m_seek_ms=n.asm.ga).apply(null,arguments)},n._v2m_set_speed=function(){return(n._v2m_set_speed=n.asm.ha).apply(null,arguments)},n._v2m_close=function(){return(n._v2m_close=n.asm.ia).apply(null,arguments)},n._xmp_start_player=function(){return(n._xmp_start_player=n.asm.ja).apply(null,arguments)},n._xmp_end_player=function(){return(n._xmp_end_player=n.asm.ka).apply(null,arguments)},n._xmp_play_buffer=function(){return(n._xmp_play_buffer=n.asm.la).apply(null,arguments)},n._xmp_get_frame_info=function(){return(n._xmp_get_frame_info=n.asm.ma).apply(null,arguments)},n._xmp_get_module_info=function(){return(n._xmp_get_module_info=n.asm.na).apply(null,arguments)},n._xmp_create_context=function(){return(n._xmp_create_context=n.asm.oa).apply(null,arguments)},n._xmp_stop_module=function(){return(n._xmp_stop_module=n.asm.pa).apply(null,arguments)},n._xmp_restart_module=function(){return(n._xmp_restart_module=n.asm.qa).apply(null,arguments)},n._xmp_seek_time=function(){return(n._xmp_seek_time=n.asm.ra).apply(null,arguments)},n._xmp_channel_mute=function(){return(n._xmp_channel_mute=n.asm.sa).apply(null,arguments)},n._xmp_get_player=function(){return(n._xmp_get_player=n.asm.ta).apply(null,arguments)},n._xmp_get_format_list=function(){return(n._xmp_get_format_list=n.asm.ua).apply(null,arguments)},n._xmp_inject_event=function(){return(n._xmp_inject_event=n.asm.va).apply(null,arguments)},n._xmp_load_module_from_memory=function(){return(n._xmp_load_module_from_memory=n.asm.wa).apply(null,arguments)},n._new_fluid_settings=function(){return(n._new_fluid_settings=n.asm.xa).apply(null,arguments)},n._fluid_settings_setstr=function(){return(n._fluid_settings_setstr=n.asm.ya).apply(null,arguments)},n._fluid_settings_setnum=function(){return(n._fluid_settings_setnum=n.asm.za).apply(null,arguments)},n._fluid_settings_setint=function(){return(n._fluid_settings_setint=n.asm.Aa).apply(null,arguments)},n._new_fluid_synth=function(){return(n._new_fluid_synth=n.asm.Ba).apply(null,arguments)},n._fluid_synth_set_reverb=function(){return(n._fluid_synth_set_reverb=n.asm.Ca).apply(null,arguments)},n._fluid_synth_noteon=function(){return(n._fluid_synth_noteon=n.asm.Da).apply(null,arguments)},n._fluid_synth_noteoff=function(){return(n._fluid_synth_noteoff=n.asm.Ea).apply(null,arguments)},n._fluid_synth_all_notes_off=function(){return(n._fluid_synth_all_notes_off=n.asm.Fa).apply(null,arguments)},n._fluid_synth_all_sounds_off=function(){return(n._fluid_synth_all_sounds_off=n.asm.Ga).apply(null,arguments)},n._fluid_synth_write_float=function(){return(n._fluid_synth_write_float=n.asm.Ha).apply(null,arguments)},n._fluid_synth_sfload=function(){return(n._fluid_synth_sfload=n.asm.Ia).apply(null,arguments)},n._tp_note_on=function(){return(n._tp_note_on=n.asm.Ja).apply(null,arguments)},n._tp_note_off=function(){return(n._tp_note_off=n.asm.Ka).apply(null,arguments)},n._tp_program_change=function(){return(n._tp_program_change=n.asm.La).apply(null,arguments)},n._tp_pitch_bend=function(){return(n._tp_pitch_bend=n.asm.Ma).apply(null,arguments)},n._tp_control_change=function(){return(n._tp_control_change=n.asm.Na).apply(null,arguments)},n._tp_channel_pressure=function(){return(n._tp_channel_pressure=n.asm.Oa).apply(null,arguments)},n._tp_render=function(){return(n._tp_render=n.asm.Pa).apply(null,arguments)},n._tp_panic=function(){return(n._tp_panic=n.asm.Qa).apply(null,arguments)},n._tp_panic_channel=function(){return(n._tp_panic_channel=n.asm.Ra).apply(null,arguments)},n._tp_reset=function(){return(n._tp_reset=n.asm.Sa).apply(null,arguments)},n._tp_init=function(){return(n._tp_init=n.asm.Ta).apply(null,arguments)},n._tp_write_audio=function(){return(n._tp_write_audio=n.asm.Ua).apply(null,arguments)},n._tp_get_duration_ms=function(){return(n._tp_get_duration_ms=n.asm.Va).apply(null,arguments)},n._tp_seek=function(){return(n._tp_seek=n.asm.Wa).apply(null,arguments)},n._tp_get_position_ms=function(){return(n._tp_get_position_ms=n.asm.Xa).apply(null,arguments)},n._tp_set_speed=function(){return(n._tp_set_speed=n.asm.Ya).apply(null,arguments)},n._tp_stop=function(){return(n._tp_stop=n.asm.Za).apply(null,arguments)},n._tp_open=function(){return(n._tp_open=n.asm._a).apply(null,arguments)},n._tp_unload_soundfont=function(){return(n._tp_unload_soundfont=n.asm.$a).apply(null,arguments)},n._tp_load_soundfont=function(){return(n._tp_load_soundfont=n.asm.ab).apply(null,arguments)},n._tp_add_soundfont=function(){return(n._tp_add_soundfont=n.asm.bb).apply(null,arguments)},n._tp_set_reverb=function(){return(n._tp_set_reverb=n.asm.cb).apply(null,arguments)},n._tp_get_channel_in_use=function(){return(n._tp_get_channel_in_use=n.asm.db).apply(null,arguments)},n._tp_get_channel_program=function(){return(n._tp_get_channel_program=n.asm.eb).apply(null,arguments)},n._tp_set_channel_mute=function(){return(n._tp_set_channel_mute=n.asm.fb).apply(null,arguments)},n._tp_set_bank=function(){return(n._tp_set_bank=n.asm.gb).apply(null,arguments)},n._tp_set_synth_engine=function(){return(n._tp_set_synth_engine=n.asm.hb).apply(null,arguments)},n._cqt_init=function(){return(n._cqt_init=n.asm.ib).apply(null,arguments)},n._cqt_calc=function(){return(n._cqt_calc=n.asm.jb).apply(null,arguments)},n._cqt_render_line=function(){return(n._cqt_render_line=n.asm.kb).apply(null,arguments)},n._cqt_bin_to_freq=function(){return(n._cqt_bin_to_freq=n.asm.lb).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.mb).apply(null,arguments)},n.stackSave=function(){return(Ce=n.stackSave=n.asm.nb).apply(null,arguments)}),Fe=n.stackAlloc=function(){return(Fe=n.stackAlloc=n.asm.ob).apply(null,arguments)},Te=n.stackRestore=function(){return(Te=n.stackRestore=n.asm.pb).apply(null,arguments)};function Ne(e){function t(){je||(je=!0,n.calledRun=!0,g||(n.noFSInit||de.init.initialized||de.init(),le.init(),N(B),de.ignorePermissions=!1,N(L),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),z.unshift(e);var e;N(z)}()))}e=e||i,W>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),R.unshift(e);var e;N(R)}(),W>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}if(n.dynCall_vi=function(){return(n.dynCall_vi=n.asm.qb).apply(null,arguments)},n.dynCall_v=function(){return(n.dynCall_v=n.asm.rb).apply(null,arguments)},n.asm=Se,n.ccall=function(e,t,r,a,o){var i={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);I(e,t=Fe(n),n)}return t},array:function(e){var t=Fe(e.length);return A(e,t),t}},s=function(e){var t=n["_"+e];return y(t,"Cannot call unknown function "+e+", make sure it is exported"),t}(e),u=[],c=0;if(a)for(var l=0;l<a.length;l++){var f=i[r[l]];f?(0===c&&(c=Ce()),u[l]=f(a[l])):u[l]=a[l]}var d=s.apply(null,u);return d=function(e){return"string"===t?S(e):"boolean"===t?Boolean(e):e}(d),0!==c&&Te(c),d},n.setValue=m,n.getValue=function(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return w[e>>0];case"i16":return _[e>>1];case"i32":case"i64":return E[e>>2];case"float":return O[e>>2];case"double":return x[e>>3];default:Q("invalid type for getValue: "+t)}return null},n.allocate=function(e,t,n,r){var a,o;"number"===typeof e?(a=!0,o=e):(a=!1,o=e.length);var i,s="string"===typeof t?t:null;if(i=3==n?r:[Ae,Fe,h][n](Math.max(o,s?1:t.length)),a){var u;for(r=i,y(0==(3&i)),u=i+(-4&o);r<u;r+=4)E[r>>2]=0;for(u=i+o;r<u;)w[r++>>0]=0;return i}if("i8"===s)return e.subarray||e.slice?b.set(e,i):b.set(new Uint8Array(e),i),i;for(var c,l,f,d=0;d<o;){var v=e[d];0!==(c=s||t[d])?("i64"==c&&(c="i32"),m(i+d,v,c),f!==c&&(l=p(c),f=c),d+=l):d++}return i},n.UTF8ToString=S,n.FS=de,n.ALLOC_NORMAL=0,n.then=function(e){if(je)e(n);else{var t=n.onRuntimeInitialized;n.onRuntimeInitialized=function(){t&&t(),e(n)}}return n},K=function e(){je||Ne(),je||(K=e)},n.run=Ne,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Ne(),e}),D=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){try{t.chipCore=new P({locateFile:function(e,t){return e.endsWith(".wasm")||e.endsWith(".wast")?"".concat(".","/").concat(e):t+e},onRuntimeInitialized:function(t){console.log("onRuntimeInitialized",t),e()}})}catch(r){throw r}}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadPlayerFromBuffer",value:function(e,t,n,r){var a,o=this;a=new Uint8Array(n);var i=new x(e,t,this.chipCore,(function(e){return o.onPlayerStateUpdate(e)}));try{i.loadData(a,r)}catch(u){throw u}var s=i.getNumVoices();return i.setTempo(1),i.setVoices(Object(d.a)(Array(s)).fill(!0)),i.stop(),i}},{key:"onPlayerStateUpdate",value:function(e){console.log(e)}},{key:"loadSongDataFromBuffer",value:function(e,t){var n=new AudioContext,r=this.loadPlayerFromBuffer(n,n.destination,e,t);return this.loadSongDataFromPlayer(r,t)}},{key:"loadSongDataFromPlayer",value:function(e,t){var n=e.metadata;console.log("metadata",n);var r=2*n.length*96;return{title:n.title,game:n.game,system:n.system,artist:n.artist,copyright:n.copyright,version:"auto",created:(new Date).getTime(),timeDivision:96,beatsPerMinute:120,rootGroup:"root",programs:[{className:"GMEPlayerSynthesizer",fileURL:t}],instructions:{root:[["C4",0,r]]}}}},{key:"loadSongDataFromURL",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o,i,s,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>1&&void 0!==u[1]?u[1]:{},e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.arrayBuffer();case 6:return r=e.sent,o=new AudioContext,i=this.loadPlayerFromBuffer(o,o.destination,r,t),s=this.loadSongDataFromPlayer(i,t),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),S=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,[{key:"loadSongDataFromFileInput",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=new FileReader;r.readAsText(t),r.onload=function(t){e(t.target.result)}}));case 2:return n=e.sent,e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSongDataFromURL",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.length>1&&void 0!==o[1]?o[1]:{},e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),j={},I={},M=["udp://explodie.org:6969","udp://track.coppersurfer.tk:6969","udp://track.empire-js.us:1337","udp://track.leechers-paradise.org:6969","udp://track.opentrackr.org:1337","wss://track.fastcast.nz","wss://track.openwebtorrent.com","wss://track.btorrent.xyz"];function A(){return C.apply(this,arguments)}function C(){return(C=Object(o.a)(a.a.mark((function e(){var t,n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=customElements.get("audio-source-loader"),n="node_modules/webtorrent/webtorrent.min.js",(r=t.findScript(n,!1))||(window.exports={},window.module={exports:window.exports},(r=document.createElement("script")).promises=(r.promises||[]).concat(new Promise(function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.onload=function(e){r.exports=window.module.exports,delete window.module,delete window.exports,t()},document.head.appendChild(r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))),i=0;case 5:if(!(i<r.promises.length)){e.next=11;break}return e.next=8,r.promises[i];case 8:i++,e.next=5;break;case 11:return e.abrupt("return",r.exports||function(){throw new Error("Script module has no exports: "+n)}());case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,[{key:"log",value:function(e){console.info(e)}},{key:"loadBufferFromURL",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.toString().startsWith("torrent://")){e.next=7;break}return console.time("getFileBufferFromTorrent"),e.next=4,this.getFileBufferFromTorrent(t);case 4:return n=e.sent,console.timeEnd("getFileBufferFromTorrent"),e.abrupt("return",n);case 7:return e.next=9,fetch(t);case 9:return r=e.sent,e.next=12,r.arrayBuffer();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMagnetURL",value:function(e){return"magnet:?xt=urn:btih:".concat(e,"&dn=torrent&").concat(M.map((function(e){return"tr="+e})).join("&"))}},{key:"getFileBufferFromTorrent",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i,s,u,c,l,f,d,h,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=function(){return(p=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){t.getBuffer(function(){var t=Object(o.a)(a.a.mark((function t(n,r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=2;break}throw new Error(n);case 2:e(r);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},h=function(e){return p.apply(this,arguments)},n=t.match(/^(torrent?:)\/\/(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/),r=n&&{hostname:n[3],pathname:n[5]},i=r.hostname,s=r.pathname.substr(1),e.next=8,this.getTorrent(i);case 8:u=e.sent,c=0;case 10:if(!(c<u.files.length)){e.next=30;break}if(l=u.files[c],s!==l.path){e.next=16;break}return e.next=15,h(l);case 15:return e.abrupt("return",e.sent);case 16:if(!s.startsWith(l.path)){e.next=27;break}if(f=s.substr(l.path.length),d=void 0,"undefined"!==typeof j[l.path]?d=j[l.path]:(d=h(l),j[l.path]=d),!(d instanceof Promise)){e.next=24;break}return e.next=23,d;case 23:d=e.sent;case 24:return e.next=26,this.getFileBufferFromArchive(d,f);case 26:return e.abrupt("return",e.sent);case 27:c++,e.next=10;break;case 30:throw new Error("Archive file not found: "+s);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFileBufferFromArchive",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decompress7ZipArchive(t);case 2:r=e.sent,o=0;case 4:if(!(o<r.length)){e.next=11;break}if((i=r[o]).path!==n){e.next=8;break}return e.abrupt("return",i.data);case 8:o++,e.next=4;break;case 11:throw new Error("Archive file not found: "+n);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTorrent",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o,i,s=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:if(n=e.sent,!I[t]){e.next=8;break}if(!(I[t]instanceof Promise)){e.next=7;break}return e.next=7,I[t];case 7:return e.abrupt("return",I[t]);case 8:return r=this.getMagnetURL(t),o=new n,I[t]=new Promise((function(e,t){s.log("Connecting to cloud url: "+r),o.add(r,(function(t){e(t)}))})),e.next=13,I[t];case 13:return I[t]=e.sent,i=I[t],this.log("Connected to cloud: "+i.infoHash),e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"decompress7ZipArchive",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 268435456,r=!1,"/data","archive.7z",(n=[]).push(new(s=function(e,t,n){this.path=e,this.isdir=t,this.data=n})("/data",!0,null)),o=new Uint8Array(t),n.push(new s("/data/archive.7z",!1,o)),"assets/3rdparty/7zip/js/worker.7z.wrapper.js",i=new Worker("assets/3rdparty/7zip/js/worker.7z.wrapper.js"),e.next=13,new Promise((function(e,t){i.onerror=console.error,i.onmessage=function(t){if(r)return i.terminate(),i=void 0,void(r=!1);1===t.data.type||2===t.data.type||3===t.data.type&&(e(t.data.results),i.terminate())};var a=[n[0],n[1]],o=["x",a[1].path,"-o/result"];i.postMessage({id:1,action:"doit",arguments:o,totalMemory:268435456,FilesDataArray:a})}));case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T=Symbol("proxy_target"),N=Symbol("proxy_listener"),R=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(s.a)(this,e),this.path=n,this.song=t,this.updateTimeout=null,this.changeListeners=[]}return Object(u.a)(e,[{key:"addChangeListener",value:function(e){this.changeListeners(e)}},{key:"removeChangeListener",value:function(e){var t=this.changeListeners.indexOf(e);-1!==t&&this.changeListeners.splice(t)}},{key:"get",value:function(t,n){var r=this;switch(n){case T:return t;case N:return this;case"indexOf":return function(e,n,r){return t.indexOf(e,n,r)};case"splice":return function(e,n){for(var a=arguments.length,o=new Array(a>2?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];return r.splice.apply(r,[t,r.path.concat(e),e,n].concat(o))};default:var a=this.path.concat(n);return"object"===typeof t[n]?new Proxy(t[n],new e(this.song,a)):t[n]}}},{key:"set",value:function(e,t,n){return e[t]=n,this.queueChange("set",this.path.concat(t),n),!0}},{key:"deleteProperty",value:function(e,t){return t in e&&(delete e[t],this.queueChange("delete",this.path.concat(t))),!0}},{key:"queueChange",value:function(e,t){this.song.queueHistoryAction(e,t);for(var n=0;n<this.changeListeners.length;n++)this.changeListeners[n](e,t)}},{key:"splice",value:function(e,t,n,r){if(!Array.isArray(e))throw new Error("Splice may only be used in array objects for path: ".concat(t.join(".")));for(var a=arguments.length,o=new Array(a>4?a-4:0),i=4;i<a;i++)o[i-4]=arguments[i];e.splice.apply(e,[n,r].concat(o)),this.queueChange.apply(this,["splice",t,n,r].concat(o))}}],[{key:"resolveProxiedObject",value:function(e){return e[T]||e}},{key:"addChangeListener",value:function(e,t){e[N].addChangeListener(t)}}]),e}();R.TARGET=T,R.LISTENER=N;var B=n(12),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(s.a)(this,e),this.config=t,this.audioContext=n,this.audioBuffer=null,this.loadAudioBuffer()}return Object(u.a)(e,[{key:"loadAudioBuffer",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.config.url);case 2:return t=e.sent,e.next=5,t.arrayBuffer();case 5:n=e.sent,this.audioBuffer=this.audioContext.decodeAudioData(n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"playFrequency",value:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=e.context.createGain();i.gain.value=parseFloat(a||127)/127,i.connect(e);var s=(e=i).context.createBufferSource();s.buffer=this.audioBuffer,"undefined"!==typeof this.config.loop&&(s.loop=!!this.config.loop);var u=t/(this.config.root?this.getCommandFrequency(this.config.root):440);return s.playbackRate.value=u,"undefined"!==typeof this.config.detune&&(s.detune.value=this.config.detune),s.connect(e),s.start(n),s.stop(n+r),o&&(s.onended=o),s}}]),e}(),z=n(0),U=n.n(z),q=n(4),G=(n(118),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={open:!1},n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"getSong",value:function(){return this.props.song}},{key:"getSampleID",value:function(){return this.props.sampleID}},{key:"getInstrumentID",value:function(){return this.props.instrumentID}},{key:"getSampleData",value:function(){return this.props.sampleData}},{key:"render",value:function(){var e=this,t=this.getSampleData(),n=t.url.replace(/\.(wav|mp3)$/,""),r="audiobuffer-instrument-renderer";return this.state.open&&(r+=" open"),U.a.createElement(q.c,{className:r},U.a.createElement(q.a,{title:"Change Sample",className:"name",onAction:function(t){return e.toggleOpen(t)}},n||"Unnamed"),this.state.open?U.a.createElement(U.a.Fragment,null,"undefined"===typeof t.mixer?null:U.a.createElement(q.c,{title:"Edit Mixer",className:"mixer"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuChangeMixer(t)},vertical:!0,openOnHover:!1},t.mixer+"%")),"undefined"===typeof t.detune?null:U.a.createElement(q.c,{title:"Detune by ".concat(t.detune," cents"),className:"detune"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuChangeDetune(t)},vertical:!0,openOnHover:!1},t.detune+"c")),"undefined"===typeof t.root?null:U.a.createElement(q.c,{title:"Key Root is ".concat(t.root),className:"root"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuChangeKeyRoot(t)},vertical:!0,openOnHover:!1},t.root)),"undefined"===typeof t.alias?null:U.a.createElement(q.c,{title:"Key Alias is ".concat(t.alias),className:"alias"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuChangeKeyAlias(t)},vertical:!0,openOnHover:!1},t.alias)),"undefined"===typeof t.range?null:U.a.createElement(q.c,{title:"Key Range is ".concat(t.range),className:"range"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuChangeKeyRange(t)},vertical:!0,openOnHover:!1},t.range)),"undefined"===typeof t.loop?null:U.a.createElement(q.c,{title:"Toggle Loop",className:"loop"},U.a.createElement(q.a,{title:"",onAction:function(n){return e.changeLoop(!t.loop)},arrow:!1,vertical:!0,openOnHover:!1},t.loop?"\u221e":"\u21e5"))):null,U.a.createElement(q.c,{title:"Edit Sample '".concat(n,"'"),className:"config"},U.a.createElement(q.a,{onAction:function(t){return e.openMenuRoot(t)},vertical:!0,openOnHover:!1},U.a.createElement(q.d,{source:"config"}))))}},{key:"openMenu",value:function(e,t){if("function"!==typeof this.props.openMenu)throw new Error("Invalid 'openMenu' props");this.props.openMenu(e,t)}},{key:"openMenuRoot",value:function(e){var t=this;this.openMenu(e,U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:function(){},disabled:!0},"Sample ",this.props.sampleID),U.a.createElement(q.g,null),U.a.createElement(q.h,{key:"mixer",onAction:function(e){return t.openMenuChangeMixer(e)}},"Edit Mixer"),U.a.createElement(q.h,{key:"detune",onAction:function(e){return t.openMenuChangeDetune(e)}},"Edit Detune"),U.a.createElement(q.h,{key:"root",onAction:function(e){return t.openMenuChangeKeyRoot(e)}},"Edit Key Root"),U.a.createElement(q.h,{key:"alias",onAction:function(e){return t.openMenuChangeKeyAlias(e)}},"Edit Key Alias"),U.a.createElement(q.h,{key:"range",onAction:function(e){return t.openMenuChangeKeyRange(e)}},"Edit Key Range"),U.a.createElement(q.h,{key:"loop",onAction:function(e){return t.openMenuChangeLoop(e)}},"Toggle Loop"),U.a.createElement(q.g,null),U.a.createElement(q.h,{key:"change",onAction:function(e){return t.openMenuChangeSample(e)}},"Change Sample"),U.a.createElement(q.f,{key:"remove",onAction:function(e){return t.renderMenu("voice-remove")}},"Remove Sample")))}},{key:"openMenuChangeSample",value:function(e){var t=this.getSampleData();this.openMenu(e,U.a.createElement(q.e,{min:0,max:100,value:t.mixer}))}},{key:"openMenuChangeMixer",value:function(e){var t=this,n=this.getSampleData();this.openMenu(e,U.a.createElement(q.e,{min:0,max:100,value:"undefined"!==typeof n.mixer?n.mixer:100,onChange:function(e,n){return t.changeMixer(n)}}))}},{key:"openMenuChangeDetune",value:function(e){var t=this,n=this.getSampleData();this.openMenu(e,U.a.createElement(q.e,{min:-1e3,max:1e3,value:"undefined"!==typeof n.detune?n.detune:100,onChange:function(e,n){return t.changeDetune(n)}}))}},{key:"openMenuChangeKeyRoot",value:function(e){var t=this,n=this.getSong().values;this.openMenu(e,U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Key Root"),U.a.createElement(q.g,null),n.getNoteOctaves((function(e){return U.a.createElement(q.h,{onAction:function(r){return t.openMenu(r,n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return t.changeRoot(n+e)}},n+e)})))}},e)}))))}},{key:"openMenuChangeKeyAlias",value:function(e){var t=this,n=this.getSong().values;this.openMenu(e,U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Key Root"),U.a.createElement(q.g,null),n.getNoteOctaves((function(e){return U.a.createElement(q.h,{onAction:function(r){return t.openMenu(r,n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return t.changeAlias(n+e)}},n+e)})))}},e)}))))}},{key:"openMenuChangeKeyRange",value:function(e){this.openMenu(e)}},{key:"openMenuChangeLoop",value:function(e){this.openMenu(e)}},{key:"renderMenu",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.getSong().values;switch(t){case"voice-loop":case"voice-remove":case null:return;case"voice-change":return U.a.createElement(U.a.Fragment,null);case"voice-mixer":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.g,null),U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Mixer"));case"voice-detune":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.g,null),U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Detune"));case"voice-root":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Key Root"),U.a.createElement(q.g,null),n.getNoteOctaves((function(t){return U.a.createElement(q.f,{onAction:function(){return n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return e.changeRoot(n+t)}},n+t)}))}},t)})));case"voice-alias":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Key Alias"),U.a.createElement(q.g,null),n.getNoteOctaves((function(t){return U.a.createElement(q.f,{onAction:function(){return n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return e.changeAlias(n+t)}},n+t)}))}},t)})));case"voice-range":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Edit Key Range"),U.a.createElement(q.g,null),U.a.createElement(q.f,{onAction:function(t){return e.renderMenu("voice-range-start")}},"Set Range Start"),U.a.createElement(q.f,{onAction:function(t){return e.renderMenu("voice-range-end")}},"Set Range End"));case"voice-range-start":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Range Start"),U.a.createElement(q.g,null),n.getNoteOctaves((function(t){return U.a.createElement(q.f,{onAction:function(){return n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return e.changeRange(n+t)}},n+t)}))}},t)})));case"voice-range-end":return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:null,disabled:!0},"Range End"),U.a.createElement(q.g,null),n.getNoteOctaves((function(t){return U.a.createElement(q.f,{onAction:function(){return n.getNoteFrequencies((function(n){return U.a.createElement(q.f,{onAction:function(r){return e.changeRange(null,n+t)}},n+t)}))}},t)})));default:throw new Error("Unknown menu key: "+t)}}},{key:"toggleOpen",value:function(e){this.setState({open:!this.state.open})}},{key:"changeMixer",value:function(e){if(!Number.isInteger(e))throw new Error("Invalid mixer value type: "+typeof e);this.config.samples[this.getSampleID()].mixer=e}},{key:"changeDetune",value:function(e){if(!Number.isInteger(e))throw new Error("Invalid detune value type: "+typeof e);this.config.samples[this.getSampleID()].detune=e}},{key:"changeRoot",value:function(e){this.config.samples[this.getSampleID()].root=e}},{key:"changeAlias",value:function(e){this.config.samples[this.getSampleID()].alias=e}},{key:"changeLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e&&(e=!this.getSampleData().loop),this.config.samples[this.getSampleID()].loop=e?1:0}}]),t}(function(e){function t(){return Object(s.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),t}(U.a.Component))),V=function(){function e(t){Object(s.a)(this,e),this.audioContext=t}return Object(u.a)(e,[{key:"isPeriodicWaveAvailable",value:function(t){return!!e.waveURLCache[t]}},{key:"getCachedPeriodicWaveFromURL",value:function(t){return e.waveURLCache[t]}},{key:"loadPeriodicWaveFromURL",value:function(){var t=Object(o.a)(a.a.mark((function t(n){var r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.waveURLCache[n]){t.next=2;break}return t.abrupt("return",e.waveURLCache[n]);case 2:return t.next=4,fetch(n);case 4:return r=t.sent,t.next=7,r.json();case 7:if((o=t.sent).real){t.next=10;break}throw new Error("Invalid 'real' data for createPeriodicWave");case 10:if(o.imag){t.next=12;break}throw new Error("Invalid 'imag' data for createPeriodicWave");case 12:return t.abrupt("return",e.waveURLCache[n]=this.audioContext.createPeriodicWave(new Float32Array(o.real),new Float32Array(o.imag)));case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),e}();V.waveURLCache={};var W=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.config=t}return Object(u.a)(e,[{key:"useDestination",value:function(e){return null}},{key:"playFrequency",value:function(t,n,r,a,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=t.context,u=new V(s);if(null!==o){var c=t.context.createGain();c.gain.value=parseFloat(o||127)/127,c.connect(t),t=c}var l=t.context.createOscillator();switch(l.frequency.value=n,"undefined"!==typeof this.config.detune&&(l.detune.value=this.config.detune),this.config.type){default:l.type=this.config.type;break;case"custom":if(!this.config.url)throw new Error("Custom osc requires a url");u.isPeriodicWaveAvailable(this.config.url)?l.setPeriodicWave(u.getCachedPeriodicWaveFromURL(this.config.url)):u.loadPeriodicWaveFromURL(this.config.url).then((function(e){return l.setPeriodicWave(e)}))}l.connect(t),l.start(r),l.stop(r+a),e.playingOSCs.push(l),l.onended=function(){var t=e.playingOSCs.indexOf(l);-1!==t&&e.playingOSCs.splice(t,1),i&&i()}}}],[{key:"stopPlayback",value:function(){for(var e=0;e<this.playingOSCs.length;e++)try{this.playingOSCs[e].stop()}catch(t){console.warn(t)}this.playingOSCs=[]}},{key:"unloadAll",value:function(){this.waveURLCache={}}}]),e}();W.playingOSCs=[],W.waveURLCache={};var H=W,K=(n(119),n(24)),Y=n(13),J=function(e){function t(){return Object(s.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t="instrument-renderer-oscillator-node";this.state.open&&(t+=" open");var n=this.getTitle();return U.a.createElement("div",{className:t},U.a.createElement("div",{className:"title",title:"Oscillator: ".concat(n),onClick:this.cb.onClick},n),this.renderParameters(),U.a.createElement(q.h,{arrow:!1,className:"config",options:function(){return e.renderMenuRoot()}},U.a.createElement(q.d,{source:"config"})))}}]),t}(function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={open:!1},n.cb={onClick:function(e){return n.toggleOpen()}},n.library=K.a.loadDefault(),n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.config.type||(console.warn("No default oscillator type was set. Setting to 'sawtooth'"),this.props.config.type="sawtooth")}},{key:"getTitle",value:function(){return this.props.config.title||this.props.config.type||"Unknown Osc"}},{key:"renderParameters",value:function(){var e=this;if(!this.state.open)return[];var t=this.props.config;return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.h,{title:"Edit Mixer",className:"mixer",options:function(){return e.renderMenuChangeMixer()},arrow:!1,vertical:!0},"undefined"!==typeof t.mixer?t.mixer+"%":"100%"),U.a.createElement(q.h,{title:"Detune by ".concat(t.detune," cents"),className:"detune",options:function(){return e.renderMenuChangeDetune()},arrow:!1,vertical:!0},"undefined"!==typeof t.detune?t.detune+"c":"0c"),t.root?U.a.createElement(q.h,{title:"Key Root is ".concat(t.root),className:"root",options:function(){return e.renderMenuChangeKeyRoot()},arrow:!1,vertical:!0},t.root?t.root:"-"):null,t.alias?U.a.createElement(q.h,{title:"Key Alias is ".concat(t.alias),className:"alias",options:function(){return e.renderMenuChangeKeyAlias()},arrow:!1,vertical:!0},t.alias?t.alias:"-"):null,t.range?U.a.createElement(q.h,{title:"Key Range is ".concat(t.range),className:"range",options:function(){return e.renderMenuChangeKeyRange()},arrow:!1,vertical:!0},t.range?t.range:"-"):null,U.a.createElement(q.f,{className:"loop",title:"Toggle Loop",onAction:function(n){return e.changeLoop(!t.loop)},arrow:!1,vertical:!0},t.loop?"\u221e":"1"))}},{key:"toggleOpen",value:function(){this.setState({open:!this.state.open})}},{key:"changeMixer",value:function(e){if(!Number.isInteger(e))throw new Error("Invalid mixer value type: "+typeof e);this.props.config.mixer=e}},{key:"changeDetune",value:function(e){if(!Number.isInteger(e))throw new Error("Invalid detune value type: "+typeof e);this.props.config.detune=e}},{key:"changeRoot",value:function(e){this.props.config.root=e}},{key:"changeAlias",value:function(e){this.props.config.alias=e}},{key:"changeOscillator",value:function(e){"custom"===e||(delete this.props.config.url,delete this.props.config.real,delete this.props.config.imag,delete this.props.config.title,this.props.config.type=e)}},{key:"changeLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e&&(e=!this.props.config.loop),this.props.config.loop=e?1:0}},{key:"loadPreset",value:function(e){console.log("Loading preset: ",e),e.type="custom",Object.assign(this.props.config,e)}},{key:"renderMenuRoot",value:function(){var e=this;return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:function(){},disabled:!0},"Oscillator: ",this.getTitle()),U.a.createElement(q.g,null),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeOscillator()}},"Change Oscillator"),U.a.createElement(q.g,null),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeMixer()}},"Edit Mixer"),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeDetune()}},"Edit Detune"),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeKeyRoot()}},"Edit Key Root"),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeKeyAlias()}},"Edit Key Alias"),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeKeyRange()}},"Edit Key Range"),U.a.createElement(q.h,{options:function(){return e.renderMenuChangeLoop()}},"Toggle Loop"),U.a.createElement(q.f,{disabled:!this.props.onRemove,onAction:function(t){return e.props.onRemove(e.props.instrumentID)}},"Remove Oscillator"))}},{key:"renderMenuChangeOscillator",value:function(){var e=this;return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.h,{options:function(){return e.renderMenuChangeOscillatorStandard()}},"Standard"),U.a.createElement(q.g,null),this.library.renderMenuProgramAllPresets((function(t){var n=Object(i.a)(t,2),r=n[0],a=n[1];e.loadPreset(r,a)})))}},{key:"renderMenuChangeOscillatorStandard",value:function(){var e=this;return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{onAction:function(t){return e.changeOscillator("sine")}},"Sine"),U.a.createElement(q.f,{onAction:function(t){return e.changeOscillator("square")}},"Square"),U.a.createElement(q.f,{onAction:function(t){return e.changeOscillator("sawtooth")}},"Sawtooth"),U.a.createElement(q.f,{onAction:function(t){return e.changeOscillator("triangle")}},"Triangle"))}},{key:"renderMenuChangeMixer",value:function(){var e=this,t=this.props.config;return U.a.createElement(q.e,{min:0,max:100,value:"undefined"!==typeof t.mixer?t.mixer:100,onChange:function(t,n){return e.changeMixer(n)}})}},{key:"renderMenuChangeDetune",value:function(){var e=this,t=this.props.config;return U.a.createElement(q.e,{min:-1e3,max:1e3,value:"undefined"!==typeof t.detune?t.detune:100,onChange:function(t,n){return e.changeDetune(n)}})}},{key:"renderMenuChangeKeyRoot",value:function(){var e=this;return Y.a.renderMenuSelectCommand((function(t){e.changeRoot(t)}))}},{key:"renderMenuChangeKeyAlias",value:function(){var e=this;return Y.a.renderMenuSelectCommand((function(t){e.changeAlias(t)}))}},{key:"renderMenuChangeKeyRange",value:function(){return U.a.createElement(U.a.Fragment,null,"TODO")}},{key:"renderMenuChangeLoop",value:function(){return U.a.createElement(U.a.Fragment,null,"TODO")}}]),t}(U.a.Component)),Q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.config=t}return Object(u.a)(e,[{key:"loadVoice",value:function(e){if(!this.config.voices[e])throw new Error("Voice config is missing: "+e);var t=Object(i.a)(this.config.voices[e],2),n=t[0],r=t[1];return new(0,c.a.getProgramClassInfo(n).classProgram)(r)}},{key:"playFrequency",value:function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=0;i<this.config.voices.length;i++){var s=this.loadVoice(i);s.playFrequency(e,t,n,r,a,o)}}},{key:"stopPlayback",value:function(){for(var e=0;e<this.config.voices.length;e++)try{this.loadVoice(e).stopPlayback()}catch(t){console.warn(t)}}},{key:"unloadAll",value:function(){}}]),e}(),X=(n(121),n(42)),$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).cb={onRemove:function(e){return n.removeVoice(e)},onAction:function(e){return n.addVoice()}},n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"setStatus",value:function(e){console.info(this.constructor.name,"setStatus",e)}},{key:"setError",value:function(e){console.error(this.constructor.name,"setStatus",e)}},{key:"wrapVoiceWithNewInstrument",value:function(e){}},{key:"addVoice",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o,i,s,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(u.length>1&&void 0!==u[1])||u[1],t){e.next=3;break}throw new Error("Invalid voice instrument class");case 3:if(r=c.a.getProgramClassInfo(t),o=r.title,i={},e.t0=!1===n,e.t0){e.next=10;break}return e.next=9,X.a.openConfirmDialog("Add voice class '".concat(o,"' to Instrument?"));case 9:e.t0=e.sent;case 10:if(!e.t0){e.next=16;break}s=this.props.config.voices.length,this.props.config.voices[s]=[t,i],this.setStatus("Instrument '".concat(t,"' added as voice ").concat(s)),e.next=17;break;case 16:this.setError("New voice canceled: ".concat(t));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renameVoice",value:function(e,t){}},{key:"removeVoice",value:function(e){var t=this.props.config.voices;if("undefined"===typeof t[e])throw new Error("Voice ID not found: "+e);t.splice(e,1)}},{key:"renderMenuAddVoice",value:function(){var e=this,t=K.a.loadDefault();return U.a.createElement(U.a.Fragment,null,U.a.createElement(q.f,{disabled:!0,action:function(){}},"Add new voice instrument"),U.a.createElement(q.g,null),t.songLengthAllPresets((function(t){var n=Object(i.a)(t,2),r=n[0],a=n[1];e.addVoice(r,a)})))}}]),t}(U.a.Component),Z=n(48),ee=function(e){function t(){return Object(s.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.config.voices;return U.a.createElement("div",{className:"polyphony-instrument-renderer"},U.a.createElement("div",{className:"voices"},t.map((function(t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],s=Z.a.getProgramClassInfo(a).classRenderer;return U.a.createElement(s,{onRemove:e.cb.onRemove,key:n,instrumentID:n,config:o})}))),U.a.createElement(q.b,{title:"Add new voice",className:"add-voice",arrow:!1,options:function(){return e.renderMenuAddVoice()}},"+"))}}]),t}($),te=null,ne=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.config=t,null===te&&(te=new D).init()}return Object(u.a)(e,[{key:"connect",value:function(e){}},{key:"loadBuffer",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileBuffer||(t=this.config.fileURL,n=new F,this.fileBuffer=n.loadBufferFromURL(t),console.info("SPC ASPlayer loaded")),!(this.fileBuffer instanceof Promise)){e.next=5;break}return e.next=4,this.spcBuffer;case 4:this.spcBuffer=e.sent;case 5:return e.abrupt("return",this.fileBuffer);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadGMEPlayer",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBuffer();case 2:return n=e.sent,e.abrupt("return",te.loadPlayerFromBuffer(t.context,t,n,"file",{destination:t}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.audioContext=t,!this.config.fileURL){e.next=4;break}return e.next=4,this.loadBuffer();case 4:console.info("SPC ASPlayer initialized");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n,r,o,i){var s,u,c,l,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadGMEPlayer(t);case 2:if(s=e.sent,this.spcPlayers.push(s),u=t.context.currentTime,!((r=null!==r?r:u)>u)){e.next=10;break}return c=r-u,e.next=10,new Promise((function(e,t){return setTimeout(e,1e3*c)}));case 10:if(r<u&&(l=1e3*(u-r),s.seekPlaybackPosition(l)),s.play(t),!o){e.next=17;break}return f=r+o-t.context.currentTime,e.next=16,new Promise((function(e,t){return setTimeout(e,1e3*f)}));case 16:s.pause();case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,o){return e.apply(this,arguments)}}()},{key:"stopPlayback",value:function(){for(var e=0;e<this.spcPlayers.length;e++)this.spcPlayers[e].pause()}},{key:"getFrequencyFromAlias",value:function(e){return null}},{key:"getCommandFrequency",value:function(e){var t=this.getCommandKeyNumber(e);return 440*Math.pow(2,(t-49)/12)}},{key:"getCommandKeyNumber",value:function(e){if(Number(e)===e&&e%1!==0)return e;if(!e)return null;var t=this.noteFrequencies,n=3===e.length?e.charAt(2):e.charAt(1),r=t.indexOf(e.slice(0,-1));return r=r<3?r+12+12*(n-1)+1:r+12*(n-1)+1}},{key:"noteFrequencies",get:function(){return["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"]}}]),e}(),re=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s.a)(this,t),console.log(n),(e=Object(h.a)(this,Object(p.a)(t).call(this,n))).config=n.config||{},e.state={},e}return Object(v.a)(t,e),t}(U.a.Component),ae=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(s.a)(this,e),this.config={},this.audioContext=t}return Object(u.a)(e,[{key:"playFrequency",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;arguments.length>5&&void 0!==arguments[5]&&arguments[5];console.info("playFrequency(",t,n,r,a,")")}}]),e}(),oe=function(){c.a.addProgramClass("AudioBufferInstrument",L,G,"AudioBuffer Instrument"),c.a.addProgramClass("OscillatorInstrument",H,J,"OscillatorNode Instrument"),c.a.addProgramClass("PolyphonyInstrument",Q,ee,"Audio Source Synthesizer"),c.a.addProgramClass("GMEPlayerSynthesizer",ne,re,"Game Music ASPlayer Synthesizer"),c.a.addProgramClass("TestInstrument",ae,null,"Test Instrument")},ie=n(25),se=n(34);oe();var ue=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.eventListeners=[],this.programLoader=new c.a(this),this.volume=null,this.lastVolumeGain=null,this.playback=null;var r={title:e.generateTitle(),uuid:Y.a.generateUUID(),version:"0.0.1",created:(new Date).getTime(),timeDivision:384,beatsPerMinute:120,beatsPerMeasure:4,startTrack:"root",programs:[["PolyphonyInstrument",{voices:[["OscillatorInstrument",{type:"sawtooth"}],["OscillatorInstrument",{type:"sawtooth"}]]}],["OscillatorInstrument",{type:"square"}]],tracks:{root:[["@track0",288],["@track1"]],track0:[["!p",0],[0,"C4",64],[64,"D4",64],[64,"E4",64],[64,"F4",64],[64,"G4",64],[64,"A4",64]],track1:[["!p",1],[64,"A3",64],[64,"A#q3",64],[64,"C4",64],[64,"C#q4",64],[64,"D#4",64],[64,"Eq4",64],[64,"F#4",64],[64,"Gq4",64],[64,"A4",64],[64,"A#q4",64],[64,"C5",64],[64,"C#q5",64],[64,"D#5",64],[64,"Eq5",64],[64,"F#5",64],[64,"Gq5",64],[64,"A5",64]]}};this.getProxiedData=function(){return r},this.data=new Proxy(r,new R(this)),this.history=[],this.values=new l.a(this),this.loadSongData(n),this.programLoadAll(),this.dispatchEventCallback=function(e){return t.dispatchEvent(e)}}return Object(u.a)(e,[{key:"connect",value:function(e){this.destination=e}},{key:"dispatchEvent",value:function(e){for(var t=0;t<this.eventListeners.length;t++){var n=Object(i.a)(this.eventListeners[t],2),r=n[0],a=n[1];e.name!==r&&"*"!==r||a(e)}}},{key:"addEventListener",value:function(e,t){this.eventListeners.push([e,t])}},{key:"removeEventListener",value:function(e,t){for(var n=0;n<this.eventListeners.length;n++){var r=Object(i.a)(this.eventListeners[n],2),a=r[0],o=r[1];if(e===a&&t===o){this.eventListeners.splice(n,1);break}}}},{key:"unloadAll",value:function(){this.programLoader.unloadAllPrograms(),this.eventListeners=[]}},{key:"loadSongData",value:function(e){var t=this.getProxiedData();if(this.playback&&this.stopPlayback(),Object.assign(t,e),this.playbackPosition=0,!t.tracks)throw new Error("No tracks found in song data");B.a.processInstructionTracks(t.tracks),this.dispatchEvent({type:"song:loaded",song:this})}},{key:"loadSongHistory",value:function(e){this.history=e}},{key:"getStartTrackName",value:function(){return"undefined"===typeof this.data.startTrack?this.data.startTrack:Object.keys(this.data.tracks)[0]}},{key:"hasTrack",value:function(e){return"undefined"!==typeof this.data.tracks[e]}},{key:"generateInstructionTrackName",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"track",t=this.data.tracks,n=0;n<=999;n++){var r=e+n;if(!t.hasOwnProperty(r))return r}throw new Error("Failed to generate group name")}},{key:"hasProgram",value:function(e){return!!this.data.programs[e]}},{key:"playProgram",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(null!==i){var u=e.context.currentTime;setTimeout(i,1e3*(r-u))}return"string"===typeof n&&(n=Y.a.parseFrequencyString(n)),t.playFrequency(e,n,r,a,o,s)}},{key:"programGetData",value:function(e){return this.programLoader.getData(e)}},{key:"programGetClassName",value:function(e){return this.programLoader.getClassName(e)}},{key:"programGetClass",value:function(e){return this.programLoader.getClass(e)}},{key:"programGetConfig",value:function(e){return this.programLoader.getConfig(e)}},{key:"programEach",value:function(e){return this.data.programs.map((function(t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1];return e(n,a,o)}))}},{key:"programLoadAll",value:function(){for(var e=this.data.programs,t=0;t<e.length;t++)e[t]&&this.programLoadInstanceFromID(t)}},{key:"programLoadInstanceFromID",value:function(e){return this.programLoader.loadInstanceFromID(e)}},{key:"programLoadRenderer",value:function(e){return this.programLoader.programLoadRenderer(e)}},{key:"programAdd",value:function(e){if("object"!==typeof e)throw new Error("Invalid programs config object");if(!e.className)throw new Error("Invalid Program Class");var t=this.data.programs.length;return this.data.programs[t]=e,this.programLoadInstanceFromID(t),t}},{key:"programReplace",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.data.programs[e];return this.data.programs[e]=[t,n],this.programLoadInstanceFromID(e),r}},{key:"programRename",value:function(e,t){this.programGetConfig(e).title=t}},{key:"programRemove",value:function(e){var t=this.data.programs;if(!t[e])return console.error("Invalid programs ID: "+e);var n=e===t.length-1,r=t[e];return n?delete t[e]:t[e]=null,r}},{key:"instructionIndexOf",value:function(e,t){if(t instanceof B.a&&(t=t.data),!this.data.tracks[e])throw new Error("Invalid instruction track: "+e);var n=this.data.tracks[e];t=R.resolveProxiedObject(t);var r=n.indexOf(t);if(-1===r)throw new Error("Instruction not found in instruction list");return r}},{key:"instructionGetList",value:function(e){if(!this.data.tracks[e])throw new Error("Invalid instruction track: "+e);return this.data.tracks[e]}},{key:"instructionGetByIndex",value:function(e,t){if(!this.data.tracks[e])throw new Error("Invalid instruction track: "+e);var n=this.instructionGetList(e);if(t<0||t>n.length)throw new Error("Index is out or range: "+t);if(!n[t])throw new Error("Invalid instruction index: "+t);return B.a.getInstruction(n[t])}},{key:"instructionGetIterator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.data.tracks[e])throw new Error("Invalid instruction track: "+e);var r=this.data.tracks[e];return new B.b(r,t||this.data.timeDivision,n||this.data.beatsPerMinute)}},{key:"instructionGetQuantizedIterator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.data.tracks[e])throw new Error("Invalid instruction track: "+e);var a=this.data.tracks[e];return new B.d(a,t,n||this.data.timeDivision,r||this.data.beatsPerMinute)}},{key:"instructionInsertAtPosition",value:function(e,t,n){if("string"===typeof t&&(t=Y.a.parseDurationAsTicks(t,this.data.timeDivision)),!Number.isInteger(t))throw new Error("Invalid integer: "+typeof t);if(!n)throw new Error("Invalid insert instruction");for(var r=B.a.parseInstruction(n),a=this.data.tracks[e],o=this.instructionGetIterator(e),i=o.nextInstruction();i;){var s=o.positionTicks;if(s>t){var u=[t-(s-i.deltaDurationTicks),s-t],c=o.currentIndex;return this.instructionReplaceDeltaDuration(e,c,u[1]),r.deltaDurationTicks=u[0],this.instructionInsertAtIndex(e,c,r),c}if(s===t){var l=void 0;for(l=o.currentIndex+1;l<a.length&&!(new B.a(a[l]).deltaDurationTicks>0);l++);return r.deltaDurationTicks=0,this.instructionInsertAtIndex(e,l,r),l}i=o.nextInstruction()}if(o.positionTicks>=t)throw new Error("Something went wrong");var f=a.length;return r.deltaDurationTicks=t-o.positionTicks,this.instructionInsertAtIndex(e,f,r),f}},{key:"instructionInsertAtIndex",value:function(e,t,n){if(!n)throw new Error("Invalid insert instruction");return n=B.a.parseInstruction(n).data,this.instructionGetList(e).splice(t,0,n),t}},{key:"instructionDeleteAtIndex",value:function(e,t){var n=this.instructionGetByIndex(e,t);if(n.deltaDurationTicks>0){var r=this.instructionGetByIndex(e,t+1,!1);r&&this.instructionReplaceDeltaDuration(e,t+1,r.deltaDurationTicks+n.deltaDurationTicks)}this.instructionGetList(e).splice(t,1)}},{key:"instructionReplaceDeltaDuration",value:function(e,t,n){this.instructionGetByIndex(e,t).deltaDurationTicks=n}},{key:"instructionReplaceCommand",value:function(e,t,n){this.instructionGetByIndex(e,t).command=n}},{key:"instructionReplaceProgram",value:function(e,t,n){this.instructionGetByIndex(e,t).program=n}},{key:"instructionReplaceDuration",value:function(e,t,n){"string"===typeof n&&(n=Y.a.parseDurationAsTicks(n,this.data.timeDivision)),this.instructionGetByIndex(e,t).durationTicks=n}},{key:"instructionReplaceVelocity",value:function(e,t,n){if(!Number.isInteger(n))throw new Error("Velocity must be an integer: "+n);if(n<0)throw new Error("Velocity must be a positive integer: "+n);this.instructionGetByIndex(e,t).velocity=n}},{key:"trackAdd",value:function(e,t){if(this.data.tracks.hasOwnProperty(e))throw new Error("New group already exists: "+e);this.data.tracks[e]=t||[]}},{key:"trackRemove",value:function(e){if("root"===e)throw new Error("Cannot remove root instruction track, n00b");if(!this.data.tracks.hasOwnProperty(e))throw new Error("Existing group not found: "+e);delete this.data.tracks[e]}},{key:"trackRename",value:function(e,t){if("root"===e)throw new Error("Cannot rename root instruction track, n00b");if(!this.data.tracks.hasOwnProperty(e))throw new Error("Existing group not found: "+e);if(this.data.tracks.hasOwnProperty(t))throw new Error("New group already exists: "+t);var n=this.data.tracks[e];delete this.data.tracks[e],this.data.tracks[t]=n}},{key:"getSongLengthInSeconds",value:function(){var e=new ie.a(this.data.tracks,this.getStartTrackName(),this.data.beatsPerMinute,this.data.timeDivision);return e.seekToEnd(),e.getEndPositionInSeconds()}},{key:"getSongPositionFromTicks",value:function(e){return this.getGroupPositionFromTicks(this.getStartTrackName(),e)}},{key:"getGroupPositionFromTicks",value:function(t,n){for(var r=this.instructionGetIterator(t);!(r.positionTicks>=n)&&r.nextInstruction(););var a=r.positionSeconds;if(n>r.positionTicks){var o=n-r.positionTicks;a+=e.ticksToSeconds(o,r.beatsPerMinute,r.timeDivision)}else if(n<r.positionTicks){var i=r.positionTicks-n;a-=e.ticksToSeconds(i,r.beatsPerMinute,r.timeDivision)}return a}},{key:"getSongPositionInTicks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e&&(e=this.getSongPlaybackPosition()),this.getGroupPositionInTicks(this.getStartTrackName(),e)}},{key:"getGroupPositionInTicks",value:function(t,n){for(var r=this.instructionGetIterator(t);!(r.positionSeconds>=n)&&r.nextInstruction(););var a=r.positionTicks;if(n>r.positionSeconds){var o=n-r.positionSeconds;a+=e.secondsToTicks(o,r.beatsPerMinute)}else if(n<r.positionSeconds){var i=r.positionSeconds-n;a-=e.secondsToTicks(i,r.beatsPerMinute)}return a}},{key:"setVolume",value:function(e){this.volume=e,this.lastVolumeGain&&(this.lastVolumeGain.gain.value=e)}},{key:"getVolumeGain",value:function(e){if(!e||!e.context)throw new Error("Invalid destination");var t=e.context.createGain();return t.gain.value=null===this.volume?1:this.volume,t.connect(e),this.lastVolumeGain=t,t}},{key:"getSongPlaybackPosition",value:function(){return this.playback?this.playback.audioContext.currentTime-this.playback.startTime:this.playbackPosition}},{key:"setPlaybackPositionInTicks",value:function(e){if(!Number.isInteger(e))throw new Error("Invalid start position in ticks");var t=this.getSongPositionFromTicks(e);return this.setPlaybackPosition(t)}},{key:"setPlaybackPosition",value:function(e){if(e=parseFloat(e),Number.isNaN(e))throw new Error("Invalid start position");this.playback&&this.stopPlayback(),this.playbackPosition=e,this.dispatchEvent({type:"song:seek",position:this.playbackPosition,song:this}),console.log("setPlaybackPosition",e)}},{key:"play",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:null,t=this.getVolumeGain(t),this.playback&&(this.stopPlayback(),this.setPlaybackPosition(0)),null===n&&(n=this.playbackPosition),console.log("Start playback:",n),r=new se.a(this,this.getStartTrackName(),this.dispatchEventCallback),this.playback=r,r.play(t,n),this.dispatchEvent({type:"song:play",playback:this.playback,song:this}),e.next=11,r.awaitPlaybackReachedEnd();case 11:return this.dispatchEvent({type:"song:end",playback:this.playback,song:this}),this.playback&&this.stopPlayback(),e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopProgramPlayback",value:function(e){this.programLoader.stopProgramPlayback(e)}},{key:"stopPlayback",value:function(){if(!this.playback)return console.warn("Playback is already stopped");var e=this.playback;this.playback=null,this.playbackPosition=e.getPositionInSeconds(),e.stopPlayback(),this.programLoader.stopAllPlayback(),console.log("End playback:",this.playbackPosition),this.dispatchEvent({type:"song:end",playback:this.playback,song:this})}},{key:"pause",value:function(){if(this.isPaused)throw new Error("Song is already paused");this.isPaused=!0}},{key:"resume",value:function(){if(!this.isPaused)throw new Error("Song is not paused");this.isPaused=!1}},{key:"isPlaying",value:function(){return!!this.playback}},{key:"playSelectedInstructions",value:function(e,t,n){e=this.getVolumeGain(e),this.playback&&this.stopPlayback();var r=new se.a(this,t,this.dispatchEventCallback);this.playback=r,r.addInstructionFilter((function(e,r){if(r.trackName!==t)return null;for(var a=r.iterator.currentIndex,o=0;o<n.length;o++)if(n[o]===a)return e})),n.length>0&&r.playAtStartingTrackIndex(e,n[0])}},{key:"playInstruction",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=(e=this.getVolumeGain(e)).context;if(!t instanceof B.a)throw new Error("Invalid instruction");var s=null;if("undefined"!==typeof t.durationTicks){var u=this.data.beatsPerMinute,c=this.data.timeDivision,l=t.durationTicks;s=l/c/(u/60)}var f=i.currentTime;r||0===r||(r=f),this.playProgram(e,n,t.command,r,s,t.velocity,a,o)}},{key:"queueHistoryAction",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Array.isArray(t)&&(t=t.join("."));var a=[e+":"+t];return null===n&&null===r||a.push(n),null!==r&&a.push(r),this.dispatchEvent({type:"song:modified",historyAction:a,song:this}),a}}],[{key:"ticksToSeconds",value:function(e,t,n){return e/n*(60/t)}},{key:"secondsToTicks",value:function(e,t,n){return Math.round(e*n/(60/t))}},{key:"loadSongFromData",value:function(t,n){var r=new e;return r.loadSongData(n),r}},{key:"loadSongFromMemory",value:function(t,n){var r=new f.a,a=r.loadSongFromMemory(n),o=r.loadSongHistoryFromMemory(n),i=new e(a);return i.loadSongData(a),i.loadSongHistory(o),i}},{key:"loadSongFromFileInput",value:function(t,n){var r=e.getFileSupportModule(n.name);if("function"!==typeof r.loadSongDataFromFileInput)throw new Error("Invalid library.loadSongDataFromFileInput method");var a=e.loadBufferFromFileInput(n),o=r.loadSongDataFromBuffer(a,n.name),i=new e;return i.loadSongData(o),i}},{key:"loadSongFromURL",value:function(){var t=Object(o.a)(a.a.mark((function t(n,r){var o,i,s,u,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"===typeof(o=e.getFileSupportModule(r)).loadSongDataFromBuffer){t.next=3;break}throw new Error("Invalid library.loadSongDataFromURL method: "+r);case 3:return i=new F,t.next=6,i.loadBufferFromURL(r);case 6:return s=t.sent,u=o.loadSongDataFromBuffer(s,r),(c=new e).loadSongData(u),t.abrupt("return",c);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadBufferFromFileInput",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=new FileReader;r.readAsArrayBuffer(t),r.onload=function(t){e(t.target.result)}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFileSupportModule",value:function(e){var t,n=e.split(".").pop().toLowerCase();switch(n){case"json":return t=new S;case"nsf":case"nsfe":case"spc":case"gym":case"vgm":case"vgz":case"ay":case"sgc":case"kss":return(t=new D).init(),t;default:throw new Error("Unknown file module for file type: "+n)}}},{key:"generateTitle",value:function(){return"Untitled (".concat((new Date).toJSON().slice(0,10).replace(/-/g,"/"),")")}}]),e}();ue.DEFAULT_VOLUME=.7;t.a=ue},function(e,t,n){"use strict";var r=n(3),a=n.n(r),o=n(8),i=n(1),s=n(2),u=n(61),c=n.n(u),l=n(13),f=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"setItem",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",localStorage.setItem(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getItem",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",localStorage.getItem(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),d=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,[{key:"getRecentSongList",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,f.getItem("song-recent-list");case 3:if(e.t1=e.sent,e.t1){e.next=6;break}e.t1="[]";case 6:return e.t2=e.t1,e.abrupt("return",e.t0.decodeForStorage.call(e.t0,e.t2));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"encodeForStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=JSON.stringify(e,t,n);return c.a.compress(r)}},{key:"decodeForStorage",value:function(e){return e?(e=c.a.decompress(e)||e,JSON.parse(e)):null}},{key:"saveState",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"audio-source-state",e.next=3,f.setItem(n,JSON.stringify(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadState",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"audio-source-state",e.next=3,f.getItem(t);case 3:return(n=e.sent)&&(n=JSON.parse(n)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"saveSongToMemory",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uuid||(t.uuid=l.a.generateUUID()),r=[],e.prev=2,e.t0=this,e.next=6,f.getItem("song-recent-list");case 6:if(e.t1=e.sent,e.t1){e.next=9;break}e.t1="[]";case 9:e.t2=e.t1,r=e.t0.decodeForStorage.call(e.t0,e.t2),e.next=16;break;case 13:e.prev=13,e.t3=e.catch(2),console.error(e.t3);case 16:return(r=r.filter((function(e){return e.uuid!==t.uuid}))).unshift({uuid:t.uuid,title:t.title}),e.next=20,f.setItem("song-recent-list",this.encodeForStorage(r));case 20:return e.next=22,f.setItem("song:"+t.uuid,this.encodeForStorage(t));case 22:return e.next=24,f.setItem("song-history:"+t.uuid,this.encodeForStorage(n));case 24:console.info("Song saved to memory: "+t.uuid,t);case 25:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveSongToFile",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="/** INSTRUCTIONS-"+l.a.generateUUID()+" **/",r=JSON.stringify(e.tracks),a=JSON.stringify(Object.assign({},e,{tracks:n}),null,"\t");a=a.replace('"'+n+'"',r);var o="data:text/json;charset=utf-8,"+encodeURIComponent(a),i=document.createElement("a");i.setAttribute("href",o);var s=(e.title||"untitled").replace(/\s+/g,"_")+".json";if(t&&(s=window.prompt("Download as file?",s)),!s)return console.warn("Download canceled");i.setAttribute("download",s),document.body.appendChild(i),i.click(),i.remove()}},{key:"loadSongFromMemory",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getItem("song:"+t);case 2:if(n=e.sent){e.next=5;break}throw new Error("Song Data not found for uuid: "+t);case 5:if(r=this.decodeForStorage(n)){e.next=8;break}throw new Error("Invalid Song Data: "+n);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSongHistoryFromMemory",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getItem("song-history:"+t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",this.decodeForStorage(n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBatchRecentCommands",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getItem("batch-recent-commands");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return t=JSON.parse(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addBatchRecentCommands",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1===(n=this.getBatchRecentCommands()).indexOf(t)&&n.unshift(t),e.next=4,f.setItem("batch-recent-commands",JSON.stringify(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBatchRecentSearches",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getItem("batch-recent-searches");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return t=JSON.parse(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addBatchRecentSearches",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1===(n=this.getBatchRecentSearches()).indexOf(t)&&n.unshift(t),e.next=4,f.setItem("batch-recent-searches",JSON.stringify(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.a=d},,,,,,function(e,t,n){},,,function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"clone",value:function(){return new t(this.data.slice())}},{key:"durationTicks",get:function(){return"undefined"!==typeof this.data[2]?this.data[2]:void 0},set:function(e){if(e=parseFloat(e),Number.isNaN(e))throw new Error("Invalid Duration");this.data[2]=e}},{key:"velocity",get:function(){return"undefined"!==typeof this.data[3]?this.data[3]:void 0},set:function(e){if(e=parseFloat(e),Number.isNaN(e))throw new Error("Invalid Velocity");this.data[3]=e}}]),t}(n(17).a);t.default=u},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=n(17),c=n(11),l=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getCommandName",value:function(){return"string"===typeof this.data[1]?this.data[1].substr(1):void 0}},{key:"setCommandName",value:function(e){this.data[1]="!".concat(e)}},{key:"getParams",value:function(){return this.data.slice(2)}},{key:"processCommandInstruction",value:function(e,t){var n=this.getCommandName().toLowerCase();switch(n){case"program":case"p":var r=t.program,a=t.destination,o=this.loadProgramFromParams(e);t.program=o,"function"===typeof o.useDestination&&(t.destination=o.useDestination(a)),"function"===typeof o.useProgram&&o.useProgram(r);break;default:return console.error("Unknown command instruction: "+n)}}},{key:"loadProgramFromParams",value:function(e){var t=this.getParams();return"string"===typeof t[0]?c.a.loadInstance(t[0],t[1]):e.programLoadInstanceFromID(t[0])}},{key:"clone",value:function(){return new t(this.data.slice())}},{key:"durationTicks",get:function(){}},{key:"velocity",get:function(){}}]),t}(u.a);t.default=l},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(123)},,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"instruction",get:function(){return this.data[2]},set:function(e){this.data[2]=e}},{key:"durationTicks",get:function(){return null},set:function(e){throw new Error("Unable to set duration on MIDI instruction")}}]),t}(n(17).a);t.default=u},function(e,t,n){},function(e,t,n){},function(e){e.exports=JSON.parse('{"title":"Mohayonao Wave-Table","url":"https://github.com/mohayonao/wave-tables","baseURL":"https://raw.githubusercontent.com/mohayonao/wave-tables/master/","default":"Brass.json","presets":[],"samples":["Bass.json","BassAmp360.json","BassFuzz.json","BassFuzz2.json","BassSubDub.json","BassSubDub2.json","Brass.json","BritBlues.json","BritBluesDriven.json","Buzzy1.json","Buzzy2.json","Celeste.json","ChorusStrings.json","Dissonant1.json","Dissonant2.json","DissonantPiano.json","DroppedSaw.json","DroppedSquare.json","DynaEPBright.json","DynaEPMed.json","Ethnic33.json","Full1.json","Full2.json","GuitarFuzz.json","Harsh.json","MklHard.json","Noise.json","Organ2.json","Organ3.json","PhonemeAh.json","PhonemeBah.json","PhonemeEe.json","PhonemeO.json","PhonemeOoh.json","PhonemePopAhhhs.json","Piano.json","Pulse.json","PutneyWavering.json","Saw.json","Square.json","TB303Square.json","Throaty.json","Triangle.json","Trombone.json","TwelveOpTines.json","TwelveStringGuitar1.json","WarmSaw.json","WarmSquare.json","WarmTriangle.json","Wurlitzer.json","Wurlitzer2.json"]}')},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(6),i=n(5),s=n(7),u=(n(49),n(50),n(48),n(12),n(46),n(25),n(34),n(24)),c=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTitle",value:function(){return"Mohayonao Wave Library Index"}},{key:"getPresets",value:function(){var e=n(120)||[];return e.samples.map((function(t){return"object"!==typeof t&&(t={url:t,type:"custom"}),t.title||(t.title=t.url.split("/").pop()),e.baseURL&&(t.url=e.baseURL+t.url),["OscillatorInstrument",t]}))}}]),t}(u.a),l=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTitle",value:function(){return"Periodic Wave Library Index"}},{key:"getLibraries",value:function(){return[new c]}}]),t}(u.a),f=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTitle",value:function(){return"FreeWaveSamples.com"}}]),t}(u.a),d=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTitle",value:function(){return"Sample Library Index"}},{key:"getLibraries",value:function(){return[new f]}},{key:"getPlaylists",value:function(){return["assets/files/test.pl.json;Test Playlist"]}}]),t}(u.a);n.d(t,"default",(function(){return h}));var h=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"getTitle",value:function(){return"Audio Source Index"}},{key:"getLibraries",value:function(){return[new d,new l,new c]}},{key:"getPlaylists",value:function(){return["assets/files/test.pl.json;Test ASPPlaylist"]}}]),t}(u.a)},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(32),i=n.n(o),s=(n(90),n(1)),u=n(2),c=n(6),l=n(5),f=n(7),d=(n(91),n(36)),h=n(49),p=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).song=null,n.webView=a.a.createRef(),n.cb={onMessage:function(e){return n.onMessage(e)}},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"postMessage",value:function(e){if("string"!==typeof e&&(e=JSON.stringify(e)),!window.ReactNativeWebView)return console.warn("SongProxyWebViewClient.postMessage: window.ReactNativeWebView is "+typeof window.ReactNativeWebView);window.ReactNativeWebView.postMessage(e)}},{key:"render",value:function(){var e=this;return this.song||(this.song=new h.a,window._SONG=this.song,document.addEventListener("message",(function(t){e.onMessage(t.data)}),!1),this.postMessage(["song:load",this.song.data.title])),a.a.createElement(d.a,null)}},{key:"onMessage",value:function(e){"["===e[0]?(e=JSON.parse(e),this.handleCommand.apply(this,e)):console.warn("Unhandled message: "+e)}},{key:"handleCommand",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];switch(e){case"song:load":var a=n[0];a=JSON.parse(a),this.song.loadSongData(a),console.log("song",this.song);break;case"song":var o=n.shift();switch(o){case"playSelectedInstructions":null===n[0]&&(n[0]=this.getAudioContext().destination)}console.log("song".concat(o,"(").concat(n.join(", "),")")),this.song[o].apply(this.song,n);break;default:console.error("Unknown command: "+e)}}},{key:"getAudioContext",value:function(){if(this.audioContext)return this.audioContext;var e=new(window.AudioContext||window.webkitAudioContext);return this.audioContext=e,e}}]),t}(a.a.Component),m=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).toggleMenu=function(){n.setState({menuOpen:!n.state.menuOpen}),n.state.menuOpen||n.playerElm.switchToMenu(null)},n.updateMenu=function(){n.forceUpdate()},n.state={},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"renderDrawerContent",value:function(){}},{key:"render",value:function(){return a.a.createElement(p,null)}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(m,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[85,1,2]]]);
//# sourceMappingURL=main.151da61f.chunk.js.map